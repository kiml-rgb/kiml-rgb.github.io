[{"title":"Obsidian çš„æ’ä»¶ä½¿ç”¨","url":"/posts/d62035eb/","content":"\n\nå‰è¨€æ•´ç†äº†ä¸€äº›å¸¸ç”¨çš„ Obsidian æ’ä»¶ã€‚\n\n\næ›´æ–°\n\n\n24-06-20 åˆå§‹è®°å½•\n\nå·¥å…·\nFile Tree å®šä½\n\næ›´å¥½çš„æ–‡ä»¶ç®¡ç†æ–¹å¼ã€‚\nä»‹ç»ï¼šå†…é“¾ï¼š[[Obsidian + Git + Hexo + å›¾åºŠ = Blog + ä¸ªäººç¬”è®°ä½“ç³»#File Tree å®šä½]]\nå¤–é“¾ï¼šFile Tree å®šä½\n\n\n\næ’ä»¶åç§°ï¼šFile Tree Alternative\n\n\nåˆ†äº«åœ°å€ï¼šobsidian://show-plugin?id=table-editor-obsidian\n\n\nAdvanced Tables\n\næ›´å¿«çš„è¡¨æ ¼åˆ›å»ºæ–¹å¼ã€‚\n\n\n\næ’ä»¶åç§°ï¼šAdvanced Tables\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=table-editor-obsidian\n\n\nAnnotator\n\nPDF é˜…è¯»å™¨ã€‚\n\n\n\næ’ä»¶åç§°ï¼šAnnotator\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=obsidian-annotator\n\n\nEmoji Toolbar\n\nåœ¨æ–‡ç« ä¸­æ’å…¥ emojiã€‚\n\n\n\næ’ä»¶åç§°ï¼šEmoji Toolbar\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=obsidian-emoji-toolbar\n\n\nePub Reader\n\nePub æ ¼å¼æ–‡ä»¶é˜…è¯»å™¨ã€‚\n\n\n\næ’ä»¶åç§°ï¼šePub Reader\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=obsidian-epub-plugin\n\n\nExcalidraw\n\nExcalidraw ç»˜å›¾å·¥å…·\n\n\n\næ’ä»¶åç§°ï¼šExcalidraw\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=obsidian-excalidraw-plugin\n\n\nLatex Suite\n\næ•°å­¦å…¬å¼æ”¯æŒ\n\n\n\næ’ä»¶åç§°ï¼šLatex Suite\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=obsidian-latex-suite\n\n\nPandoc\n\nå°† Markdown æ ¼å¼æ–‡ä»¶å¯¼å‡ºæˆå…¶ä»–æ ¼å¼æ–‡ä»¶ã€‚\n\n\n\næ’ä»¶åç§°ï¼šPandoc\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=obsidian-pandoc\n\n\nPrivacy Glasses\n\næ¨¡ç³Šå¤„ç†æ–‡ä»¶ï¼Œå¦‚æœåœ¨å…¬å…±åœºåˆå¤„ç†æ–‡ä»¶å¯ä»¥ç”¨åˆ°è¿™ä¸ªã€‚\n\n\n\næ’ä»¶åç§°ï¼šPrivacy Glasses\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=privacy-glasses\n\n\nç¾åŒ–\nLinter\n\nMarkdown æ–‡ä»¶æ ¼å¼åŒ–å·¥å…·ã€‚ï¼ˆåŒ…æ‹¬ä¸­æ—¥éŸ©è¯­ä¸è‹±æ–‡ä¹‹é—´çš„ç©ºæ ¼ï¼Œéå¸¸å¥½ç”¨ï¼‰\n\n\n\næ’ä»¶åç§°ï¼šLinter\n\n\nåˆ†äº«é“¾æ¥ï¼šobsidian://show-plugin?id=obsidian-linter\n\n\nBlue Topaz + Style Settings\n\nç›®å‰åœ¨ä½¿ç”¨çš„ä¸»é¢˜ï¼Œä¸»é¢˜å¯ä»¥ç›´æ¥åœ¨ Obsidian ä¸­æœç´¢ã€‚å¯ä»¥é…åˆ Style Settings ä¸€èµ·ä½¿ç”¨ï¼ˆéå¸¸å¥½ç”¨ï¼‰ã€‚\n\n\n\næ’ä»¶åç§°ï¼šStyle Settings\n\n\nåˆ†äº«åœ°å€ï¼šobsidian://show-plugin?id=obsidian-style-settings\n\n\n","categories":["åšå®¢"],"tags":["åšå®¢","Obsidian"]},{"title":"ä¼˜åŒ– Hexo ç½‘ç«™çš„æ°¸ä¹…é“¾æ¥æ ¼å¼","url":"/posts/ff783527/","content":"\n\nå‰è¨€æµè§ˆä¹‹å‰å¼•ç”¨çš„æ–‡ç« åœ°å€ï¼Œçªç„¶å‘ç°ï¼Œåœ°å€å…¨éƒ¨å˜æˆäº† 404ã€‚åæ¥å‘ç°æ¯æ¬¡å‘å¸ƒï¼Œåœ°å€é“¾æ¥éƒ½ä¼šæ”¹å˜ã€‚æ‰€ä»¥è®°å½•ä¸€ä¸‹ï¼Œæ€ä¹ˆå¤„ç†è¿™ä¸ªé—®é¢˜ã€‚\n\n\nå‚è€ƒæ–‡ç« \n\n\n\nä¼˜åŒ– Hexo ç½‘ç«™çš„æ°¸ä¹…é“¾æ¥æ ¼å¼\nHexoçš„SEOä¼˜åŒ–-ä½¿ç”¨abbrlinkè®¾ç½®æ°¸ä¹…é“¾æ¥ä¸ºéšæœºå€¼\n\n\næ›´æ–°\n\n24.05.22 åˆå§‹è®°å½•24.06.12 æ›¿æ¢æ’ä»¶ä¸ºabbrlink\n\næ‰“å¼€ Hexo é…ç½®æ–‡ä»¶å¯ä»¥çœ‹åˆ°åŸå…ˆçš„é…ç½®å¤„ä¸ºï¼š\nurl: https://kiml.github.iopermalink: :year/:month/:hash.htmlpermalink_defaults:pretty_urls:Â  trailing_index: true # Set to false to remove trailing &#x27;index.html&#x27; from permalinksÂ  trailing_html: true # Set to false to remove trailing &#x27;.html&#x27; from permalinks\nç…§ç†è¯´è¿™æ ·é…ç½®ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œç”±äº hash å€¼çš„è®¡ç®—ä¸æ–‡ç« æ ‡é¢˜æœ‰å…³ï¼Œå¯èƒ½æ˜¯å› ä¸ºè¿™æ ·ï¼Œé‡æ–°å‘å¸ƒåï¼Œæœ‰éƒ¨åˆ†é¡µé¢ä¼šç›´æ¥å˜æˆ 404 çš„çŠ¶æ€ã€‚\nä¼˜åŒ–\nå®‰è£…æ’ä»¶\nåœ¨ Hexo æ ¹ç›®å½•æ‰“å¼€ç»ˆç«¯å®‰è£…æ’ä»¶ã€‚ä¹‹å‰ä½¿ç”¨ abbrlink2ï¼Œä½†æ˜¯ clean ä¹‹åæ‰€æœ‰çš„é“¾æ¥éƒ½é‡æ’å¤±æ•ˆäº†ã€‚æ›¿æ¢æ–°çš„æ’ä»¶ï¼Œè¿™ä¸ªä¼šåœ¨æ–‡ç« å‰ç”Ÿæˆ abbrlink å€¼ï¼Œåªè¦ä¸åˆ é™¤é“¾æ¥å°±ä¸ä¼šå˜åŒ–ã€‚\nnpm install hexo-abbrlink --save\nä¿®æ”¹é…ç½®\nä¿®æ”¹ Hexo çš„é…ç½®æ–‡ä»¶çš„Â permalinkÂ å­—æ®µã€‚å½“æ°¸ä¹…é“¾æ¥å‚æ•°ä¸º permalink: posts/:abbrlink/ æ—¶ï¼Œç”Ÿæˆçš„æ–‡ç« é“¾æ¥ç±»ä¼¼äº /post/cd6eb56d/,ä¾‹å¦‚ https://xxx.com/post/cd6eb56d/ã€‚\nurl: https://kiml.github.iopermalink: posts/:abbrlink/\tpermalink_defaults:\nè®¾ç½® abbrlinkï¼Œåœ¨é…ç½®ä¸­æ·»åŠ \nabbrlink:Â  alg: crc32 Â #support crc16(default) and crc32Â  rep: hex Â  Â #support dec(default) and hex\nabbrlink å‚æ•°è¯´æ˜\nå‚æ•°ï¼šalg å¯¹åº”éšæœºå€¼ç®—æ³•å‚æ•°ï¼Œå¯é€‰ä¸º crc16 å’Œ crc32 å‚æ•°\nrep å¯¹åº”ç”Ÿæˆé“¾æ¥çš„è¡¨ç¤ºæ–¹æ³•ï¼Œhexï¼šåå…­è¿›åˆ¶ï¼Œdec: åè¿›åˆ¶\nå¯¹äº crc16 ç®—æ³•ç”Ÿæˆçš„éšæœºå€¼ï¼Œå…·æœ‰ä¸€ä¸ªæœ€å¤§é™åº¦ï¼Œä¸º 65536ã€‚\nä½¿ç”¨ abbrlink\næ¸…é™¤ä¹‹å‰çš„é“¾æ¥ç¼“å­˜ï¼Œå¹¶é‡æ–°ç”Ÿæˆæ›´æ–°\nhexo clean &amp; hexo g\n","categories":["åšå®¢"]},{"title":"GitåŠå¸¸ç”¨å‘½ä»¤","url":"/posts/41401b09/","content":"\n\nå‰è¨€\nGit éƒ¨åˆ†çŸ¥è¯†ä»¥åŠå¸¸ç”¨å‘½ä»¤\n\n\næ›´æ–°\n\n\n23.07.11 åˆå§‹è®°å½•24.09.05 æ›´æ–°Macç”µè„‘ç›¸å…³æ“ä½œ\n\nå®‰è£…\nWindows\nä¹‹å‰åœ¨å†™ [[Obsidian + Git + Hexo + å›¾åºŠ = Blog + ä¸ªäººç¬”è®°ä½“ç³»]] è¿™ç¯‡ç¬”è®°çš„æ—¶å€™æœ‰æåˆ°è¿‡ Git çš„å®‰è£…ã€‚è¿™é‡Œå°±ç›´æ¥æŠŠæ­¥éª¤è´´è¿‡æ¥ï¼Œå…·ä½“å®‰è£…åœ°å€ (https://git-scm.com/)\n\n\nè®¿é—® git å®˜æ–¹åœ°å€ï¼Œä¸‹è½½å¯¹åº”çš„å®‰è£…åŒ…ï¼Œè¿›è¡Œå®‰è£…ï¼ˆç®€å•çš„ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼‰ã€‚\n\n\nå®‰è£…å¥½ä¹‹åï¼Œé¼ æ ‡å³é”®å¯ä»¥çœ‹åˆ°ï¼šGit Bash Hereï¼Œç‚¹å‡»åæ‰“å¼€äº†ã€‚\n\n\nè¾“å…¥ï¼šgit --version\nå‡ºç°ç‰ˆæœ¬å·è¯´æ˜å®‰è£…æˆåŠŸã€‚\n\n\nMac\nMac å®‰è£…éå¸¸ç®€å•ã€‚åœ¨ç»ˆç«¯è¿è¡Œ git --version æŒ‡ä»¤ï¼Œå¦‚æœæœ¬æœºæ²¡æœ‰å®‰è£…ï¼Œä¼šå¼¹å‡ºå®‰è£…å¼¹çª—ï¼Œç›´æ¥å®‰è£…å°±è¡Œã€‚\nLinux\n\n\nlinux å®‰è£…ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤\n\n\nsudo apt-get install git\ngit é…ç½® SSH key\nGit æ˜¯åˆ†å¸ƒå¼çš„ä»£ç ç®¡ç†å·¥å…·ï¼Œè¿œç¨‹çš„ä»£ç ç®¡ç†æ˜¯åŸºäº SSH çš„ï¼Œæ‰€ä»¥è¦ä½¿ç”¨è¿œç¨‹çš„ Git åˆ™éœ€è¦ SSH çš„é…ç½®ã€‚\nä¸€ã€è®¾ç½® Git çš„ user name å’Œ emailï¼š\n$ git config --global user.name &quot;kiml&quot;  $ git config --global user.email &quot;1162278448@qq.com&quot;\näºŒã€ç”Ÿæˆ SSH å¯†é’¥\n\nå†…é“¾ï¼š[[Obsidian + Git + Hexo + å›¾åºŠ = Blog + ä¸ªäººç¬”è®°ä½“ç³»#gité…ç½® SSH key]]\nå¤–é“¾ï¼š[Obsidian + Git + Hexo + å›¾åºŠ = Blog + ä¸ªäººç¬”è®°ä½“ç³»](https://kiml.site/posts/121fccfa/#git é…ç½® SSH key)\n\nMac ç³»ç»Ÿé…ç½®å¤šä¸ª ssh æºï¼ˆé‚®ç®±ä¸åŒï¼‰\n\n\nç”Ÿæˆ ssh å¯†é’¥ï¼ˆè¿™è¾¹å¯ä»¥å…ˆç”Ÿæˆå…¶ä¸­ä¸€ä¸ªé‚®ç®±çš„åœ°å€ï¼‰\n\n\nssh-keygen -t rsa -C &quot;é‚®ä»¶åœ°å€&quot; # è¯¥é‚®ç®±åœ°å€æ˜¯ç»‘å®šgithubè´¦å·çš„åœ°å€\n\n\nåœ¨å¯¹åº”çš„å¹³å°ä¿å­˜å…¬é’¥\n\n\næµ‹è¯•æ˜¯å¦æˆåŠŸ\n\n\nssh -T git@github.com\nå‡ºç°  You've successfully authenticated, but GitHub does not provide shell access. è¯´æ˜æˆåŠŸ\n\n\nå¤±è´¥å¯ä»¥é€šè¿‡å‘½ä»¤ -v æŒ‡ä»¤è¾“å‡ºè¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯ï¼ˆè¿™é‡Œè®°å½•é‡åˆ°è¿‡çš„ä¸€ç§æƒ…å†µï¼šæŸ¥çœ‹æ—¥å¿—å‘ç°è¿æ¥æ²¡æœ‰å°è¯•æ–°ç”Ÿæˆçš„ç§é’¥ï¼‰\n\n\n# sshå¼ºåˆ¶æ·»åŠ å¯†é’¥ è¿™ä¸ªä¼šè¢«é‡ç½®ssh-add ~/.ssh/id_rsa\n\n\nå¤šæºçš„é…ç½®æ–‡ä»¶åˆ° .ssh ç›®å½•ä¸‹æ–°å»º config æ–‡ä»¶ï¼ˆå¯ä»¥è§£å†³ 4 çš„é—®é¢˜ï¼‰\n\n\nHost githubÂ  Â  User æŒ‰å®å¡«å†™Â  Â  Hostname github.comÂ  Â  PreferredAuthentications publickeyÂ  Â  IdentityFile ~/.ssh/id_rsa_116Host company-gitÂ  Â  User æŒ‰å®å¡«å†™Â  Â  Hostname xxxÂ  Â  PreferredAuthentications publickeyÂ  Â  IdentityFile ~/.ssh/id_rsa\ngit å·¥å…·\nGitHub Desktop\n\nå¹³æ—¶æ›´å¤šä½¿ç”¨ IntelliJ IDEA è‡ªå¸¦çš„ git å·¥å…·ï¼Œå¶ç„¶å‘ç°è¿™ä¸ªå·¥å…·ï¼Œè¿‘æœŸæ‰“ç®—ä½¿ç”¨å®˜æ–¹æ–‡æ¡£ï¼š(https://docs.github.com/zh/desktop/installing-and-configuring-github-desktop/overview/getting-started-with-github-desktop)\n\nå¸¸ç”¨å‘½ä»¤\nclone åˆ°æœ¬åœ°\ngit clone git@gitee.com:kiml_rgb/blog.git\næäº¤ä»£ç \n# è¿›å…¥é¡¹ç›®å·¥ç¨‹ç›®å½•cd hello/# å°†å½“å‰ä¿®æ”¹çš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºgit add .# æäº¤ä»£ç git commit -m &quot;first commit&quot;\næ¨é€ä»£ç \ngit push\næ‹‰å–ä»£ç \ngit pull\nåˆ›å»ºå¹¶æäº¤åˆ†æ”¯\n# åˆ‡æ¢å¹¶ä»å½“å‰åˆ†æ”¯åˆ›å»ºä¸€ä¸ªdevåˆ†æ”¯git checkout -b dev# å°†æ–°åˆ›å»ºçš„devåˆ†æ”¯æ¨é€åˆ°è¿œç¨‹ä»“åº“git push origin dev\nå…¶ä»–å¸¸ç”¨å‘½ä»¤\n# åˆ‡æ¢åˆ°devåˆ†æ”¯git checkout dev# æŸ¥çœ‹æœ¬åœ°ä»“åº“æ–‡ä»¶çŠ¶å†µgit status# æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰åˆ†æ”¯git branch# æŸ¥çœ‹æäº¤è®°å½•git log\n","categories":["ç¯å¢ƒæ­å»º"],"tags":["Git"]},{"title":"IntelliJ ç³»åˆ—äº§å“å¸¸ç”¨è®¾ç½®","url":"/posts/ce75656e/","content":"\n\nå‰è¨€\nIntelliJ ç³»åˆ—äº§å“ å¸¸ç”¨è®¾ç½®ã€‚è¿™äº›è®¾ç½®ä¸åŒè½¯ä»¶é—´éƒ½å¯ä»¥å¯¼å‡ºå…±ç”¨ï¼Œå¸è½½å®‰è£…ä¹Ÿå¯ä»¥é€‰æ‹©é™é»˜é€‰é¡¹ã€‚\n\n\næ›´æ–°\n\n\n23.07.02 åˆå§‹è®°å½•23.07.09 åŸºæœ¬è®¾ç½®ï¼ˆåˆå§‹ï¼‰23.07.16 åŸºæœ¬è®¾ç½®å®Œæˆ æ¨èæ’ä»¶ï¼ˆåˆå§‹ï¼‰23.08.28 ä¸‰ä¸ªæ’ä»¶çš„æ·»åŠ 24.06.06 LeetCodeæ’ä»¶24.09.09 ç¼–è¯‘å¤§é¡¹ç›®è®¾ç½® ä¸‰ä¸ªæ’ä»¶çš„æ·»åŠ 24.11.20 ä»£ç æ¨¡æ¿æ’ä»¶\n\nIntelliJ IDEA å¸¸ç”¨è®¾ç½®\nåŸºæœ¬è®¾ç½®\nåŸºæœ¬é£æ ¼åŠ UI å­—ä½“å¤§å°\n\nè®¾ç½®æ‰“å¼€ IDEA ä¸ç›´æ¥æ‰“å¼€é¡¹ç›®\n\nè¿™æ ·é»˜è®¤æ‰“å¼€ IDEA æ—¶å°±æ˜¯å¦‚ä¸‹ç”»é¢ï¼š\n\nç‚¹å‡» Customize é‡Œçš„ All settingsï¼Œå°±å¯ä»¥ä¸ºæ‰€æœ‰æ–°é¡¹ç›®è®¾ç½®é…ç½®ã€‚\nè®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç æ ¼å¼ï¼ˆå¾ˆé‡è¦ï¼‰\nå»ºè®®å°†æ‰€æœ‰éƒ½è®¾ç½®æˆ UTF-8 æ ¼å¼ï¼ŒMaven ä¸‹è½½ä¸æˆåŠŸæœ‰æ—¶å€™å’Œè¿™ä¸ªæœ‰å…³\n\nè®¾ç½®ä»£ç æç¤ºçš„åŒ¹é…æ ¼å¼\n\nè®¾ç½®æ–°å»ºç±»æ–‡ä»¶çš„æ³¨é‡Šæ¨¡æ¿\n/** * @author $&#123;USER&#125; * @since: $&#123;DATE&#125; $&#123;TIME&#125;*/\n\nè®¾ç½®å¤šä¸ªç±»åŒæ—¶æ‰“å¼€å¹¶ä¸é‡å éšè—\n\nè®¾ç½® maven é…ç½®\n\nè®¾ç½® SQL è‡ªåŠ¨è¡¥å…¨\n\n\nå¯ç”¨ IDEA çš„ database æ’ä»¶\n\n\né’ˆå¯¹é¡¹ç›®è¿›è¡Œ SQL Dialects é…ç½®\n\n\nå†…å­˜è®¾ç½®\n\n\nåŸºæœ¬è®¾ç½®å¯¼å‡º\nä¸ºäº†æ›´æ–¹ä¾¿çš„è¿ç§» IDEAï¼Œå¯ä»¥å°†åŸºæœ¬è®¾ç½®å¯¼å‡ºã€‚ï¼ˆä¸åŒå¹³å°æœ€å¥½ä¸è¦è¿™ä¹ˆæ“ä½œï¼Œå®¹æ˜“å‡º bugï¼‰\n\nMaven ç¼–è¯‘è·³è¿‡æµ‹è¯•\n-Dmaven.test.skip=true\n\næ¨èæ’ä»¶\nLombok\n\né€šè¿‡æ³¨è§£ä¸å†éœ€è¦ç¼–å†™ getterã€setterã€equals ç­‰æ–¹æ³•ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨ç”Ÿæˆï¼Œå¼€å‘æ—¶å¸¸ç”¨çš„æ’ä»¶ã€‚IDEA åœ¨ç›®å‰ä½¿ç”¨çš„ç‰ˆæœ¬ä¸­å·²ç»å†…ç½®ï¼ŒSpringBoot 2.1.x ä¹‹åçš„ç‰ˆæœ¬ä¹Ÿåœ¨ Starter ä¸­å†…ç½®äº† Lombok ä¾èµ–ã€‚\n\né›†æˆ\nåœ¨é¡¹ç›®çš„ pom.xml æ–‡ä»¶ä¸­å¯ä»¥æ·»åŠ  Lombok ä¾èµ–ï¼ŒSpringBoot 2.1.x ç‰ˆæœ¬åæ— éœ€æŒ‡å®š Lombok ç‰ˆæœ¬ï¼ŒSpringBoot åœ¨ spring-boot-dependencies ä¸­å·²ç»å†…ç½®ã€‚\n&lt;!--lombokä¾èµ–--&gt;&lt;dependency&gt;    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;    &lt;artifactId&gt;lombok&lt;/artifactId&gt;    &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt;\nMyBatisX\n\nMybatisX æ˜¯ä¸€æ¬¾åŸºäº IDEA çš„å¿«é€Ÿå¼€å‘æ’ä»¶ï¼Œä¸ºæ•ˆç‡è€Œç”Ÿã€‚\n\nMaven Helper\n\nå¯ä»¥å³é”®é¡¹ç›®å¿«é€Ÿå®Œæˆé¡¹ç›® maven çš„å„ä¸ªé˜¶æ®µã€‚\npom.xml æ–‡ä»¶ç‚¹å‡»åï¼Œæ˜¾ç¤ºå³è¾¹å¤šäº† Dependency Analyzer çš„ Tab é€‰é¡¹ï¼Œå¯ä»¥æŸ¥çœ‹ä¾èµ–å†²çªã€‚åŒæ—¶ä¹Ÿå¯ä»¥å¿«é€Ÿæ’é™¤å†²çªçš„æ–‡ä»¶ã€‚\n\nGit Commit Template\n\nä¸º git çš„æäº¤æä¾›æ¨¡æ¿ã€‚ä¾‹å­ï¼šfix(DAO): ç”¨æˆ·æŸ¥è¯¢ç¼ºå°‘ username å±æ€§ feat(Controller): ç”¨æˆ·æŸ¥è¯¢æ¥å£å¼€å‘\n\nå‚æ•°è¯¦è§£ï¼š\n\n\n\nå‚æ•°\nç±»å‹\nshuoming\n\n\n\n\ntype(å¿…é¡»)\n\nç”¨äºè¯´æ˜ git commit çš„ç±»åˆ«ï¼Œåªå…è®¸ä½¿ç”¨ä¸‹é¢çš„æ ‡è¯†ã€‚\n\n\n\nfeat\næ–°åŠŸèƒ½ï¼ˆfeatureï¼‰\n\n\n\nfix/to\nä¿®å¤ bugï¼Œå¯ä»¥æ˜¯ QA å‘ç°çš„ BUGï¼Œä¹Ÿå¯ä»¥æ˜¯ç ”å‘è‡ªå·±å‘ç°çš„ BUGã€‚\n\n\n\nfix\näº§ç”Ÿ diff å¹¶è‡ªåŠ¨ä¿®å¤æ­¤é—®é¢˜ã€‚é€‚åˆäºä¸€æ¬¡æäº¤ç›´æ¥ä¿®å¤é—®é¢˜\n\n\n\nto\nåªäº§ç”Ÿ diff ä¸è‡ªåŠ¨ä¿®å¤æ­¤é—®é¢˜ã€‚é€‚åˆäºå¤šæ¬¡æäº¤ã€‚æœ€ç»ˆä¿®å¤é—®é¢˜æäº¤æ—¶ä½¿ç”¨ fixã€‚\n\n\n\ndocs\næ–‡æ¡£ï¼ˆdocumentationï¼‰\n\n\n\nstyle\næ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰ã€‚\n\n\n\nrefactor\né‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹ bug çš„ä»£ç å˜åŠ¨ï¼‰ã€‚\n\n\n\nperf\nä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒã€‚\n\n\n\ntest\nå¢åŠ æµ‹è¯•ã€‚\n\n\n\nchore\næ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨ã€‚\n\n\n\nrevert\nå›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚\n\n\n\nmerge\nä»£ç åˆå¹¶ã€‚\n\n\n\nsync\nåŒæ­¥ä¸»çº¿æˆ–åˆ†æ”¯çš„ Bugã€‚\n\n\nscope(å¯é€‰)\n\nscope ç”¨äºè¯´æ˜ commit å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®ä¸åŒè€Œä¸åŒã€‚\n\n\nsubject(å¿…é¡»)\n\nsubject æ˜¯ commit ç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡ 50 ä¸ªå­—ç¬¦\n\n\n\nStatistic\n\nä»£ç ç»Ÿè®¡å™¨\n\nLeetCode Editor\n\nLeetCode åˆ·é¢˜\n\nä¸­æ–‡ä¹±ç é—®é¢˜ï¼š\nåœ¨ Help-&gt;Edit Custom VM Options æ·»åŠ å¦‚ä¸‹ï¼š\n-Dfile.encoding=utf-8\nTranslation\n\nç¿»è¯‘æ’ä»¶\n\nKey Promoter X\n\nå¿«æ·é”®æç¤º\n\nEasyCode\n\nä»£ç æ¨¡æ¿\n\nè¿™é‡Œæä¾›å…¬å¸å†…ä½¿ç”¨çš„ä¸€ä¸ªæ¨¡æ¿ï¼š(https://blog-resources.oss-cn-hangzhou.aliyuncs.com/Z2409-12/11/EasyCodeConfig.json)\nWebStorm å¸¸ç”¨è®¾ç½®\nåŸºæœ¬è®¾ç½®\nå› ä¸ºæ˜¯åŒä¸€å®¶å…¬å¸ï¼Œä¸€äº›åŸºæœ¬çš„é…ç½®ä¸ IntelliJ IDEA æ˜¯ç›¸åŒçš„ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚\næ¨èæ’ä»¶\nESLint Restart Service Action\n\nä½¿ç”¨ ESLint è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç ã€‚\n\n\nGitToolBox\n\næ˜¾ç¤ºæ›´è¯¦ç»†çš„ git ä¿¡æ¯å¾ˆå¤š Git çš„åŠŸèƒ½å¢å¼ºï¼Œæ¯”å¦‚è‡ªåŠ¨ fetch ä»£ç ï¼ŒçŠ¶æ€æ ä¸­æ˜¾ç¤ºå½“å‰ Git åˆ†æ”¯çš„æœªæäº¤å’Œè½åæäº¤æ•°æ˜¾ç¤ºï¼Œè¿‡æ—¶åˆ†æ”¯æ¸…ç†ï¼Œcommit çª—å£æ”¯æŒ emoji è¡¨æƒ…ï¼ŒInline Blame å¯ä»¥çœ‹åˆ°æ¯è¡Œä»£ç æ˜¯è°æäº¤çš„ã€ä»€ä¹ˆæ—¶å€™æäº¤çš„ã€ä»¥åŠ commit ä¿¡æ¯ç­‰ç­‰ï¼Œå¦‚æœä½ ç»å¸¸ç”¨ Gitï¼Œè¿™ä¸ªæ’ä»¶å¿…è£…äº†ã€‚\n\nHighlightBracketPair\n\né«˜äº®æ‹¬å·\n\nIntelliVue\n\nWebstorm ä¸Šå¯¹ Vue æ”¯æŒå¾ˆæ£’çš„æ’ä»¶ï¼Œç°åœ¨å·²ç»æ”¯æŒ Vue3 çš„ä¸€äº›è¯­æ³•ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»º Vue2 çš„ dataã€methods ç­‰ï¼Œæˆ–è€… Vue3 çš„ setup method ç­‰ï¼Œå¸®ä½ å°‘äº›ä¸€äº›æ¨¡æ¿ä»£ç ã€‚\n\n.ignore\n\n.ignoreÂ æ’ä»¶æ”¯æŒåˆ›å»ºå¤šç§Â .ignoreÂ æ–‡ä»¶æ¯”å¦‚Â .gitignoreã€.eslintignoreã€.dockerignoreÂ ç­‰ç­‰ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„åŸºæœ¬éƒ½æ”¯æŒï¼Œæ–°å»ºçš„æ—¶å€™æ”¯æŒé€‰æ‹©ä¸åŒç±»å‹çš„æ¡†æ¶æˆ–åº“å¸¸ç”¨çš„å¿½ç•¥é…ç½®ï¼Œå¦‚Â node_modulesã€distã€.cacheÂ ç­‰ã€‚\n\n","categories":["ç¯å¢ƒæ­å»º"],"tags":["IDEA"]},{"title":"Windows è‡ªå¸¦çš„ Linux å­ç³»ç»Ÿ","url":"/posts/ba3da13b/","content":"\n\nå‰è¨€æœ¬æ¥æƒ³åœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šå®‰è£… jenkinsï¼Œä½†æ˜¯é…ç½®é«˜çš„æœåŠ¡å™¨ä»·æ ¼å¤ªè´µï¼Œé…ç½®ä½çš„éå¸¸å®¹æ˜“ cpu 100%ï¼Œä¸åˆ©äºæµ‹è¯•ã€‚æ‰€ä»¥æ‰“ç®—ç›´æ¥ç”¨å°å¼æœºåšè™šæ‹Ÿäº‘ä¸»æœºã€‚\n\n\nå‚è€ƒæ–‡ç« \nWin10 ç³»ç»Ÿå®‰è£… Linux å­ç³»ç»Ÿæ•™ç¨‹(WSL2 + Ubuntu 20.04 + Gnome æ¡Œé¢ ï¼‰\n\n\næ›´æ–°\n\n\n24-09-22 åˆå§‹è®°å½•\n\nå®‰è£… WSL\nå®‰è£… WSL1\n\n\nç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell\n\n\nè¾“å…¥å‘½ä»¤ï¼Œå¯ç”¨é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»ŸåŠŸèƒ½\n\n\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\n\n\nåœ¨ Microsoft Store ä¸­é€‰æ‹©ä¸­æ„çš„ Linux åˆ†å‘ç‰ˆæœ¬ï¼Œå¹¶å®‰è£…\n\n\nä¸ºæ–°çš„ Linux åˆ†å‘ç‰ˆåˆ›å»ºç”¨æˆ·è´¦æˆ·å’Œå¯†ç \n\n\nå‡çº§åˆ° WSL2\n\n\nå¼€å¯â€œè™šæ‹Ÿæœºå¹³å°â€å¯é€‰åŠŸèƒ½\n\n\ndism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart\n\n\né‡å¯ç”µè„‘\n\n\nä¸‹è½½ Linux å†…æ ¸æ›´æ–°åŒ…é€‚ç”¨äº x64 è®¡ç®—æœºçš„ WSL Linux å†…æ ¸æ›´æ–°åŒ…\n\n\nè®¾ç½® WSL ç‰ˆæœ¬\n\n\nPS C:\\Users\\user-name&gt; wsl --set-version Ubuntu-20.04 2æ­£åœ¨è¿›è¡Œè½¬æ¢ï¼Œè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´...æœ‰å…³ä¸ WSL 2 çš„ä¸»è¦åŒºåˆ«çš„ä¿¡æ¯ï¼Œè¯·è®¿é—® https://aka.ms/wsl2è½¬æ¢å®Œæˆã€‚\nä½¿ç”¨ WSL\nå¯åŠ¨å’Œé€€å‡º Linux\nè¿›å…¥ Linux å­ç³»ç»Ÿæœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š\nï¼ˆ1ï¼‰å’Œæ­£å¸¸è½¯ä»¶ä¸€æ ·å¯åŠ¨ï¼Œå¦‚åœ¨å¼€å§‹èœå•ä¸­ç‚¹å‡»å…¶å›¾æ ‡ã€åŒå‡»æ¡Œé¢å¿«æ·æ–¹å¼\nï¼ˆ2ï¼‰åœ¨ Windows ä¸­æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œå¦‚ PowerShellï¼Œè¾“å…¥å‘½ä»¤ wsl\nï¼ˆ3ï¼‰åœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤ Linux å‘è¡Œç‰ˆåç§°.exeï¼Œå¦‚ ubuntu20.04.exe\né€€å‡º Linux å­ç³»ç»Ÿçš„æ–¹å¼ï¼š\nï¼ˆ1ï¼‰ç›´æ¥å…³é—­ç»ˆç«¯\nï¼ˆ2ï¼‰åœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤ exitï¼Œæ­¤æ—¶é€€å‡ºäº† WSLï¼Œç„¶åè¾“å…¥å‘½ä»¤Â wsl -t Ubuntu-20.04ï¼Œå…³é—­ ubuntu å­ç³»ç»Ÿã€‚\n# åˆ—å‡ºæ‰€æœ‰åˆ†å‘çš„åç§°ã€è¿è¡ŒçŠ¶æ€ã€å¯¹åº”çš„ WSL ç‰ˆæœ¬wsl -l -v# ç»ˆæ­¢æŒ‡å®šçš„ Linux åˆ†å‘wsl -t &lt;distro&gt;# æ³¨é”€åˆ†å‘wsl --unregister &lt;distro&gt;# ç»ˆæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„åˆ†å‘å’Œ WSL2 è½»å‹å·¥å…·è™šæ‹Ÿæœºwsl --shutdown\næ¢æº\nä½¿ç”¨ Linux å­ç³»ç»Ÿæ—¶ï¼Œä¸ºäº†æé«˜è½¯ä»¶çš„å®‰è£…é€Ÿåº¦ï¼Œéœ€è¦å°†è½¯ä»¶æºæ¢æˆå›½å†…çš„é•œåƒæºã€‚\n\n\nå¤‡ä»½åŸæ¥çš„æ•°æ®æºé…ç½®æ–‡ä»¶\n\n\nsudo cp /etc/apt/sources.list /etc/apt/sources.list_backup\n\n\nä¿®æ”¹æ•°æ®æºé…ç½®æ–‡ä»¶\n\n\nsudo vi /etc/apt/sources.list\n# é»˜è®¤æ³¨é‡Šäº†æºç ä»“åº“ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Šdeb https://mirrors.ustc.edu.cn/ubuntu/ focal main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal main restricted universe multiversedeb https://mirrors.ustc.edu.cn/ubuntu/ focal-security main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-security main restricted universe multiversedeb https://mirrors.ustc.edu.cn/ubuntu/ focal-updates main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-updates main restricted universe multiversedeb https://mirrors.ustc.edu.cn/ubuntu/ focal-backports main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-backports main restricted universe multiverse# é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨# deb https://mirrors.ustc.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse\n\n\næ›´æ–°æºï¼Œå‡çº§è½¯ä»¶\n\n\nsudo apt-get updatesudo apt-get upgrade\nä½¿ç”¨ SSH ç™»å½• Linux å­ç³»ç»Ÿ\nå¼€å¯ SSH å¹¶å…è®¸ root ç™»å½•\n\n\nå®‰è£… SSH æœåŠ¡å™¨\n\n\nsudo apt updatesudo apt install openssh-server\n\n\nä¿®æ”¹é…ç½®ç«¯å£ä¸º 22ï¼Œå…è®¸å¯†ç å’Œ root ç™»å½•ã€‚\n\n\nsudo nano /etc/ssh/sshd_config\næ‰¾åˆ°ä¸‹é¢çš„å†…å®¹å¹¶å»æ‰æ³¨é‡Šåœ¨å‰é¢çš„#å·ï¼Œå…¶ä¸­æŠŠ PermitRootLogin prohibit-password æ›´æ”¹ä¸º PermitRootLogin yes è¿™æ˜¯å…è®¸ç”¨ root ç™»å½•çš„ã€‚\nPort 22PermitRootLogin prohibit-passwordPasswordAuthentication yes\n\n\né‡å¯ SSH æœåŠ¡\n\n\nservice ssh restart# æˆ–è€…è¿è¡Œè¿™ä¸ªå‘½ä»¤sudo service ssh --full-restart\n\n\nç»ˆç«¯æµ‹è¯•è¿æ¥è¾“å…¥æŒ‡ä»¤ï¼Œæ ¼å¼ä¸ºï¼šssh ç”¨æˆ·å@åŸŸå/IP\n\n\nssh root@0.0.0.0ssh 127.0.0.1\n\n\nç¡®ä¿ SSH æœåŠ¡å™¨ä¼šåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨\n\n\nsudo systemctl enable ssh\n\n\né…ç½®æ°¸ä¹…è§£å†³æ–¹æ¡ˆå°†ä¸Šè¿°çš„å‘½ä»¤ä¿å­˜ä¸º service.shï¼Œä¿å­˜åœ¨ home ç›®å½•ä¸‹\n\n\n# &gt;&gt;&gt; service ssh restart &gt;&gt;&gt;# for Xshell connectionsudo service ssh --full-restart# &lt;&lt;&lt; service ssh restart &lt;&lt;&lt;\né…ç½®å¥½ä¹‹åï¼Œä¸‹æ¬¡å¼€æœºï¼Œåªéœ€è¦åœ¨ Linux å­ç³»ç»Ÿçš„é»˜è®¤ç»ˆç«¯è¿è¡Œ sh service.sh å‘½ä»¤åï¼Œå…³æ‰ç»ˆç«¯æ”¹ç”¨ xshell ç™»å½•å³å¯ã€‚\n\n\næŸ¥çœ‹ SSH ç›‘å¬ç«¯å£\n\n\nsudo ss -tuln | grep 22\n\n\nSSH æœåŠ¡å™¨çŠ¶æ€\n\n\nsudo service ssh status\nè®¾ç½®é»˜è®¤ä½¿ç”¨ root ç™»å½•ç³»ç»Ÿ\n\n\nåˆ‡æ¢ root æƒé™\n\n\nsudo -i# ç„¶åè¾“å…¥å¯†ç \n\n\nåˆ›å»º/æ‰“å¼€ /etc/wsl.conf ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹\n\n\n[user]default=root\n\n\nè¿è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°å¯åŠ¨ WSL ä»¥åº”ç”¨æ›´æ”¹\n\n\nwsl --shutdown\nè®¾ç½®ç«¯å£è½¬å‘\n\nä¸ºäº†èƒ½å¤Ÿä»å¤–éƒ¨è¿æ¥åˆ°ä½ çš„ WSL Linux å­ç³»ç»Ÿï¼Œä½ éœ€è¦ç¡®ä¿ç³»ç»Ÿå…·æœ‰å…¬å…± IP åœ°å€ï¼Œæˆ–è€…è®¾ç½®ç«¯å£è½¬å‘ä»¥å°†æµé‡è·¯ç”±åˆ° WSL å­ç³»ç»Ÿçš„å±€åŸŸç½‘ IP åœ°å€ã€‚è¯·æ£€æŸ¥ä½ çš„ç½‘ç»œé…ç½®ï¼Œç¡®ä¿ WSL å­ç³»ç»Ÿèƒ½å¤Ÿè®¿é—®å…¬å…±ç½‘ç»œï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªå¯ä¾›å¤–éƒ¨è®¿é—®çš„ IP åœ°å€ã€‚\n\n\n\nå¢åŠ è½¬å‘çš„å‘½ä»¤ï¼š\n\n\nnetsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=22 connectaddress=[IP] connectport=[PORT]# è¿™é‡Œçš„IPä¸ºWSLä¸­ä½¿ç”¨ipconfigæŸ¥çœ‹çš„IPåœ°å€ï¼ŒPORTä¸ºWSLçš„PORT# è¿˜éœ€è¦åœ¨windowsé˜²ç«å¢™ä¸­æ·»åŠ å¯¹åº”çš„å…¥ç«™è§„åˆ™ï¼Œè®¾ç½®å®Œæˆåå¯ä»¥é€šè¿‡ipåœ°å€è¿œç¨‹è®¿é—®wsl\n\n\nåˆ é™¤è½¬å‘çš„å‘½ä»¤ï¼š\n\n\nnetsh interface portproxy delete v4tov4 listenport=22 listenaddress=0.0.0.0\n\n\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ—å‡ºå½“å‰çš„ç«¯å£è½¬å‘è§„åˆ™ï¼š\n\n\nnetsh interface portproxy show all\n\n\næµ‹è¯•è¿æ¥çš„å‘½ä»¤ï¼š\n\n\nssh username@ip -p 22\n\nè¿™é‡Œæµ‹è¯•è¿æ¥çš„ ip å¯ä»¥åœ¨ linux å†…ä½¿ç”¨å‘½ä»¤ hostname -I è¿›è¡ŒæŸ¥çœ‹\n\nå¸è½½ Linux ç³»ç»Ÿ\nwsl --unregister Ubuntu\nSSH å®‰å…¨\n","categories":["ç¯å¢ƒæ­å»º"],"tags":["Linux"]},{"title":"è£…æœº-è½¯ä»¶å®‰è£…","url":"/posts/89b09b58/","content":"\n\nå‰è¨€æ‰¾åˆ°å·¥ä½œä¹‹åæ¯å¤©å°±æ˜¯èººå¹³ï¼Œå¥½ä¹…æ²¡æœ‰æ›´æ–°æŠ€æœ¯ä¸Šçš„å†…å®¹äº†ï¼Œä¹‹å‰å­¦çš„å¥½å¤šä¸œè¥¿ä¹Ÿå¿˜äº†â€¦â€¦ç”šè‡³ md è¯­æ³•éƒ½å¿˜äº†å¥½å¤šï¼ˆæ¯å¤© CRUDï¼Œä½†æ˜¯ä¹Ÿå¾ˆæ¶ˆè€—ç²¾åŠ›ã€‚å¿…é¡»è¦ä¸æ–­å­¦ä¹ ï¼Œå¥½ç—›è‹¦ï¼Œä»€ä¹ˆæ—¶å€™èƒ½é€€ä¼‘ğŸ˜¢ï¼‰è¶ç€ 618 é…äº†ä¸€å°æ–°ç”µè„‘ï¼Œé¡ºä¾¿ç”¨åŠä¸ªå¤šæœˆçš„æ—¶é—´ç”¨æ–°ç”µè„‘æ‰“æ¸¸æˆã€‚ã€‚ã€‚æ­£å¥½æœ€è¿‘åœ¨è£…è½¯ä»¶ï¼Œæ•´ç†ä¸€ä¸‹è£…æœºè¦æ³¨æ„çš„äº‹ï¼Œä»¥åŠä¸€äº›å¿…å¤‡è½¯ä»¶ï¼Œä¾¿äºåé¢å†æ¬¡è£…æœºä½¿ç”¨ã€‚\n\n\næ›´æ–°\n\n\n23.06.24 åˆå§‹è®°å½•23.07.02 IDEAå¸¸ç”¨æ’ä»¶ + åŸºæœ¬è®¾ç½®23.07.09 ç¼–ç¨‹ç¯å¢ƒJava + MySQL23.07.11 Git23.08.28 Maven\n\nåˆå§‹è£…æœº\nè¿™éƒ¨åˆ†éƒ½æ˜¯ç…§ç€ b ç«™ä¸Šçš„è§†é¢‘å®Œæˆçš„ã€‚æ€»ä¹‹æ—¶é—´å°±åˆ†ä¸¤å¤§å—ï¼ŒæŠŠé›¶ä»¶è£…ä¸Šå»ï¼Œç†çº¿ã€‚å…·ä½“å¯å‚ç…§ä»¥ä¸‹è§†é¢‘ï¼šBç«™ èµµå¾·æŸ±è£…æœº\nç³»ç»Ÿå®‰è£…\nç³»ç»Ÿå®‰è£…éœ€è¦å‡†å¤‡ä¸€ä¸ª U ç›˜è£…ç³»ç»Ÿã€‚å…·ä½“æ­¥éª¤å¯ä»¥å‚ç…§ä»¥ä¸‹è§†é¢‘ï¼šBç«™ èµµå¾·æŸ±è£…ç³»ç»Ÿ\nå®‰è£…ç³»ç»Ÿå®Œæ¯•ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å»å¯¹åº”å®˜ç½‘å®‰è£…å¯¹åº”é©±åŠ¨ï¼Œè¿™ä¸ªä¾æ®é…ç½®ä¸åŒï¼Œéœ€è¦ä¸‹è½½çš„ä¸œè¥¿ä¹Ÿä¸ä¸€æ ·ã€‚å¯ä»¥æ£€æŸ¥ä»¥ä¸‹é¡¹ç›®çš„é©±åŠ¨æ˜¯å¦å®‰è£…ï¼Œæ¯é¡¹éƒ½éœ€è¦åˆ°å¯¹åº”çš„å®˜ç½‘å»ä¸‹è½½å¯¹åº”çš„é©±åŠ¨åŒ…ï¼š\n\n\ncpu é©±åŠ¨\n\n\nä¸»æ¿é©±åŠ¨ï¼ˆæ¶‰åŠè¾ƒå¤šï¼‰\n\n\næ˜¾å¡é©±åŠ¨\n\n\né¼ æ ‡é©±åŠ¨ï¼ˆè°ƒå…‰éœ€è¦ï¼‰\n\n\né”®ç›˜é©±åŠ¨ï¼ˆè°ƒå…‰éœ€è¦ï¼‰\n\n\nè½¯ä»¶å®‰è£…\nå¸¸ç”¨è½¯ä»¶\nOffice å…¨å®¶æ¡¶\nè¿™ä¸ªç›´æ¥ç™»å½•åŸæ¥çš„å¾®è½¯è´¦æˆ·å°±å¯ä»¥å®‰è£…äº†ï¼Œä¹‹å‰ä¹°ç¬”è®°æœ¬æœ‰é…æœ‰å®¶åº­ç‰ˆå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚æœ‰çš„ç¬”è®°æœ¬æ²¡æœ‰é€ï¼Œè¿™ä¸ªéœ€è¦æ³¨æ„åŸæ¥çš„ä¸è¦å¸è½½ï¼Œä¸ç„¶é‡æ–°ä¸‹è½½æ¯”è¾ƒéº»çƒ¦ï¼ˆè¿™æ˜¯ä¸ªä»˜è´¹è½¯ä»¶ï¼‰ã€‚ç›´æ¥å»ä¹°ä¸ªæ¿€æ´»ç å°±è¡Œ\nSteam\nè£…æœºç¬¬ä¸€ä»¶äº‹\nUUåŠ é€Ÿå™¨\nç”¨äº†è¿™ä¹ˆå¤šï¼Œæœ€å¸¸ç”¨çš„è¿˜æ˜¯è¿™ä¸ªï¼ŒåŠ é€Ÿå•†åº—æ˜¯è¶³å¤Ÿç”¨äº†ï¼Œæƒ³è¦åŠ é€Ÿæ¸¸æˆå¯ä»¥è¿›ä¸€æ­¥å»è´´å§ä¸‹è½½\nChrome\næ’ä»¶å°±ä¸æä¾›äº†ï¼Œè‡ªå·±åç»­éœ€è¦å†æœï¼Œæœ€å¥½è¿˜æ˜¯èƒ½æ•´ä¸ªè´¦å·ï¼Œä¸ç„¶æ¯æ¬¡è£…æœºéƒ½è¦é‡æ–°æŠŠæ”¶è—å¤¹çš„å¯¼å‡ºæ¥æœ‰ç‚¹éº»çƒ¦ã€‚\nSnipaste\nå¾ˆå¥½ç”¨çš„æˆªå±è½¯ä»¶ï¼ŒU ç›˜é‡Œå¸¦æœ‰å®‰è£…åŒ…ï¼Œç›´æ¥è§£å‹ç¼©ï¼Œå¼€å¯åå°±å¯ä»¥ F1 æˆªå›¾äº†\nScreenToGif\nåˆ¶ä½œ Gif çš„è½¯ä»¶ï¼Œä»¥å‰ä¸‹è½½è¿‡ä½†æ˜¯æ²¡æœ‰ç”¨åˆ°çš„æœºä¼š\nToDesk\nè¿œç¨‹è¿æ¥å·¥å…·ï¼Œä¸æƒ³èƒŒç”µè„‘å›å®¶å°±å¸¦è¿™ä¸ª\nObsidian\nç›®å‰åœ¨ç”¨çš„ All in One ç¬”è®°è½¯ä»¶ï¼Œå¥½ç”¨ä½†æ˜¯å¤ªç¹çäº†ï¼Œä¸€å¼€å§‹å¤§åŠæ—¶é—´éƒ½æµªè´¹åœ¨æ’ä»¶å’Œå¸ƒå±€ä¸Šé¢ï¼Œç›®å‰ç”¨ç€è¿˜è¡Œï¼Œå¸Œæœ›åé¢èƒ½å®Œå…¨ç”¨èµ·æ¥ã€‚å½“ä¸ª md ç¼–è¾‘å™¨è¿˜æ˜¯ä¸é”™çš„ã€‚\nTypora\nä¸€æ¬¾ Markdown ç¼–è¾‘å™¨å’Œé˜…è¯»å™¨ã€‚æ›´ä¾¿æ·çš„æµè§ˆå·¥å…·ã€‚\nç½‘ç›˜\nç™¾åº¦ç½‘ç›˜\nä¹‹å‰å‚åŠ æ´»åŠ¨ï¼Œå®¹é‡å·²ç»åˆ° 5T äº†ï¼Œä½†æ˜¯ä¸å……ä¼šå‘˜å®Œå…¨æ²¡æ³•ä½¿ç”¨ï¼Œç°åœ¨å°±æ˜¯ä¸€ä¸ªå‰ç¥¥ç‰©çš„å­˜åœ¨ï¼Œæœ‰æ—¶å€™ç½‘ä¸Šè´­ä¹°èµ„æºä¼šå‘ç½‘ç›˜é“¾æ¥ï¼Œè¿˜æ˜¯éœ€è¦ä¸‹è½½ä¸€ä¸ªè½¯ä»¶ã€‚\né˜¿é‡Œäº‘ç›˜\néœ€è¦å¤‡ç”¨ä¸€ä¸ª\nç¼–ç¨‹ä¸“ç”¨\nå¼€å‘ç¯å¢ƒ\nJava\nç›®å‰ç”¨çš„è¿˜æ˜¯ 1.8 ç‰ˆæœ¬ï¼Œåœ¨ U ç›˜å†…å­˜äº†å¸¸ç”¨çš„å‡ ç‰ˆ JDKã€‚æœ‰å®‰è£…åŒ…åŒå‡»ä¸‹è½½å°±è¡Œï¼Œä¸‹è½½ä¹‹åéœ€è¦é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡\nMySQL\nç›®å‰ä½¿ç”¨çš„æ˜¯ 5.7.20 ç‰ˆæœ¬ï¼Œå®˜ç½‘ä¸‹è½½å°±è¡Œã€‚åŒæ ·ä¹Ÿéœ€è¦é…ç½®ç¯å¢ƒå˜é‡ã€‚\nRedis\nå®‰è£…ä¸ SpringBoot ä¸‹çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š\n\nå†…é“¾ï¼š[[Spring Data Redis]]\nå¤–é“¾ï¼šSpring Data Redis\n\nMaven\nä¸€ä¸ª Java é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œwindow éœ€è¦å®˜ç½‘ä¸‹è½½å¯ç”¨çš„.zip åŒ…ï¼Œä¹‹åè§£å‹åˆ°ä¸€ä¸ªæ²¡æœ‰ä¸­æ–‡æ²¡æœ‰ç©ºæ ¼çš„è·¯å¾„ä¸‹ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦é…ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡ã€‚ï¼ˆå¯èƒ½å‡ºç° IDEA ä¸é€‚é…éœ€è¦é™ä½ maven ç‰ˆæœ¬ï¼Œå½“å‰ IDEA 2020.3.2ï¼Œå¯ä»¥å®‰è£… Maven 3.6.3ï¼‰\næ‰“å¼€å®‰è£…ç›®å½• conf/settings.xml æ–‡ä»¶ï¼Œè¿›è¡Œä»¥ä¸‹ä¸¤é¡¹é…ç½®ã€‚\n\n\nå…¶ä»–\nè¿˜æœ‰å¾ˆå¤šå…¶ä»–ç¯å¢ƒé…ç½®ï¼ŒåŒ…æ‹¬å¼€å‘ç”¨çš„å…¶ä»–ä¸­é—´ä»¶ã€‚å¬è¯´ Windows ä¹Ÿèƒ½é…ç½® Docker äº†ï¼Œè¿™éƒ¨åˆ†åº”è¯¥ä¼šå•ç‹¬å†™æ–‡ç« ã€‚\nå¼€å‘å·¥å…·\nIntelliJ IDEA\nè¿™ä¸ªä¸ç”¨å¤šè¯´ï¼ŒU ç›˜é‡Œå­˜äº†ä¸€ä¸ªå¯ç”¨çš„ç ´è§£ç‰ˆï¼Œä»å¤§å­¦ç”¨åˆ°ç°åœ¨äº†ã€‚å®‰è£…åè¿˜éœ€è¦è¿›è¡Œä¸€äº›å¸¸ç”¨çš„è®¾ç½®ã€‚å…·ä½“å¯ä»¥å‚è€ƒä»¥ä¸‹\n\nå†…é“¾ï¼š[[IntelliJ ç³»ç±»äº§å“å¸¸ç”¨è®¾ç½®]]\nå¤–é“¾ï¼šIntelliJ IDEAå¸¸ç”¨è®¾ç½®\n\nWebStorm\nå‰ç«¯çš„ IDEAï¼Œæ‰“ç®—æŠ›å¼ƒ Vs Code ç”¨è¿™ä¸ªäº†ã€‚çœ‹äº†å¾ˆå¤šå¯¹æ¯”æµ‹è¯„ã€‚ç”¨ JetBrains çš„äº§å“ä¹ æƒ¯äº†ã€‚\nPycharm\nPython çš„ IDEAï¼Œä¹Ÿæ˜¯ JetBrains å®¶çš„ã€‚\nTabby\nä¸€æ¬¾ç»ˆç«¯å·¥å…·ï¼Œä¹‹å‰ç”¨çš„ä¸€ç›´æ˜¯ FinalShellï¼Œåæ¥æƒ³è½¬æˆ XSHELLï¼Œæ‰çŸ¥é“ XSHELL &amp; XFTP çš„å®¶åº­ç‰ˆæ˜¯å…è´¹çš„ï¼Œåæ¥æ˜¯çœ‹åšå®¢ï¼ŒçŸ¥é“äº†ä¸€æ¬¾ 22 å¹´çš„ç»ˆç«¯ Tabbyï¼ˆä¸è¿‡è¿™ä¹ˆå¤šå…·ä½“å“ªä¸ªå¥½ç”¨ç¡®å®ä¹Ÿæ˜¯ä¸å¤ªäº†è§£ï¼Œæ¢æˆè¿™ä¸ªçš„åŸå› ä¸»è¦æ˜¯ä»–å¯ä»¥ç»“åˆè¿œç¨‹è¿æ¥å’Œè¿œç¨‹ä¼ è¾“ä¸¤å—çš„å†…å®¹ã€‚ä¹Ÿçœ‹åˆ°æŠŠæ•°æ®åº“è¿æ¥ï¼ŒæœåŠ¡å™¨ç›‘æ§ï¼Œç»ˆç«¯éƒ½ç»“åˆåœ¨ä¸€èµ·çš„å·¥å…·ï¼Œä½†æ˜¯æ•°æ®åº“å·¥å…·è¿˜æ˜¯æ¯”è¾ƒä¹ æƒ¯ç”¨ navicatï¼Œæ‰€ä»¥æš‚æ—¶å†³å®šæ˜¯å…ˆæŠŠç»ˆç«¯å·¥å…·æ¢æˆ Tabbyï¼‰å…·ä½“ä½¿ç”¨æ­¥éª¤å‚è€ƒï¼ˆåé¢æœ‰æ—¶é—´å†æ•´ç†åˆ°è‡ªå·±çš„ç¬”è®°é‡Œé¢å§ï¼‰ï¼š(https://www.macrozheng.com/tool/tabby_start.html)\nNavicat\nä¸€æ¬¾å¥½ç”¨çš„æ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œæä¾› 14 å¤©å…è´¹è¯•ç”¨ã€‚ä½†æ˜¯è¿™ç§ä¸€èˆ¬éƒ½æ˜¯æœ‰ç ´è§£çš„ï¼Œç½‘ç›˜é‡Œå­˜äº†ä¸€ä¸ªï¼ˆä¼šè¢«æ€æ¯’è½¯ä»¶æ€æ‰ï¼‰\nGit\nç‰ˆæœ¬æ§åˆ¶å·¥å…·ã€‚ï¼ˆç›®å‰ä½¿ç”¨çš„åšå®¢å·¥å…· Hexo ä¹Ÿæ˜¯ä¾é  Git éƒ¨ç½²ï¼‰\nå…·ä½“ä½¿ç”¨ä»‹ç»å¦‚ä¸‹\n\nå†…é“¾ï¼š[[Git åŠå¸¸ç”¨å‘½ä»¤]]\nå¤–é“¾ï¼šGitåŠå¸¸ç”¨å‘½ä»¤\n\nå…¶ä»–\nç¿»å¢™\nç›®å‰ä½¿ç”¨çš„æ•™ç¨‹æ˜¯ (https://github.com/Alvin9999/new-pac/blob/master/è‡ªå»ºv2rayæœåŠ¡å™¨æ•™ç¨‹.md)\nps. å»ºè®®ç›´æ¥æœºåœºè´­ä¹°ï¼Œæè¿™ä¸ªæ²¡ç”¨çš„é€Ÿåº¦åˆæ…¢è¿˜è´µ\n","categories":["ç¯å¢ƒæ­å»º"],"tags":["å·¥å…·"]},{"title":"è£…æœº-è½¯ä»¶å®‰è£…ï¼ˆLinuxï¼‰","url":"/posts/dada24a1/","content":"\n\nå‰è¨€è®°å½• Linux å®‰è£…æ•™ç¨‹\n\n\næ›´æ–°\n\n\n24-09-12 åˆå§‹è®°å½•\n\né»˜è®¤æ“ä½œä¸º root æƒé™ï¼Œæƒé™ä¸è¶³å‘½ä»¤å‰åŠ  sudo\nMySQL\n\n\nMySQL 8.0.26 ä¸‹è½½\n\n\nwget https://downloads.mysql.com/archives/get/p/23/file/mysql-8.0.26-linux-glibc2.12-x86_64.tar.xz\n\n\nè§£å‹ç¼©æ–‡ä»¶\n\n\ntar -xvf mysql-8.0.26-linux-glibc2.12-x86_64.tar.xz\n\n\nç§»åŠ¨æ–‡ä»¶\n\n\nmv mysql-8.0.26-linux-glibc2.12-x86_64 /usr/local/mysql\n\n\nåˆ›å»ºæ•°æ®å­˜æ”¾ç›®å½•\n\n\n# cdåˆ°å®‰è£…ç›®å½•ä¸‹mkdir data\n\n\nåˆ›å»ºç”¨æˆ·ç»„å’Œç”¨æˆ·\n\n\ngroupadd mysqluseradd -g mysql mysql\n\n\næ”¹å˜ mysql ç›®å½•æƒé™\n\n\nchown -R mysql.mysql /usr/local/mysql/chown -R mysql .chgrp -R mysql .\n\n\næ•°æ®åº“åˆå§‹åŒ–ï¼ˆéœ€è¦è®°ä½ä¸´æ—¶å¯†ç ï¼‰\n\n\n./bin/mysqld --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --initialize\n\n\nä¿®æ”¹ my.cnf æ–‡ä»¶\n\n\nvim /etc/my.cnf# æ–‡ä»¶å†…å†…å®¹[mysqld]    basedir = /usr/local/mysql    datadir = /usr/local/mysql/data    socket = /usr/local/mysql/mysql.sock    character-set-server=utf8    port = 3306   sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES [client]   socket = /usr/local/mysql/mysql.sock   default-character-set=utf8\n\n\nåˆ›å»º mysql æœåŠ¡\n\n\n# å°† mysql.server å¯åŠ¨æ–‡ä»¶å¤åˆ¶åˆ° /etc/init.d ç›®å½•cp -a /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld# èµ‹äºˆæƒé™chmod +x /etc/rc.d/init.d/mysqld# åˆ›å»º mysql æœåŠ¡chkconfig --add mysqld# æ£€æŸ¥æœåŠ¡æ˜¯å¦ç”Ÿæ•ˆchkconfig --list mysqld\n\n\né…ç½®å…¨å±€ç¯å¢ƒ\n\n\nvim /etc/profile# æ·»åŠ å¦‚ä¸‹é…ç½®export PATH=$PATH:/usr/local/mysql/bin:/usr/local/mysql/libexport PATH# ä½¿ç¯å¢ƒå˜é‡è®¾ç½®ç”Ÿæ•ˆsource /etc/profile\n\n\nå¯åŠ¨ mysql æœåŠ¡\n\n\nservice mysql startservice mysql status\n\n\nç™»å½• mysql ä¿®æ”¹å¯†ç \n\n\n# å¯†ç ä¸ºä¹‹å‰çš„ä¸´æ—¶å¯†ç mysql -uroot -p# ä¿®æ”¹å¯†ç ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;\n\n\nè®¾ç½® mysql è¿œç¨‹ç™»å½•\n\n\nuse mysql;-- å…è®¸ä»»ä½•ä¸»æœºä½¿ç”¨ root è¿›è¡Œè¿æ¥update user set host=&#x27;%&#x27; where user=&#x27;root&#x27; limit 1;-- åˆ›å»ºä¸€ä¸ªå…è®¸è¿œç¨‹è®¿é—®çš„ MySQL è´¦æˆ·CREATE USER &#x27;your_user&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;your_password&#x27;; GRANT ALL PRIVILEGES ON *.* TO &#x27;your_user&#x27;@&#x27;%&#x27; WITH GRANT OPTION;flush privileges;\nRedis\n\n\næºç å®‰è£…ä¸ç¼–è¯‘\n\n\nwget http://download.redis.io/redis-stable.tar.gztar -xzvf redis-stable.tar.gzcd redis-stablemake\næ‰§è¡Œå®Œ make å‘½ä»¤åï¼Œsrc ç›®å½•ä¸‹ä¼šå‡ºç°ç¼–è¯‘åçš„ redis æœåŠ¡ç¨‹åºÂ redis-serverï¼Œè¿˜æœ‰ç”¨äºæµ‹è¯•çš„å®¢æˆ·ç«¯ç¨‹åºÂ redis-cliï¼Œä¸¤ä¸ªç¨‹åºä½äºå®‰è£…ç›®å½• src ç›®å½•ä¸‹\n\n\nå®‰è£…å¯æ‰§è¡Œç¨‹åºåˆ° /usr/local/bin\n\n\nmake install\n\n\nå‰å°è¿è¡Œå¯åŠ¨\n\n\nredis-server# ä½¿ç”¨æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨cp redis.conf /etc/redis.confredis-server /etc/redis.conf\n\n\nå…¶ä»–å‘½ä»¤\n\n\nredis-cliredis&gt; set foo barOKredis&gt; get foo&quot;bar&quot;redis-cli shutdown#ç›´æ¥å…³é—­ä¸ä¿å­˜å†…å­˜redis-cli shutdown nosave\n\n\né…ç½® Redis ä¸ºåå°æœåŠ¡å°†é…ç½®æ–‡ä»¶ä¸­çš„ daemonize no æ”¹æˆ daemonize yesï¼Œé…ç½® redis ä¸ºåå°å¯åŠ¨ã€‚\n\n\nRedis è®¾ç½®è®¿é—®å¯†ç åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ° requirepassï¼Œå»æ‰å‰é¢çš„æ³¨é‡Šï¼Œå¹¶ä¿®æ”¹åé¢çš„å¯†ç ã€‚\n\n\nè®¾ç½®è¿œç¨‹å¯è®¿é—®\n\n\nåœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ° bind 127.0.0.1 è¿™ä¸€è¡Œï¼Œæ³¨é‡Šã€‚\nå¦‚æœ redis3.2 ç‰ˆæœ¬ä»¥ä¸Šçš„ï¼Œéœ€è¦å°†ä¿æŠ¤æ¨¡å¼ï¼ˆprotected-modeï¼‰ä¿®æ”¹æˆ no\n\n\nå¸¸ç”¨çš„é…ç½®æ–‡ä»¶\n\n\n#é»˜è®¤ç«¯å£6379port 6379#ç»‘å®šipï¼Œå¦‚æœæ˜¯å†…ç½‘å¯ä»¥ç›´æ¥ç»‘å®š 127.0.0.1, æˆ–è€…å¿½ç•¥, 0.0.0.0æ˜¯å¤–ç½‘bind 0.0.0.0#å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨daemonize yes#è¶…æ—¶timeout 300loglevel notice#åˆ†åŒºdatabases 16save 900 1save 300 10save 60 10000rdbcompression yes#å­˜å‚¨æ–‡ä»¶dbfilename dump.rdb#å¯†ç  abcd123requirepass abcd123\nDocker å’Œ Docker-compose\n\n\nå®‰è£… GCC ç›¸å…³çš„ç¯å¢ƒ\n\n\nyum -y install gccyum -y install gcc-c++\n\n\nå®‰è£… Docker éœ€è¦çš„ä¾èµ–è½¯ä»¶åŒ…\n\n\nyum install -y yum-utils device-mapper-persistent-data lvm2\n\n\nè®¾ç½®å›½å†…çš„é•œåƒ\n\n\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n\næ›´æ–° yum è½¯ä»¶åŒ…ç´¢å¼•\n\n\nyum makecache fast\n\n\nå®‰è£… DOCKER CE(æ³¨æ„ï¼šDocker åˆ†ä¸º CE ç‰ˆå’Œ EE ç‰ˆï¼Œä¸€èˆ¬æˆ‘ä»¬ç”¨ CE ç‰ˆå°±å¤Ÿç”¨äº†)\n\n\nyum -y install docker-ce\n\n\nå¯åŠ¨ Docker\n\n\nsystemctl start dockerdocker version\n\n\nä¸‹è½½ Docker Compose çš„å½“å‰ç¨³å®šç‰ˆæœ¬\n\n\nsudo curl -L &quot;https://github.com/docker/compose/releases/download/1.24.1/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose\n\n\nå°†å¯æ‰§è¡Œæƒé™åº”ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶\n\n\nsudo chmod +x /usr/local/bin/docker-compose\n\n\nåˆ›å»ºè½¯é“¾\n\n\nsudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose\n\n\næµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ\n\n\ndocker-compose --version\nMinio\n\n\næœåŠ¡å™¨å®‰è£…\n\n\nwget https://dl.min.io/server/minio/release/linux-amd64/miniochmod +x minioMINIO_ROOT_USER=admin MINIO_ROOT_PASSWORD=password ./minio server /mnt/data --console-address &quot;:9001&quot;\n\n\nå®¢æˆ·ç«¯å®‰è£…\n\n\nwget https://dl.min.io/client/mc/release/linux-amd64/mc chmod +x mc mc alias set myminio/ http://MINIO-SERVER MYUSER MYPASSWORD\n","categories":["ç¯å¢ƒæ­å»º"],"tags":["Linux","å·¥å…·"]},{"title":"è®¾è®¡æ¨¡å¼-è´£ä»»é“¾æ¨¡å¼","url":"/posts/b6c1490f/","content":"\n\nå‰è¨€\nè®¾è®¡æ¨¡å¼ - è´£ä»»é“¾æ¨¡å¼\n\n\næ›´æ–°\n\n\n24-09-13 åˆå§‹è®°å½•\n\nç®€å•ç†è§£\nå¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼Œé’ˆå¯¹ä¸€ä¸ªè¯·æ±‚ï¼Œåšå¤šå±‚å¤„ç†ï¼ˆ ä¸åˆ†å…ˆåï¼‰ï¼Œå¹¶ä¸”è¿™äº›å¤„ç†å¯èƒ½éšç€ä¸šåŠ¡éœ€æ±‚è¿›è¡Œä¸æ–­å˜æ›´ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨è´£ä»»é“¾æ¨¡å¼ã€‚æ¯”å¦‚è¯´ Spring ä¸­çš„ Filter ä½¿ç”¨çš„å°±æ˜¯è´£ä»»é“¾æ¨¡å¼ã€‚* è¿™é‡Œç†è§£ä¸ç­–ç•¥æ¨¡å¼çš„ä¸åŒåœ¨äºï¼šè´£ä»»é“¾æœ‰ç‚¹åƒ if return ä¼šæ¯ä¸ªåŒ¹é…æ¯”è¾ƒï¼Œè€Œç­–ç•¥åƒ map get key ç›´æ¥åŒ¹é…ä¸€ä¸ªï¼›è´£ä»»é“¾å¤šç”¨äºè§£è€¦ï¼Œç­–ç•¥å¤šç”¨äºå°è£… *\nä¸€èˆ¬æ¥è¯´ï¼Œè¿™ç§å¤šå±‚å¤„ç†å¯èƒ½ä»£ç ä¸­ä½¿ç”¨å¤šä¸ª if æ¥è¿›è¡Œå¤„ç†ã€‚å¤„ç†æ–¹å¼å¯ä»¥å¦‚ä¸‹ï¼š\n\n\nå°†å¤„ç†çš„å„ä¸ªæµç¨‹æŠ½è±¡ä¸ºå„ä¸ªç±»ï¼ˆæœ¬æ¥ Handler é‡Œè¾¹æœ‰å¤šä¸ª if å’Œ æ–¹æ³•)\n\n\nå°†å¤šä¸ªç±»ç”¨ Chain é“¾èµ·æ¥ï¼Œæš´éœ²ä¸€ä¸ªæ–¹æ³•ç»™ Handler ä½¿ç”¨\n\n\npublicÂ interfaceÂ FilterÂ &#123;  Â Â Â Â //Â è¿‡æ»¤  Â Â Â Â voidÂ doFilter(StringÂ data);  &#125;    classÂ Filter1Â implementsÂ FilterÂ &#123;  Â Â Â Â @Override  Â Â Â Â publicÂ voidÂ doFilter(StringÂ data)Â &#123;  Â Â Â Â Â Â Â Â //doSomething  Â Â Â Â &#125;  &#125;    classÂ Filter2Â implementsÂ FilterÂ &#123;  Â Â Â Â @Override  Â Â Â Â publicÂ voidÂ doFilter(StringÂ data)Â &#123;  Â Â Â Â Â Â Â Â //doSomething  Â Â Â Â &#125;  &#125;    classÂ Filter3Â implementsÂ FilterÂ &#123;  Â Â Â Â @Override  Â Â Â Â publicÂ voidÂ doFilter(StringÂ data)Â &#123;  Â Â Â Â Â Â Â Â //doSomething  Â Â Â Â &#125;  &#125;\npublicÂ classÂ FilterChainÂ &#123;  Â Â Â Â List&lt;Filter&gt;Â filtersÂ =Â newÂ ArrayList&lt;&gt;();    Â Â Â Â publicÂ FilterChain()Â &#123;  Â Â Â Â Â Â Â Â filters.add(newÂ Filter1());  Â Â Â Â Â Â Â Â filters.add(newÂ Filter2());  Â Â Â Â Â Â Â Â filters.add(newÂ Filter3());Â Â Â Â &#125;  Â Â Â Â Â Â Â Â publicÂ voidÂ processData(StringÂ data)Â &#123;  Â Â Â Â Â Â Â Â forÂ (FilterÂ filterÂ :Â filters)Â &#123;  Â Â Â Â Â Â Â Â Â Â Â Â filter.doFilter(data);  Â Â Â Â Â Â Â Â &#125;  Â Â Â Â &#125;  &#125;\npublicÂ classÂ HandlerÂ &#123;  Â Â Â Â publicÂ voidÂ handlerRequest(RequestÂ request)Â &#123;  Â Â Â Â Â Â Â Â //Â å¾—åˆ°è¯·æ±‚çš„æ•°æ®  Â Â Â Â Â Â Â Â StringÂ dataÂ =Â request.getData();  Â Â Â Â Â Â Â Â FilterChainÂ filterChainÂ =Â newÂ FilterChain();  Â Â Â Â Â Â Â Â //Â å¤„ç†æ•°æ®  Â Â Â Â Â Â Â Â filterChain.processData(data);  Â Â Â Â &#125;  &#125;\né€šç”¨ä»£ç \n\n\nä¸šåŠ¡æ‰§è¡Œå™¨æ¥å£ï¼Œæ‰€æœ‰çš„ä¸šåŠ¡å®ç°éƒ½ä¼šå®ç°è¯¥æ¥å£\n\n\n/**  Â *Â ä¸šåŠ¡æ‰§è¡Œå™¨Â */  publicÂ interfaceÂ BusinessProcessÂ &#123;  Â Â Â Â voidÂ process(ProcessContextÂ context);  &#125;\n\n\nè´£ä»»é“¾ä¸Šä¸‹æ–‡\n\n\n/**  Â *Â è´£ä»»é“¾ä¸Šä¸‹æ–‡Â */  publicÂ classÂ ProcessContextÂ &#123;  Â Â Â Â //Â æ ‡è¯†è´£ä»»é“¾çš„code  Â Â Â Â privateÂ StringÂ code;  Â Â Â Â //Â å­˜å‚¨ä¸Šä¸‹æ–‡çš„çœŸæ­£è½½ä½“  Â Â Â Â privateÂ ModelÂ model;  Â Â Â Â //Â è´£ä»»é“¾ä¸­æ–­çš„æ ‡è¯†  Â Â Â Â privateÂ BooleanÂ needBreakÂ =Â false;  &#125;\n\n\nä¸šåŠ¡æ‰§è¡Œæ¨¡æ¿ï¼ˆæŠŠè´£ä»»é“¾çš„é€»è¾‘ä¸²èµ·æ¥ï¼‰\n\n\n/**  Â *Â ä¸šåŠ¡æ‰§è¡Œæ¨¡æ¿ï¼ˆæŠŠè´£ä»»é“¾çš„é€»è¾‘ä¸²èµ·æ¥ï¼‰ Â */  publicÂ classÂ ProcessTemplateÂ &#123;  Â Â Â Â privateÂ List&lt;BusinessProcess&gt;Â processList;  Â Â Â Â publicÂ List&lt;BusinessProcess&gt;Â getProcessList()Â &#123;  Â Â Â Â Â Â Â Â returnÂ processList;  Â Â Â Â &#125;  Â Â Â Â publicÂ voidÂ setProcessList(List&lt;BusinessProcess&gt;Â processList)Â &#123;  Â Â Â Â Â Â Â Â this.processListÂ =Â processList;  Â Â Â Â &#125;  &#125;\n\n\nè´£ä»»é“¾çš„æµç¨‹æ§åˆ¶å™¨\n\n\n/**  Â *Â è´£ä»»é“¾çš„æµç¨‹æ§åˆ¶å™¨ï¼ˆæ•´ä¸ªè´£ä»»é“¾çš„æ‰§è¡Œæµç¨‹é€šç”¨æ§åˆ¶ï¼‰Â */  @Data  publicÂ classÂ ProcessControllerÂ &#123;  Â Â Â Â   Â Â Â Â //Â ä¸åŒçš„codeÂ å¯¹åº”ä¸åŒçš„è´£ä»»é“¾  Â Â Â Â privateÂ Map&lt;String,Â ProcessTemplate&gt;Â templateConfigÂ =Â null;    Â Â Â Â publicÂ voidÂ process(ProcessContextÂ context)Â &#123;  Â Â Â Â Â Â Â Â //æ ¹æ®ä¸Šä¸‹æ–‡çš„CodeÂ æ‰§è¡Œä¸åŒçš„è´£ä»»é“¾  Â Â Â Â Â Â Â Â StringÂ businessCodeÂ =Â context.getCode();  Â Â Â Â Â Â Â Â ProcessTemplateÂ processTemplateÂ =Â templateConfig.get(businessCode);  Â Â Â Â Â Â Â Â List&lt;BusinessProcess&gt;Â actionListÂ =Â processTemplate.getProcessList();  Â Â Â Â Â Â Â Â //éå†æŸä¸ªè´£ä»»é“¾çš„æµç¨‹èŠ‚ç‚¹  Â Â Â Â Â Â Â Â forÂ (BusinessProcessÂ actionÂ :Â actionList)Â &#123;  Â Â Â Â Â Â Â Â Â Â Â Â tryÂ &#123;  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â action.process(context);  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (context.getNeedBreak())Â &#123;  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â break;  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &#125;  Â Â Â Â Â Â Â Â Â Â Â Â &#125;Â catchÂ (ExceptionÂ e2)Â &#123;  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //...  Â Â Â Â Â Â Â Â Â Â Â Â &#125;  Â Â Â Â Â Â Â Â &#125;  Â Â Â Â &#125;  &#125;\n\n\nä¸¾ä¾‹ç”¨çš„ä¸¤ä¸ªå®ç°\n\n\n/**  Â *Â ç™½åå•å¤„ç†å™¨Â */  @Service  publicÂ classÂ WhiteListProcessÂ implementsÂ BusinessProcessÂ &#123;  Â Â Â Â @Override  Â Â Â Â publicÂ voidÂ process(ProcessContextÂ context)Â &#123;  Â Â Â Â Â Â Â Â UserModelÂ userÂ =Â (UserModel)Â context.getModel();  Â Â Â Â Â Â Â Â ifÂ (&quot;3y&quot;.equals(user.getName()))Â &#123;  Â Â Â Â Â Â Â Â Â Â Â Â context.setNeedBreak(true);  Â Â Â Â Â Â Â Â &#125;  Â Â Â Â &#125;  &#125;    /**  Â *Â å‘æ¶ˆæ¯å¤„ç†å™¨Â */  @Service  publicÂ classÂ SendMessageProcessÂ implementsÂ BusinessProcessÂ &#123;    Â Â Â Â @Override  Â Â Â Â publicÂ voidÂ process(ProcessContextÂ context)Â &#123;  Â Â Â Â Â Â Â Â UserModelÂ userÂ =Â (UserModel)Â context.getModel();  Â Â Â Â Â Â Â Â System.out.println(&quot;ç»™&quot;+user.getName()+&quot;å‘æ¶ˆæ¯&quot;);  Â Â Â Â &#125;  &#125;\n\n\næŠŠå¤„ç†å™¨æ·»åŠ åˆ° ProcessTemplate æ¨¡æ¿ï¼ŒæŠŠ ProcessTemplate æ·»åŠ åˆ° ProcessController çš„ Map ä¸Š\n\n\n&lt;!--å‘é€æ¶ˆæ¯çš„è´£ä»»é“¾--&gt;&lt;beanÂ id=&quot;sendMessageTemplate&quot;Â class=&quot;com.chainofresponsibility.ProcessTemplate&quot;&gt;  Â Â &lt;propertyÂ name=&quot;processList&quot;&gt;  Â Â Â Â &lt;list&gt;  Â Â Â Â Â Â &lt;refÂ bean=&quot;whiteListProcess&quot;&gt;&lt;/ref&gt;  Â Â Â Â Â Â &lt;refÂ bean=&quot;sendMessageProcess&quot;&gt;&lt;/ref&gt;  Â Â Â Â &lt;/list&gt;  Â Â &lt;/property&gt;  &lt;/bean&gt;    &lt;!--é€šç”¨æµç¨‹å¤„ç†å™¨ï¼Œç»´æŠ¤å¤šæ¡è´£ä»»é“¾--&gt;&lt;beanÂ id=&quot;processController&quot;Â class=&quot;com.chainofresponsibility.ProcessController&quot;&gt;  Â Â &lt;propertyÂ name=&quot;templateConfig&quot;&gt;  Â Â Â Â &lt;map&gt;  Â Â Â Â Â Â &lt;entryÂ key=&quot;sendMessage&quot;Â value-ref=&quot;sendMessageTemplate&quot;Â /&gt;  Â Â Â Â &lt;/map&gt;  Â Â &lt;/property&gt;  &lt;/bean&gt;\n\n\næ¥å£é‡Œæ‰§è¡Œè´£ä»»é“¾\n\n\n@RestControllerpublicÂ classÂ UserControllerÂ &#123;Â Â Â Â @AutowiredÂ Â Â Â privateÂ ProcessControllerÂ processController;  Â Â Â Â @RequestMapping(&quot;/send&quot;)Â Â Â Â public void send(StringÂ userName)Â &#123;Â Â Â Â Â Â Â Â //Â æ„å»ºä¸Šä¸‹æ–‡Â Â Â Â Â Â Â Â ProcessContextÂ processContextÂ =Â newÂ ProcessContext();  Â Â Â Â Â Â Â Â UserModelÂ userModelÂ =Â newÂ UserModel();Â Â Â Â Â Â Â Â userModel.setAge(&quot;24&quot;);Â Â Â Â Â Â Â Â userModel.setName(userName);Â Â Â Â Â Â Â Â processContext.setModel(userModel);Â Â Â Â Â Â Â Â processContext.setCode(&quot;sendMessage&quot;);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â processController.process(processContext);Â Â Â Â &#125;&#125;\nPipeline\nRedis ä¼šç”¨ Pipeline å»åšæ‰¹é‡çš„æ“ä½œã€‚å®ƒæ˜¯ã€Œè´£ä»»é“¾æ¨¡å¼ã€çš„å®ç°ä¹‹ä¸€ã€‚\n// å…·ä½“åˆ†æ todo\n","categories":["è®¾è®¡æ¨¡å¼"],"tags":["è®¾è®¡æ¨¡å¼","è´£ä»»é“¾æ¨¡å¼"]},{"title":"Dockeræ‹‰å–å¤±è´¥","url":"/posts/4512ff84/","content":"\n\nå‰è¨€å‚è€ƒæ–‡ç« ï¼šå½»åº•è§£å†³dockerï¼šdocker: Get https://registry-1.docker.io/v2/: net/http: request canceled æŠ¥é”™\n\n\næ›´æ–°\n\n\n24-12-12 åˆå§‹è®°å½•\n\né—®é¢˜\ndockeré…ç½®äº†é•œåƒï¼Œæ‹‰å–å¤±è´¥ã€‚æŠ¥é”™ä¿¡æ¯ï¼šERROR: Get &quot;https://registry-1.docker.io/v2/&quot;: net/http: request canceled while waiting for connection\nåŸå› \né•œåƒåœ°å€å¤±æ•ˆã€‚\nè§£å†³\næ¢æº\n\næœ¬æ¬¡æœªä½¿ç”¨ï¼Œéœ€è¦æ¢æºé‡å¯ï¼Œä½†æ˜¯åŸdockerä¸­å«æœ‰è·³æ¿æœºï¼Œéœ€è¦è·³æ¿æœºæ‰èƒ½è¿æ¥ä¸ŠæœåŠ¡å™¨ï¼Œé‡å¯ä¼šå¯¼è‡´è·³æ¿æœºè¿æ¥å¤±è´¥ã€‚\n\n\n\nä¿®æ”¹ /etc/docker/daemon.jsonæ–‡ä»¶\n\n\nåŠ å…¥é•œåƒé…ç½®\n\n\né‡å¯\n\n\nsystemctl daemon-reloadÂ   systemctl restart docker\nä¿®æ”¹DNSæœåŠ¡é…ç½®\n\næœªä½¿ç”¨\n\næ‰‹åŠ¨æ‹‰å–\n\nè§£å†³ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ‰‹åŠ¨æ‹‰å–åï¼Œä½¿ç”¨docker-composeè¿›è¡Œéƒ¨ç½²ï¼Œéœ€è¦å¡«å†™æ‹‰å–çš„é•œåƒï¼ˆåŠ ä¸Šä»“åº“åï¼‰ï¼Œä¸ç„¶ä¾æ—§ä¼šä»åŸåœ°å€æ‹‰å–\n\ndocker pull ä»“åº“å/é•œåƒå:ç‰ˆæœ¬å·# æš‚æ—¶å¯ç”¨çš„ä¸€ä¸ªä»“åº“docker.m.daocloud.io\nç»™dockeré…ç½®ä¸€ä¸ªä»£ç†\n\næœªä½¿ç”¨ã€‚\n\n","categories":["bugè®°å½•","2024"],"tags":["docker"]},{"title":"Keep ä¸»é¢˜æ›´æ–° tools åŠŸèƒ½æŠ¥é”™ btoa is not defined","url":"/posts/9344475e/","content":"\n\nå‰è¨€ä¸æ˜¯ä¸“ä¸šå‰ç«¯ï¼Œæ­¤é—®é¢˜é€šè¿‡ Chat GLM è§£å†³\n\n\næ›´æ–°\n\n\n24-06-17 åˆå§‹è®°å½•\n\né—®é¢˜\nKeep ä¸»é¢˜æ›´æ–° tools åŠŸèƒ½ï¼Œä½†æ˜¯è®¿é—® tools æ¨¡æ¿é¡µé¢æŠ¥é”™ï¼šbtoa is not definedã€‚\nåŸå› \næ ¹æ® Chat GLM çš„æè¿°ã€‚\n\nå¦‚æœä½ é‡åˆ°äº†Â btoa is not definedÂ çš„é”™è¯¯ï¼Œè¿™æ„å‘³ç€Â btoaÂ å‡½æ•°åœ¨ä½ çš„ç¯å¢ƒä¸­ä¸å¯ç”¨ã€‚btoaÂ æ˜¯æµè§ˆå™¨ç¯å¢ƒä¸­ç”¨äºå°†å­—ç¬¦ä¸²ç¼–ç ä¸º Base64 çš„å‡½æ•°ï¼Œè€Œåœ¨ Node.js ç¯å¢ƒä¸­æ²¡æœ‰è¿™ä¸ªå…¨å±€å‡½æ•°ã€‚\nåœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨Â BufferÂ ç±»æ¥å®ç°ç›¸ä¼¼çš„åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¸ä½¿ç”¨Â btoaÂ çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥åœ¨ Node.js å’Œæµè§ˆå™¨ç¯å¢ƒä¸­éƒ½å·¥ä½œã€‚\n\nè§£å†³\næ‰¾åˆ° node_module ä¸­ keep ä¸»é¢˜çš„å®‰è£…ä½ç½®ï¼šä¸€èˆ¬åœ¨è¿™ä¸ªåœ°æ–¹ï¼ˆâ€¦/blog/node_modules/hexo-theme-keep/layout/_templateï¼‰ã€‚åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­çš„ tools-nav.ejs ä¸ºæ›´æ–°åçš„ tools é¡µé¢æ¨¡æ¿æ–‡ä»¶ã€‚\nä¿®æ”¹å¼€å§‹éƒ¨åˆ†ä»£ç ï¼Œæ³¨é‡Šç¬¬ä¸€è¡Œï¼Œæ”¹æˆä½¿ç”¨ Buffer è½¬æ¢çš„æ–¹å¼ï¼ˆè¿™éƒ¨åˆ†ä¹Ÿæ˜¯ Chat GLM ç»™å‡ºçš„å»ºè®®ï¼‰ï¼š\n&lt;%  // const btoaStr = (str) =&gt; btoa(encodeURIComponent(str)).trim().replaceAll(&#x27;=&#x27;, &#x27;&#x27;)  const btoaStr = (str) =&gt; &#123;      // ä½¿ç”¨ Buffer å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º Base64 ç¼–ç       const base64 = Buffer.from(str).toString(&#x27;base64&#x27;);        // å»é™¤ Base64 ç¼–ç å­—ç¬¦ä¸²ä¸­çš„ç­‰å·      const base64Url = base64.replace(/\\+/g, &#x27;-&#x27;).replace(/\\//g, &#x27;_&#x27;).replace(/=/g, &#x27;&#x27;);        return base64Url;  &#125;;  const tools_data = theme.source_data.tools  const tools_nav_data = theme.source_data.tools.filter((t) =&gt; t?.category)  %&gt;\n","categories":["bugè®°å½•","2024"]},{"title":"Leetcodeä¸æœ¬åœ°ç»“æœä¸ä¸€è‡´é—®é¢˜","url":"/posts/f9d0f046/","content":"\n\nå‰è¨€å‚è€ƒæ–‡ç« ï¼šLeetcodeä¸æœ¬åœ°ç»“æœä¸ä¸€è‡´é—®é¢˜è§£å†³åŠåˆ†æ\n\n\næ›´æ–°\n\n\n24.06.08 åˆå§‹è®°å½•\n\né—®é¢˜\nLeetcode æäº¤çš„ä»£ç ï¼Œæµ‹è¯•ç”¨ä¾‹ä¸é€šè¿‡ã€‚æƒ³åœ¨æœ¬åœ°è°ƒå¼æŸ¥çœ‹ï¼Œä½†æ˜¯æœ¬åœ°æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚\nåŸå› \næœ¬åœ°åœ¨ main æ–¹æ³•ä¸­ç›´æ¥è°ƒè¯•ï¼Œéƒ¨åˆ†å…¨å±€å˜é‡ä½¿ç”¨äº† static å…³é”®å­—ï¼ŒLeetcode åªåŠ è½½äº†ä¸€æ¬¡ Solution ç±»ã€‚å¯¼è‡´å…¨å±€å˜é‡æ²¡æœ‰æ¢å¤åˆå§‹å€¼ã€‚\nè§£å†³\nå…¨éƒ¨å˜é‡å†æäº¤åˆ° Leetcode æ—¶ï¼Œæ‰‹åŠ¨åˆ é™¤ static å…³é”®å­—ã€‚\n","categories":["bugè®°å½•","2024"]},{"title":"Longé•¿åº¦å¤§äº17ä½æ—¶ï¼Œç²¾åº¦ä¸¢å¤±","url":"/posts/b4cd8fc4/","content":"\n\næ›´æ–°\n\n\n24.06.06 åˆå§‹è®°å½•\n\né—®é¢˜\nå‰ç«¯ JS åœ¨ Long é•¿åº¦å¤§äº 17 ä½æ—¶ï¼Œå‡ºç°ç²¾åº¦ä¸¢å¤±çš„é—®é¢˜\nè§£å†³\nåœ¨æ­¤å¤„æ·»åŠ æ³¨ è§£å°†è¿”å›ç»™å‰ç«¯çš„é—¨åº— ID è‡ªåŠ¨è½¬ä¸º string ç±»å‹ã€‚\n\n\nä½¿ç”¨ jackson æ¥å®Œæˆè‡ªåŠ¨è½¬æ¢ï¼Œæ·»åŠ ä¾èµ–\n\n\n&lt;dependency&gt;      &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;      &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;    &lt;version&gt;2.9.8&lt;/version&gt;&lt;/dependency&gt;\n\n\nåœ¨å¯¹åº”çš„å®ä½“ç±»ä¸­æ·»åŠ æ³¨è§£\n\n\n@JsonSerialize(using= ToStringSerializer.class) private Long id;\n","categories":["bugè®°å½•","2024"],"tags":["BUG","Java"]},{"title":"RestTemplateä½¿ç”¨GETè¯·æ±‚ï¼Œè¿”å›ä¸­æ–‡ä¹±ç ","url":"/posts/419abf20/","content":"\n\næ›´æ–°\n\n\n24.05.23 åˆå§‹è®°å½•\n\né—®é¢˜\næµ‹è¯• RestTemplate çš„ Get è¯·æ±‚ï¼Œè¿”å›ä¸­æ–‡ä¹±ç ã€‚\nåŸå› \nå½“ RestTemplate é»˜è®¤ä½¿ç”¨ String å­˜å‚¨ body å†…å®¹æ—¶é»˜è®¤ä½¿ç”¨ ISO_8859_1 å­—ç¬¦é›†ã€‚\nè§£å†³\né…ç½® StringHttpMessageConverter æ¶ˆæ¯è½¬æ¢å™¨ï¼Œä½¿ç”¨ utf-8 å­—ç¬¦é›†ã€‚\n@Bean  public RestTemplate restTemplate() &#123;      RestTemplate restTemplate = new RestTemplate(new OkHttp3ClientHttpRequestFactory());      //æ¶ˆæ¯è½¬æ¢å™¨åˆ—è¡¨      List&lt;HttpMessageConverter&lt;?&gt;&gt; messageConverters = restTemplate.getMessageConverters();      //é…ç½®æ¶ˆæ¯è½¬æ¢å™¨StringHttpMessageConverterï¼Œå¹¶è®¾ç½®utfâ€8      messageConverters.set(1, new StringHttpMessageConverter(StandardCharsets.UTF_8));      return restTemplate;  &#125;\n","categories":["bugè®°å½•","2024"],"tags":["BUG","Java","RestTemplate"]},{"title":"MybatisPluså¤šè¡¨è”æŸ¥åˆ†é¡µï¼ŒTotalè®¡æ•°å¼‚å¸¸","url":"/posts/ae58dfcb/","content":"\n\næ›´æ–°\n\n\n24.04.19 åˆå§‹è®°å½•\n\né—®é¢˜\nä½¿ç”¨ MP çš„åˆ†è¡¨è”æŸ¥ï¼Œå‡ºç°äº†æŸ¥è¯¢å‡º 10 æ¡æ•°æ®ï¼Œä½†æ˜¯ Total æ•°é‡æ˜¾ç¤º 4 çš„é—®é¢˜ã€‚ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ SQL ä¹¦å†™é”™è¯¯ï¼Œä½†æ˜¯çœ‹äº†åŒæ ·ä¸€å¼ è¡¨çš„å¦ä¸€ä¸ª SQLï¼Œåªæ˜¯åŠ ä¸Šäº† GROUP BYï¼Œå°±å¯ä»¥æ˜¾ç¤ºæ­£ç¡®çš„ Total æ•°ã€‚\nDEBUG\næ§åˆ¶å°è¾“å‡º SQL è¯­å¥ï¼Œå‘ç° count() è¯­å¥çš„è®°å½•åªåˆ°äº† left join å‰ï¼Œæ‰€ä»¥è®¡æ•°å¼‚å¸¸ã€‚\nè§£å†³\nä½¿ç”¨ page æ–¹æ³•æ—¶ï¼šåŠ ä¸Šä»¥ä¸‹è¯­å¥\n// éœ€è¦æ‰‹åŠ¨æŠŠsqlçš„ä¼˜åŒ–å…³é—­ã€‚ä¸ç„¶è®¡æ•°çš„æ—¶å€™åªä¼šæŸ¥ä¸»è¡¨çš„è®°å½•æ•°page.setOptimizeCountSql(false);  \nè¿™é‡Œåœ¨æºç ä¸­é»˜è®¤æ˜¯å¼€å¯çš„\n\nå¦‚æœä¸å…³é—­å°†ä¼šå¯¼è‡´è®¡ç®—æ€»è®°å½•æ•°æ®çš„æ—¶å€™ï¼Œsql è¯­å¥ä¼šä¸¢å¼ƒåé¢çš„å­æŸ¥è¯¢ï¼Œé€ æˆè®°å½•æ•°ç»“æœä¸æ­£ç¡®ã€‚\n","categories":["bugè®°å½•","2024"],"tags":["BUG","Java","MybatisPlus"]},{"title":"ä½¿ç”¨ git æäº¤æŠ¥é”™ï¼šerror RPC failed; HTTP 413 curl 22 The requested URL returned error 413","url":"/posts/5a672f0a/","content":"\n\nå‰è¨€å‚è€ƒæ–‡ç« ï¼šä½¿ç”¨gitæäº¤æ—¶æŠ¥é”™ï¼šerror: RPC failedï¼› HTTP 413 curl 22 The requested URL returned error: 413 Request Entity\n\n\næ›´æ–°\n\n\n24-07-19 åˆå§‹è®°å½•\n\né—®é¢˜\nä½¿ç”¨ git push æ—¶æŠ¥é”™\nTotal 254 (delta 50), reused 0 (delta 0), pack-reused 0error: RPC failed; HTTP 413 curl 22 The requested URL returned error: 413send-pack: unexpected disconnect while reading sideband packetfatal: the remote end hung up unexpectedly\nåŸå› \n\n413 Request Entity Too Large æœåŠ¡å™¨æ‹’ç»å¤„ç†å½“å‰è¯·æ±‚ï¼Œå› ä¸ºè¯¥è¯·æ±‚æäº¤çš„å®ä½“æ•°æ®å¤§å°è¶…è¿‡äº†æœåŠ¡å™¨æ„¿æ„æˆ–è€…èƒ½å¤Ÿå¤„ç†çš„èŒƒå›´ã€‚æ­¤ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯ä»¥å…³é—­è¿æ¥ä»¥å…å®¢æˆ·ç«¯ç»§ç»­å‘é€æ­¤è¯·æ±‚ã€‚\n\nè§£å†³\n\n\nä¿®æ”¹ä¸Šä¼ çš„æ•°æ®é™åˆ¶å¥½åƒæ²¡ç”¨\n\n\ngit config --global http.postBuffer 52428800\n\n\nä½¿ç”¨ ssh æ–¹å¼ä¸Šä¼ è¿˜æ˜¯ä¸è¡Œ\n\n\nï¼ˆ1ï¼‰æŸ¥çœ‹å½“å‰ git çš„æäº¤åœ°å€\ngit remote -v\nï¼ˆ2ï¼‰æŸ¥çœ‹ ssh ä»“åº“åœ°å€\nï¼ˆ3ï¼‰è®¾ç½®æ›´æ¢è¿œç¨‹ä»“åº“åœ°å€\ngit remote set-url origin å¤åˆ¶è¿‡æ¥çš„sshåœ°å€\nï¼ˆ4ï¼‰å†æ¬¡æäº¤\n\n\nåŸå…ˆåœ¨æäº¤ç›®å½•ä¸‹åŠ äº†ä¸€ä¸ª 1G å¤šçš„ doc ç›®å½•ï¼Œåˆ é™¤äº†è¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯è¿”å›å¦‚ä¸‹æŠ¥é”™ä¿¡æ¯ã€‚\n\n\nremote: This repository(including wiki) size 2.25 GB, exceeds 1024.00 MB.        remote: You only have 3 push opportunities        remote: HelpLink:       https://gitee.com/help/articles/4232        remote: Repository GC:  https://gitee.com/kiml_rgb/shanjupay/settings#git-gcerror: File: 1e079cdcb1b8f36ed4bb8a17a78df5582ca9db14 2.24 GB, exceeds 100.00 MB.    \nï¼ˆ1ï¼‰æŒ‰ç…§æç¤ºæ‰§è¡Œå‘½ä»¤æŸ¥çœ‹è¶…å¤§çš„æ–‡ä»¶\ngit rev-list --objects --all | grep 1e079cdcb1b8f36ed4bb8a17a78df5582ca9db14\nï¼ˆ2ï¼‰æ‰§è¡Œå‘½ä»¤å¿½ç•¥æ‰è¶…å¤§çš„æ–‡ä»¶\ngit rm --cached file_name#å¦‚æœæ˜¯æ–‡ä»¶å¤¹git rm -r --cached directory_name\nï¼ˆ3ï¼‰åœ¨ commit çš„æäº¤å†å²é‡Œé¢å»é™¤è¿™ä¸ªè¶…å¤§æ–‡ä»¶ï¼ˆæ³¨æ„è¿™é‡Œè¦å¡«å†™æ­¥éª¤ 1 æŸ¥è¯¢å‡ºçš„æ–‡ä»¶å…¨ç§°ï¼ŒåŒ…æ‹¬æ–‡ä»¶è·¯å¾„ï¼‰\ngit filter-branch --tree-filter &#x27;rm -f æ–‡ä»¶å&#x27; HEAD\nï¼ˆ4ï¼‰å¦‚æœæŠ¥é”™ï¼š\nWARNING: git-filter-branch has a glut of gotchas generating mangled history         rewrites.  Hit Ctrl-C before proceeding to abort, then use an         alternative filtering tool such as &#x27;git filter-repo&#x27;         (https://github.com/newren/git-filter-repo/) instead.  See the         filter-branch manual page for more details; to squelch this warning,         set FILTER_BRANCH_SQUELCH_WARNING=1.\næ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç„¶åé‡æ–°æ‰§è¡Œç§»é™¤å‘½ä»¤ï¼š\ngit stash\nå‡ºç° â€¦ was rewritten è®°å½•è¯´æ˜æ‰§è¡ŒæˆåŠŸã€‚å†æ¬¡ä½¿ç”¨ git push æˆåŠŸã€‚\n","categories":["bugè®°å½•","2024"],"tags":["Git","BUG"]},{"title":"ä½¿ç”¨mapstructè½¬æ¢å¯¹è±¡ï¼ŒæŠ¥é”™Cannot find implementation forâ€¦â€¦","url":"/posts/82c00b85/","content":"\n\nå‰è¨€å‚è€ƒæ–‡ç« ï¼šmapstruct æŠ¥é”™ java.lang.ClassNotFoundException: Cannot find implementation for\n\n\næ›´æ–°\n\n\n24.06.05 åˆå§‹è®°å½•\n\né—®é¢˜\nä½¿ç”¨ mapstruct è½¬æ¢å¯¹è±¡ï¼Œæ¥å£å¯ä»¥å¯åŠ¨ï¼Œä½†æ˜¯æ‰§è¡ŒæŠ¥é”™ï¼š\njava.lang.ClassNotFoundException: Cannot find implementation for com.â€¦â€¦.convert.AuthorizationPrivilegeConvert\nåŸå› \næ³¨è§£æ²¡æœ‰å¼•ç”¨å…¨ã€‚\nè§£å†³\næ·»åŠ ä¾èµ–ï¼Œé‡å¯æœåŠ¡ã€‚\n&lt;dependency&gt;   &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;   &lt;artifactId&gt;mapstruct-jdk8&lt;/artifactId&gt;   &lt;version&gt;â€¦â€¦&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;    &lt;artifactId&gt;mapstruct-processor&lt;/artifactId&gt;    &lt;version&gt;â€¦â€¦&lt;/version&gt;&lt;/dependency&gt;\n","categories":["bugè®°å½•","2024"],"tags":["BUG","Java"]},{"title":"è·¨åŸŸäº§ç”Ÿçš„åŸå› åŠè§£å†³æ–¹æ¡ˆ","url":"/posts/f5b0876a/","content":"\n\nå‰è¨€\né¢è¯•å¿…ä¼šï¼Œæ€»ç»“ä¸€ä¸‹\n\n\næ›´æ–°\n\n\n24-08-22 åˆå§‹è®°å½•\n\nè·¨åŸŸçš„åŸå› \nè·¨åŸŸæ˜¯æ˜¯å› ä¸ºæµè§ˆå™¨çš„åŒæºç­–ç•¥é™åˆ¶ï¼Œæ˜¯æµè§ˆå™¨çš„ä¸€ç§å®‰å…¨æœºåˆ¶ï¼ŒæœåŠ¡ç«¯ä¹‹é—´æ˜¯ä¸å­˜åœ¨è·¨åŸŸçš„ã€‚\næ‰€è°“åŒæºæŒ‡çš„æ˜¯ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„åè®®ã€ä¸»æœºå’Œç«¯å£ï¼Œä¸‰è€…æœ‰ä»»ä¸€ä¸ç›¸åŒå³ä¼šäº§ç”Ÿè·¨åŸŸã€‚\nè·¨åŸŸä¸¾ä¾‹\n\n\n\nå½“å‰é¡µé¢ url\nè¢«è¯·æ±‚é¡µé¢ url\næ˜¯å¦è·¨åŸŸ\nåŸå› \n\n\n\n\nhttp://www.test.com/\nhttp://www.test.com/index.html\nå¦\nåŒæºï¼ˆåè®®ã€åŸŸåã€ç«¯å£å·ç›¸åŒï¼‰\n\n\nhttp://www.test.com/\nhttps://www.test.com/index.html\nè·¨åŸŸ\nåè®®ä¸åŒ\n\n\nhttp://www.test.com/\nhttp://www.baidu.com/\nè·¨åŸŸ\nä¸»åŸŸåä¸åŒ\n\n\nhttp://www.test.com/\nhttp://blog.test.com/\nè·¨åŸŸ\nå­åŸŸåä¸åŒ\n\n\nhttp://www.test.com:8080/\nhttp://www.test.com:7071/\nè·¨åŸŸ\nç«¯å£å·ä¸åŒ\n\n\n\nè·¨åŸŸçš„è§£å†³åŠæ³•\nä»¥ä¸‹è·¨åŸŸè§£å†³æ–¹å¼é€‰æ‹©ä¸€ç§ï¼Œé‡å¤é…ç½®ä¸ä¼šç”Ÿæ•ˆã€‚\nJava é…ç½®\n\n\n\nä½¿ç”¨ @CrossOrigin æ³¨è§£å®ç°è·¨åŸŸã€å±€åŸŸç±»è·¨åŸŸã€‘ï¼ˆä¸€èˆ¬ä¸ç”¨ï¼Œæ²¡æœ‰è®°å½•ï¼‰\n\n\né€šè¿‡é…ç½®æ–‡ä»¶å®ç°è·¨åŸŸã€å…¨å±€è·¨åŸŸã€‘\n\n\né€šè¿‡ CorsFilter å¯¹è±¡å®ç°è·¨åŸŸã€å…¨å±€è·¨åŸŸã€‘\n\n\né€šè¿‡ Response å¯¹è±¡å®ç°è·¨åŸŸã€å±€åŸŸæ–¹æ³•è·¨åŸŸã€‘ï¼ˆä¸€èˆ¬ä¸ç”¨ï¼Œæ²¡æœ‰è®°å½•ï¼‰\n\n\né€šè¿‡å®ç° ResponseBodyAdvice å®ç°è·¨åŸŸã€å…¨å±€è·¨åŸŸã€‘ï¼ˆä¸€èˆ¬ä¸ç”¨ï¼Œæ²¡æœ‰è®°å½•ï¼‰\n\n\n\n\n\né€šè¿‡é…ç½®æ–‡ä»¶å®ç°è·¨åŸŸï¼ˆé‡å†™ WebMvcConfigurerï¼‰\n\n\n@Configurationpublic class CorsConfig implements WebMvcConfigurer &#123;     @Override    public void addCorsMappings(CorsRegistry registry) &#123;        registry.addMapping(&quot;/**&quot;)                .allowedOrigins(&quot;*&quot;)                .allowedHeaders(&quot;*&quot;)                .allowCredentials(true)                .allowedMethods(&quot;GET&quot;, &quot;POST&quot;, &quot;OPTIONS&quot;, &quot;DELETE&quot;, &quot;PUT&quot;, &quot;PATCH&quot;)                .maxAge(3600);    &#125;&#125;\n\n\nè¿”å›æ–°çš„ CorsFilterï¼ˆè·¨åŸŸé…ç½®ï¼‰\n\n\n@Configurationpublic class GlobalCorsConfig &#123;     @Bean    public CorsFilter corsFilter() &#123;        //1. æ·»åŠ  CORSé…ç½®ä¿¡æ¯        CorsConfiguration config = new CorsConfiguration();        // æ”¾è¡Œå“ªäº›åŸå§‹åŸŸ        config.addAllowedOrigin(&quot;*&quot;);        // æ˜¯å¦å‘é€ Cookie        config.setAllowCredentials(true);        // æ”¾è¡Œå“ªäº›è¯·æ±‚æ–¹å¼        config.addAllowedMethod(&quot;*&quot;);        // æ”¾è¡Œå“ªäº›åŸå§‹è¯·æ±‚å¤´éƒ¨ä¿¡æ¯        config.addAllowedHeader(&quot;*&quot;);        // æš´éœ²å“ªäº›å¤´éƒ¨ä¿¡æ¯        config.addExposedHeader(&quot;*&quot;);        //2. æ·»åŠ æ˜ å°„è·¯å¾„        UrlBasedCorsConfigurationSource corsConfigurationSource = new UrlBasedCorsConfigurationSource();        corsConfigurationSource.registerCorsConfiguration(&quot;/**&quot;,config);        //3. è¿”å›æ–°çš„CorsFilter        return new CorsFilter(corsConfigurationSource);    &#125;&#125;\nNginx é…ç½®\nserver &#123;    listen       80;    server_name  your_domain.com;    location /api &#123;        # å…è®¸è·¨åŸŸè¯·æ±‚çš„åŸŸåï¼Œ* è¡¨ç¤ºå…è®¸æ‰€æœ‰åŸŸåè®¿é—®        add_header &#x27;Access-Control-Allow-Origin&#x27; &#x27;*&#x27;;        # å…è®¸è·¨åŸŸè¯·æ±‚çš„æ–¹æ³•        add_header &#x27;Access-Control-Allow-Methods&#x27; &#x27;GET, POST, OPTIONS&#x27;;        # å…è®¸è·¨åŸŸè¯·æ±‚çš„è‡ªå®šä¹‰ Header        add_header &#x27;Access-Control-Allow-Headers&#x27; &#x27;Origin, X-Requested-With, Content-Type, Accept&#x27;;        # å…è®¸è·¨åŸŸè¯·æ±‚çš„ Credential        add_header &#x27;Access-Control-Allow-Credentials&#x27; &#x27;true&#x27;;        # é¢„æ£€è¯·æ±‚çš„å­˜æ´»æ—¶é—´ï¼Œå³ Options è¯·æ±‚çš„å“åº”ç¼“å­˜æ—¶é—´        add_header &#x27;Access-Control-Max-Age&#x27; 3600;        # å¤„ç†é¢„æ£€è¯·æ±‚        if ($request_method = &#x27;OPTIONS&#x27;) &#123;            return 204;        &#125;    &#125;    # å…¶ä»–é…ç½®...&#125;\nGateway ç½‘å…³é…ç½®\n\n\n\né€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®è·¨åŸŸå®ç°ã€‚\n\n\né€šè¿‡åœ¨æ¡†æ¶ä¸­æ·»åŠ  CorsWebFilter æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚\n\n\n\n\n\né€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®è·¨åŸŸå®ç°ã€‚\n\n\nspring:  cloud:\tgateway:  \t  globalcors:  \t    cors-configurations:  \t      &#x27;[/**]&#x27;: # åŒ¹é…æ‰€æœ‰è¯·æ±‚  \t        allowedHeaders: &quot;*&quot;  \t        allowedOrigins: &quot;*&quot; #è·¨åŸŸå¤„ç† å…è®¸æ‰€æœ‰çš„åŸŸ  \t        allowedMethods: # æ”¯æŒçš„æ–¹æ³•  \t          - GET  \t          - POST  \t          - PUT  \t          - DELETE  \t          - OPTIONS\n\n\né€šè¿‡åœ¨æ¡†æ¶ä¸­æ·»åŠ  CorsWebFilter æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚\n\n\n// åœ¨ Spring-Framework ä» 5.3 ç‰ˆæœ¬ä¹‹å‰ï¼Œä½¿ç”¨ä»¥ä¸‹ä»£ç å¯ä»¥è®© Spring Cloud Gateway ç½‘å…³å…è®¸è·¨åŸŸï¼š@Configurationpublic class GlobalCorsConfig &#123;    @Bean    public CorsWebFilter corsWebFilter() &#123;        CorsConfiguration config = new CorsConfiguration();        // è¿™é‡Œä»…ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œé…ç½®ä¸ºæ”¾è¡Œæ‰€æœ‰åŸŸåï¼Œç”Ÿäº§ç¯å¢ƒè¯·å¯¹æ­¤è¿›è¡Œä¿®æ”¹        config.addAllowedOrigin(&quot;*&quot;);        // æ”¾è¡Œçš„è¯·æ±‚å¤´        config.addAllowedHeader(&quot;*&quot;);        // æ”¾è¡Œçš„è¯·æ±‚ç±»å‹ï¼Œæœ‰ GET, POST, PUT, DELETE, OPTIONS        config.addAllowedMethod(&quot;*&quot;);         // æš´éœ²å¤´éƒ¨ä¿¡æ¯        config.addExposedHeader(&quot;*&quot;);         // æ˜¯å¦å…è®¸å‘é€ Cookie        config.setAllowCredentials(true);         UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();        source.registerCorsConfiguration(&quot;/**&quot;, config);        return new CorsWebFilter(source);    &#125;&#125;// è€Œ Spring-Framework 5.3 ç‰ˆæœ¬ä¹‹åï¼Œå…³äº CORS è·¨åŸŸé…ç½®ç±» CorsConfiguration ä¸­å°† addAllowedOrigin æ–¹æ³•åä¿®æ”¹ä¸º addAllowedOriginPatternï¼Œå› æ­¤é…ç½®äº†å˜æˆäº†ä»¥ä¸‹è¿™æ ·ï¼š@Configurationpublic class GlobalCorsConfig &#123;    @Bean    public CorsWebFilter corsWebFilter() &#123;        CorsConfiguration config = new CorsConfiguration();        // è¿™é‡Œä»…ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œé…ç½®ä¸ºæ”¾è¡Œæ‰€æœ‰åŸŸåï¼Œç”Ÿäº§ç¯å¢ƒè¯·å¯¹æ­¤è¿›è¡Œä¿®æ”¹        config.addAllowedOriginPattern(&quot;*&quot;);        // æ”¾è¡Œçš„è¯·æ±‚å¤´        config.addAllowedHeader(&quot;*&quot;);        // æ”¾è¡Œçš„è¯·æ±‚ç±»å‹ï¼Œæœ‰ GET, POST, PUT, DELETE, OPTIONS        config.addAllowedMethod(&quot;*&quot;);         // æš´éœ²å¤´éƒ¨ä¿¡æ¯        config.addExposedHeader(&quot;*&quot;);         // æ˜¯å¦å…è®¸å‘é€ Cookie        config.setAllowCredentials(true);         UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();        source.registerCorsConfiguration(&quot;/**&quot;, config);        return new CorsWebFilter(source);    &#125;&#125;\n","categories":["bugè®°å½•","2024"]},{"title":"Freemarker åŸºç¡€","url":"/posts/e9ae925d/","content":"\n\nå‰è¨€\nJava å¼€å‘çš„æ¨¡æ¿å¼•æ“ã€‚å®˜ç½‘æ¨¡æ¿ï¼šTemplate + data-model = output - Apache FreeMarker Manual\n\n\næ›´æ–°\n\n\n24-07-23 åˆå§‹è®°å½•24-07-26 bugè®°å½•\n\nå¿«é€Ÿå…¥é—¨\nfreemarker ä½œä¸º Spring MVC ä¸€ç§è§†å›¾æ ¼å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ SpringMVC æ”¯æŒ freemarker è§†å›¾æ ¼å¼ã€‚\nMaven ä¾èµ–\n&lt;!--çˆ¶å·¥ç¨‹æŒ‡å®šSpringBootç‰ˆæœ¬--&gt;&lt;parent&gt;      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;      &lt;artifactId&gt;springâ€bootâ€starterâ€parent&lt;/artifactId&gt;      &lt;version&gt;2.1.3.RELEASE&lt;/version&gt;  &lt;/parent&gt;&lt;!--freemarkerä¾èµ–--&gt;&lt;dependency&gt;      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;      &lt;artifactId&gt;springâ€bootâ€starterâ€freemarker&lt;/artifactId&gt;  &lt;/dependency&gt;\né…ç½®æ–‡ä»¶\n# freemarkeråŸºæœ¬é…ç½®spring:  freemarker:    charset: utf-8    requestâ€contextâ€attribute: rc    contentâ€type: text/html    suffix: .html    enabled: trueresources:  addâ€mappings: false #å…³é—­å·¥ç¨‹ä¸­é»˜è®¤çš„èµ„æºå¤„ç†mvc:  throwâ€exceptionâ€ifâ€noâ€handlerâ€found: true #å‡ºç°é”™è¯¯æ—¶ç›´æ¥æŠ›å‡ºå¼‚å¸¸\nä»£ç ä½¿ç”¨\n\n\næ·»åŠ  view æ˜ å°„\n\n\n@Component  public class WebMvcConfig implements WebMvcConfigurer &#123;      @Override      public void addViewControllers(ViewControllerRegistry registry) &#123;  \t    // æ³¨æ„è¿™é‡Œä¸è¦æ·»åŠ åç¼€        registry.addViewController(&quot;/pay-page&quot;).setViewName(&quot;pay&quot;);          registry.addViewController(&quot;/pay-error&quot;).setViewName(&quot;pay_error&quot;);       &#125;  &#125;\n\n\nè¿”å› Controller æ³¨è§£ä¸è¦åŠ  @ResponseBody æˆ– @RestControllerï¼ˆè¿™ä¸ªæ³¨è§£æŠŠè¿”å›çš„ä¿¡æ¯è½¬æˆ json è¿”å›ï¼Œä¸èƒ½å®ç°é¡µé¢è·³è½¬çš„åŠŸèƒ½ï¼‰\n\n\nè¿”å›ä½¿ç”¨ forward:\n\n\nreturn &quot;forward:/pay-error&quot;;\nåŸºç¡€æŒ‡ä»¤\n\n1ã€æ³¨é‡Šï¼Œå³ &lt;#â€â€å’Œâ€â€&gt;ï¼Œä»‹äºå…¶ä¹‹é—´çš„å†…å®¹ä¼šè¢« freemarker å¿½ç•¥\n2ã€æ’å€¼ï¼ˆInterpolationï¼‰ï¼šå³ $&#123;..&#125; éƒ¨åˆ†ï¼Œfreemarker ä¼šç”¨çœŸå®çš„å€¼ä»£æ›¿ $&#123;..&#125; \n3ã€FTL æŒ‡ä»¤ï¼šå’Œ HTML æ ‡è®°ç±»ä¼¼ï¼Œåå­—å‰åŠ  # äºˆä»¥åŒºåˆ†ï¼ŒFreemarker ä¼šè§£ææ ‡ç­¾ä¸­çš„è¡¨è¾¾å¼æˆ–é€»è¾‘ã€‚\n4ã€æ–‡æœ¬ï¼Œä»…æ–‡æœ¬ä¿¡æ¯ï¼Œè¿™äº›ä¸æ˜¯ freemarker çš„æ³¨é‡Šã€æ’å€¼ã€FTL æŒ‡ä»¤çš„å†…å®¹ä¼šè¢« freemarker å¿½ç•¥è§£æï¼Œç›´æ¥è¾“å‡ºå†…å®¹ã€‚\n\nList æŒ‡ä»¤\n\nè¯´æ˜ï¼š _indexï¼šå¾—åˆ°å¾ªç¯çš„ä¸‹æ ‡ï¼Œä½¿ç”¨æ–¹æ³•æ˜¯åœ¨ stu åè¾¹åŠ  _indexï¼Œå®ƒçš„å€¼æ˜¯ä» 0 å¼€å§‹\n\nList&lt;Student&gt; stus = new ArrayList&lt;&gt;();\n&lt;table&gt;  &lt;tr&gt;    &lt;td&gt;åºå·&lt;/td&gt;\t&lt;td&gt;å§“å&lt;/td&gt;\t&lt;td&gt;å¹´é¾„&lt;/td&gt;\t&lt;td&gt;é’±åŒ…&lt;/td&gt;  &lt;/tr&gt;  &lt;#list stus as stu&gt;    &lt;tr&gt;\t  &lt;td&gt;$&#123;stu_index + 1&#125;&lt;/td&gt;\t  &lt;td&gt;$&#123;stu.name&#125;&lt;/td&gt;\t  &lt;td&gt;$&#123;stu.age&#125;&lt;/td&gt;\t  &lt;td&gt;$&#123;stu.mondy&#125;&lt;/td&gt;\t&lt;/tr&gt;  &lt;/#list&gt;&lt;/table&gt;\nMap æŒ‡ä»¤\nHashMap&lt;String,Student&gt; stuMap = new HashMap&lt;&gt;();\nè¾“å‡ºstu1çš„å­¦ç”Ÿä¿¡æ¯ï¼š&lt;br/&gt;å§“åï¼š$&#123;stuMap[&#x27;stu1&#x27;].name&#125;&lt;br/&gt;å¹´é¾„ï¼š$&#123;stuMap[&#x27;stu1&#x27;].age&#125;&lt;br/&gt;è¾“å‡ºstu1çš„å­¦ç”Ÿä¿¡æ¯ï¼š&lt;br/&gt;å§“åï¼š$&#123;stuMap.stu1.name&#125;&lt;br/&gt;å¹´é¾„ï¼š$&#123;stuMap.stu1.age&#125;&lt;br/&gt;éå†è¾“å‡ºä¸¤ä¸ªå­¦ç”Ÿä¿¡æ¯ï¼š&lt;br/&gt;&lt;table&gt;  &lt;tr&gt;    &lt;td&gt;åºå·&lt;/td&gt;    &lt;td&gt;å§“å&lt;/td&gt;    &lt;td&gt;å¹´é¾„&lt;/td&gt;    &lt;td&gt;é’±åŒ…&lt;/td&gt;  &lt;/tr&gt;  &lt;#list stuMap?keys as k&gt;    &lt;tr&gt;  \t  &lt;td&gt;$&#123;k_index + 1&#125;&lt;/td&gt;  \t  &lt;td&gt;$&#123;stuMap[k].name&#125;&lt;/td&gt;  \t  &lt;td&gt;$&#123;stuMap[k].age&#125;&lt;/td&gt;  \t  &lt;td&gt;$&#123;stuMap[k].mondy&#125;&lt;/td&gt;    &lt;/tr&gt;  &lt;/#list&gt;&lt;/table&gt;\nif æŒ‡ä»¤\n&lt;table&gt;  &lt;tr&gt;    &lt;td&gt;å§“å&lt;/td&gt;    &lt;td&gt;å¹´é¾„&lt;/td&gt;    &lt;td&gt;é’±åŒ…&lt;/td&gt;  &lt;/tr&gt;  &lt;#list stus as stu&gt;    &lt;tr&gt;      &lt;td &lt;#if stu.name ==&#x27;å°æ˜&#x27;&gt;style=&quot;background:red;&quot;&lt;/#if&gt;&gt;$&#123;stu.name&#125;&lt;/td&gt;      &lt;td&gt;$&#123;stu.age&#125;&lt;/td&gt;      &lt;td&gt;$&#123;stu.mondy&#125;&lt;/td&gt;    &lt;/tr&gt;  &lt;/#list&gt;&lt;/table&gt;\nè¿ç®—ç¬¦\n\n\nç®—æ•°è¿ç®—ç¬¦ FreeMarker è¡¨è¾¾å¼ä¸­å®Œå…¨æ”¯æŒç®—æœ¯è¿ç®—ï¼ŒFreeMarker æ”¯æŒçš„ç®—æœ¯è¿ç®—ç¬¦åŒ…æ‹¬:+, - , * , / , %\n\n\né€»è¾‘ è¿ç®—ç¬¦ é€»è¾‘è¿ç®—ç¬¦æœ‰å¦‚ä¸‹å‡ ä¸ª: é€»è¾‘ä¸ &amp;&amp; é€»è¾‘æˆ– || é€»è¾‘é ! é€»è¾‘è¿ç®—ç¬¦åªèƒ½ä½œç”¨äºå¸ƒå°”å€¼ï¼Œå¦åˆ™å°†äº§ç”Ÿé”™è¯¯\n\n\næ¯”è¾ƒè¿ç®—ç¬¦ è¡¨è¾¾å¼ä¸­æ”¯æŒçš„æ¯”è¾ƒè¿ç®—ç¬¦æœ‰å¦‚ä¸‹å‡ ä¸ª:\n\n= æˆ–è€… == åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰\n!= åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ä¸ç­‰\n&gt; æˆ–è€… gt åˆ¤æ–­å·¦è¾¹å€¼æ˜¯å¦å¤§äºå³è¾¹å€¼\n&gt;= æˆ–è€… gte åˆ¤æ–­å·¦è¾¹å€¼æ˜¯å¦å¤§äºç­‰äºå³è¾¹å€¼\n&lt; æˆ–è€… lt åˆ¤æ–­å·¦è¾¹å€¼æ˜¯å¦å°äºå³è¾¹å€¼\n&lt;= æˆ–è€… lte åˆ¤æ–­å·¦è¾¹å€¼æ˜¯å¦å°äºç­‰äºå³è¾¹å€¼\n\n\n\n\næ³¨æ„ï¼š= å’Œ != å¯ä»¥ç”¨äºå­—ç¬¦ä¸²ï¼Œæ•°å€¼å’Œæ—¥æœŸæ¥æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ï¼Œä½† = å’Œ != ä¸¤è¾¹å¿…é¡»æ˜¯ç›¸åŒç±»å‹çš„å€¼ï¼Œå¦åˆ™ä¼šäº§ç”Ÿé”™è¯¯ï¼Œè€Œä¸” FreeMarker æ˜¯ç²¾ç¡®æ¯”è¾ƒï¼Œâ€œxâ€,&quot;x &quot;,â€œXâ€ æ˜¯ä¸ç­‰çš„ã€‚å…¶å®ƒçš„è¿è¡Œç¬¦å¯ä»¥ä½œç”¨äºæ•°å­—å’Œæ—¥æœŸï¼Œä½†ä¸èƒ½ä½œç”¨äºå­—ç¬¦ä¸²ï¼Œå¤§éƒ¨åˆ†çš„æ—¶å€™,ä½¿ç”¨ gt ç­‰å­—æ¯è¿ç®—ç¬¦ä»£æ›¿ &gt; ä¼šæœ‰æ›´å¥½çš„æ•ˆæœ,å› ä¸º FreeMarker ä¼šæŠŠ &gt; è§£é‡Šæˆ FTL æ ‡ç­¾çš„ç»“æŸå­—ç¬¦,å½“ç„¶,ä¹Ÿå¯ä»¥ä½¿ç”¨æ‹¬å·æ¥é¿å…è¿™ç§æƒ…å†µï¼Œå¦‚ï¼š&lt;#if (x&gt;y)&gt;\n\nç©ºå€¼å¤„ç†\n\n\nåˆ¤æ–­æŸå˜é‡æ˜¯å¦å­˜åœ¨ä½¿ç”¨ ?? ç”¨æ³•ä¸ºï¼švariable??ï¼Œå¦‚æœè¯¥å˜é‡å­˜åœ¨ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› false\n\n\n&lt;#if stus??&gt;&lt;#list stus as stu&gt;...\n\n\nç¼ºå¤±å˜é‡é»˜è®¤å€¼ä½¿ç”¨ ! ä½¿ç”¨ ! è¦ä»¥æŒ‡å®šä¸€ä¸ªé»˜è®¤å€¼ï¼Œå½“å˜é‡ä¸ºç©ºæ—¶æ˜¾ç¤ºé»˜è®¤å€¼ã€‚\n\n\n&lt;#--å¦‚æœnameä¸ºç©ºæ˜¾ç¤ºç©ºå­—ç¬¦ä¸²ã€‚--&gt;$&#123;name!&#x27;&#x27;&#125;&lt;#--å¦‚æœstuæˆ–bestFriendæˆ–nameä¸ºç©ºé»˜è®¤æ˜¾ç¤ºç©ºå­—ç¬¦ä¸²ã€‚--&gt;$&#123;(stu.bestFriend.name)!&#x27;&#x27;&#125;\nå†…ç½®å¯¹è±¡\nåœ¨ freemarker ä¸­å¯ä»¥è®¿é—® Requestã€Session ç­‰å†…ç½®å¯¹è±¡ã€‚\nRequestï¼š ç”¨äºè·å– Request å¯¹è±¡ä¸­çš„ attribute å¯¹è±¡ã€‚\nSessionï¼šç”¨äºè·å– Session å¯¹è±¡ä¸­çš„ attribute å¯¹è±¡ã€‚\nRequestParametersï¼šç”¨äºè·å– Request å¯¹è±¡çš„ parameter å‚æ•°ï¼ˆæµè§ˆå™¨ç«¯å‘é€çš„è¯·æ±‚æ•°æ®ï¼‰\n\n\né…ç½®\n\n\nspring:   freemarker:     requestâ€contextâ€attribute: rc #æŠŠSpringçš„RequestContextå¯¹è±¡æš´éœ²ä¸ºå˜é‡rc     exposeâ€requestâ€attributes: true     exposeâ€sessionâ€attributes: true\n\n\nä¾‹å­åœ¨ Controller ä¸­è®¾ç½® requestã€session çš„å±æ€§å€¼\n\n\n//æµ‹è¯•å†…ç½®å¯¹è±¡ request.setAttribute(&quot;attr1&quot;,&quot;test&quot;); HttpSession session = request.getSession(); session.setAttribute(&quot;session1&quot;, &quot;user1&quot;);\né¡µé¢è·å–æ•°æ®\nurlè¯·æ±‚å‚æ•°ï¼š$&#123;RequestParameters[&#x27;param1&#x27;]!&quot;&quot;&#125; request Attribute:$&#123;Request[&quot;attr1&quot;]!&quot;&quot;&#125; session Attribute:$&#123;Session[&quot;session1&quot;]!&quot;&quot;&#125; å·¥ç¨‹è·¯å¾„ï¼š$&#123;rc.contextPath&#125; è¯·æ±‚åœ°å€: $&#123;rc.requestUri&#125;\nBUG\nè®¿é—®æŠ¥é”™ 404\n\n\næ£€æŸ¥æ˜¯å¦æ·»åŠ äº† view æ˜ å°„ï¼Œæ³¨æ„ä¸è¦åŠ åç¼€ã€‚\n\n\næ£€æŸ¥ Controller å±‚ä½¿ç”¨çš„æ³¨è§£ï¼šä¸è¦åŠ  @ResponseBody æˆ– @RestControllerï¼ˆè¿™ä¸ªæ³¨è§£æŠŠè¿”å›çš„ä¿¡æ¯è½¬æˆ json è¿”å›ï¼Œä¸èƒ½å®ç°é¡µé¢è·³è½¬çš„åŠŸèƒ½ï¼‰\n\n\nnacos é…ç½®æ–‡ä»¶è¯»å–å¤±è´¥ï¼ˆä¸ç¡®å®šåŸå› é‡å¯ nacos åå°±å¥½äº†ï¼‰ï¼šä½¿ç”¨ nacos è¯»å–é…ç½®æ–‡ä»¶ï¼Œå‡ºç°è‡ªåŠ¨è£…é…æ—¶ suffix æ²¡æœ‰è¯»å–åˆ°çš„æƒ…å†µã€‚ï¼ˆæœ¬åœ°é…ç½®ä½¿ç”¨.html å¯ä»¥è¯»å–æˆåŠŸï¼Œä½†æ˜¯æ”¾åˆ° nacos åï¼ŒFreeMarkerProperties ä¸­çš„ suffix å±æ€§å§‹ç»ˆä¸ºé»˜è®¤çš„ .ftlï¼Œå¹¶ä¸”ä»springboot2.0å¼€å§‹é»˜è®¤çš„ suffix ä¸º .ftlhï¼‰\n\nä½†æ˜¯è¿™é‡Œè¿˜æ˜¯å»ºè®®ä½¿ç”¨ .ftlï¼Œä¸ç„¶ååºæ¥å£è°ƒç”¨å¤„å¯èƒ½ä¼šå‡º bug\n\n\n\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["Java","Freemarker"]},{"title":"Jenkins + k8s å®ç° CICDï¼ˆæŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²ï¼‰","url":"/posts/60f8da4b/","content":"\n  972a4ea99218889cef049d656e4bf4b2b3f032f944a5ceeb3ea8aead21368f745f71bc99025aa2e705d9ccd09d86707ac6e343b6bce3cbb001b83a7cf7cfb1079c3dceccc68c9c8c4cf2e2ad3c3a69a8c892c0a95bfc866c10ae4092d65c4914688402a31e1b797be6ea0d67ef80d47a5552a85635be0dd01893a6ef43339426901a8c802280a33371f100ddf7f8ccedba9ee463f4b49d3bac6ae22dd6bb22274ecaab942d64a18d7ca45e2259763be82abb2d9f312a6a722f0cdd4cc1c9c5467d6f65f3375df6d9e88d972ef413a9ee9d0448446f852f37e60354ec4f6092774924fd0dfad472fdbf34e3c16627a6829db3ab5f0e6d5b6029dbc3f0def87dc052795e08bff2401ab407ae991ab1fc05b4ebe0231ba27fb294a5e4fad8cda77ab6bf46870fd0de75d6bac8e26fc72e854a8d6875148eb92446048079e9f14d182be00c10b69b14beb08ae5403e566adaf2bdc57e1495cbf0f543ea806198796212a29ed0d0a856ed3d450d18db26e813b8af2e74477cf20d757375780537286de39b5c8c9037e58680397d9801e423f2ce98546c6c8948460b434d52c1d47801e45c8598b2ce8098cae070906362eae48bf6aa1b3360bff34ea3a227db5c282ffa9204df03df591de6e0eec6357034da890ad6954ce4f2dacdc2a0a38a7d8aa86e2ceec1cc6af87e19108c38982d5e841a2d513e49a58d7645bc84decb40e66ddc5193e727aa2d6e3fc5e8a6898dca80231aaf3a667e0c9e3fe1698f9dfdab90ab52438e0df1967b58f42fc8e55c62f52d38bb926324d395efcae777ea24c07ec781754a31432850553bbc339465c00272a9f1c94e62f1c794ecbaa32aaee041b5303e7301a27cd8fd6fa343a6c761ce020c328aa769fb52d14b3dc85bde78862ea09abd90854cc4a5cc7b275f4df083f98642fbbd4c9f9eba0bd66cbec9ca28e17c4f3b88d084e078f8d9e4e93614158f8dbe8ff5be1f6d2a8654f0c860046a4d26638715be06c87e9fa69ba4e1ddc07e2b0ed8d84cd68b4cef489be6b875a97026f949e0a2eb4b8faa69a3d60babb7c8a1593373c5564d0a34988ae11b33543d6718b613734f69d3a4acec1f399dd0965702e3d40b52bb572f0a0fa892c3decb6540466ac069276b01183069e572ba89dd7370278fe1affc7ed94dea9b33de0e46f2bc8d6813c6b298efe261c95b785be9791258360004ccd83fb18d545b4403b25993ede6bbfef47cec267d6fb76e3aca5ee8f459f12a8cd28bded8722ce56def08543510eb3d18f38abd7da0b02bf757a0f400fa5cbf3973997553510e2105dd27ca04760323c0484d407d1e632256b6bc18d9f5c88169a78e15cebc63ba86664e0ccfbd688432ecf4e04e9f62d1beac5464865bea62695873205367691378218792bbe1b19dee5efcce799c6f38563e00c4337966db5a467af2d04c08533cedd4f33d0685a1fd3cfee2fe23e23099db1c988e6cbc88331ca47ac560c569b99c933b23e57f9f05c097b1508bb3adfab01148790d9a981a56f955a9bc6b9c83596c17e2f3f1be2c2ed025d63bbebad40b75ba0d1a2a320689235ab7f1a47f2889f509353e8d357e7b1f0384edfbf84c79b1334e2cd7bd51c707275f79bedd01908652206ff1808bf0b422cfccb0997358233f50ef88c50f349bf23351c104972e9a4a6da7d7ba135118a700dc32fa483f0d212d4295ac3ecbf80c625ccee079e75abe7b3059a30b43545daee782dd2df6f151ee23791c6d968384d141bb0183ab52c3f9346d3965746c4fbd2c67a83ea2665a1129cc7694369f87e1e5faea4fcc70fe7e21cca9319b469f221da2a650ea41d6d398657856d114b1faea0ed7612bf74d63b04356229e06dd34f4e2fe61b8fbe5c61fa685e0a1522b9d6ab56e3469feb14bcde24f32f8317dcd2c11a7c738cfbb87e3e50a98a61c6fb4fcc55e2364eec61707598248bdf9702d7407b9db9c1823e0d0155a3f0c9a48fec4c1051e8dbf5a9c9ccafe6c5b05113e4feea986f3a52d573b5447b4a63a557488303e73847fbce0d1676fbd4177e31027e1db3f28bc78c0b0d3423043e20aadf5853597a651bdcbc332ae7b7255f6dfcf267e4354d847c8da261d0a7e7e5a049f8b259d2b8aa3be6502d73d3342b7d57a1e9f3dabe924d01ea7aeff3c98f659bb7178e0f29fc25718914ef32cdff4f1c2d29ebcc36f1c6e238555f21c0c44b4af48a4bb0d28168b0503937e500acf881281e8008b82485dbe906ca401f8edee67cf7f177e959e1661f203579f2ef24996f0b04b373f5d1fca92553c8bc7332d6d976f9371e10482a054578f373967a2be9a6ad925bfbedc9c0193ed6e461b63f0afa2997b947a5bb9fa8b5a0f68c3ad537ae07619b525095a9aa4db1cb4b54213d986c93ae18e0b92b9e24c94a012ec5cdcf7c00ba1fb416bb11d31f847436b886c0d0148679d4d556d7af15b304ff32ed1dfcb5136f9174d04c2425abe11d10f03d62b4ce4ad45b90ff7b04c07199e3a486b52e2117cac6a27d8693268c2675867de5ec86e277ece03c47307456f9599d8955c74d9b4d1a54aefe428a11b927494199698bde1ffbf49f9bf05c4b27d1c79e238aac9d2fa53b61fe4b9c917f2ce9b1e7b493572cea70f9b2f017b33c90e6c9a282cc41ace227e6af5bff0e5e57bd25cd2a474d037e46edc4ee71b3359f7a63322769f0fe2dbea93a9556d46e7053149aab757d83e884ca7ebbca53c5ece0f17df7f001ab0654abb0049e0036818a5150b2b57b2271db12c1109d8dc1c3b5939bafd49ac64a12bbb1e76a46d491ee5490eaad267134d0d9aa573e7ed45a4fa839abe470d0b5abcc42d7668720f4bee69bc532151b60be3bf914887f49fb2f7df56984a002d0346e65a5d591784c0e74fda48c09e1cbed059558bee205b350bff566f65ff0dcce951d1189769914965cd429262fc70f94b8bdd89cd45f7104fcacbc1cad55ee75c7bccfd27c7782f4ea0eaece4d07ffc342db37af691a08d57d9ea933be96f4a4f724f562e3173fe51f2c68aa9372fa55e27bc4d8d01a909ff51a547d2accd9fab68e56889d165895ab2799ef13f9e805f7fe84d4af659ad7a71f2b8d7876a57e8f6574b2694a86fd17901cfe6cc9fd612791c3fc74d0dc1c57532dea80f6d8e75a0048227e487f26eb16a114110b7ffd8d1b94152605d70c3dd39d35f69974a2cc0b297e1d2cfa5d1f81224bfd7ec0b370c1aea738d415773af418f3dee8bf4974335fa3861cccb9d157d21c8b474fa87b640319a3311e9a960d4d133d535447032f8bdf85571b044d08c26c7546f97d3a5e6935a015edc46e3028214fd0f62f74310b622712a271393b5c5343ba793357a6df499309e77f85ed1e2e3ea10ff6a7ec2906e0a69fff6fa82f202aba6f8166dc74b83e9537b6fd437aa71d6a45a7522b09a28b6b7be131a01c77e70cd5ecfa04c42c17661ef2393e5760fbe53d3495d84f6121c02337c3805642bb9367b7b790db577f5b6679bf71e3913cbc8eade69c2564e24b5594d052477953fb6669c364c87c2ec9af21464bc03a2ea11caf85c32c7c1e5f74ebf64293f420eacf8ce639046e779ab20cb32596eea0be6361141baeae8734ce4779fa124afff905874be625e796eed41b3d418db41799ae1d2bd423f8c44b6d7c858b180269b68bac6d78f30735dfa0d9dbf6611f31e747bf7b5c79bc97d5547813c95e642409690ccf102407b992e1523873bb80013b108258226fef72639e3080dcfd0c811f0f4e140cab42095b66c8335e669cdae82e04f9b0b389498f03abaab12bac23cd9b0ab111e9df0aa6ba2f06391fce72709997f33dfb08342ebe88a6b9cf6970be73ab3d3919d74f492831cd81b4e8cc5d641d1d61f1d59a976f8b9de60009829e3fc9bd1c1a0ecba7b56d3ec416be2e704b9de0769d1c8a152a9bf487ec43a7840efbe2a0ba8888bc813027081d2ae6bc6ae349d5763b4758f20222817f6f26701dd4d9960f8f051ae6ec607de819b413de8e5b5358932de7771534a1d18696fe3040c52c5edd08254690c706ddd751f924a9323bb8a6b56bffe113e2b01a7619aa2e079d3d3c31d83e347e56f096bd0686ba1a3d44dec91cad26bb2f9a600e661433e9c77d588e5292b742d39d413e9a217c649d9c9cb1cdd46d491ebf2858af0b75b786240600a50044aeca515adc2862ff0418a139992a22c8856ee67312d66dac287f7104744c23ad3a130404853dc62f0e834acb025cbcce69430f5a8306910a04ec2295b8c74fa96e63e5c1a316c828702b35fa734e70392697ad3cf6b737b5d009d23bf8f871d83d1a5ce5e742b449411497863e3e793a96e2c21702c3b49d4225a78156b71a74188e5949cc896421bf10a5666f80cf5af95e6efcb7b451ffb2eeae6772b36f6bdcaa62e0ae1fd36ad008388c9d3cf604d4fe8f3cd0243c10e7c5cf176ea1378d8ea5f8c108a33c66b09e89d4bfce54554c80930d866f29762aff4725435e4f7819ad2db48f8c1ac0ed1506fa86169ac218f64132f2000a54c411ccfe187e6a4fe2a2fc29565f3effbc2cd6e3735ce611ec82c32d9a4c6ecabebaecf42eb262318085bd12d0684c9c849f8e5f1433a65d123ddb709431a4a93e41a309c16b56b7136d70cb51fd1d4ed18cef7a86cae2594dff6802e44a948fe4826cff3bc19ad50ef1ccb875b25f5c4e7a4b4dee1a8bbacf0dbc13e673d98debd8f8323032cbb8a35e504837c646ac4ef6ad8d7585d4d9db1c9490d1e032a5296a7a29d2c1fc25b76226dc7ab63798df57118340be5c2def7c28f64de4b4848ed8fedc740f42a2873032f2657622a87d48505c442faaa1f65a1430b12a606ad4cfe5f4bfaaa4c6b0816c11893b639bb187a04cfacc1495fb37bc81662adf2a060d932f0684ead4340432075198d0526a9b1cbd522dab4d6b6b8ef550cfc9a52deb188054e9c1f4f5c0d466839b1bf4521d469d9b11b20aad04d569f807bae706366538effe9723493c70964f5f2194c3f1708fc5cd9554ca303c196ffa4648c654559dfe1870baa521ce954931b7b45fc34d8a3a7894a30e9b4cbc1177de5d19f9172606537300041ba71526830524b54abccb1e1e59cf5e2c0de73db9e6d7b93a7ddf93c879177d56c3c37594f0578bd4098e74bf90e8cf0503702baa0f6725d3a19476902aa69161111d80284f7db1a43320094093dfa84437a2c3ffe1e9993195b552b3ebb48edd08d18d5c5b974205f8fcf3fa20d40bd5400f06b0dc014c915b6a79d5ae421fa551145dcc8a701edbac320b8768d45732b2556123a6f9a0346afa344050060c43b99faf320d69130d3b0406e41ee798774b6da0ecbb3947be21553c9ba7f3421d901065e534b91ffaf65ee1179de28e80b847cc24c522a2d34db674de7ba5752d267dfc9eb7155e2888ea51fef8353a15b46c38cf11290b196ecacf42dd8fa687ae5a6368d200534a5f93db51608d0fe7bfe94809c49856e8d0e007ef744ccfcba9ab62779814a595bee78262bfd84560a84e1e93b02d724fe3cad643215c46a1db617a98d0d582ae1343d043e92e7f3114179c1b40a10f2d45870b734de192122157531b0f4ffb44299246350e760d8aea124681c9e5a267e8c28f70f241e5555e0b355e1876191fd50a3023b545790348ea17f7bfc6a3ba9cc591276f237244e42ff0853fa54bdf3e51068e6477aae0202803acd9d8d319a1dfc1862a8bd09c872cb26fe60607677755092e6d24fc7bf03db768b4c43a3617df568980b622ac375e681c1e194304434396b0c50cc793d0d80d530c183a5d08122b904ecffb42ad1d5887efc7c0ece97e851dffaa7ca8d8055aec9190421656fdd2464e9fd6619414cccf93c892e0e8101061ce1a58c0a09426366e6005ffb7722b5f4f750cd16f0d72bb4f0d15102e4ade97ecfd9ce7788521d474f0a94e1a1b82f543e4e3d425450a1db9daa7404edbc7d8f2e4ced1439b1de37c23844dd28c1cf7c7145f5c82e6d98a15a037d724443a375351c1f3d47c73fd7d35950227f369a671c68e270eed820221b4955604b9bac760cd052499d5371928b44646aa8d72405c29b8f5d1afd2f118ee41cf2e4d78864d19f80298ee0deed0c5e2206a126a96d71d163ec7a89192c776822ffdc49ecff56cfdfedc160a99fe6aaaeb1716bd303928ddb9405cabfdce38010657a3958c9e66d12f6630dbb57c7250f0d2588a1b734f06a61c7543b8d46a3d89527948167785975f9e9b22f89571dd4526fab3f19bdfa3f5578594f649fb81de10d3963ceda0216abe865917ab9a13fa44410db2db1356e4ac27d318fb783140199f3cf2c820b4f053313b730d094fa141f93150cb70fa96d050397c6c278233d8139f89b00333752a90cce05eaa67f8f71302239a4a941da942e9435c562058ea30b4b657b756f141e085190ea7d540c9657e386cf1caed24fbe3b81555282da838bb31b19f76f5def5a97d9ef7f2b4cccede67ffd041a73683148501f6a781e1d7d8a72aaaf1f14450e1c6d22091f4ff01056c5badd9a14c8dec3051b44995ad499d1a23a169a2b1c81285749db6b8fce5a1f627882bbd10ffbe238e9751039d4f3cfea5a00feadef06608fca22bf19936118ef3505183b654d5e009b1f2ef77dbe315e4291b0ce0ac70cfc4de08c7198b80033afc5e2217cefa15a01c3e35e9e635e6b002a84dd585e00704f5f6d148e509d7797f736084c5273f673e3cb9d3c13287aeae3827b167352abc628e52f11bfc247fd3bc9e7120eb97cfa1183105c3c617eec3c348ae585917db3c72990a172ecc2b63908519e21f720ac0ca0d6c114c46821054d1e14d2df0c1f9fd270e768e74fd1b5fc838f78e04df83efacef092c926e287b0c511ac474ad086a4d2ae665ccf0db77646caf68783113de36e78443e77124ad7346a80ee4769eddcb7ca10833cec0c449cbadb0e3d1381b4754a61c1ed60e763a9d5ae10fa30aa2452644c4d9154217be52cbf6fba81b6c24a06316d53f2f3c3aa21403cd4f16d1bc5ea2b79c6710c68358b987b89609f78fedc86b60cbd68817ddc7d3010754bdc7ede9967750a653a64e989a4d4ed09ca10434cd24e6aaf8b3da961a3b32d25e65bb0615723cc25eb6ebbc2fd01ec373c021ae9d484b69f44ffdaf1c687edd3100a42e46accbc75bd1a46cc5b09a37fca081529fce5fb143f5e4d81610f978c978a81148f1c03ebd15d8165fbd321c16a48e069387e6bd05fe411fe1848e1eec19834a85e9e9870447e2b079840aa546b4a3590b5ad0e1c665afe2ca61407a351d4073ccbef35dd235f2104a9df9cfea5a5e23ed1ccb76bd9fddeae49327accb2775ce7d40a018b3256585bfea92777c66677325835db60a0e12687a34ccd111c2cf2664d5846a6aa41e25f2a54a133ab981396ab363a219d60b52e034f8e3524118a32d997eceaad78267637fa71efa208d1869a51941676aa476c286c2ccd578b813d634d5dc48bd9cda2e6ead3f9a4ee453aaf7f38e6946d69f05bdb25403ec08adc1188f28bb46511aad1bcdda92cf5a019ed76852dd8e5c891e30c98cb9a907412be076f9f90d4670cb9adab7df49c28650d2399fd12daf957a6f6d940aad967e485212330c4355f4572fb793b9df7a8f5f551976a6d3bd69e915730a7f626dec04cadbc055649033b06ee3675c8e100ee42669ee1c3161527f471e78f9ce59fc60b1ef59bf27a65b296730130404c1e6e150c9330f29a11d49546a65d1c147b7808cd238ae549e7fc0fe77b4f6101f4e5b60526bbefe02461631062dc41ff584d51bf5caf030429d8a81cf729e1ebc88658fb0ddf2fb36fe8773fd8fdcb116b86f2ddc91ee3bffed47bf2ce7529c6c8ea8206e9325973581cc6c4d7d16e758ee8193897679a7ca4aa0b944abe2ead0c271d365a396dc54c3c72a812d3eb32d6c7e2deac172e169a58b16de051f77feab32a3dccf57bce855255b997d7c65f5b65d60b5b9894e1ab5a16244f3a7c1bc909040f7b66b35567a43fc6c29f13bf8da47c3b0820d320593a88de5f277b08040f36b4e5afb8836e2d13dd452f6e7dc7dfcefb7e4b65cdf2bebfb704ef182439fa06439412e92720065744a585a469b19864854fb8cb6d42772f40267483e33c52def23bddce97bac945a3784b5bde6550ed8802836743b45f59b040f67dc023558d9b8029b7bd90c736f6e7df474933d5a0c11037a18511e99abc4ecb3300060b97ce46181c4a88532d15884fa4ee68a9aa61b4bb36bffd55f7617f2036d4210b1a037e89420d71114e66e06cb3f7f1364a888794f96f8bfcb5c70286b8629ceadf566b8ade9e34b5de6c12c23aaae428194ec10b3510d4dc7d0fb060a296b4d90c5dec9e136c2b42ce0e163ec81eb8ad8cf1890f9019d6b92cfde67c252eaa17a58eb46887c8b837f817ac269cfa13be20dcef9c08b72cd661a6cefbfed85e9ee468b75a5118068e4e266228034e83dee1207e221a779fb92b9c24f086770e589c1b882cbb9f536cf476301620f7ead8fd7dd7e83b6e4336341204bb46e10c8aec6182c0539828089e600253540e11861f6768914696b90c0815fe29b4b117522da4802d6c22df2632469e32409a4388afa6c03d534dcf79a80f1cff6543f7a4451be1b403e36693e8d393d03e6ca7ad9d8f5b7219bdaf1b7925367462ed65bcf8121515ca6ddc0f2cf79709b66ccb2973e5abd1d4417e3d587400ba5ab9670c8964d71529133f5f6a450e14169b1a96eb2844ad32cdc779b67bd29dd9874f21a8b7d1a1605153095effad8b17bdb025fafb70133b825810d88a9ea2cf685deac1af9fd0197656caa134fe6c3ecd83592a159f84f841404141cb8026d52d754f37ba72a9d8d21d98275c9a6872ad6618b2e080c2fe564d9f7055bbb9386118425cfd7abd4aab7bf31cbcb311ff2b6ea3ead72191a4338d9811a416f1bdcf4b7dd566ece9df7b6566a9a066b7ab30da17bd0700417f436b86fe61c1daee3f915dd0498cae5d71d2930ab029b0ed376b97e7b0876e057635894c1146e7884e03bcb4d552be44dc3ac4b9bdba77a17eaf39073b3f72e82aacb3429862cc4641ad1784b6e2f22615982cf804e9c496a56ab15ba61092ec123c7ce0345f6b0e2e1f24095a3a0479dffe8b5593b25b0b5a38fa73d7861b08dfa3547d0c4b8c6eb876d470b970c247c5339d8355f60afb220a7168834e748dae153d9decda88c1fbf9ec6b86f8beec65101fdad886594f2510c858ce39b784da9bd380a38525a7dd7f5d26025bc4af6c78425e10e9eaea486d40d53171cf5330f734d7ff55fda7d7b1b07b1b330e0280fc2db4690393d5e2cb940f493c763beb04365c5ad388f8eccbc4f5338e907d2f32a61ae39c4643b922f20d9884c7dcd82f668c4b1200e8c8060a6b27f8396f8777b825a25c893b1b6f59153214141eedd9a26736ef77d2e6f61a5ac1013b9409365d5079d0dd0f9caf1cde34d82863d9a4756edd2c9998517e945432f5b973ace6daec8af09fa23b34f54cd5bb75e4854291c2f61b571f17a088d6a392a520856a7d545ad815fcc8292299ea1fc3d2180c71abe7ae874dbd5f043b2bca2f8a0264987504be49a4c3d4820670facb8d688c5b7dded465c817b568b1d38d36b3bd8933b8c54f640ac0c20b462ecc880a1f5d793ed08ccd1e72949db1a390cbb3ef1e9703313756da8533848dc778462ab96c8325eb5236894c85a577f51998a7b8a7f080bd67818faaa59d39ee90d7b074eda53d3bcb87b8b2ca5a4c855015f75d82261629102f5e64c44700ff479e9f487d6715acd98951adcf36e9b732746814bdc7a36ddb2d3bb0a519bc1655016b649b3bece6b2753eb573ce11ecd9a1815eec6ceae403512d87f1dd7cff56cd31229986c889fd807a1a3f7784a0c526dc271efcf44316991712e6a8223436c159e65681127b1f646c33343ea2e564919e1a9d4262b19be775001190e332e1f84f3b6d5f3e18b918a7c1f91ec8ed97719edfcea053b7ebc02c0c17a15791c63eb5755bce45bf4493ad7261bf5b4ffc671d062be05fb4328507a371c78d504041085c0682f24e1b39550e8cfaa7304967d21413a12a94eeb9d98692a9b24838fbaf29c60b4db26f2952ca577b72564e59a57e1d6e6adf3c9feb977af19b8e39effaf87e74c3ee92a27ec7226bc99ee28bff046b24716a9e5846884f950b9839e170e6f216a4491365d69d6f9ab0aeb83fafea57cfaae0ac32fac63f0d6a8a492dcef2b81d7cb9f9ff8361cdedbbae4398185c432c158ecc4aaec1d938414c891d7db8814ebd4e83a970e1c48b4c438f02653534996cda830c0ee1a3eab8c81fcb5986bfddd56612752b42a61f1600d503a0897fb347431ad639a7481748b5feb795d24034dc5099ea2de65817cdb3960a8a927d82890ca4d4618b728f6ff37ccaebb92370c55c3e95c559663b1cbca9468f1d14ffbfe68c117188b477e4ede69a8c3507e2112fc7ac7fb069ebccffc8ccc0742b7f18402711397eb2be7aa2d27ed69113052ae51a6cbb06fcbcd21c0a74a741778d898b6a4a44901f74701b9ecd2d050b9846c83c89efa42479852da1413f34ac457c26543231fa9070f3288e18487287a72e809263823dc930f338fd8cd0e03573e9c9b86fa41c6980036c3c3e3af1a74d7993faaa2eac60015ec65a303dbfafa542d3d90302053a9a0429aede0b30b98fb1a0547a6c0517e737bb2d8794c7864bce1dbb9c1216690ed1415d394ad56ed5209eaad42981e5f14bc4effced30c1cd376b8be51fab2117e5ce789ecad8d77b5eb0c8fe9180afbf0f06b3bd172b0527f1ba5dfe5726d6678763085d71552047de6bf13edb3e20eb63166bb20d8492c6566b1783ea5869d36e4b602fb01174d1a4c4a34998f03e5b0383a9104a766bf2e1304cb4f47623eff043c20524d56f0c3408563f50031b3175acfb88dd4e75510f1814232d2e13db531185fb2543a91e60c8dac8f6f0c0f64a7f3698fabc6837a6445c23ebbf68c9745c612449f43caa4fe85a9482138815d0f037d1227e42551ba0f0c46a16a1a8e38fbc7c6ac38386878c4bf8e9294b9bf1659a2bb5a78da30dfdee9af2ae5c9d2cfa9cadc4da247f91b4de42c385b36c4a7aa62446f3c4f4da00b69acc70495463c56ef95c00bbbbe792eb325f36fe256fba2c0db5f02c90197f120ceb8c4ba3d73caa8e8e288aa6aee9e17f1a881df4555864dd525e91752014f42b75b9bf453b2d871c0090c434d060bdfee22452cff66f32b7809f1899b8dd5e9e4bafffaad4763408d5c577486aa791e77658ba3b077f3ab8ee947109442f4ab0d7703dba1e2b1c2bbf684771081fa6dbbc33e10b8fdda83dd074cb09dfc26a04dfb62c774156d5de01cbd9f26469cdfd867b582e671c018af909b2042543124df20490c3882d5721720c7f01ef45d9c9369f237dd79f6399708dc19a29f2a7ddb95de6e5af6c91666a8d6c816a74388a0dcf26b5e12a851ce6ef18439e76188eb99f0c22a20a921770491c9c21c6314517e84cac12f4bb8ba7a1a1dedb549c7983a347bdcb37a371afad7ab95202d80ef0a9d7a557e1f174d531b68c2ab1b27bc2e2e84d32a5fbed6a4e5634820833daba2fe57858ab78deefcc7246e28e1cdbafa4c31d18f2f40b2273de2606e21f20b56a0638033fc711ddbab87f889f244cfd7d72a6f1ea525041fca91d913d98e8f41615b94980a8c49c69081236c0585a984d0950b3eb5efb8f3187ce9963b9ab4b3c29dd5fad7e2cafc154d2e1be1193c0e6a8236ada852a10ab2167fd37d65706f8cc6ee7bbf86ffaf3e850446ff9cbff258d5d508a16e3f514bb35ab835373f2b623310965652e178c3acbacb85b71beaf11dadd96ce1eb24c9ec4f897077b73333fecdb18954556b43d5755abf690411fb15d9261b6303a74f9708d83bd68823736164ef8366085dc365fcd4daf121fc847af3cb62521fc2a043ae76c137f3c385b53c207e89bd9460dccc88b63bcc739479876672ee77c2a2ddc5f612ac53ddc139617adbeb5af1b7c5c611b012b5f81d990f34438806fa499617d051e6baff0ba5faba38625ddb49771db0959706d0d7ff40be5a9639209e73d992519e163157ce34a3936d077ac75cdf2b9f450f73f2bb2a3fa301ca5320a99e778b8e30c905fbfed786f2716a711487ddda169022d4b335e0e59de8e9ca62cb41769804aba5d45636823b00fe9c4d65ab855a548a50ea6910a281ab0ae0cd3de756e9b6d623c6c6b3aa34079a957ca65a28b7dcf02a443923a2e08161583d3099b286fa6fbe4ad665abf7f4d9b877cffae25b4b9e4452f8a2a0f958dea60eba93192cb0250ee9fd4da8c96d37a4acce82babd3ea1579aa848a39493ea739237bb422c6d039a568ca40d6022563a5ac6f7f152f540bfc7bc6c58e0fca6ca57e3ea78407ebad3157ea0c216fb63505b03443e32bcddbb5c03a3965972d5d30d35f7f1ab9cf5908ded0bef9bda9110ea39d2b6e9a9bf8e124c4aa2e11100466987cef0a198f776c0be72cf0bab5524e12ce254661e408bce760b87289886ff2e99f1b983905be80f5d19d8b91f89362461afc525f3528f5b6cc9bbdb78d390456efbdb0de8d9851301e96f3c64fd4d5098c92b4df54a5faf476047dd316d79b1daba30a41d8d300edac5c04ef1b098116f012b4df2976861b635b8836eb05e9d55b4dd63b9296f487880fcc95d2d4b0d8442674f7a812bd6e1221a074ddd5aefe7fb1142c0901a72c139ac52dd62e2a33df249bc284a18831f76a6aa04c3642857fdddfb55025d6910626f7e3e2ed20d71202e31b87ba1b7c213ba03216816c72fd79f2a14c985d4f57e0b1622eeca12c9834971d701a935a80deba7abf2d19b944f64b5012531443fd5975bcc633b62a8f61022022e66e02be58f3f7c381d544404da1e2986b442922f5e369aa29e6fe03a6eaaf02423c2887c4d282b085cb8045c0e30c67ecc02bc12950d05d3c9f225ca54a78ddbd2c098e6f738250153a3a70c19fbe2e14f1b3820a42a985c69c4da6d1d7aaf207e89caa498b4ba75187250ab2fea4d526fc10a069805362d77aab1204ed584b3b502f7f57be73d909e3e0fc86772440f258f12f7fa3f45ffb984b9abe4b0b11cca30fa2c358061e2672d77a62d16e63a8509617ac0b15e3243d9b199858d4b8c452fc7d2c8e56e620ef0998016a31ebc09b5e20d9ac284534f87384430cff156a68c062eab3fbe1a91fff750727d09c50ef24c3e0c7e3ac5c1ad33df98e254afc8045a5f9b350a28989b323f95cf507a6a6fd6cda36d6cb208622bff2faad09eeaeb037b5e9e3eeb530742a5577f42b0b4f2059d60fe9bad5cde69dc66cd6a369fc2c9bec6e423436badf5ace0003418ed0e36ec65bbf0d54a532aadedc240c4a17fd39639d66781702d76311a595c188b901732c53db54d1d010358415ee0184570ba37d7263500878b2da0884f174d22503aaeddfeb72008db81ed857c8d17867275034a598949e0f8518468c0a44163128d07fe060a362bb79c2d8acfd8514662b8f3920f6d3a0e29565b09a8d9baa14857c10039c4c2f819bb17c9fa85dfe01a2699d571607e2f1ef6d8af3adbbaf1deda72bf18cf7af898adb02932773b62cabf7aff61cfe58106dd390be401e13f7d7b7a44d28966c540ff6969ca1efad89078fa8870c0c9650f0d8120f1ccd8b1f8ebe4b06f1633c03f92126c3ad1622c49e8ec7681b78b228d2348fd40f67ff40dd2c35cae1e3f8be537882c4f16a8a56595a6361bedac644d006b2438c5ace48aeadf9ba7679c2e906d28ea6641a432ed777420001133a4fc362ae21461ab88c0f55c3bd3f00c1831a2d5bd2da93cba5d6cfcd3979664997cdddb0d475e5e6184e323824f5136782a198e9585c9f5820fb72518d5c17beed750aaa7f9af054124a28992d4ec8ca94b4ee6775b44a25126bbcafca1e95dcbf1ab619ddf5c197af4cc3dac1ce9e0425839159a6a5b45a392e71328486152eb88d102ce71328d7dcf7cc32c7a40d4d329f64407837056dfd789540c885a4dbe0bb963a9873f9dda3ab1b1e0c7a447ae4e7a46a0c9fb7d4642d1358b6d408b9c6f4ea5e5c54d58ed3c7e60db30564e5b56449fd7e28a38e4a8a185426ce959392748a6b21490d0c0918e4983c33c074fee7467a9df5f7533b86389eb4a152cc44b44d43cfca3cc7744c4e0d1e637cded561e04184761c5459d2b2dcfa186f3be7b15c3c4862ca8908be6ea66bba96ea7805b16fb190ac35d82b50ff59646b1d9fd9626bb424ba23bd29c5f7a441ea1de7407809bc511e31061807f834bf8428bbe55e059a596ad96b56fa3a3654310aad18c59c426a4940132feca270aba77a7f653e9e4a21b73fb7d7d0c15a15675808f1d2079422df4a808a944f3f467523db72536e60d8a97cacb6070db6e96fe9fcf53c9f5430bc56d0d82197ef91317c4c12affdb6ef788ba1412601c0ac51606021df964203722254e9c2d9d03869ffac2421b76605697b2107c3cd962b81fb164381acb8398d14e455a913863de290448127cb7ac52ac2300e41a8224e9974c03dc6c33f2adbed821b6d081976d2a5ac9e69a33be78e7d6b1ee917446f0b00e35f1562c6a0987436c46ff896ca1eb844ded473a5b1d88ffcdd49e4e5cfd60a04b6968bc472634f55bb13cfa75b0586490a0ec84314ca4aa32c44f84bcd413d2c661bb481620f055bbd8c9ec4fb33fa92dc8ee42d95db8e338ad0277c374d245a2ff87eae4bfa5e5b2e2f18770693df9aa4c04c009949148a9879ad24915bd3401224fe6103a2cedd86fe23c88d4e9371a0c9d31d384602fa6f02e12f02649598febb58c0484fcdc456f6fde287f3d186b82f60e9ec8b533f9783086a4b78478d2553a1fa72c32628933fdaaec0b2c4c3bcd49aa8b5f5c7546846969980e7d3b5d2c9e16c68326da3d93ff60f2d6ada49b00559b792f2d91d3c37d73a14042a16449bce480ddbba8d57fe8ee095e4940eb6ec5c83820d347b9a6e64cd2661b840030df188ec977e5ba3724cc75f194396baeac33ecf6d5ccce06aef27eaf6a92ec3f51cc67000d47880c6381afc984c4a3e79a5706e5951f32ffbdfe73f972a4f56ffae47dedac735702a2dad862e12d00f75e025fc9df68e1218d4992d7f959f6d26b8db3c7e89e86a1bfe74d64cf294ead9c72991eb0a3844b07f994e0e2ea1a7422b77005f26b0da05489198d7705daa69be6abd605048cc00cd39b7e7306559cd93edac0d7bdab928a6fc0727c8ec9357a1b2ff4039b06764005e2861889726c61929f20bc304f05009f9850162eba046ad9cab0f2cc9196f8cf20b4402fb2295fc9ac201a1c775d6c2a82292d3f72aa5f104d8190fec4af4ab8d27022c53a11e2f16fdd15ca287a187d60425678d7cfb0c227a875f6272289e0e5af8adb8aa4b135cf8ffdc5e723384817d9b802a1488e7f5a67a0dbfc3680a4b3359c370dcabc7a04ef2cf6ff61b8628949f09fb94e7c38ad90e076d51b7dd7d7bcec28f86932ed62c992c32e549634325c8e0b811b962e64e40ce4f0a15c82467ad61941655abc617bdbe9d725da319f4f4e10a2d0943e178b897fea9edc0af91803d049e81862d5e909a1c956d35d264009aa7108431fc9be977188537061024966a53514ba649ed6c139e0befcda314367f53378fb98343d342b0ab117c785ef89d4fead4a603fa94a00e901fe4cbefc6aad5fb01f9d0427566e61490d7b5e6f7c196c45a6babf5759c03b7cd325bbf0dec32d704f9bf6c3c67577e79583cad8593e31e34c161a78b38fae5a6c23477387e409a41b69ef9878af306ef1245b734097c38645b347041afe3aaa39dd5450a385b73288e0d69edaeda1e6cbd1499b909550f7c70f0637a1250f792f13a44a9c211b5ef773a2229620445c0617fa954c7b0fad8b7aa03e38449c45e4055bbb21370f32d075f55f107a31df932e891824e0f0a51d945eb53ad539e3dff01b44eac2d47bf24a2c979462de738e3c8206c9ddf9d37cb9f2a2c2b873fad9086e15cdb65bdd4ac6ec229323db1de2fa6388b96397727e50e87e7460497fa044fddbcefd0fcd90572fc5866c00dfd614efe70f3cca4eeaf91bb3fc913ae8c18266af38235044ccb368bdc2729603139159bd1df5e2e7c323f8d60c28f2a44ed36f5a7f7405638679d9e90313ba8713cfc12127f13818f9208de17ce200611549b1f05bccf94f22864d8fc0e464f9d83ad0c7f2435a501e47832b47b14d4834fc29b380e8870ffdc19aa78d25193973b361ef93b87de69d3e5a08198efeb0be067a298db5111afb2bf71b38b2b45d1b35e08fc18fcb238cfa0ad80d6f7830b439e4e379889a604db612faaa7a270d70b3dccb3a8ccbba3bcd9ba7c2c83a8a88b64518b9efa71d990ea933e8d69c1093df6191b9a94e4d1801b5d8e2c1f1669fbcde888be298fe514a6cf55ab6d2f405a499d233a897d37f3aeb7cd1eca274ea620cd037358355ae24a1eb18f689b0544a5b1339c088c758c7853b9519cd525942ba268beec36e1fda4573fd89955f8df9d94c5cd0ded5d51e08c0464343ce962dade6c9d90c08188e9ea51caa8655919b4ae074b397171c711af232abc6bfb818712460eb565b63a0a842c4d1065a7757f8290ce3f4b989dce2d453ea2885cf5362a77c8fe2d46f180658cadece06b63f84218657588598ded2a980dcbf134c933f0171f30e9a618e4b5873d334d4224b0988090ab86ff1dff06119c7314d905d20c8efaacf7c265ba08fb3e3b89afccbd4ea846f60ab838fbf76df7556da4cc87876c16945ea263a4b133804574ae7d67c77c2e6f27b4feb10730566d3cf707f017ec6adadc0cc29bdd735785390c8db7e4d6f79df49ebf2ab0e6b20695dfb000e7538dcdd6e2137c98e1373bd0b6f5c15d3ef9e2601a7a41687fd460879c2286bd473ff81fee41ffa6e05aa7727da81dd0b72744775983bdee14e462fce7b0a69f7622a6cf5338ddff46e68448fb6de554a405a1f5819204e9a033674f158110eaec0aa63ba3cf2422a04a499cdaa212b6cbc0ab52d58679864bd70ecd87983d2a703eb7ab9caf14cfed49114cf42ad4c6778b109db3dadd6f58cf5ab773516cdef7ef0cf4d5cdc2ecf3e42581f4ee0b3374eff375e5901d90a85d36a14d97ed9a9142d96f5aa2a0a7a456fa9087fb293a3c3ded004816094218d251089280fa9b73d44dc03d176acf11f9069f35146270d706f0ab17228fcb2915d1366571eb226f76c8e299dd1641a5100eec4d28c8bff857ceaee27bd15a7d9cc79184861e7ef5473254ce88bc8c971eb113e08a26f760018d24b23914196cb623db85fd2452e427032a6199f60b1ae31a2c0ade755a07e58e403cfd9af79d2e59651e2ab53eab6aa905eb0308e83c74ca1d83560033df90b83aacb35f8b431fc004c04e4d64719e06d250fd42099d1562ce89a7744335e1b410c66bfc547de277ff1cf77dab233ab0819d55ab83ea7b68f821cf664beb9d74f76e939bffdbceb5169347027a4eff38905f03293829ad96be303d78c5183ef62bed2269a4227dead10fa488211bcadef93285f692d3644ba119cc433e33043c6f006b01d38ff522a83d8e95911447c13c5fb42bb9b83c433b2a495a0732ec85176f28336a8c5b88393320e0d827cf460c7b49e9ffba8009e69af06d401fb2dd30114b9fee9cee2650f6d09e7835540ec9a89f773609cc8cd55158354d5c11ada386c4e2aff206c8d5dd4d4f932c7cda9a4cfbebd2646d0c427deed9810b32265cc0a8a40c1b007d53cf07a62208d8ed057a6a4e97f3973287a95c7efbed60b35ad41f8aa765ba9e5ed6547ad9fd88e5d8f12a49ea0f56ddcd7123d75fc9fd9bba7b01c48afaf1805f8087360dd28c641bb1b775574d41fee64fa1bedce8ee6694a1b905b4a91c7da29471112b6e1f1710ce0a76736871350669e1fed6601e84378b112dbab21f0816a735906bb06b4d753659af0353550376ba294bd1b7a2ce09f5c3f7a792b254ee1665106364372ce02ee01d13634c2f396fb4aa1a3c05b1af80accf6dc44ff71bb4f2b98a906f5b68ea333ab03d94e1f27e3bcc09d5163202b44b235dbf5140af94645a865b68e209b30863c09b4ec04561db0fb467df580c736c44c23fc5aa5d8f7f7327fff951f26ad25b78c220fb3f9dad2e846cc4c7734c95635334ea5035ece2e08a62bb9fab5102039dffec3551e76d01a601b1e8db9ccbbf42cdeebd4519cb6c203fa267e87496a3d1b0d6a03d038258059c4ae7746030075371fe76cd001af0eb296a9aa00097f65771542bc74208e00ead838c59d02907365bd7fedcefcab3108f0138abf78402b8021339731c9fb99494e812bd3d605b262a1e12911206fd04b15ff359ea33a97958409f100a0550a28f3029104403a90c4dc3d5a585259df54d7021f24fada83715132dfcf198e657d341d0bc345298b0cf904e3c97805258c1a49dca51f03dbf24deeb1405afcc6af18489ddeeea5a14540eb80a7b9cfe5d8c6f4202a6b724f686a364a19d706702fcf4b3a29b5ddc68090cabab900f2e2160c39cfe4c16ea1f92000a2ffcf66705d75b90cdd44f0553bf72c2f472fd75aa3ce58382a5c6a930fadad23ee95bdc70d5bce262728ade2ffa93853139eebffa0d68b3dc55e416acb6acf4decaabdd5870438e771107c15a5adc520ec10a34f46928f5bc0eaffe568b06224bfa8a9314c6ac250a0fb6e7615e1f38725313e724a7ce415fb81eeaefaced8e33ccc2076faf6b0a69028d9fe48cbdc25461f33030105858cf7b86c9612f9355f1218f14d0b09f65e2b44e920310ce20ccf1595bc761a8dbbeb411d653dd44fae3f9a7f3c0a25afcd940e9514763f471039a269b99a111754c400fb3ebace5c6a9baa8d4d755c6b391b437cd64cae6ab52f3166ee3acd57874343a1babc893bbcd2209088e12db40d28ce34189d6d6f75f3a44bb1c2ef13451a1688f2d4d074c7a28932455fc52036637adbf4ea48f4db7b60404ee3b4b15cc5c7da731162f0c05b28c0e7160e511075e194ea18aece9b1ca11e95fec9a09be3e8d8daa273f60f22dd69f5f1cbabe41a7ac198a79b14598a85f438d472ad6dd715c357e62c0900f103256cc0b0ce380810a0c10144f7f1483bf56c652c05d3f3f82116e8866bcc2c5772697a1bba09c5812d0ef3658365dff82bf6e01214d141f7a4f58790edc68fe90a8fce579ad59fc71c807db06b7a0bc4ae1f3511302c743b9a6e083360109641c46839400fda377b91c7b0d617fb80471ae6db697304aaa29419d5a3f94a9ffccddf702847c17f05e3bb67c35b237ad8cc994202c3f354c1d059dc65d5729f1a0a49181e2f5108a3824b004fa67a0b8d1681e727cf88a939328f747175c78a1687ba8bc4a5806a06c9379b3568be8958bef70adef59fa5820ab8a4ed0c56732677a60e77cb376c0112590eca9ff595e1f6c3e2c9252a9ab7f2f0d2b28ca56db1aea4f831d41a1f1329fab7f539f141d3adde745d4414ecd3472bf447cdfa488335a639b0f2aefdd0b3e54af7ed0b75d671fcfeac18ac0e8feb541cb92d3bfcfa1321caa82c91b7ac453243106877403801bf8f451d777a2499a36a400773128d0ae881acf1e457965232d80c9190eb19b20a43eeec5834b2e808e3bbedb56861fb851c06e3b0c3b013654a5619ff53a062880be558c3da9c2f50b9ed405a1b981f55c920e8b0223fd5e381c4760496181a6b03fcadfc66ed0d033b1fcf26f973e780c91c5813001ac4b7c147a91bb4cb8cc045a2f4736a08154a92c75fab83c65f4711b7ad2205a67190d760e75f86f61a33919ef7080de7a83df1f8d5f365f93f6e99a675ea00d73d4132232be730b4facf203672f1c5cb9fd3dd28987a9748eac6fe9878b9d03773086d72f74efd6e375413a2d06030dc9a0e8c2a7752ff99442393a264ee859cc2b5398e51512df2ea64382bc80b127e09f62cba4fa61e54f31e20ce967761ad257daf91489a0ad2440f8760e869e3e2fdad9839e53a35456daa008213d8406b4b78d82f060b695c06caacefb4c15eec33e30447aa054e970d839596b3ce599c264f79d6b5babb7d9cffed501e26441bd46e6403f1825a5fba4a8828e19247400311ed65bd3d9b89be0288ed8ce51d65098f1852fd837df324054ead6cd77e1c5b66cdf59c958ec7a798004d060e67b99350da508e85b83370f38809b73bb4acb08e7f837c5f4b51ac35b2bb53eb62df1b02aee48e7bdf3612873744afbe56d00beb553812b4378e200c03896bcc1d09688d7d0b96534f47bba6181507d0c38e441189e8aaffecb958d0475feca8ab7e62598e7ba09d42a9eef807dd9817b5f2140154e21f6248593cc7d927d18e67a4bd990689bd67e463cddfe6f1b8b8601f5f69b20ba9d066535d6f69a6993a6ca6a5c93c4fd5b6edb7c00a3175781be47138bab78e082db6cfb7a1e93f4555622b834a35cfd0456a32b08e22ac7c0cc10405445a0e4b4917adae27606bc43083e7956829bc41a4f00355bab73f63da79c1820ed98b3cd6bfc59c46b2b9c81fb55d39ada09aa681286c46af4133b1990cd8dff04ad8873f63be7b665dc4b05c3269ad67e3578ce6dc17886125d30fd687a9c7f0ec0fd0130229cbeedc52f7f6ea370a136cd0acb953a08571ffffbfd7d9ae17228a87361a59366087eecafe73e55525ab850ae0ea1ad4529f8ee6cdab0e69e4cfadba44c0a5cc84fd04590266a47500e5ffbf25ff526d1cb391a253eebce1e5fc7393462f549627881dccea9d20cba0485fefe1cd63d310ad86495fabdb8127cfa16948903d3481cdf3d64efd98634ee1d47afe6e95b5869e4fe212499f0da2447b978714b3fbf1ee613a816bc28961d3d5e295689f0f27726b875c39a192c52448872092a0b2691fc68c90aed83115403a18005c11465ef35691a7e32d9d1eb44529bc4bd3ac82ac10e71c6bc24a5118b248584a267f818bd4c3c70c65ac632607d59d4de672ef59cdded8bafb6a5591b1ef640d2f11d49262a46f13628058d0cdf099b39f50821ad786ad750b348e3b55f4fb253a446e40e8c49076634b225e09bf7e24c2364294162f273765783bf6e9bbb27fcc0b6f015345d0644d8226b69d939d3bea4418c0945be5febdd1a3814719c60b7b3b77e2cfcc2dd060ccfb259b889ab32e2c4835df1f394bd7ec90340c0e462a22292b5cb46b8bbd5ee76bc0ca0e4ab027bbe45ee8ed04ee242697c1fa150ed820381fe17096d407fde9b94f59d9b67a75d529592047a4210b56afe78221cecae803877094eb062678aad1edbde6c45e74ddf6b783cd2e0fdef3280725e6a97c5a72265ecb9fa8783073c3ee546c134788348ea0b124f6daed864befb4f908304466d0a674fa063bf4e9cd8b0aabf6cc85ac67dcefd204cc623189befcb19aca26a6cb751f76a24146b56f7f14e5d95563dfeca391628d6af817782b84b9ec0e0f248bdf1d21620c16cb03d05c3a0d5c50e8411aea08e1a261645cec03112a49d82d7c03a550bc6df5008be98bd68cf7b46693d2e416240154cb1567913346a0e028c50ed1a77d32731a840bf63c29a52eccc89ab09c03484d664b1adf5f766575454d52773a3b76cb46fa39db683a7d73747e489d217062e4c3dc703c5c76c9e9c72bb5190b57facfdddfeba51cd5c2801ddb62ae09042c3bd04c6e890e695c4755f96474c9b2a491fb00419d5e0f9bfe278c35f6e4be4527aaf189d76bdceaf3820b485c30269af6fd22fd840a3d7f9ff1b25a2a217523f30914c7db95787b96f15731677b091569859022827a4202418964344e50cf0536f92a0b034de556c656c2c3bd1278f45a0bd504f610897a1130c49ce3c295181766f15eda7915688a066e82cf054fe61173ae67dc788cc535ab9d52ce299cf70eac1b8d70c69814df293f562880cab74098400f0a73f3496e0d225522fd58252b2725a2a59eadefe3d1d572f213f4afde81b188e50e64bbf1b4179cd85ad3ba403196242ee440f2c3da1bc3abf8a8e0f04de8913af0abfcb5fa91486404d6979ad60289680f3756995f973dac5b2e0c05078b0ea41c4e5265e804ede81a517bd6b7863eac687ddb1f1dc208b6a57921983d01dccbbdd1843c8b3dcb2c37c35e6547ec37e1d6492e90fe1cceebfb1690e08fc204607edc918ec09308a39a3f3878181e4427daca3d093afe64da569a975d0540d5e69bc4f46b75b59bdad1e5b438f117d6412f9281882ba2463bf6dcc23ce387e6aba1aeb8c2b5384c95e858f8751dd90bb0c1ddff167f525f25f1bcc52b885a5e1647ec67e7ee0dbcca0b0375a0d40c9b98826607053206d2102511ed766c21c0263316a3d576bf312fc5039f8f28c426de4f1b3c05a5932b326dd1343b64d13a49857b8c600d7f89c667c54f4be19c26ba06a2704f37d5ab25b8c07fa274ccc855b87d052f600e20491910832861e0b71c9349ca6355ba23b292fdda7b40a12ffd5369cede61987deeb6272b2ee4073740ba86f69afac9e88543014b424b8a85fba240a93d8c95b26d79a46143ffab5a83c13eaf0d6acc4259a9ceed4c2d463b8dd0ec4ea47cc794679d8fd0e3e5a746316c2ec97d06a03a22bfff46407a9d854618b6a4415cfbc7186e5a5d667fd3ce7bd6d2a16cca51374665e370f55a56da7ad6f3b5ccc20957dbf5a21667eca3cc6e63cf7426b62aa9334eb69871996a11a1bf21340887d808767f17c6a523ace2deb91074f53e2eaed821ec54a21b8bdabb5a1d00e53aa8f95db9d5296fd302a833d9981f8e1c5580b6aee79a7e95e9fc3c0bcc6dc9143699a974ceff47dbe1c79febb58167fa124d2cf12e4b15c1e745b0e5f814455f142d1cc558f0c91dfb56445756fd09c0b9e5508f787129c9f48188f1991c10efebafe62abf530d1f46b45ab4f774e951bc5289bdba8b5e24d75238ab02f412e35e4b89e8b2c27ac4de3fbd85470a32c5d0e19e8a79fd6dfeee567aab1a7028677eee7f0b9a40bb4b2a05c9b3d75d3a667b8c68163254dba4ed69c74412701b3464b159443bb18e236e27d8d5c896a80577f0dac78df5c00d84a3784fbae7004ba194da5e9e9ea8b0305a8ed515da4b1f83214a65bf6f0da2d2cb0f8af6382470812e2f7242824c6035c5c3dd800d0c561f909f67d0af8338012cbd73e4ca404891bb6eb14d8c3cd2bd8a47f81f6a1d142c2dc5e2354df2114eb9a90de0372f02a4d6d90f2ab6786d2ba83027ad657fb7471300b290e4cfcddd60d182b789938a17eed2e3bb674605054388560d8f5e0549ea848e4c7ba69cf4e034ed88520b69f010767208453ed2f0966fa09e409f95d385f37919d367bd4ebe8a6674cb7331583e0a26e7020854cbcff46cb2a45c368ee8662582c67fb2fbacb09a95016be9b2730a24cb026812846976f1084fcd77458d8ee6e0f93877578ecfebaf0c20f4e12b2d4ee6dd57d3380c493d162ae4cd2a6a5816fb2f45bca2bf68455ee3a1a961fc3354bb36e619078164d06cc30eac909f40545f93001a30f2f32bdc7d356783529a86b83553e50843ecc9681e9f3d4138064dfe3ca902a22c6bc03b2a67125c7b5d5c55db2ea3a4e9766a617c91061821822fa90034b75f4c4d9081c58fd4d577fdf1a07542cd6867edbffff7065f2dbbb94ec853c58f292f93db8556cea965c794e80eeeda4d53b3d0ed9132e817c551d0f205d5eba15d5ac9b169bcc2d1e4037eb411d46266af6c652d25abbea5b390c320472bacfeb28c6048db8cea15f9d1cfd3ae6951a3b4e451065eb62b2732d36abce8318c70275cf22cc04faae3c4921b593ed9ab124a3db1daae29d419e30b4d8042eedecb02b991ed57d90f8e5554d65e082fad69b77940a63ed92a76ae0bca82ba6617ccdcc5ab90041852bc509373ff58c680a90b4b216f068f84182cbfd3aa5021ab9d6292b333d535ed3feebe31ffa2ac5c344c8327c5c40cf9e0f5c2269bc88d74b36e47d33639d0374a363a6dda781291f7ac780666043aae0e9102faa930deaf7afc2ff98fa035cc08d94da500c82c66bf59e2c3928661d346efc67abbd85b7b3f3239143b17c6b65f320f71423bd130642997958ca5558a984cc66d4a8688ab8493dd31aef5531d376cd30182250adcb5a73d70fdd7e5d87cbc111b300a4fc92e0dd0b7be23594b40f99d6f48c5c5bb63b55cb086160e5b26c04f71e73b1b9480e0f757f1a21dfe8c2d8426232d1fdea8eb6f700a3326c5288ab80f60af080c60ba3878892d8b122046b5740fc10801d255481b461b92e2427179a54266906c6e5dd64d9d65eed0059723aeaf370807330f62c640d18767cc46fac76035c6d7fa622b591071b2c3c720911b064951f507b4b74b1b070dbe6e54cbbf73778e72c3687b84ba17c37967043d8e4fc722aacbff20dc0cda7b58932a57fe8ea095e210f5072fc6ca91840de6a2d033230f16f4867d346e3a4c1e4016473ef8fd07a32792d18bade9f8eb2983790a35a270cf1117b9c603ff6b02db78955a4872ff9edd4f0017ee633c758f1cc5c476ea0df5f3d9c94aa19f180199a1c78cf9c06d50f76fd1060841d4ca8572caf21bd8425fd7a4e02fba7fe2577d7e9b96cf6de7c3d4e3991e092393066cbc7ba1c220042ccc535a65ed42b116383359d610f9c230a28f155b083017682b7afc9730da887e2231f1790e9d3525785989613423da6baee916045562d56d11eaed9deec96bcc2aae33aeb1bf67c6b786cf2e13bd1a8fef73d5f27a67bf404259b805d31ab1290ba7c8edef7f6b4bc26515d38205d918a24816a70db1192ed0bc94972dba97b222c5cf863ff25d4018dbd79a3797c6f6790b6fca9b09577aff3674e94fa9361f93886ba0e24d7eb6e6155c0a97f95fbefba08efbc83e7e72edf7fb28fe7472fb0d6021ca92560ce7e7b7f764fb6f982e17a383f99c7e4b86dcb939636aa62c060c45db037a045f517286b5b91a080f587ceb7571924fa6109f3eca5bcbef14427884e05c33e521e138e92089883382f6a32516e5592792744f75de7ecdce48cc7e57aa930a28b7a1051ff2f869a634e39c93f1d9e08c8536ca97b4abf06b02d4cb66476d6ec87cc3f15a141c6c4ab3c60080777f9065dd1c07eec6d9c3fd61b406299acf80087451ecc6ffe4b31a923ffd31985c44649394ac609c2f6a7d1b664220c95ca83d00e0eba71de90a5456600fd90166dd7f8a2255661843bea580f351724b7a6458d9a2a2deba9797f2de4e36938f2f78193808a8bed3b833126b1c10048a62eb6940a38b519e8b04f9c8a4135bd0d5952eb0d3f19c2f9117f2335d872adebf6f8173aa1001878f0414b4b9008879823f924aa6eb98aca084d6647c25b70bc9db6f3f6302bf92f62dcc7be0ef36ec756d50b8e9abe268920807d8146688a32ec23f6e551f88d69aa160b93f9817f4c9800659bbbc4d768db321f16833c403be5bb370407283afc554b0ca4dfa4992b19b7e314c05c63b19086219711a1811c4644f9453ba1baaac2ebab4b8be356dbc6bb033c6d10fa04c498895043aaaedf90d80a2f978694e75ba2776c6ec3509fab5c704e50ae1c4ba69da5d3bf9c563bd123ced8fe368c91da5cd891ec55d21728a6094fc81e6d00edb153f6fa51a5e344ebc239e0de359cdbfb2f79f2339956364940e7b88dc530709c7f465bc09d97fb418d872757df5030a335423a80026fdeb54af082b6f72f497408797e409f02570d381a044fc87b450cb65c1176fa95ca7c34b0d2b67ce8ad6dab5a16f3acf7fb11893d3c4b7587a18c1d26df1ef371923203e2e7d395d4c7468d7a78e119f24662828cd7608ff25e7fee5ff548ae59335c2ce2ca95e3d883d586d65a7f0544d7323ed758a45ec0ff27bf74d9cde97b4e460172c9a291fc831ede012ddbd8dde717506cbca23abd884986d968d48447d9a1c4814e3f803d3bddc31735b4cd464e64ee0c6f9684208447e858c2e87bccd912c9f5b9eb2d3bc2043b39c32338b428c070b9f6540b02524366b68422486d2ce04d75f2d58037e04db159c38f59446809d5be7bc7ac8a901522b3bbca5a237fbfaa90826b4a5c150f0f2c9833ca81f49fe36383b1e9fda3a4b33e692479210a504f1b8fcdda12deccd473f99669b0c71aab9083e2aceafe400e9a5a648e78a70b777879617aa4bdffefd10742cbfb62aadde4712f90a54edf69700ae5d2c29a8044407783771a0800422ba5f94adf688c9e7d87311e93f16284eb560bb6192243ba2447155f39aebaa3c38ec3f28b12ada427b8eeab7c28ab5bfa7e0c239cd27d0a05ed8d961c83b8f98e9f2771d6a7a888bbdc5ea12a888f1f2268f36210ab5412717cf383c454c2b83bb46b3c0cdf299d3c591e5eee10612047da485ca558b8076b4811ceca2b962237ba756b7715ebcfc5e2f765a043abe11b4fa6fb1ef11a1ea879079fecd92368d3b5bd120761d9f61c5fbfc4528f41fab21789a7fad607dc2b107f10d54cc05b2f46be7400214e444496c7876913ce10ccf6debda46a3e02ffd7d73fc7a03278b96c100bef3c794c8c9438f5319ce615d287398b9b6ffa6322d3425b3291bfa5334168f8559c275ee61fe5947ba20027edb9195cfeb5524ff830b5e8bcf7233bf603d7fa946833a57bd9069ee407d9a109cd6673c39ab8e1ec33d37e48cc1d8d2f5b7126b54f1c30609af4e00645b763ecf063b28a8e4de7d551b259b46ebbf5dabd9d4728be747a5cb82a7df558ff588a74f46091521879228a87d72466c6b21d00d5463767e7ca9a5f0919cddd5af6bf47628b5311ec332ae52dff62a06d585ba151cd74dfd7a6e8a63fc4b4886b0e8fba22a2513a6494a2741439a2f3f83bab933a97dbb00cf9f3fa2ab860894862691f2fa6f04e9fb342e3f7846ef523d727b85c056c9d79805923bb04f21d07b5927163f7d43c1f363c149a5ba9ee0c467d4559d76e67459c5671ca30d35b3f7752a58af9b468f80f6f64dcfc43ddce5d0489461f909357a43dd6525101aceab57522ad8ab908d5914d9087d96d4da55b53fe1144b047cec243dff2922bf41e12be16d42bd91aab7bfbd57e746a89797db5abd4e4a6d911007dd096893714ea52b61878e6620ece37fbcb33e4c80e4cceb760dbc4ddc560f60df2ce34efe1ff92fb272c58446c56a2dbc257100d24964ade5283262fc5823524944f9e801ee694ed62d5c071e097b95a7403c6614879cb284eb2ad68933062bf12415ea7191d77dfd02fc6b45fb7b4be7714b05c1c2161520c0e1c205d7f3b62b846c15c1be8f9173c716dbbb4b6d2f55b7b489569cee338a809ac48dc0f54fcd1ecd73a06ec41b0b637b5dcea1f18b5b1d02a083a8057f282e93be73677749cf2dc68cb9ec31830c7373dfa10d3350640b1520e6b053045eb08fd2710871ccf243ca586b21a784fcdb87ed8e8e7caf4680b345c9745a69b3a46523b68f2cc4b9e13c35a7bdf5f89132f24e4eb23bb951f33529534dbb9e7a1a0940dc806ef82b2d5a382cb3cb791c4528bef2e531d1bc411290df9960eef08d00cb51be1ad953ce2c08c47801b26dcf0ab9ec77b5c2078cbe0aa000bdeefff92e12b25e040642a6a7861cbb278b1c05c6e32a7e53e0b34a03f44dd19377b4e9ac479586284bb533d2e35c6eec747c904c44b7f0ee69affb8b90f15f4d83db4d77aedc7b3f49715953ed790501b588a2286a2dc24417f160196a1c668631859b51f7cfc0d37764bab693c86d02fe52c79d8a7686f19a98dcaed4f0c5b49df5075c4b2ce791792997841ffe25eb421b071827a22fd3d7aa5bf125b71993fbfff218a6f1f011b1abeb5505757604c29966c6969240526703d61cf932cbf6859c2553009c5e7cc84ed371a218567063b5b43b62fbf331ea6b4cd68bdb1e488c785fefb9fb21387117f7ba3cab3f9908d602c3c9d1e65167387f455b3d6c7534f0d5ce8ca687d9c76ee42f5ac200e4b79cc31a4072600f366a0d8cd909674d6ce072330ae7649a2130b73d8e814131999227df206b8d5d0ccc5a8583a8bb8393303ce90113322206b1b5792d07ad53009feb610f097a9a51d9350131cb6aa21a01aeac88b56a6bff4434deffd922df86d786c4f267faa60cdd2c4be2d7cef2a1f17099f563a44804052cebd7a68ea9982d51cb91da55de14365f0dd2d65e9c747d3cd4f014c033ec313bf9ffa35476a8cf18a4f5ecab788d005311b3e0a414abb3bcd4bec7c30f91d0c7016560d9dda200a433c57124b8fc19c14b8eea936acc46d957a1ec819075d5c1958940988f65b2259f9b3eef1480338dec04e874287513532521de3aaaeb764da8e228abba6993f2c697ca864f254c5d20f355b749c81d840340b10a9e687ad569876ed520f1ac997db568bebb77edacc7418972b942df8d7e76adde73b907fd23e735aa77f9d652fd6ba69133b07b398525c5afacedda8dcbe14191bda7a37f1fecf075ba96c2b29b56cf48244241fb2734bff5adb221365666fe5c6ddee7052fafc7f2eadf5f1b833001f38aadc2a9822b0a4319be72114d4f1928499e4f5edac5f848fb85694ba13930e32d2bc4e0679c8b4861036c8c427b6b101462af0e45a104623b09280f8bf8e431f22bf4e35207ba103069218e638a99195b546e398adfc11507ae58071a67e8c85da4217579a46a8d89998f1d57a62e2bf7af2fc6f4849058abb7ef5664016a9d514e1c3e656af66b29f0be3acf83a3d72cfcff8bb74c7b61a5594b415f4f31bf3b602a8bf0e1d88a3b9e694e0787259b60cb17cca0ab0410e1da3b4a545dd11f90d22ebc80e2d8e8043d1738373f826cdd86c167cac9d33946efaca9f415fc6b57fe2bff88270a75fd63de1c7ac369f77b08f94343d99514c8949ae6c9e38bd53222ae462727552ba3945e10d08475438afd88eb17a6f60014468be1b1b1c682fb1f034ddd1952cdba93092ce13a30862fab1ca047141019d3a054c22e316f934a7e45eb63ea62c8b138c5c5cdb46883f269a183ad18706d1d456eb5093706093e3f59cb5eaf17fbcb80b8b9262cbc71f8fba9a0dc273639c7cfc320bf58321012f985604d08f1a559defd0e9941152678005cd61f5f6a23a9864ef2156dd0c936b4ba122f8c45b92134ea0bc0d2c7ca139d0291f225c3c01fee291d123890fc05bc9c3564a07f3281ec9e6cc3e7b26839bb59feda5d88e99cfc966884667b33a32fff24f5b56a2ec7d5075796624a6c633f20c9c1ad303f9a12ba1a99b76992757724511915e7a1108ec35c0448bca21eae1386a09a48372bea2f52bc1b24dc967e3b678e57083fc3146c9e287c405dda72969d444d403149cb566a69d296f9be2e19c6fce28fba00fe3f8270a941596b54f569cecc3bc6bc1c621964fc213d978977f4342e7c1d2b85e7a5e901a6aa94bf18b4ea2727a5cb35f24c440f456fd16ff34918b562553f1e7915184bafc8ff336d717d6b18b8cbccadbb330e81395c11655ec71095b90b0b88f5c670600603e431102d1da805482a0679580acef65f5288a4afdbbc92efa9e4b356bd26da54e9114aa59f7deede46d3d346146096e2acdad442bc853c0ef54ee973130f662b6452331c0a52624990f2278b2e50bcd53c8d319d5bcf9d60bffd5120925fc28d325eff5f1925df25787f4bc3411caf8ea90fad525aa9b93ecf1057132aa4586ea5082cdc252d2ce1365bbb4e174e221601f8d695fd7201fb2c093e429f4c4d7aee8b632ae8fb0abf8f5480360d24ab7a9969fef3b1089334c73574815966a3350777fab8d445d2b1a65317043735dcc9b507f2ca991daaeeff90036e42be877924a13f748356c6e91904059269467366bdfc3c50699e7282558b80c827bb18fb33183fdb981010aabfec784483f17980191be2c53ecb44740d7397f996752f0501e9e742f4b08eed3e485cb74d89270ea81b0bac60640a10818f244d958512355c4f6e0c17460158dc0630ab6e9fe297994ba74c1197f35f25ca88f0042ce7bed3b5425b0c86e5d5afa06e59b5e1c06af549402f222c8345de2087b01b4d94b006db5fe067c639c0aa21d9cddf39ee0b74fe65a7e8ccbc70a66378b734d179390b8dd7fc45d49df6c4b3ef51068266af691cebd363d0c1f2353c48aafa48052ba4e79f71bb6ba7cd4c3e4692de696c43c88949504a5062110757fd399aa05fe9b5e76d418f531d8dbc844b64ae081637c90bfc0aec1aacdc1a8326e0ef260e997b83c4ba147117b0ca5fbf5bdcdc015c972e451b4f4ec211f1bbb8e2f41aff23dfb535608a22bf97dea2970b8835c3ac8dff7aecad63e0be9dbbeae1d36c8e4d0f0de74072bd5606fbdd00527457876b2202b45d6c779a9ccccc10c12a218dced6d85923d1aa66b259738923a04b22dd1eaf794cdca64674d5075ea6bdde5c70b1ce30573ed0542780c00cb50fc6c590863c519741e4b2e61109def077639248379c02bbc5f2407eccac1d185a9832f1e850884a19fad612e7e546ca310b02c3efd2b82a869f4f8b091b6b86443db57b227387da135527013c4feece192922d7e4e80b1cf2abba7b984500282c276d9a405ecdbe37e680ebd779095aecfde4f031c8383354d99bbbc21342660ebc06cf3e6f95903306d4825fba46326ac0d673d25d14b0d3802e1e12a8519d68e5c9685143badb5064721c8125a6d8dbdffb5250029fecb7fa3edc15efa4347062c5bf695488f206207b3a16f7b3c444d73de35113f4c7edf939b8b069a9ece328ee99eab937443abb9432f34e4450c6e94a12faef73f4167ba1e9083cdbfd3e89f8aa5de76262f6787df9fcecf23115f621ee13b85003c71d90093ae231ab30bafe72fb614262d7b6fcc2a4397dff2769c0d08638f79ee4f30c0dd163fa7ac33bc1d9cc85660cb56e3ac01046b2bf4a534a3a576628a17e033e601f890e4ca8636bd62b01c8d88985580a923be460b5a9986e4f32ca7ff5ff020dcc7f021cb6c748a3617ddfbf7a4cdfe06d0d8b6832a356194ad32a9d2d0fcc075fdcc6a95cb140b578bd1eedcd794be83940b0f9a0906a481ae53e61d68ed201acdcc3effd3f46d637ffd815ae105a8c8f88735d0ade3dc2a50b1221e98f1eaea6d30e8b4c9423754563b6debc7a93b0dc9a70bd532013b60d4a27a1fa8b46c417b5a7902ddf1f454b79c8164a437035d54f528065959f7cce44dc0461d4577559c2d731cd56459db662b1d26be4b4643fed02acaa3aa593b5523c124c74854759c0c2afeaafea83611b9e0fb77780411d17f5359ce48b447a8f9d4e2e2036560f627ae573ecb134e07cd155dbe02081e1be16f836c28c884b74053f310ba9d50eda6ab0ba464c5c7664805bdf829e694b91c774553ee52f0b0fe858873f538b2af06af00eabd2fbee46498f758e0cf0d396d9410a150a399fe3b01cf656c81d12110c7ce2b9592e72445a6b9ba543c5b37ec684bdfc9916f14538ea27e6924142c395b8a3531fd0881107a2a1907408e2e7b7d5278e50b8879e0f2b79f2f22f870c6d4eb4d06a52529eac904fd6f6f4e257d1ef6c5bfe1ec6b36d6c20797d70fc2082bdd7d4cd21bcd36704b3ec483e3d074a47eb8e10e2c2435272c61c13e417e12e460a3ee0307fedb67afb46284fce12a332be5c68f6f7e6488ba0c9dcd14e25ceaf76e4c8bc26b2b65390b90602c804d028a0e39e1e063fdfb6da81c8b3730226226bce2a544c2909ee1f2f6cf1b37e7f8ac3770af6b2c7564dbf4d38a030dd5a4cf80ee7bc3aa5270a13d38d4c6193b570aa733a1abf0a228a56c008412097ff3d41d7cdc214e6783ef3a77c3e7e7de5d15ce104a03fbd88cbe1b26dd1823e755c3d28bb9382f18869084b5595f76d1049457913794f43d6554f57108ec5193cddaf8cc74322f7662f588c33f985b546d8a9161cac0b635f36927b0a6e51e6b0b122be772c3251a1b0b2c4f69c4e810de7c1fc3d4ce1a06a31e47520e6748e121cffda56d7db281a4b77b8ee8ca4755f6ed16c29ec3101a70240648ed00a59f28f94b2046639d58c6c15139df67819082a3cbc6b26a95a9f6af1039679023969f3f3a028a637f8fa549febe433e4929d7650fe4844a5d784b08d0d8efa70b64b84f2050c404486558bb7c64d2b4db8f96406f6643003bf63bbc622d1cb41643408d918a9f6831ee521e0b9d2c44db3706e68ca0ca93534a69e193f5e36ba0362d142d124389aa0ae6d24bbe69d84196fbc7e63a7fcdf4d6162aaad57c10f3b969d3757c88d98a24cf37ff5e5bbbcaced2c57a3a64c55b7147d450b3b53ef9f111e5377970bb0fedd883e497e6cb993bf5fef8b89eb0f4b0e95bffd144b7ba3ce374c61240b65fe5e1579b02840259054aeb7aae94d3eac622cf00b7616d3f0c9aaf0f1778397e0ef47d920fdc49cd472b23b75cf95f26fbbcaaebccbe2a80bef2e9ea704ef3e40828e9ead992dcc8a1ba98dab9a7d3ef3b260153e129a329f63207feaae6b16078c7bc1755b57ee63cf81c3dc2770e0dc6b72d20bc78bb6b833d093f6e5f1e3745d80572d1aa590f506d28b06bee16ca2d60ade3e25f76bb35989828060177a6af094b592d2b34f49398b316a2b8f7388fe742f5b481bb29d5f85ec4c28ce3c75cb82a21a449499403a3cd6dc6fbf37e502e6640e16745ae01fa55b3d49b0d4db8e95bf698c840604ddb6846da639f8a516a7120df59c187e25f8f022385750f2ff7887596045b98627bf5831cfceedbd38865e57081c3acf6b3de9aedac34afd9ad7450363e91b24162ab8a9502917744f7359228a2a2a8edfadd48551c297ec55833a32e68bbce2e42cef941b50b0db96bf7c4bf66bcd64e42041813ce0958075bb4773763e546dd4d0d5e2b253190ca3f4862ecb5a74bfbf4e5734d999dbb386dbc3631c405d43e89cfe33ca7f7dc880501788d795b941fbe266bdd20ddce1e5471948cc8a3d3a144e3495e6c9ce67e2b8d68607c20a41aa231d3867885295fe32645b9c73fc963fba5a8b1a6ac5be5d5efc3d1928f5e1ff83341b814b336abcf0567ee16c32b2c7c23255d790ebaed0f631860dc51ec116683c9e7c02a1c468b10af1e742fd92e28afb6cc440960114a769dcf16bca418dfff0a9fda2cada50eb420de51a1477dfc76083118b0394e8090a7ba28163856b743feb56ac588f9b04283b5bd0cdea36788830ab7a5604d7241b0813de8f23f0269dca8e6eaae24c485bb6918ba07d97511a6227e435ed5ee59ba7e0741fc8d3bbd5a2996b0eb773d0f26522bea1d49839d94b87231b060f6ffd5f7c63579fac42c492cd95d5f35e16d7c7adfdedbeb48253ab04cdb623518af22911b78d3abbc78aa2953e4ccaabcb5b847cb4dba553af0eb6526dff1fe14c356d453a4e6e01cebd14ce0420929fb9c46f8981c547a6fa49cfd8b35b9a3a29a4144c41fc012a753ce818d5debe9af5201f0b44f07f14570af020cdd828a9c62809356545b52c5cf9afb9a2e2ab78fb18e96020d06ce99fec7f98e6376ca261093aa7b3c3d316db02e12fc4f9962177e9cf3ac3245b8700fd8564381de4a61ca7e21641a92e05bd8b0291ce1a8669d444807da22d5f1567fa52e7d75df44677b05ddfe16f13747c5158b61764309cfdbd4d5e946aee1746f8166cd2b88d52f0da945db8748eeecd9efc843803b64efd8c09499fcab4ef32b2599b1d929afad6ceb6d4e728095ca42616c370d06e1cd7a809d6920d86ab6f748061c3c142e1b850629c59a7644d642c6d5cedd10a2466fff793ce945e4d4581304c36303b1f53877be90477435112c547551e7e98edc14cbee52a63e6ec657c1197a3b28b263df6dd9620cca82f8c00d71ff3ad348ff1c7f248b1eb5e4890cdfe69e26f5b3e1039be400beb6fb1ab88b4ec5ac07d40d0771de6de787f78a0a98e8f4d162192e5524162649fe4475cddf702a9cebc5036b40f1c1686f4ce7999a082fc42a7901bf9eeddccbc08b3354a69a49978224cde599352c328d6bb4f8040a152499b8baf7119f376fe29b04a8994ecce4910a2c2f98dd82897fc7f2911cdeb34165b79486714d2d512b1d98da0ba803f8d541ee1e757f40f2a0002037e0b35bc291e2b9da100903f1518596ee8e895d1948e89f4a40bfe546a36f6f2aa1da2e8d9d0d6400c0699c38a4693c53906faa608998035109fe1bdc218ad9b944323c5711ba4b1b88096545d7d4d8e29b51cafe82c65a4e0a929cb0c6ef58266934964b702f549aa29f6f380629ee2185cd10cad261f90bf4296dedf28c1410e303f5b697f5934ad308ba9dec2d776a44015c945bf57e2a3199a3c97c5381487a89cffb377dddfd9d1114924ae46685fe6e2f6a35d28e1fe58baf680cd816dcbab4229c4819077bfb06944a74de3646cbc1d81d37237868ede790c2006d7d7696e6f2cfd3d979724d3af7d2c9c04bed35b1fa7a716846eb7ce37a7daba2dd67c1280f6b9100804c2e1c2a90b809657333eaad9d1aa8163f07ef26f768f938b4b742f0f5c12a6db602729035a0f0b84e012bc86c0b5b5cacf1175fff6ffcf285c6238c56c728686edd9afe30bfc409b18a5c6e5a279eb8bf2d7a5e172bbbf9bac7b2be31386cb1310f2045d5bce82e7dee6140e63fdce5190c9c65dc6f8a6bb2a5eca63d0b3cf0684e98468c1529f1c6a4bf031be9b22dc7cc14a483e447cdcd0ab9cecf0070ba117533a1aefea7ebd2c58a2c2fc5882b78bdfdbb3520f44ad69e7483f4316a86f12c7bd10d2b46e56ef4d7dbb78a5be0c7cdf1c590d3ab729354f448068231654a034772ca368d437d93cad2136506b841f0d758bb5d33bf65bd11c4cb209b40692147d2977b1dda40d4bcb8efa162fa16984b33a55f0f03da3476a44de5680ff8a6e89ad283ada18976b15c4b3c0165671c701b9859cdf4092bd40adadc216ae41df82f912e64e9ad9022a8cb5a29ea2b7ac79dbc93661228a28d8e167c9a8cb934ca66d80353b38e687bb63a1f6174f4c77af2ba0e7afc63891e591799fb17f3f5fa73ba79ae8cd954362d65f9405c1c413d910f82e37a5c78cbaae8bcc8562d082231f4a8545c196bdbc3d9d01ce8ddaa354a78e6bd497ef9a00503f1269040946dbdc7b4d57bc341c5a7af380feafca611bddd815d92602607d8d693e53743c5f42e5ab219ec57fb59949c54faf2ae8577ea6332a46434ff67f125cc87b1283b6c40936537320ff8a9ec9c0aeeb456499e70c46759d5bc0579c977cd416eb924c6c427e0c93c0de270f425e814d6cd39e4457aeffb123a70c58bed78b8e68a62af51e33f7b626302e8bd34011636ef145e9a499d8e17c4d9ba130ed3a46ae5f2fc4813296fd60ee0ad71e9b184bf85391ebf3a8de6aa8ded19b8b966bd707be73c61db3dc72aa2d7c8b145556c6d47630f20ffd74a07e1300b122e90f410640206689169b0464246ce9a045786d644e2e888c70a0202593c52db33d525ec8e47bbb749ae5900922df6b9365592e5dd3c7fe45ddc5818759e0c8706aeeff34100494201820c8797db068127423eb5bb61a731071033629e0a333f87a46b400bf5310261a09b92d7d01bb8b9cf6fa6981f4ee08fb6a5afa7143c58750e0741397e3b320ff495a0392a8f7b4e2ffb05947858756e7cc775fdedb3f5cf55fc0f2dc1552ca02f919d5c7a96100db0fd0976d4815ec24b87c346fae422b8419710010267d82a584be94642c6eeb915bdef25377ad81f09fa7ce30fb617dc127a30f2e0fbb174a39d1aec77fc8b840def243b637fb8432371708a3ad39769a3f89e9f30e7327c84a16b2ac838a6ef8f782c7768055281793ba0ad5708030d21f6a1622927397ef81e6b6a2fcd4693db73bd85bc2699a1be42b22f803dfb18c87a2b8c735d5fdfe6b00c4e8f62456456a33bc9bdeabf4ced2adeed5617596d22b1b3170e932e8b2f029432fc5b722139c017816100b277d61a702f1f1fe8220e011dda7a1afb18fc4af05b2c56fa6ece7c95b8f3532ba304f41f83d686be4177f14faada58def3d1949414c878e37cddbd359be129a9b143bfbfed7c5a76c62e4adcc869d3384d8f71a3054cd8624507ac908c7d96a1a9b21a6294b89a4533e9c3853671b9e666fea05057e7cb130417692c20a3a335d727c2f2315fb90c966f38cd5db31ac6c2f945010e8baebc1046ffb970285bad92043d1c65fcb06dd2bdc07b5e3cc37446752fd1ae9da42826ac63244679f7e9bd2fc8abde55f2d4a238b6b1d2caf8a44cc76b8d3178955876b8139770b07c3fdcb629838075baab981f9565785081503a0a40bbb8513edf57e66133f5437ba9004a1cb77776d32b0cf37581dc994d1aabce9fe791691e4b0ea63db387a7236cf28229c00808986faab521f8222724fc28fd3fb2f163092d30fb1f67dc87127ef6fc0eb138637d1c1b01946a37b5dbd6fb1c4e32511c71bc6a545634bf11bdbc7e9db6a2f9231f46140c395f4390c3efce210f6686eae058eef6223299112d666a2d79bb8610a5f304b9dd01d122e91881863831a6de0c159029c45e35db5e74fae93aaf7581614b93409ea04bd4176cd025cc275bcb55b41ab512c44fdf2eef0c6d6db5f461bac47b69c270088c1f4dbd01e813bc001a34625e54104444c327783f4c994f8f83011e32d9c6108fc87590095843af586021e6f6ae86750a7ac1ffcd7381b2fb22ddd9cfa8f0e73ba6ce8559e1ad0149a375cf30b7abffaac39320ae667b2b36b6719c7eeaf51810151ccd85e8362d94bc461ff98390fbaec6b25fdf9c44084128cd6fae1a78388b645b99c9a384d1160f7c099c825d06cb9aed9dcb639bd38972532ba707bbb38244d3402b4de17ca8c57008e92f2e51e66c0c95e5dc70cb8bf45b2cf3024d4ba07612da516a46ba76257f3b63b19d6bd4e4bce7a13444d1739cc2bff4bfd5a13218a93f95bbdc67965d36cd0c72523eeda154876319ab6d592b95987af80e96f4e9374894a84c393c7809ed8bebe3bd43613170e901ce03d2f1529bfdcc6f4ca54906e8ba995d3b3d3c5e96b157807dc8a7313e4f2223c0869f055ca3a550b8e8ce41496619144e081a5b70f75bf0cdb2f5efb8f86dd084f7cca35f059b93c17ac58f0808e90f4460cca42c2bd3778bbd38a1c155cf594ec95a9f8640009d8040791b76d85d42d9567d4d2f0f0d4306bd9b5074f8eb6ab91402fb73419527be7783c908ce5dc31fdeb08901ccb238d3bd684732d1a051d5b5c5d73b369fa3e37058136e3cf252ac7d457447149686051aec0caf2273e4fb17d2acc72b2a5572a7629935ab0a90b05f0803ee6cd15c18692a846d498862b37f713a7c754b55c8edcf143b93878dabe06474defc1a877268d1ff56be75e7990f4bbb347a4f239d0a8be2fa1a953cff525df45dbb104015e2752f349990b608461d3b4ecdd6686908bc0468c685a0a0b79a9f56cb3e3a8ef6463bae7476c4e9f88112640f52a951af215aa4a8c9b8750fcd6d4cc42ed5b7f69e288b7d4dd25b7e9e9bd270a1e46a71056f5896cc9840fc310e76d02ae3dcb668bb8cdaeb3ed61396bb6b4727bc7775feb687569ad2bee65eea4f42f49c3b713f880d5e0c29740599d1937c19f164faf286faceb48ca55b8b217507c23d444517d88e14b146e14229839cc691db9b057d37a679716bc6ad836c1c791bd2471715a89ae06065804345bba8e50415a652630b9b5179c094dc12baee0d7b0a800db9478ffcb15da9e333030c9988ac46c2e3f05e66e8619933ac966389e5fba7a31c76edd3f6607c56564888c5432ff0dc7843fb75fe3d90a7a2961a148917c01842095781a7cfa99938753931651df928354ff7b0548dc129f7fc0f9bb4f2840d0593a6010ecab4cfc5c38ff213b46f08acdf7387b68094f3787225ccfa0f8b7d2677a366e7b1f3e9c772f2891f78e194d3a5713ce8d4320d960f36e485b14486a1c2ea4d6743d6928a172bfec6a44c0783987cbc037027bd2cd3a3252d6ca99a3048190ca32772bae3292f03264e12302559ab3fb720e64eb9457a55cf50f0432e40cbbc25949f489a17beec01bb4347d052609ca5d337626ed53eeb960c15648f823f6d672b9ede953f6c9d31d2b531eed78843b346acb113c0577dcd21a09543b47e61024761e51f4fc4a81b50db34f82d928f30764dc990c567b79ad215b4223b29e079b08bfe528c096b4343c24b67f0cdc6dd7526ded2a9567f4d877f87b9aba6aee872001cfc9922a59c835b3be58b380b4f1d4b13db7e2d6848233d39917ff46592b82a031594f1d739ff1eb8de7e86d9721194111aee0c65dce1b0f179ef354cd778408fb240ee49611cfe44a6e6c9f5a697be3a990241edf92cb54d19bd38def70dc9d1dbc7a2331227366725d8322773d2f496b7602024ce06f5f84daacfca75c21cdcd8bf2010605f41d9c4279eb4ba88c803e0db78288b1aa490a807342a8400ab5de4444534126b6b93b7\n  \n    \n      \n      \n        Hey, password is required here.\n      \n    \n  \n\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["Jenkins","Kubernetes"]},{"title":"ã€ä»£ç æ¨¡æ¿ã€‘äºŒç»´ç çš„ç”Ÿæˆ","url":"/posts/5ee0f6a5/","content":"\n\nå‰è¨€\nZXing æ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œç”¨ Java ç¼–å†™çš„å¤šæ ¼å¼çš„ 1D / 2D æ¡ç å›¾åƒå¤„ç†åº“ï¼Œä½¿ç”¨ ZXing å¯ä»¥ç”Ÿæˆã€è¯†åˆ« QR Codeï¼ˆäºŒç»´ç ï¼‰ã€‚å¸¸ç”¨çš„äºŒç»´ç å¤„ç†åº“è¿˜æœ‰ zbarï¼Œè¿‘å‡ å¹´å·²ç»ä¸å†æ›´æ–°ä»£ç ï¼Œä¸‹è¾¹ä»‹ç» ZXing ç”ŸæˆäºŒç»´ç çš„æ–¹æ³•ã€‚\n\n\næ›´æ–°\n\n\n24-06-28 åˆå§‹è®°å½•\n\nZXing\n\n\nå¼•å…¥ä¾èµ–\n\n\n&lt;!-- äºŒç»´ç ç”Ÿæˆ&amp;è¯†åˆ«ç»„ä»¶--&gt;  &lt;dependency&gt;      &lt;groupId&gt;com.google.zxing&lt;/groupId&gt;      &lt;artifactId&gt;core&lt;/artifactId&gt;      &lt;version&gt;3.3.3&lt;/version&gt;  &lt;/dependency&gt;  &lt;dependency&gt;      &lt;groupId&gt;com.google.zxing&lt;/groupId&gt;      &lt;artifactId&gt;javase&lt;/artifactId&gt;      &lt;version&gt;3.3.3&lt;/version&gt;  &lt;/dependency&gt;\n\n\nç”ŸæˆäºŒç»´ç æ–¹æ³•\n\n\npublic class QRCodeUtil &#123;      /**       * ç”ŸæˆäºŒç»´ç        *       * @param content äºŒç»´ç å¯¹åº”çš„URL       * @param width   äºŒç»´ç å›¾ç‰‡å®½åº¦       * @param height  äºŒç»´ç å›¾ç‰‡é«˜åº¦       * @return äºŒç»´ç äºŒè¿›åˆ¶æµ       */      public String createQRCode(String content, int width, int height) throws IOException &#123;          String resultImage = &quot;&quot;;          // é™¤äº†å°ºå¯¸ï¼Œä¼ å…¥å†…å®¹ä¸èƒ½ä¸ºç©º          if (!StringUtils.isEmpty(content)) &#123;              ServletOutputStream stream = null;              ByteArrayOutputStream os = new ByteArrayOutputStream();              // äºŒç»´ç å‚æ•°              @SuppressWarnings(&quot;rawtypes&quot;)              HashMap&lt;EncodeHintType, Comparable&gt; hints = new HashMap&lt;&gt;();              // æŒ‡å®šå­—ç¬¦ç¼–ç ä¸ºâ€œutf-8â€              hints.put(EncodeHintType.CHARACTER_SET, &quot;utf-8&quot;);              // L M Q Hå››ä¸ªçº é”™ç­‰çº§ä»ä½åˆ°é«˜ï¼ŒæŒ‡å®šäºŒç»´ç çš„çº é”™ç­‰çº§ä¸ºM              // çº é”™çº§åˆ«è¶Šé«˜ï¼Œå¯ä»¥ä¿®æ­£çš„é”™è¯¯å°±è¶Šå¤šï¼Œéœ€è¦çš„çº é”™ç çš„æ•°é‡ä¹Ÿå˜å¤šï¼Œç›¸åº”çš„äºŒç»´å—å¯å‚¨å­˜çš„æ•°æ®å°±ä¼šå‡å°‘              hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.M);              // è®¾ç½®å›¾ç‰‡çš„è¾¹è·              hints.put(EncodeHintType.MARGIN, 1);                try &#123;                  // zxingç”ŸæˆäºŒç»´ç æ ¸å¿ƒç±»                  QRCodeWriter writer = new QRCodeWriter();                  // æŠŠè¾“å…¥æ–‡æœ¬æŒ‰ç…§æŒ‡å®šè§„åˆ™è½¬æˆäºŒç»´å—                  BitMatrix bitMatrix = writer.encode(content, BarcodeFormat.QR_CODE, width, height, hints);                  // ç”ŸæˆäºŒç»´ç å›¾ç‰‡æµ                  BufferedImage bufferedImage = MatrixToImageWriter.toBufferedImage(bitMatrix);                  // è¾“å‡ºæµ                  ImageIO.write(bufferedImage, &quot;png&quot;, os);                  /**                   * åŸç”Ÿè½¬ç å‰é¢æ²¡æœ‰ data:image/png;base64 è¿™äº›å­—æ®µï¼Œè¿”å›ç»™å‰ç«¯æ˜¯æ— æ³•è¢«è§£æï¼Œæ‰€ä»¥åŠ ä¸Šå‰ç¼€                   */                  resultImage = new String(&quot;data:image/png;base64,&quot; + EncryptUtil.encodeBase64(os.toByteArray()));                  return resultImage;              &#125; catch (Exception e) &#123;                  e.printStackTrace();                  throw new BusinessException(CommonErrorCode.E_200007);              &#125; finally &#123;                  if (stream != null) &#123;                      stream.flush();                      stream.close();                  &#125;              &#125;          &#125;          return null;      &#125;  &#125;\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"]},{"title":"ã€ä»£ç æ¨¡æ¿ã€‘å»¶æ—¶ä»»åŠ¡","url":"/posts/f6ca592/","content":"\n\nå‰è¨€\n\n\n\nä¸šåŠ¡åœºæ™¯ï¼š\n1ã€ç”Ÿæˆè®¢å• 30 åˆ†é’Ÿæœªæ”¯ä»˜ï¼Œåˆ™è‡ªåŠ¨å–æ¶ˆï¼ˆå»¶æ—¶ä»»åŠ¡ï¼‰\n2ã€ç”Ÿæˆè®¢å• 60 ç§’åï¼Œç»™ç”¨æˆ·å‘çŸ­ä¿¡ï¼ˆå»¶æ—¶ä»»åŠ¡ï¼‰\nâ€¦\n\n\næ›´æ–°\n\n24-08-18 åˆå§‹è®°å½•ï¼ˆä»åŸå…ˆçš„ç¬”è®°è¿›è¡Œæ¬è¿ï¼‰\n\nå®šæ—¶ä»»åŠ¡ä¸å»¶æ—¶ä»»åŠ¡çš„åŒºåˆ«\n\n\nå®šæ—¶ä»»åŠ¡æœ‰æ˜ç¡®çš„è§¦å‘æ—¶é—´ï¼Œå»¶æ—¶ä»»åŠ¡æ²¡æœ‰\n\n\nå®šæ—¶ä»»åŠ¡æœ‰æ‰§è¡Œå‘¨æœŸï¼Œè€Œå»¶æ—¶ä»»åŠ¡åœ¨æŸäº‹ä»¶è§¦å‘åä¸€æ®µæ—¶é—´å†…æ‰§è¡Œï¼Œæ²¡æœ‰æ‰§è¡Œå‘¨æœŸ\n\n\nå®šæ—¶ä»»åŠ¡ä¸€èˆ¬æ‰§è¡Œçš„æ˜¯æ‰¹å¤„ç†æ“ä½œæ˜¯å¤šä¸ªä»»åŠ¡ï¼Œè€Œå»¶æ—¶ä»»åŠ¡ä¸€èˆ¬æ˜¯å•ä¸ªä»»åŠ¡\n\n\nè§£å†³æ€è·¯\næ•°æ®åº“å®šæ—¶è½®è¯¢ï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰\n\né€šå¸¸åœ¨å°å‹é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œå³é€šè¿‡ä¸€ä¸ªçº¿ç¨‹å®šæ—¶çš„å»æ‰«ææ•°æ®åº“ï¼Œé€šè¿‡è®¢å•æ—¶é—´æ¥åˆ¤æ–­æ˜¯å¦æœ‰è¶…æ—¶çš„è®¢å•ï¼Œç„¶åè¿›è¡Œ update æˆ– delete ç­‰æ“ä½œã€‚\n\nå®ç°\né€šè¿‡ springBoot ä¸­çš„@Schedule è¿›è¡Œå®ç°\næ­¥éª¤\n\n\nåœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£@EnableScheduling\n\n\n@SpringBootApplication  @EnableScheduling  public class ScheduleAppcation &#123;      public static void main(String[] args) &#123;          SpringApplication.run(ScheduleAppcation.class, args);      &#125;  &#125;\n\n\nåœ¨ç›®æ ‡ç±»ä¸Šæ·»åŠ æ³¨è§£\n\n\n// ç›®æ ‡ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå»¶è¿Ÿ10sæ‰§è¡Œã€‚@Scheduled(fixedDelay = 10 * 1000)  public void testJob01() &#123;\t...&#125;\n// cronè¡¨è¾¾å¼@Scheduled(cron = &quot;0 0 6 * * ?&quot;)  public void testJob01() &#123;\t...&#125;\nä¼˜ç¼ºç‚¹\n\n\nå­˜åœ¨å»¶æ—¶ï¼Œå®šæ—¶ä»»åŠ¡é»˜è®¤æ˜¯å•çº¿ç¨‹æ‰§è¡Œï¼Œå‰ä¸€ä¸ªä»»åŠ¡é˜»å¡ä¼šå½±å“åä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œ\n\n\næ•°æ®åº“æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹ï¼Œæ‰«ææŸè€—å·¨å¤§\n\n\nJDK çš„å»¶è¿Ÿé˜Ÿåˆ—\n\nè¯¥æ–¹æ¡ˆæ˜¯åˆ©ç”¨ JDK è‡ªå¸¦çš„ DelayQueue æ¥å®ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—åªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡çš„æ—¶å€™æ‰èƒ½ä»ä¸­è·å–å…ƒç´ ï¼Œæ”¾å…¥ DelayQueue ä¸­çš„å¯¹è±¡ï¼Œæ˜¯å¿…é¡»å®ç° Delayed æ¥å£çš„ã€‚\n\nDelayQueue å±äºæ’åºé˜Ÿåˆ—ï¼Œå®ƒçš„ç‰¹æ®Šä¹‹å¤„åœ¨äºé˜Ÿåˆ—çš„å…ƒç´ å¿…é¡»å®ç° Delayed æ¥å£ï¼Œè¯¥æ¥å£éœ€è¦å®ç° compareTo å’Œ getDelay æ–¹æ³•\ngetDelay æ–¹æ³•ï¼šè·å–å…ƒç´ åœ¨é˜Ÿåˆ—ä¸­çš„å‰©ä½™æ—¶é—´ï¼Œåªæœ‰å½“å‰©ä½™æ—¶é—´ä¸º 0 æ—¶å…ƒç´ æ‰å¯ä»¥å‡ºé˜Ÿåˆ—ã€‚\ncompareTo æ–¹æ³•ï¼šç”¨äºæ’åºï¼Œç¡®å®šå…ƒç´ å‡ºé˜Ÿåˆ—çš„é¡ºåºã€‚\nå®ç°\nåˆ©ç”¨ JDK è‡ªå¸¦çš„ DelayQueue æ¥å®ç°\næ­¥éª¤\n\n\nåœ¨æµ‹è¯•åŒ… jdk ä¸‹åˆ›å»ºå»¶è¿Ÿä»»åŠ¡å…ƒç´ å¯¹è±¡ DelayedTaskï¼Œå®ç° compareTo å’Œ getDelay æ–¹æ³•\n\n\npublic class DelayedTask  implements Delayed&#123;        // ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´    private int executeTime = 0;        public DelayedTask(int delay)&#123;        Calendar calendar = Calendar.getInstance();        calendar.add(Calendar.SECOND,delay);        this.executeTime = (int)(calendar.getTimeInMillis() /1000 );    &#125;    /**     * å…ƒç´ åœ¨é˜Ÿåˆ—ä¸­çš„å‰©ä½™æ—¶é—´     * @param unit     * @return     */    @Override    public long getDelay(TimeUnit unit) &#123;        Calendar calendar = Calendar.getInstance();        return executeTime - (calendar.getTimeInMillis()/1000);    &#125;    /**     * å…ƒç´ æ’åº     * @param o     * @return     */    @Override    public int compareTo(Delayed o) &#123;        long val = this.getDelay(TimeUnit.NANOSECONDS) - o.getDelay(TimeUnit.NANOSECONDS);        return val == 0 ? 0 : ( val &lt; 0 ? -1: 1 );    &#125;&#125;\n\n\nåœ¨ main æ–¹æ³•ä¸­åˆ›å»º DelayQueue å¹¶å‘å»¶è¿Ÿé˜Ÿåˆ—ä¸­æ·»åŠ ä¸‰ä¸ªå»¶è¿Ÿä»»åŠ¡\n\n\nå¾ªç¯çš„ä»å»¶è¿Ÿé˜Ÿåˆ—ä¸­æ‹‰å–ä»»åŠ¡\n\n\npublic static void main(String[] args) &#123;\tDelayQueue&lt;DelayedTask&gt; queue = new DelayQueue&lt;DelayedTask&gt;();\t\tqueue.add(new DelayedTask(5));\tqueue.add(new DelayedTask(10));\tqueue.add(new DelayedTask(15));\tSystem.out.println(System.currentTimeMillis()/1000+&quot; start consume &quot;);\twhile(queue.size() != 0)&#123;\t\tDelayedTask delayedTask = queue.poll();\t\tif(delayedTask !=null )&#123;\t\t\tSystem.out.println(System.currentTimeMillis()/1000+&quot; cosume task&quot;);\t\t&#125;\t\t//æ¯éš”ä¸€ç§’æ¶ˆè´¹ä¸€æ¬¡\t\ttry &#123;\t\t\tThread.sleep(1000);\t\t&#125; catch (InterruptedException e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;     &#125;\nä¼˜ç¼ºç‚¹\n\n\næ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå®¹æ˜“å‡ºç° OOMï¼ˆOut Of Memoryï¼‰å¼‚å¸¸\n\n\næœåŠ¡å™¨å®•æœºåï¼Œå†…å­˜ä¸­çš„æ•°æ®å®¹æ˜“ä¸¢å¤±\n\n\nRedis ç¼“å­˜\nå®ç°\nåˆ©ç”¨ Redis ä¸­ Key çš„è¿‡æœŸæ—¶é—´\næ­¥éª¤\n\n\nç»™ Redis ä¸­ Key è®¾ç½®è¿‡æœŸæ—¶é—´\n\n\nç›‘å¬ Redis ä¸­ Key è¿‡æœŸäº‹ä»¶\n\n\nè·å–è¿‡æœŸ Key å¯¹åº”çš„å€¼è¿›è¡Œæ¶ˆè´¹\n\nè¿‡æœŸ Key æ‹¿ä¸åˆ°å€¼\n\nå¯ä»¥æŠŠä¿¡æ¯å­˜å‚¨åˆ° Key ä¸Šï¼ˆç›‘å¬äº‹ä»¶å¯ä»¥è·å–åˆ°å³å°†è¿‡æœŸçš„ keyï¼Œå¯ä»¥å°†æ–‡ç«  id å­˜å‚¨åˆ° redis ä¸­ï¼‰\nå­˜å‚¨ä¸€ä»½ä¸è¿‡æœŸçš„å¯¹åº” Keyï¼Œåœ¨ Key è¿‡æœŸæ—¶è·å–è¿™ä¸ªä¸è¿‡æœŸ Key å–å€¼å†åˆ é™¤\n\n\n\n\n\nä¼˜ç¼ºç‚¹\n\n\nè‹¥ Redis ç›‘å¬è¿‡æœŸ Key çš„å¾®æœåŠ¡æ˜¯å¤šä¸ªé›†ç¾¤æ—¶ï¼Œåªèƒ½æœ‰ä¸€ä¸ªå¾®æœåŠ¡å¤„ç†ï¼Œéœ€è¦å¼•å…¥åˆ†å¸ƒå¼é”ï¼Œæ€§èƒ½ä¼šä¸‹é™ã€‚\n\n\npackage com.heima.common.redislock;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.data.redis.core.StringRedisTemplate;import java.util.UUID;import java.util.concurrent.TimeUnit;public class RedisLockImpl implements RedisLock &#123;\t@Autowired\tprivate StringRedisTemplate stringRedisTemplate;\tprivate ThreadLocal&lt;String&gt; threadLocal = new ThreadLocal&lt;String&gt;();\tprivate ThreadLocal&lt;Integer&gt; threadLocalInteger = new ThreadLocal&lt;Integer&gt;();\t\t@Override\tpublic boolean tryLock(String key, long timeout, TimeUnit unit) &#123;\t\tBoolean isLocked = false;\t\tif (threadLocal.get() == null) &#123;\t\t\tString uuid = UUID.randomUUID().toString();\t\t\tthreadLocal.set(uuid);\t\t\tisLocked = stringRedisTemplate.opsForValue().setIfAbsent(key, uuid, timeout, unit);\t\t&#125; else &#123;\t\t\tisLocked = true;\t\t&#125;\t\t// é‡å…¥æ¬¡æ•°åŠ 1\t\tif (isLocked) &#123;\t\t\tInteger count = threadLocalInteger.get() == null ? 0 : threadLocalInteger.get();\t\t\tthreadLocalInteger.set(count++);\t\t&#125;\t\t\treturn isLocked;\t&#125;\t@Override\tpublic void releaseLock(String key) &#123;\t\t// åˆ¤æ–­å½“å‰çº¿ç¨‹æ‰€å¯¹åº”çš„uuidæ˜¯å¦ä¸Rediså¯¹åº”çš„uuidç›¸åŒï¼Œå†æ‰§è¡Œåˆ é™¤é”æ“ä½œ\t\tif (threadLocal.get().equals(stringRedisTemplate.opsForValue().get(key))) &#123;\t\t\tInteger count = threadLocalInteger.get();\t\t\t// è®¡æ•°å™¨å‡ä¸º0æ—¶æ‰èƒ½é‡Šæ”¾é”\t\t\tif (count == null || --count &lt;= 0) &#123;\t\t\t\tstringRedisTemplate.delete(key);\t\t\t&#125;\t\t&#125;\t&#125;&#125;\nä½¿ç”¨ MQ å®ç°å»¶æ—¶ä»»åŠ¡\nå®ç°\n\nå†…é“¾ï¼š[[æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰å‹ä¸ä¼˜ç¼ºç‚¹]]\nå¤–é“¾ï¼šæ¶ˆæ¯é˜Ÿåˆ—çš„é€‰å‹ä¸ä¼˜ç¼ºç‚¹\n\nä¼˜ç¼ºç‚¹\n\n\né«˜æ•ˆï¼Œå¯ä»¥åˆ©ç”¨ MQ çš„åˆ†å¸ƒå¼ç‰¹æ€§è½»æ˜“çš„è¿›è¡Œæ¨ªå‘æ‰©å±•ï¼Œæ¶ˆæ¯æ”¯æŒæŒä¹…åŒ–å¢åŠ äº†å¯é æ€§ã€‚\n\n\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"]},{"title":"ã€ä»£ç æ¨¡æ¿ã€‘é˜¿é‡Œäº‘æ¥å£å®ç°çŸ­ä¿¡å‘é€","url":"/posts/9b7300f0/","content":"\n\nå‰è¨€é˜¿é‡Œäº‘æ¥å£å®ç°çŸ­ä¿¡å‘é€ã€‚\n\n\næ›´æ–°\n\n\n24.05.24 åˆå§‹è®°å½•\n\nä¾èµ–\n&lt;!--smséªŒè¯æœåŠ¡--&gt;  &lt;dependency&gt;      &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;      &lt;artifactId&gt;spring-cloud-alicloud-sms&lt;/artifactId&gt;      &lt;version&gt;2.2.0.RELEASE&lt;/version&gt;  &lt;/dependency&gt;\nä»£ç \n\n\nService ä¸­è¦æ·»åŠ çš„ä»£ç \n\n\n@Override  public Boolean sendCode(String phone) &#123;      //éç©ºæ ¡éªŒ      if (Strings.isNullOrEmpty(phone)) &#123;          throw new LogicException(&quot;æ‰‹æœºå·ä¸ºç©º&quot;);      &#125;        StringBuilder sbCode = new StringBuilder();      // 6ä½éšæœºå¯†ç     Stream.generate(() -&gt; new Random().nextInt(10))              .limit(6)              .forEach(sbCode::append);      //å°†éªŒè¯ç æ”¾å…¥redis, 5åˆ†é’Ÿè¿‡æœŸ      redisTemplate.opsForValue().set(phone, sbCode.toString(), Duration.ofMinutes(5));      log.info(&quot;çŸ­ä¿¡éªŒè¯ç ï¼š&quot; + sbCode.toString());      return smsSender.sendMsg(phone, sbCode.toString());  &#125;   \n\n\nSmsConfig.java\n\n\n@Configuration  @RefreshScope  public class SmsConfig &#123;      @Value(&quot;$&#123;sms.operator.signName&#125;&quot;)      private String signName;      @Value(&quot;$&#123;sms.operator.templateCode&#125;&quot;)      private String templateCode;        public String getSignName() &#123;          return signName;      &#125;        public String getTemplateCode() &#123;          return templateCode;      &#125;  &#125;\n\n\né…ç½®æ–‡ä»¶ä¸­æ·»åŠ \n\n\nsms:  operator:    signName: ä½ çš„signName    templateCode: ä½ çš„templateCode  \n\n\nSmsSender.java\n\n\n@Component  @Slf4j  public class SmsSender &#123;      @Autowired      private SmsConfig smsConfig;      @Autowired      private ISmsService smsService;        /**       * å‘é€éªŒè¯ç çŸ­ä¿¡       *       * @param telephone æ‰‹æœºå·       * @param code     æ‰‹æœºéªŒè¯ç        */      public boolean sendMsg(String telephone, String code) &#123;          SendSmsRequest request = new SendSmsRequest();            request.setPhoneNumbers(telephone);          request.setSignName(smsConfig.getSignName());          request.setTemplateCode(smsConfig.getTemplateCode());          ObjectMapper mapper = new ObjectMapper();          JsonNode rootNode = mapper.createObjectNode();          // å­˜å…¥éªŒè¯ç           ((ObjectNode) rootNode).put(&quot;code&quot;, code);            try &#123;              request.setTemplateParam(mapper.writeValueAsString(rootNode));              val sendSmsResponse = smsService.sendSmsRequest(request);              log.info(&quot;çŸ­ä¿¡å‘é€æ¥æ”¶ï¼š&quot; + JSONUtil.toJsonPrettyStr(sendSmsResponse));              if (sendSmsResponse.getCode() != null &amp;&amp; &quot;OK&quot;.equals(sendSmsResponse.getCode())) &#123;                  return true;              &#125; else &#123;                  throw new LogicException(&quot;éªŒè¯ç å‘é€å¤±è´¥ï¼š&quot; + sendSmsResponse.getMessage());              &#125;          &#125; catch (Exception e) &#123;              log.error(&quot;send sms error.&quot; + e.getMessage());              val operLog = OperLog.builder().title(&quot;å‘é€éªŒè¯ç &quot;)                      .businessType(BusinessType.OTHER.ordinal())                      .operParam(JSONUtil.toJsonPrettyStr(request))                      .status(BusinessStatus.FAIL.ordinal())                      .errorMsg(e.getMessage())                      .build();              AsyncManager.me().execute(AsyncFactory.recordOper(operLog));              throw new LogicException(&quot;éªŒè¯ç å‘é€å¤±è´¥&quot;);          &#125;      &#125;  &#125;\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["Java","ä»£ç æ¨¡æ¿"]},{"title":"æ¶ˆæ¯å¹³å°-é¡¹ç›®ä»‹ç»","url":"/posts/2b76eac7/","content":"\n\nå‰è¨€æ–°é¡¹ç›®å­¦ä¹ ç¬”è®°ã€‚\né¡¹ç›® git åœ°å€ï¼šhttps://gitee.com/zhongfucheng/austin.git\nå‰ç«¯é¡¹ç›® git åœ°å€ï¼šhttps://gitee.com/zhongfucheng/austin-admin\n\n\næ›´æ–°\n\n\n24-09-10 åˆå§‹è®°å½•\n\né¡¹ç›®æ¦‚è¿°\naustin é¡¹ç›®æ˜¯æ¶ˆæ¯æ¨é€å¹³å°çš„å®ç°ï¼Œå®ƒçš„æ ¸å¿ƒåŠŸèƒ½ï¼šç»Ÿä¸€çš„æ¥å£å‘é€å„ç§ç±»å‹æ¶ˆæ¯ï¼Œå¯¹æ¶ˆæ¯ç”Ÿå‘½å‘¨æœŸå…¨é“¾è·¯è¿½è¸ª\nç³»ç»Ÿé¡¹ç›®æ¶æ„\n\n\n\nå·¥ç¨‹æ¨¡å—\nä½œç”¨\n\n\n\n\naustin-common\né¡¹ç›®å…¬å…±åŒ…ï¼šå­˜å‚¨ç€é¡¹ç›®å…¬å…±å¸¸é‡/æšä¸¾/Bean\n\n\naustin-support\né¡¹ç›®å·¥å…·åŒ…ï¼šå¯¹æ¥ ä¸­é—´ä»¶/ç»„ä»¶\n\n\naustin-cron\nå®šæ—¶ä»»åŠ¡æ¨¡å—ï¼šå¯¹ xxl-job å°è£…å’Œé¡¹ç›®å®šæ—¶ä»»åŠ¡é€»è¾‘\n\n\naustin-web\nåå°ç®¡ç†æ¨¡å—ï¼šæä¾›æ¥å£ç»™å‰ç«¯è°ƒç”¨\n\n\naustin-service-api\næ¶ˆæ¯æ¥å…¥å±‚æ¥å£å®šä¹‰æ¨¡å—ï¼šåªæœ‰æ¥å£å’Œå¿…è¦çš„å…¥å‚ä¾èµ–\n\n\naustin-service-api-impl\næ¶ˆæ¯æ¥å…¥å±‚å…·ä½“å®ç°æ¨¡ å—ï¼š çœŸå®å¤„ç†è¯·æ±‚\n\n\naustin-handler\næ¶ˆæ¯å¤„ç†é€»è¾‘å±‚ï¼šæ¶ˆè´¹ MQ ä¸‹å‘æ¶ˆæ¯\n\n\naustin-stream\nå®æ—¶å¤„ç†æ¨¡å—ï¼šåˆ©ç”¨ flink å®æ—¶å¤„ç†ä¸‹å‘é“¾è·¯æ•°æ®\n\n\naustin-data-house\næ•°æ®ä»“åº“æ¨¡å—ï¼šæ¶ˆè´¹ MQ æ•°æ®å†™å…¥ hive\n\n\n\n\n","categories":["åç«¯é¡¹ç›®","æ¶ˆæ¯å¹³å°"]},{"title":"æ¶ˆæ¯å¹³å°-æ ¸å¿ƒä»£ç ","url":"/posts/4f08dd5e/","content":"\n  665b6e36e8990f013070faca4228a0bfccd399cf756e12c68920c56ce8b4287efa95190af6d6209f579011876b8fa876e0bc2b631d0e227bd44e7792f33fee40dad7ec9375821980e8a38f95ea5d6068fdf072be6dfe9835ac738acc08e2b8652b180e2dd198205612d8298c4f272fd39d8b30f53e63690c16fcccbf7eb6681a06e2642eec08adebbadb213c7dc237ff929bcabc17115cc10f4c5b4fc9aebc200fcf18916cd0aa57c6fb3203481a404b20c9e749b4522858fd75b824a8d59085a8ff9aa5ac41736ec8bc70d688f60a680638bf018dfefb1aed5fcc8183305a1949ab59168a4f805b4f859b8d4abb0aa19d5350b9470b7e4294183d018170e370a50f3952ceb065205db3fc33e14948daed0c356cc17650a6c7a9419d7ee11733285d9eb5cad2707de7edd63077c83910eb31de24e59915023fbdd333f7e3e35274c9950f8040a4d6571439555b3a21d2788d20a3fdca53de945cd871b0259a628d9615216526851b256afba7af06012e061e0831b0b2518690ae131328d27ca09dcf341a435579cb6e4e24a6b9c75c7f4274bcac486648b2b1d63adc9e7aecaa650321e1e38f934db2cd86468a3d3bf7468a5b755aaf749570d84da015a1d83ccc336920871daf7d7dcff045fa0c4afc809b7950819dd93f1c57d4e61552acd3a7178057c69b7679a1728e909efb96cb5543a8fe9cf0cecf62c0a5c39b00bbcfbb8f5c074db648c3799d6fdd2d73b224a4a50efbf5fff9e0af0e71da9dba7630beab7d1626eea2c5dbe30ad253bff8ea06006d99368c8b76b2ba8178173c288d40abe7d384549db225e9aa4d2b7eb103e0e791afcee8a55ce3dcbd9d1b3fa5f64e6e4fc22b633663d9a1f9654e1b9c4112631034edda784c698b4de90f6e09e19c7809d54c2ca4a78ad10488d152c8053e91491902eda5af2f936a73497673141428f19a4f732c8f714dd425a595ded08c5fdee561b7aad0f595359535247690e159b2af36d831a5704e7e7dbcbf22bd325be89e6544a9c6d23ad0ac1be78744df3fe61ad12e48f3f7cb940c87b5549dc8ac7f8e76b819663b3688f04dd09becce536b8e86374e93186024c2f1eedb6f84f3a3bb39fbaddd9766f456925075bb1156ad99221682ecb275d0c335495a796389250cdd8fff406bb0f4fba8975d104b57322b05ae57bc0c5587a56f4054c3b611971411ac2e4467344c46ddd858be2b3cce107bad61a8679f5df2b2be2233f1e430644771869ec07756688473217662ad5186f7ac23b896395a9b7ef4a3a9e47b3befd5b50ac9c36875eaf82247674ca676a309f2047a97f041416bd13d3c8b5ab78c56e839e274889ddbb99387dd327c77235435cda782667decd07361bdc1fbd87718dca038082483c9ef603f60c7c62c8df248df5bd4ba2060c9846555e77ee39d7fb29793da5e01b3a6c6cddc043ce71529107ad2dad9ee30dc5f601f234594f6e046a00d84fb0d4f5e343247afba7adf4c30a6f4cf281ccf6cf4710217b4c075d3ce956a4e6b633ba3af167ea3d8554962ac73b726016accf287bd3c4a54fcf65e00274a363bd64dcba23ae96befc2e2b2808a9696bf34d3cd2781754ce0bfba2e1b2668a4f82e718e4cbeb54a1db7212f522916b65ea0f5ae1b40f115dca4c42641123213d8b870689cbd7e216c2e1b209dd24e239b76449a88bda48fabe4cfed3bcaf9ae64270e8530774eb7d13c07ade02a25e7c113c657d78a59c01c33a30b4dc2626d9295a5a9445f1cc5b86bcdc4c58fd1ff29b2644a4fe6af281e9781a5cc3a99dddd1064ecf45419abe61f1aec206f01b74b76728a4a2e4425844e92052816d33c90bc0428ecb2ac183f3d6626fb65b48ad90b00740a368a846093ce8b667b529a337da2cac8cba8c9816649b25fb9bc2b23a90aa3852ab1b5e8de8fc926a1921a42b471ce2bfc41584a47881c7b85c72ac83fd5373a155c6285fd0e08df65fb90e239f83d1c3c1795d018515513122169e4b89690dd2e128bbb3622d232edb14ededea5f9405dd43ad0f69d2ed176150ab3caee7c4c4b9fab331a9f06916123c28107c580440bb367d50f48b21222aa6051177fe90cbef3801e8a65977e5acd80a1b7d55c30c3765d34c636ee94a5c455aaa12720ea4af635aa77875219cf85a4e1136dece1c4d733da25d4c4a3bc38c55bfabe2eb51e5a01a7807f3f8ad25ffb97383f9eab3ee47c1bf3d39fe6922e7370b4e57420ea942ba9912516f2306be1f9426f2b5712279870b0855c7e6422bdc51ac98957598e90120fdf44cd7edf363bb6cd7111cab2c8633deeb55b304dca9b1197726b231aee9c57c8de7a6f2a849504c0a8e578d50e370e38a5fc57161f568cddcd43a9532a013a6e2577ed17eaa5f7b8f7977dfeca84cf72c1c1680aa05ff002f4acbac273fba9fc9e8f2c05587b42eb2a029ff617a209e001352bf2c63c2f3d904ff2a1269513d805f92d1f95b2eb682690c666f3d7c0fc6475e8d5eb878e3da4f9ebbe5755952fed078a1dbe0e30ae5eeeeb996dd5ab6483e82f3829dfbef027e2d0749a16d183ba480513178a892e3812a00a63d45756726925d55cf047e0aad0a718b67994705c8c87562a5e507cdb84bafa3de033558679f02760af75eed436887a92ec27265335cf816aec6f4e28fab17a664ef55cc27973455740e58fbc930ff07621999d8e51651ee5a42dc901062490da04f05a1ed1b277ab9f9a83022e1868917c7101d7b01beb58fd4c11c40281c88fa9bd4b574d6e7e350afef2fb0f7b9a3cf6db8c3c67286551e2b20fa8448e5a0fb57122dcc5e1bf376800f350243f6800e37b815e5b6bfcfcb31a00ae9b9755f42c52b13ba852018461fd58dac3e915f41155f4514e694a722d8bb2bb2f58caa18edad27a96a6b430a57bd90f5d778c13559c18a9e44e7f8956292136832828b2758df4b27fd1a9d5a87e7fed54bc49fae2698aa7b8b36d8c8a9142b4f1591e7d85ff0609546a44de7f072d3e9cb2e340553ac920fbafa541f26527ce2c5af531d9e4db41342f375b6ad3f20169d165af1899972b75ed4626a7c9b6fcca190fdd69f59a43b7aed8740289f389976f30435e88f17ec1e7c6dc15c6529d3afad84fc9076dff42247c1c9b552279c6d8fafb3866442b75c6db5d5eb3b8c66f417803323ac2e7b490a96c1b8d43d36fef5caef7f76edfba680decb2dd01ade6859ee0e62a966feea367a80bc1663d0739c2caafd8f566a458891fec8575768ea6670de80b1191ff24ed55122338e0bcf6f76709e4917a098acf93958c4456184d80e790a038b2a4f6abae701480295771d71761416e8b094268ff1d2503b935ea4c524aeb47bf3ba1d197262b5306a6d15b02fb5f01a1532044311963b3f3cf07c0deee4c2ab9d03e72a849be4aca4e2a45f412a3ae351b7dd3e3bb93331bb9940d\n  \n    \n      \n      \n        Hey, password is required here.\n      \n    \n  \n\n","categories":["åç«¯é¡¹ç›®","æ¶ˆæ¯å¹³å°"],"tags":["Java"]},{"title":"æ¶ˆæ¯å¹³å°-æ ¸å¿ƒæ–‡æ¡£","url":"/posts/d978b51b/","content":"\n  75e86ac553190f42ebdd56fafb303e85dc6a1a1a46f0acebaf1f04073eb758dc03ced5e004cf01aca104fdc62a8d68e601b59b3212abdab62d5f768d15cfa18c332989279c5f056126be2ebf5e2b3ce3c9aeeebb8e1e27a7209ae5ef44a58468afee8f711fe819700b0f6de40aa5cd11a0f68cf099f9875ce5d3c113175d0e316d43438e034cc9f1ae0301edf1d9428fd136db5d3f27ac447de92039f0eb1ca246fbafc11d70b0c340bb41c758ceb2b2c39454755e85eba1b7bd59de454695259f7d9cfa8db6039421353a6be2676b54e64ece29430084b53f318e40f38b763adb319c0c599ee0187bcc11f4303fa978fb485dbfc8f947cfcd5b4679740c807c195d192b34cec54663145ce587bf43eacb6f4c2a87dd87e14c74093c12ec9c490087f040a9a452a6cd709be06c4ebda59ceb8ee75c348ea1d5ffb61d74307a6ad7b241a89b28bdf168b043f5ddb6999731df162df074c979d4e08508de1dbbcd8497df48cd5235bea17ec990572904bcb0ac6a2a7100bc448597d1b51c3e775a57ec36820f6f8f174362f72abd2d9623d6db315ccb3f6f12803d2a691851555246bb24ad11647136254cd31c13f89b6df8a5043809af0b3b6d1e01c73c8f860a8c37582a7985c94d445546bf72f75adf1340d6599310a20c2c20582295583d1ca64fd5ebf097ebb91dde9d3180bcbb6a7b9139d1893c09d12db952b61184de93ca34c36fecebd5932c81ae55f95a6f4ca74e8fb0f3441b3c7480bd2e1405d68e67135a237a92aa157c9423ca0e7d115419723b1e870152f7a326670e59b871daad2d38af4149191937327ff9ccaad5e66c389efe894b71ff963dfad9ca98822a05c67573d72c4bd0275993c4235fb26aed1c13c0668b6031db1b4ff27b540a6f30b9bccd769c7b410eec83a90a0e11eec29b775fa43b66e57432b3b4fdc6ee2807691b868548d39060e67e6a991a292cb85d47e08ffb903d1b94e7c68f47d604a58d99649bba8d78e3e9807f52dd4a4489274de5ed20026d180d84fc7ff30e6d72e69da150631eb17d36b66f1f104e3504a25e94cee20fa0d0bf3b887d1906127622f586fac1958c0e67c074a8c4c5b179ac480c275a5a1ddf7a292467758e71f6cf16c6849f2f2e5815bfba33a4820e5c95424e66dc45d317a95f66b2f39f2084dcea51b1e99345d3e6e864902533229a56e2aeb17125dbd038116ebd1cf64fc66cd8f562cc73bff28e0206d304c63e700b8bfb8f157fcc552c367568b42f5edc8aa4af901f2f1f2199331178c844722cd4fe001d5266308b743d389dab012ee19a414f97915718613e7be7ac22746d30c95a06b17f2a1c444934b8480dd07041cd643d0444f9ba9d6e66cd6b0bba25c5855bee4a413d48eb012b4c05d7f6619508f6b3fc6602965582767be5f44070c525a50a2fff69a2d9816d736d3605f6d5728784d7b83e7bc6ba6e6f3bc77ac289934a3bfb99b5106e306f5878396738551e4abe7ecd9e1168a32ba97fd13d4ccd73eb98b0b8cc4cbca9ef2912107dd891766bf43fce6014457dc7872ca397834ca735e0a25abe701b74feb02543546adec2413d5ae389fb9de21f7a6859f0564df8877c18ff12b14b6ddbbb2db7a2b10f9aede01750337badfdebb6ae178bb29b8e95a09d627a5572c738510f18c5f05257bc67edc5f6c5880a146d7496a18e2b04962045c09511f3b5e75ca0a50adb2091b18fdbc8a7366ba15df55f85ffd0491b1013dabacc9098fc073be2de988cff20587cb921f1a2df22600e1167d8a346d989b3a8c2f883de2568798d295fdf10f0bead231ea1aeb018b7a3ebf9906e9aba3e3aa9844c29bad5aa2a3b2a7761\n  \n    \n      \n      \n        Hey, password is required here.\n      \n    \n  \n\n","categories":["åç«¯é¡¹ç›®","æ¶ˆæ¯å¹³å°"],"tags":["Java"]},{"title":"é¢è¯•-æ€»è§ˆ","url":"/posts/b567f09b/","content":"\n\nå‰è¨€\nè¿™ä¸ªéƒ¨åˆ†ä½œä¸ºä¸€ä¸ªèƒŒé¢˜æ‰“å¡ Listã€‚å±•ç¤ºé¢è¯•å‰å¿…é¡»æŒæ¡çš„ä¸œè¥¿ã€‚\n// todo ç¬¬ä¸‰å­£ è§†é¢‘ 71-92 æ²¡æœ‰çœ‹\n\n\næ›´æ–°\n\n\n24.06.02 åˆå§‹è®°å½•\n\nArrayList\n\n\nä»€ä¹ˆæ˜¯åŒå‘é“¾è¡¨\n\n\nåº•å±‚åŸç†\n\n\nå’Œ LinkedList çš„åŒºåˆ«\n\n\nçº¿ç¨‹ä¸å®‰å…¨å¦‚ä½•è§£å†³\n\n\nHashMap\n\n\nput çš„è¿‡ç¨‹\n\n\nå¤´æ’æ³•å’Œå°¾æ’æ³•çš„åŒºåˆ«\n\n\n1.7 å’Œ 1.8 çš„æ‰©å®¹æœºåˆ¶\n\n\né“¾è¡¨å’Œçº¢é»‘æ ‘çš„è½¬åŒ–è¿‡ç¨‹\n\n\nçº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜ (è§£å†³æ–¹æ¡ˆ)\n\n\nConcurrentHashMap çš„ 1.7 å’Œ 1.8 åŸç†å’ŒåŒºåˆ«\n\n\nå¤šçº¿ç¨‹\n\n\nå®ç°æ–¹å¼ï¼Œæ¯ç§å®ç°æ–¹å¼çš„åŒºåˆ«\n\n\nVolatile å…³é”®å­—\n\n\nCAS è‡ªæ—‹é”\n\n\nLock é”æ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”\n\n\nä½ äº†è§£ AQS æœºåˆ¶å®ƒçš„æ ¸å¿ƒåŸç†æ˜¯ä»€ä¹ˆ\n\n\nå…¬å¹³é”ï¼Œéå…¬å¹³é”ï¼Œåå‘é”ï¼Œè½»é‡é”\n\n\nçº¿ç¨‹çš„ 6 ç§çŠ¶æ€\n\n\nçº¿ç¨‹æ± çš„ 7 å¤§æ ¸å¿ƒå‚æ•°\n\n\n4 ä¸ªæ‹’ç»ç­–ç•¥\n\n\nçº¿ç¨‹æ± å¤šçº¿ç¨‹çš„æ‰§è¡Œæµç¨‹\n\n\nçº¿ç¨‹æ± çš„å¸¸ç”¨å®ç°æ–¹æ³•\n\n\nThreadLocal çš„åŸç†\n\n\nJVM\n\n\nè¯´ä¸€ä¸‹ JVM çš„ä¸»è¦ç»„æˆéƒ¨åˆ†åŠå…¶ä½œç”¨\n\n\nè¯´ä¸€ä¸‹ JVM è¿è¡Œæ—¶æ•°æ®åŒº\n\n\nå †é‡Œé¢çš„åˆ†åŒºï¼šEdenï¼Œsurvival ï¼ˆfrom+ toï¼‰ï¼Œè€å¹´ä»£ï¼Œå„è‡ªçš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆ\n\n\nè¯´ä¸€ä¸‹ JVM è°ƒä¼˜çš„å·¥å…·\n\n\nå¸¸ç”¨çš„ JVM è°ƒä¼˜çš„å‚æ•°éƒ½æœ‰å“ªäº›\n\n\nç®€è¿° Java åƒåœ¾å›æ”¶æœºåˆ¶\n\n\nä»€ä¹ˆæ˜¯ Full GC\n\n\nä»€ä¹ˆæƒ…å†µä¸‹ä¼šè§¦å‘\n\n\nè¯´ä¸€ä¸‹ JVM æœ‰å“ªäº›åƒåœ¾å›æ”¶ç®—æ³•\n\n\næ•°æ®åº“\n\n\nç´¢å¼•çš„æœºåˆ¶å’Œåº•å±‚åŸç†\n\n\nä»€ä¹ˆæ˜¯ç»„åˆç´¢å¼•\n\n\næœ€å·¦åŒ¹é…åŸåˆ™\n\n\næ•°æ®åº“çš„äº‹åŠ¡\n\n\nå¼•æ“çš„åŸç†\n\n\næ•°æ®åº“æ‚²è§‚é”å’Œä¹è§‚é”çš„å®ç°\n\n\nb+ æ ‘çš„å¥½å¤„\n\n\næ•°æ®åº“çš„ä¼˜åŒ–\n\n\nå¤šä¸ªæ•°æ®æºå¦‚ä½•æ“ä½œ\n\n\næ¡†æ¶\n\n\nSpring çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶\n\n\nbean çš„ç”Ÿå‘½å‘¨æœŸ\n\n\nSpringMVC çš„æ‰§è¡Œæµç¨‹\n\n\nioc\n\n\ndi\n\n\naop\n\n\nSpringBoot å¼‚å¸¸å¤„ç†æœºåˆ¶\n\n\nç®€åŒ–æ“ä½œçš„åŸç†\n\n\nè‡ªå®šä¹‰æ³¨è§£\n\n\nSpringcloud çš„ç»„ä»¶\n\n\nRedis\n\n\nRedis çš„æ•°æ®ç±»å‹\n\n\nå¸¸ç”¨å‘½ä»¤\n\n\næŒä¹…åŒ–æ–¹æ³•\n\n\né›ªå´©ã€å‡»ç©¿ã€ç©¿é€\n\n\nè¿‡æœŸç­–ç•¥\n\n\næ·˜æ±°ç­–ç•¥\n\n\nä¸æ•°æ®åº“çš„ä¸€è‡´æ€§\n\n\nå“¨å…µæ¨¡å¼\n\n\né›†ç¾¤\n\n\nåˆ†å¸ƒå¼é”\n\n\nå¼‚æ­¥é˜Ÿåˆ—\n\n\nå»¶æ—¶é˜Ÿåˆ—\n\n\nçº¿ç¨‹æ¨¡å‹\n\n\nåˆ†åŒº\n\n\nMQ\n\n\nä¸ºä»€ä¹ˆè¦ç”¨ MQ\n\n\nMQ çš„ä¼˜åŠ¿\n\n\næ¶ˆæ¯è¡¥å¿æœºåˆ¶\n\n\nä¸€è‡´æ€§\n\n\né¢„é˜²æ¶ˆæ¯ä¸¢å¤±\n\n\nå¯é æ€§\n\n\nä¸é‡å¤æ¶ˆè´¹\n\n\né›†ç¾¤é•œåƒæ¨¡å¼\n\n\nMQ çš„å·¥ä½œæ¨¡å¼\n\n\né¡¹ç›®åº”ç”¨åœºæ™¯\n\n\nåœºæ™¯\n\n\nè¯·æ±‚é‡å¤§å¦‚ä½•æ‹¦æˆª\n\n\nå¦‚ä½•å»ä¸¤ä¸ªåº“æŸ¥æ•°æ®\n\n\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡"]},{"title":"é¢è¯•-åŸºç¡€","url":"/posts/3a228d8a/","content":"\n\nå‰è¨€\nâ—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24.06.03 åˆå§‹è®°å½•\n\nâ—Java çš„åŸºæœ¬æ•°æ®ç±»å‹\nbyteï¼Œshortï¼Œintï¼Œlongï¼Œfloatï¼Œdoubleï¼Œcharï¼Œboolean\né¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§\nç»§æ‰¿ã€å¤šæ€ã€å°è£…\nJDK å’Œ JRE çš„åŒºåˆ«\nJREï¼šJava è¿â¾æ—¶ç¯å¢ƒã€‚å®ƒæ˜¯è¿â¾å·²ç¼–è¯‘ Java ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å†…å®¹çš„é›†åˆï¼ŒåŒ…æ‹¬ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰ï¼ŒJava ç±»åº“ï¼ŒJava å‘½ä»¤å’Œå…¶ä»–çš„â¼€äº›åŸºç¡€æ„ä»¶ã€‚ä½†æ˜¯ï¼Œå®ƒä¸èƒ½â½¤äºåˆ›å»ºæ–°ç¨‹åºã€‚\nJDK(Java Development Kit)ï¼šå®ƒæ˜¯åŠŸèƒ½â»¬å…¨çš„ Java SDKã€‚å®ƒæ‹¥æœ‰ JRE æ‰€æ‹¥æœ‰çš„â¼€åˆ‡ï¼Œè¿˜æœ‰ç¼–è¯‘å™¨ï¼ˆjavacï¼‰å’Œâ¼¯å…·ï¼ˆå¦‚ javadoc å’Œ jdbï¼‰ã€‚å®ƒèƒ½å¤Ÿåˆ›å»ºå’Œç¼–è¯‘ç¨‹åºã€‚\nç®€å•æ¥è¯´ï¼ŒJDK åŒ…å« JREï¼ŒJRE åŒ…å« JVMã€‚\nJava æ”¯æŒå¤šç»§æ‰¿å’Œå¤šå®ç°å—\nä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œæ”¯æŒå¤šå®ç°ã€‚\næ„é€ å‡½æ•°å’Œä¸€èˆ¬å‡½æ•°æœ‰ä»€ä¹ˆåŒºåˆ«\n\n\nå®šä¹‰æ ¼å¼ä¸åŒ\n\n\næ„é€ å‡½æ•°æ˜¯åœ¨å¯¹è±¡åˆ›å»ºæ—¶ï¼Œå°±è¢«è°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–ï¼Œè€Œä¸”åˆå§‹åŒ–åŠ¨ä½œåªæ‰§è¡Œä¸€æ¬¡ã€‚ ä¸€èˆ¬å‡½æ•°ï¼Œæ˜¯å¯¹è±¡åˆ›å»ºåï¼Œéœ€è¦è°ƒç”¨æ‰æ‰§è¡Œï¼Œå¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ã€‚\n\n\nJava æ€ä¹ˆåˆ›å»ºå¯¹è±¡\n\n\nä½¿ç”¨ new å…³é”®å­—\n\n\nä½¿ç”¨ newInstance æ–¹æ³•\n\n\n\nJava åå°„ä¸­æœ‰ä¸€ä¸ª newInstance() æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼šè·å–è¦åˆ›å»ºçš„ç±»çš„ Class å¯¹è±¡ã€‚å¦‚æœåªéœ€è¦è°ƒç”¨è¿™ä¸ªç±»çš„è®¿é—®æƒé™ä¸º public æ— å‚æ„é€ å™¨ï¼Œç›´æ¥ä½¿ç”¨ Class ç±»çš„å®ä¾‹æ–¹æ³• newInstance()ã€‚è·å– Class å¯¹è±¡çš„æ„é€ å™¨å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨ Class ç±»çš„å®ä¾‹æ–¹æ³• getDeclaredConstractors() æ¥è·å–æ„é€ å™¨å¯¹è±¡çš„æ•°ç»„ã€‚(è·å–æ‰€æœ‰æ„é€ å™¨ï¼Œæ— è§†è®¿é—®æƒé™çš„é™åˆ¶ï¼Œæ•°ç»„é¡ºåºæŒ‰ç…§ä»£ç ä¸­çš„é¡ºåºå†³å®š) å¦‚æœè°ƒç”¨çš„æ„é€ å™¨æ˜¯ private çš„ï¼Œéœ€è¦è°ƒç”¨ Constractor ç±»çš„çˆ¶ç±» AccessibleObject ç±»çš„å®ä¾‹æ–¹æ³• setAccessible(true) æ¥æ‰“ç ´è®¿é—®é™åˆ¶ã€‚ä½¿ç”¨ Constractor ç±»çš„å®ä¾‹æ–¹æ³• newInstance()ã€‚è·å– Class å¯¹è±¡çš„æ–¹æ³•æœ‰ 3 ä¸ªï¼Œæ­¤å¤„ä¸å¤šèµ˜è¿°ã€‚è·å– Constractor å¯¹è±¡çš„æ–¹æ³•æœ‰ 4 ä¸ªï¼Œæ­¤å¤„ä¸å¤šèµ˜è¿°ã€‚\n\n\n\nä½¿ç”¨ clone() æ–¹æ³•\n\n\n\nObject ç±»æ˜¯æ‰€æœ‰ç±»çš„ç›´æ¥æˆ–é—´æ¥çˆ¶ç±»ï¼ŒObject ç±»ä¸­æä¾›äº† å®ä¾‹æ–¹æ³• native()ï¼Œåœ¨ç»™å®šå¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œåˆ›å»ºä¸€ä¸ªå®Œå…¨ç›¸åŒçš„å¯¹è±¡ã€‚æ­¥éª¤å¦‚ä¸‹ï¼šæƒ³è¦ä½¿ç”¨ clone() æ–¹æ³•åˆ›å»ºå¯¹è±¡çš„ç±»ï¼Œå®ç° Cloneable æ¥å£ã€‚åœ¨ç±»çš„å†…éƒ¨ï¼Œé‡å†™ Object ç±»çš„ clone() æ–¹æ³•ã€‚å¤‡æ³¨ï¼šæ²¡æœ‰å®ç° Cloneable æ¥å£ï¼Œä¼šæŠ›å‡º CloneNotSupportedException å¼‚å¸¸ã€‚Object ç±»æä¾›çš„ clone() æ–¹æ³•ï¼Œè®¿é—®æƒé™æ˜¯ protectedï¼Œæ‰€ä»¥å¦‚æœä¸é‡å†™ clone() æ–¹æ³•ï¼Œæ˜¯æ²¡æœ‰æƒé™è°ƒç”¨çš„ã€‚Object ç±»çš„ clone() æ–¹æ³•ï¼Œæ˜¯ native æ–¹æ³•ã€‚\n\n\n\nâ”ä½¿ç”¨ååºåˆ—åŒ–çš„ readObject() æ–¹æ³•\n\n\n\nè¿™ä¸ªæ–¹æ³•ä¸€å…±åˆ†ä¸¤æ­¥ï¼šå°†å¯¹è±¡åºåˆ—åŒ–ï¼Œå­˜å‚¨åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ä»æ–‡ä»¶ä¸­ååºåˆ—åŒ–ï¼Œå¾—åˆ°ç±»å¯¹è±¡ã€‚\nåºåˆ—åŒ–ï¼šæƒ³è¦åºåˆ—åŒ–å¯¹è±¡çš„ç±»ï¼Œå®ç° Serializable æ¥å£ã€‚ä½¿ç”¨æ–‡ä»¶è¾“å‡ºæµ FileOutputStream åˆ›å»ºå­˜å‚¨åºåˆ—åŒ–ä¹‹åå¯¹è±¡çš„æ–‡ä»¶ã€‚ä½¿ç”¨å¯¹è±¡è¾“å‡ºæµ ObjectOutputStream çš„å®ä¾‹æ–¹æ³• writeObject(obj)ã€‚åˆ¤æ–­ç±»ä¸­æ˜¯å¦å­˜åœ¨ï¼Œåä¸º writeReplace()ï¼Œè¿”å›ç±»å‹ä¸º Object çš„æ–¹æ³•ã€‚è‹¥æœ‰ï¼Œå†™å…¥è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼›å¦åˆ™ï¼Œå†™å…¥ obj å¯¹è±¡ã€‚\nååºåˆ—åŒ–ï¼šä½¿ç”¨æ–‡ä»¶è¾“å…¥æµ FileInputStream æ‰¾åˆ°å­˜å‚¨åºåˆ—åŒ–å¯¹è±¡çš„æ–‡ä»¶ã€‚ä½¿ç”¨å¯¹è±¡è¾“å…¥æµ ObjectInputStream çš„å®ä¾‹æ–¹æ³• readObject()ã€‚åˆ¤æ–­ç±»ä¸­æ˜¯å¦å­˜åœ¨ï¼Œåä¸º readResolve()ï¼Œè¿”å›ç±»å‹ä¸º Object çš„æ–¹æ³•ï¼Œè‹¥æœ‰è¯»å–è¿™ä¸ªå¯¹è±¡ï¼›å¦åˆ™ï¼Œååºåˆ—åŒ–æ–‡ä»¶ä¸­çš„å¯¹è±¡æµã€‚\nå¤‡æ³¨ï¼šåœ¨ç±»ä¸­ï¼ŒwriteReplace() å’Œ readResoleve() æ˜¯ä¸¤ä¸ªéå¸¸ç‰¹æ®Šçš„æ–¹æ³•ï¼Œå…¶ç‰¹å¾ç­¾åéœ€è¦ä¸¥æ ¼é™åˆ¶ï¼šæ–¹æ³•åé™å®šï¼Œå‚æ•°ä¸ªæ•°é™å®šä¸º 0ï¼Œè¿”å›ç±»å‹å¿…é¡»æ˜¯ Objectï¼Œä¸èƒ½ä¸º Object çš„å­ç±»ï¼Œä½†æ˜¯å¯ä»¥æŠ›å‡ºä¸åŒçš„å¼‚å¸¸ã€‚è®¿é—®ä¿®é¥°ç¬¦æ²¡æœ‰é™åˆ¶ï¼Œä½†ä¸€èˆ¬æ¨èä¸º privateï¼Œé˜²æ­¢è¯¯æ“ä½œã€‚å…¶ç‰¹æ®Šçš„åœ°æ–¹è¿˜åœ¨äºå°†å…¶è®¾ä¸º private æ–¹æ³•ï¼Œæ²¡æœ‰å…¶ä»–æ–¹æ³•è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¸ä¼šå‘å‡ºè­¦å‘Šã€‚\n\nJava ä¸­çš„å¼‚å¸¸\nThrowable -&gt;Exception -&gt; ClassNotFoundException\t\t\t\t\t  -&gt; IOException\t\t\t\t\t  -&gt; RuntimeException      -&gt; NullPointerException\t\t\t\t\t\t\t\t\t\t\t  -&gt; NumberFormatException\t\t\t\t\t\t\t\t\t\t\t  -&gt; IndexOutOfBoundsException\t\t\t\t\t  ......          -&gt;Error\nâ—æŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ«\n\n\nå®šä¹‰ï¼šæ¥å£å®šä¹‰ï¼šinterfaceï¼›æŠ½è±¡ç±»ï¼šabstrat class;\n\n\næŠ½è±¡ç±»å¯ä»¥å®šä¹‰æ„é€ æ–¹æ³•ä¾›å­ç±»è°ƒç”¨ï¼Œæ¥å£ä¸å¯ä»¥ï¼›\n\n\næ¥å£çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œæ‰€æœ‰å±æ€§éƒ½æ˜¯å¸¸é‡ï¼šstatic final ç±»å‹ï¼›è€ŒæŠ½è±¡ç±»ä¸­å¯ä»¥æœ‰ä¸æ˜¯æŠ½è±¡çš„æ–¹æ³•å’Œä¸æ˜¯å¸¸é‡çš„å±æ€§ï¼›\n\n\næŠ½è±¡ç±»åªèƒ½å•ç»§æ‰¿ï¼Œè€Œæ¥å£ä¹‹é—´å¯ä»¥å¤šç»§æ‰¿ï¼Œæ¥å£ä¹‹é—´çš„ç»§æ‰¿ç”¨ extexdsï¼Œç±»å®ç°æ¥å£ç”¨ implements.\n\n\n== å’Œ equals()\n\n\n==ï¼š\n\n\n\n\nå¦‚æœæ¯”è¾ƒçš„å¯¹è±¡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ™æ¯”è¾ƒçš„æ˜¯å…¶å­˜å‚¨çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼›\n\n\nå¦‚æœæ¯”è¾ƒçš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåˆ™æ¯”è¾ƒçš„æ˜¯æ‰€æŒ‡å‘å¯¹è±¡çš„åœ°å€å€¼æ˜¯å¦ç›¸ç­‰ï¼ˆæ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚\n\n\n\n\nequalsï¼š\n\n\n\n\nå¦‚æœæ²¡æœ‰å¯¹ equals æ–¹æ³•è¿›è¡Œé‡å†™ï¼Œåˆ™ç›¸å½“äº ==ï¼Œæ¯”è¾ƒçš„æ˜¯å¼•ç”¨ç±»å‹çš„å˜é‡æ‰€æŒ‡å‘çš„å¯¹è±¡çš„åœ°å€å€¼ã€‚\n\n\nä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç±»ä¼šé‡å†™ equals æ–¹æ³•ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚æ¯”å¦‚ String ç±»ä¸­çš„ equals() æ˜¯è¢«é‡å†™äº†ï¼Œæ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å€¼ã€‚\n\n\nä¸ºä»€ä¹ˆé‡å†™ equals æ–¹æ³•ï¼Œè¿˜å¿…é¡»è¦é‡å†™ hashcode æ–¹æ³•\n\n\nä¿è¯æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœé‡å†™äº† equals æ–¹æ³•ï¼Œè€Œæ²¡æœ‰é‡å†™ hashcode æ–¹æ³•ï¼Œä¼šå‡ºç° equals ç›¸ç­‰çš„å¯¹è±¡ï¼Œä½†æ˜¯ hashcode ä¸ç›¸ç­‰çš„æƒ…å†µï¼Œé‡å†™ hashcode æ–¹æ³•å°±æ˜¯ä¸ºäº†é¿å…è¿™ç§æƒ…å†µçš„å‡ºç°ã€‚\n\n\nä½¿ç”¨ hashcode æ–¹æ³•æå‰æ ¡éªŒï¼Œå¯ä»¥é¿å…æ¯ä¸€æ¬¡æ¯”å¯¹éƒ½è°ƒç”¨ equals æ–¹æ³•ï¼Œæé«˜æ•ˆç‡\n\n\né‡å†™åï¼š\n\n\nequals() ç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œhashcode() ä¸€å®šç›¸ç­‰ï¼›\n\n\nhashcode() ä¸ç­‰ï¼Œä¸€å®šèƒ½æ¨å‡º equals() ä¹Ÿä¸ç­‰ï¼›\n\n\nhashcode() ç›¸ç­‰ï¼Œequals() å¯èƒ½ç›¸ç­‰ï¼Œä¹Ÿå¯èƒ½ä¸ç­‰ã€‚\n\n\næ‰€ä»¥å…ˆè¿›è¡Œ hashcode() åˆ¤æ–­ï¼Œä¸ç­‰å°±ä¸ç”¨ equals() æ–¹æ³•äº†ã€‚\n\n\nä½† equels æ˜¯æ˜¯æ ¹æ®å¯¹è±¡çš„ç‰¹å¾è¿›è¡Œé‡å†™çš„ï¼Œæœ‰æ—¶å€™ç‰¹å¾ç›¸åŒï¼Œä½† hash å€¼ä¸åŒï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ æ‰€ä»¥ä¸¤ä¸ªéƒ½é‡å†™æ‰èƒ½ä¿éšœæ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚\n\n\næ·±æ‹·è´å’Œæµ…æ‹·è´\næµ…æ‹·è´ï¼ˆshallowCopyï¼‰åªæ˜¯å¢åŠ äº†ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å·²å­˜åœ¨çš„å†…å­˜åœ°å€ã€‚\næ·±æ‹·è´ï¼ˆdeepCopyï¼‰æ˜¯å¢åŠ äº†ä¸€ä¸ªæŒ‡é’ˆå¹¶ä¸”ç”³è¯·äº†ä¸€ä¸ªæ–°çš„å†…å­˜ï¼Œä½¿è¿™ä¸ªå¢åŠ çš„æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªæ–°çš„å†…å­˜ï¼Œä½¿ç”¨æ·±æ‹·è´çš„æƒ…å†µä¸‹ï¼Œé‡Šæ”¾å†…å­˜çš„æ—¶å€™ä¸ä¼šå› ä¸ºå‡ºç°æµ…æ‹·è´æ—¶é‡Šæ”¾åŒä¸€ä¸ªå†…å­˜çš„é”™è¯¯ã€‚\næµ…å¤åˆ¶ï¼šä»…ä»…æ˜¯æŒ‡å‘è¢«å¤åˆ¶çš„å†…å­˜åœ°å€ï¼Œå¦‚æœåŸåœ°å€å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆæµ…å¤åˆ¶å‡ºæ¥çš„å¯¹è±¡ä¹Ÿä¼šç›¸åº”çš„æ”¹å˜ã€‚\næ·±å¤åˆ¶ï¼šåœ¨è®¡ç®—æœºä¸­å¼€è¾Ÿä¸€å—æ–°çš„å†…å­˜åœ°å€ç”¨äºå­˜æ”¾å¤åˆ¶çš„å¯¹è±¡ã€‚\nJava ä¸­éƒ½æœ‰å“ªäº›å¼•ç”¨ç±»å‹ï¼Ÿ\nå¼ºå¼•ç”¨ï¼šå‘ç”Ÿ gc çš„æ—¶å€™ä¸ä¼šè¢«å›æ”¶ã€‚\nè½¯å¼•ç”¨ï¼šæœ‰ç”¨ä½†ä¸æ˜¯å¿…é¡»çš„å¯¹è±¡ï¼Œåœ¨å‘ç”Ÿå†…å­˜æº¢å‡ºä¹‹å‰ä¼šè¢«å›æ”¶ã€‚\nå¼±å¼•ç”¨ï¼šæœ‰ç”¨ä½†ä¸æ˜¯å¿…é¡»çš„å¯¹è±¡ï¼Œåœ¨ä¸‹ä¸€æ¬¡ GC æ—¶ä¼šè¢«å›æ”¶ã€‚\nè™šå¼•ç”¨ï¼ˆå¹½çµå¼•ç”¨/å¹»å½±å¼•ç”¨ï¼‰ï¼šæ— æ³•é€šè¿‡è™šå¼•ç”¨è·å¾—å¯¹è±¡ï¼Œç”¨ PhantomReference å®ç°è™šå¼•ç”¨ï¼Œè™šå¼•ç”¨çš„ç”¨é€”æ˜¯åœ¨ gc æ—¶è¿”å›ä¸€ä¸ªé€šçŸ¥ã€‚\nSPI ä»‹ç»\nâ€‹SPI å…¨ç§° Service Provider Interfaceï¼Œæ˜¯ Java æä¾›çš„ä¸€å¥—ç”¨æ¥è¢«ç¬¬ä¸‰æ–¹å®ç°æˆ–è€…æ‰©å±•çš„ APIï¼Œå®ƒå¯ä»¥ç”¨æ¥å¯ç”¨æ¡†æ¶æ‰©å±•å’Œæ›¿æ¢ç»„ä»¶ã€‚\nJava çš„ SPI æœºåˆ¶å°±æ˜¯å°†ä¸€äº›==ç±»ä¿¡æ¯å†™åœ¨çº¦å®šçš„æ–‡ä»¶ä¸­==ï¼Œç„¶åç”±ç‰¹å®šçš„ç±»åŠ è½½å™¨ ServiceLoader åŠ è½½è§£ææ–‡ä»¶è·å–èµ„æºã€‚\nJava SPI åŸºäº â€œæ¥å£ç¼–ç¨‹ï¼‹ç­–ç•¥æ¨¡å¼ï¼‹é…ç½®æ–‡ä»¶(çº¦å®š)â€ç»„åˆå®ç°çš„åŠ¨æ€åŠ è½½æœºåˆ¶ã€‚å®ƒæä¾›äº†ä¸€ç§æœåŠ¡å‘ç°æœºåˆ¶ï¼Œå…è®¸åœ¨ç¨‹åºå¤–éƒ¨åŠ¨æ€æŒ‡å®šå…·ä½“å®ç°ã€‚\nä¸€èˆ¬æƒ…å†µä¸‹æ˜¯è°ƒç”¨æ–¹è°ƒç”¨å®ç°å¥½çš„æ¥å£ï¼Œä½†æ˜¯å½“æ¥å£å­˜åœ¨äºè°ƒç”¨æ–¹è¿™è¾¹æ—¶ï¼Œå°±æ˜¯ SPI ï¼Œç”±æ¥å£è°ƒç”¨æ–¹ç¡®å®šæ¥å£è§„åˆ™ï¼Œç„¶åç”±ä¸åŒçš„å‚å•†å»æ ¹æ®è¿™ä¸ªè§„åˆ™å¯¹è¿™ä¸ªæ¥å£è¿›è¡Œå®ç°ï¼Œä»è€Œæä¾›æœåŠ¡ã€‚\nâ€‹ä»¥ä¸‹æ˜¯ SPI çš„ä¸€äº›è¿ç”¨åœºæ™¯ï¼š\n\n\n\nåœºæ™¯\nè¯´æ˜\n\n\n\n\næ•°æ®åº“é©±åŠ¨\næ•°æ®åº“é©±åŠ¨åŠ è½½æ¥å£å®ç°ç±»çš„åŠ è½½ JDBC åŠ è½½ä¸åŒç±»å‹æ•°æ®åº“çš„é©±åŠ¨\n\n\næ—¥å¿—é—¨é¢ SLF4J æ¥å£å®ç°ç±»åŠ è½½\nSLF4J åŠ è½½ä¸åŒæä¾›å•†çš„æ—¥å¿—å®ç°ç±»\n\n\nSpring\nSpring ä¸­å¤§é‡ä½¿ç”¨äº† SPIï¼Œæ¯”å¦‚ï¼šå¯¹ servlet3.0 è§„èŒƒå¯¹ ServletContainerInitializer çš„å®ç°ã€è‡ªåŠ¨ç±»å‹è½¬æ¢ Type Conversion SPI(Converter SPIã€Formatter SPI) ç­‰\n\n\nDubbo\nDubbo ä¸­ä¹Ÿå¤§é‡ä½¿ç”¨ SPI çš„æ–¹å¼å®ç°æ¡†æ¶çš„æ‰©å±•ï¼Œä¸è¿‡å®ƒå¯¹ Java æä¾›çš„åŸç”Ÿ SPI åšäº†å°è£…ï¼Œå…è®¸ç”¨æˆ·æ‰©å±•å®ç° Filter æ¥å£\n\n\nSpringBoot\nSpringBoot åŸºäº SPI æ€æƒ³å®ç°è‡ªåŠ¨è£…é…\n\n\næ’ä»¶æ‰©å±•\nå¼€æºæ¡†æ¶ï¼Œæƒ³ä½¿ç”¨åˆ«äººçš„æ’ä»¶ï¼Œæ‰©å±•æŸä¸ªåŠŸèƒ½ã€‚\n\n\n\nServiceLoaderï¼šç‚¹å‡»é“¾æ¥è·³è½¬é“¾æ¥åˆ° JavaGuideã€‚\né¢è¯•å¤§ç™½è¯\nJava ä¸­çš„ SPI å°±æ˜¯ä½ æä¾›ä¸€ä¸ªæ¥å£ï¼Œç„¶åè®©åˆ«äººæä¾›å®ç°ç±»ã€‚ç„¶åå°†è¿™ä¸ªå®ç°æ”¾åœ¨ resources/META-INF/services/ ä¸­ã€‚è¿™æ · Java å¯åŠ¨çš„æ—¶å€™å°±ä¼šå»æ‰«æè¿™ä¸ªä¸‹é¢çš„ jar åŒ…ï¼Œå¹¶æŠŠä»–åŠ è½½è¿›æ¥ã€‚ä¸€èˆ¬æ¥è¯´ç”¨åœ¨å¼€æºæ¡†æ¶ä¸­çš„æ’ä»¶æ‰©å±•ï¼Œç„¶åæ¯”è¾ƒå¸¸è§çš„æ€æƒ³æç°å°±æ˜¯ Java çš„ JDBC å®ç°ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±ä½¿ç”¨çš„æ•°æ®åº“ï¼Œå°†å¯¹åº”çš„ jar åŒ…å¼•ç”¨è¿›æ¥ã€‚\nï¼ˆDubbo ä¸­å¯èƒ½é—®åˆ°çš„é—®é¢˜ï¼‰Dubbo ä¸­ä¹Ÿä½¿ç”¨äº†è¿™ä¸ªæ€æƒ³: æ¯”å¦‚è¯´æœ‰ä¸€è¡Œä»£ç æ˜¯ï¼š\nProtocol protocol = ExtensionLoader.getExtensionLoader(Protocol.class).getAdaptiveExtension();\nç„¶ååœ¨ä½¿ç”¨ Protocol æ¥å£æ—¶ï¼Œdubbo ä»–ä¼šå»æ‰¾ä¸€ä¸ªä½ é…ç½®çš„ Protocolï¼Œä»–å°±ä¼šå°†ä½ é…ç½®çš„ Protocol å®ç°ç±»ï¼ŒåŠ è½½åˆ° jvm ä¸­æ¥ï¼Œç„¶åå®ä¾‹åŒ–å¯¹è±¡ï¼Œå°±ç”¨ä½ çš„é‚£ä¸ª Protocol å®ç°ç±»å°±å¯ä»¥äº†ã€‚è¿™ä¸ª Protocol å°±æ˜¯ç”¨æ¥é…ç½®ä»–çš„ç½‘ç»œåè®®çš„ï¼Œç„¶ååœ¨æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ dubbo åè®®ï¼Œå°±æ˜¯ DubboProtocolã€‚dubbo é‡Œé¢æä¾›äº†å¤§é‡çš„ç±»ä¼¼ä¸Šé¢çš„æ‰©å±•ç‚¹ï¼Œå°±æ˜¯è¯´ï¼Œä½ å¦‚æœè¦æ‰©å±•ä¸€ä¸ªä¸œè¥¿ï¼Œåªè¦è‡ªå·±å†™ä¸ª jarï¼Œè®©ä½ çš„ consumer æˆ–è€…æ˜¯ provider å·¥ç¨‹ï¼Œä¾èµ–ä½ çš„é‚£ä¸ª jarï¼Œåœ¨ä½ çš„ jar é‡ŒæŒ‡å®šç›®å½•ä¸‹é…ç½®å¥½æ¥å£åç§°å¯¹åº”çš„æ–‡ä»¶ï¼Œé‡Œé¢é€šè¿‡ key=å®ç°ç±»ï¼ˆè¿™äº›éƒ½å¯ä»¥åœ¨å®˜ç½‘çš„æ–‡æ¡£é‡Œæ‰¾åˆ°ï¼‰ã€‚\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡"]},{"title":"é¢è¯•-é›†åˆ","url":"/posts/c99ff7c6/","content":"\n\nå‰è¨€\né›†åˆå¸¸è§é—®é¢˜ï¼Œå…¶ä¸­ HashMap å¾ˆé‡è¦â—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24.06.01 åˆå§‹è®°å½•24.08.09 ä¿®æ”¹éƒ¨åˆ†æ–‡å­—é”™è¯¯\n\nJava é›†åˆ\né›†åˆåˆ†ä¸ºå•åˆ—é›†åˆ ï¼ˆcollectionï¼‰ å’ŒåŒåˆ—é›†åˆ ï¼ˆmapï¼‰ã€‚å•åˆ—é›†åˆåˆåŒ…æ‹¬ Listï¼ˆå¯é‡å¤ï¼‰ å’Œ Setï¼ˆä¸å¯é‡å¤ï¼‰ï¼ŒList åˆ†ä¸º ArrayList å’Œ LinkedList\nå•åˆ—é›†åˆæ˜¯å®ç° Iterable æ¥å£äº§æˆçš„å¯¹è±¡ï¼Œæ”¯æŒè¿­ä»£å™¨å’Œå¢å¼º forã€‚\nè¿­ä»£å™¨ nkedListï¼ŒSet åˆ†ä¸º HashSet å’Œ TreeSetã€‚åŒåˆ—é›†åˆ Map åˆ†ä¸º TreeMap å’Œ HashMap\nåŸºç¡€\næ‰€æœ‰çš„å•åˆ—é›†åˆéƒ½å¯ä»¥ä½¿ç”¨è¿­ä»£å™¨ï¼Œå› ä¸ºä»–ä»¬éƒ½ç»§æ‰¿äº† Iterable æ¥å£ï¼Œè¿™ä¸ªæ¥å£é‡Œçš„ Iterator æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ª Iterator å¯¹è±¡ï¼Œè¿™ä¸ª Iterator å¯¹è±¡å°±æ˜¯è¿­ä»£å™¨å¯¹è±¡ï¼Œåº•å±‚é’ˆå¯¹ä¸åŒç±»å‹çš„é›†åˆéƒ½å†™äº†ä¸åŒçš„å®ç°ç±»ï¼Œæ‰€ä»¥é›†åˆå¯ä»¥ç›´æ¥ä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œéå†æŸ¥è¯¢ã€‚è¿™ç§åªéœ€è¦æä¾›ä¸€ç§æ–¹æ³•ï¼ˆiterator æ–¹æ³•ï¼‰è®¿é—®ä¸€ä¸ªå®¹å™¨å¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚çš„æ–¹å¼å°±æ˜¯è¿­ä»£å™¨è®¾è®¡æ¨¡å¼ã€‚\nè¿­ä»£å™¨å€’åº\nList é›†åˆå¯ä»¥ä½¿ç”¨è¿­ä»£å™¨å€’ç€éå†ï¼ŒListIterator æœ‰ previous() æ–¹æ³•å’Œ hasprevious() æ–¹æ³•ï¼Œå¯ä»¥è‡ªåŠ¨æŒ‡å‘å¹¶å–å‡ºä¸Šä¸€ä¸ªå…ƒç´ ã€‚Set é›†åˆä¸èƒ½ç”¨è¿­ä»£å™¨å€’ç€éå†ï¼Œä½†å¯ä»¥æ ¹æ®å®ƒçš„å¤§å°é¡ºåºå€’ç€å–å‡ºã€‚\nä½¿ç”¨ foreachã€iteratorã€for æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ•ˆç‡ä¸Šå“ªä¸ªæ›´é«˜ï¼Ÿ\nåŒºåˆ«ä¸Šï¼š\næ™®é€š for å¾ªç¯ä¸€èˆ¬ç”¨æ¥å¤„ç†æ¯”è¾ƒç®€å•çš„æœ‰åºçš„ï¼Œå¯é¢„çŸ¥å¤§å°çš„é›†åˆæˆ–æ•°ç»„.\nforeach å¯ç”¨äºéå†ä»»ä½•é›†åˆæˆ–æ•°ç»„ï¼Œè€Œä¸”æ“ä½œç®€å•æ˜“æ‡‚ï¼Œå”¯ä¸€çš„ä¸å¥½å°±æ˜¯éœ€è¦äº†è§£é›†åˆå†…éƒ¨ç±»å‹ï¼Œå®ƒçš„åº•å±‚æœ‰å‡½æ•°å¼ç¼–ç¨‹æ³¨è§£Â @FunctionalInterfaceï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯ä»¥è¿›è¡Œ Lamda å½¢å¼ç®€å†™ã€‚\niterator æ˜¯æœ€å¼ºå¤§çš„ï¼Œä»–å¯ä»¥éšæ—¶ä¿®æ”¹æˆ–è€…åˆ é™¤é›†åˆå†…éƒ¨çš„å…ƒç´ ï¼Œå¹¶ä¸”æ˜¯åœ¨ä¸éœ€è¦çŸ¥é“å…ƒç´ å’Œé›†åˆçš„ç±»å‹çš„æƒ…å†µä¸‹è¿›è¡Œçš„ï¼Œå½“ä½ éœ€è¦å¯¹ä¸åŒçš„å®¹å™¨å®ç°åŒæ ·çš„éå†æ–¹å¼æ—¶ï¼Œè¿­ä»£å™¨æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼\nè‡³äºå¢å¼º for å’Œ iterator å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œå¢å¼º for ç¼–è¯‘åçš„.class æ–‡ä»¶ä¸­ï¼Œå°±æ˜¯ iteratorï¼Œæ‰€ä»¥äºŒè€…é™¤äº†å†™æ³•æ˜¯ç”¨ç¬¬ä¸‰æ–¹å‚æ•°æ¥è¡¨ç¤ºï¼Œæ•ˆç‡ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚\næ•ˆç‡ä¸Šï¼š\nè¿™ä¸ªéœ€è¦å¤šæ–¹è€ƒè™‘ï¼Œæ¯”å¦‚æ™®é€š for å¾ªç¯ç”¨åœ¨æ•°ç»„æ˜¯éå†æœ€å¿«çš„ï¼Œå®ƒæ˜¯ç›´æ¥è·å–æ•°æ®ï¼Œä½†æ™®é€š for ä¸èƒ½ç”¨åœ¨ä¸çŸ¥é“é•¿åº¦çš„é›†åˆä¸­ï¼Œè¿™å°±éœ€è¦ç”¨ iterator æˆ–è€… foreachï¼Œç›¸å¯¹æ¥è¯´ï¼Œiterator æ•ˆç‡ä¼šé«˜äº foreachï¼Œå› ä¸º foreach åœ¨è®¿é—®è¿‡ç¨‹ä¸­äº§ç”Ÿä¸€ä¸ªé¢å¤–çš„ Enumerator å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šè¿›è¡Œç‰ˆæœ¬æ£€æŸ¥å¤„ç†ï¼Œæ‰€ä»¥å®ƒæ˜¯çº¿å®‰å…¨çš„ã€‚\nå¯¹äº ArrayList æ¥è¯´ï¼Œå®ƒæ˜¯é€šè¿‡ä¸€ä¸ªæ•°ç»„å®ç°çš„ï¼Œå¯ä»¥éšæœºå­˜å–ï¼›ä½†æ˜¯ LinkedList æ˜¯é€šè¿‡é“¾è¡¨å®ç°çš„ï¼Œå½“è¦éå†ä¾ä¸ªå–å‡ºæ—¶ï¼Œfor å¾ªç¯æ—¶è¦å–çš„æ¯ä¸ªå…ƒç´ éƒ½å¿…é¡»ä»å¤´å¼€å§‹éå†ï¼Œè€Œ iterator éå†åˆ™ä»å¤´å¼€å§‹ï¼Œè¾¹éå†è¾¹å–ï¼Œå–å®Œåªéœ€è¦ä¸€æ¬¡éå†ï¼Œæ‰€ä»¥ for å¾ªç¯éœ€è¦çš„æ—¶é—´è¿œè¿œè¶…è¿‡ foreach å¾ªç¯ã€‚Â å¯¹äºæ•°ç»„æ¥è¯´ï¼Œfor å’Œ foreach å¾ªç¯æ•ˆç‡å·®ä¸å¤šï¼Œä½†æ˜¯å¯¹äºé“¾è¡¨æ¥è¯´ï¼Œfor å¾ªç¯æ•ˆç‡æ˜æ˜¾æ¯” foreach ä½ã€‚\nArrayList å’Œ LinkedList çš„åº•å±‚åŸç†\né¦–å…ˆï¼ŒList é›†åˆæ˜¯æœ‰åºé›†åˆï¼Œå³å­˜å–æœ‰åºï¼ŒList é›†åˆçš„ç‰¹ç‚¹æ˜¯å­˜å–é¡ºåºä¸€è‡´ï¼Œå­˜å‚¨å…ƒç´ å¯é‡å¤ï¼Œéƒ½æœ‰ç´¢å¼•ã€‚\nArrayList çš„åº•å±‚æ˜¯æ•°ç»„ï¼Œä¸€ä¸ªç´¢å¼•å¯¹åº”ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥æŸ¥è¯¢é€Ÿåº¦å¿«ï¼›ä½†æ˜¯åœ¨å¢åˆ æ—¶ï¼Œéœ€è¦è°ƒæ•´æ•´ç»„æ•°æ®çš„ç§»åŠ¨ï¼Œæ‰€ä»¥å¢åˆ è¾ƒæ…¢ã€‚\nè€Œ LinkedList çš„åº•å±‚æ˜¯åŒå‘é“¾è¡¨ï¼Œæ¯æ¬¡æŸ¥è¯¢æ—¶éƒ½è¦ä»ä¸¤å¤´å¼€å§‹æŸ¥è¯¢ï¼ˆç¦»å¤´è¿‘å°±ä»å¤´æŸ¥ï¼Œç¦»å°¾è¿‘å°±ä»å°¾æŸ¥ï¼‰ï¼Œæ‰€ä»¥æŸ¥è¯¢è¾ƒæ…¢ï¼›ä½†æ˜¯å¢åˆ æ—¶ï¼Œåªéœ€è¦å°†é“¾è¡¨å¤´ç»“ç‚¹å’Œå°¾ç»“ç‚¹æŒ‡å‘æ–°æ’å…¥çš„ç»“ç‚¹å³å¯ï¼Œæ‰€ä»¥å¢åˆ é€Ÿåº¦è¾ƒå¿«ã€‚\nä½†å¦‚æœæ˜¯æ–°å¢çš„æ•°æ®é‡è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼ŒArrayList çš„æ–°å¢æ•ˆç‡åé¢æ¯” LinkedList çš„æ•ˆç‡æ›´é«˜ã€‚å› ä¸º ArrayListr åº•å±‚æ•°ç»„çš„æ‰©å®¹æ˜¯ 1.5 å€ï¼Œæ•°æ®é‡è¶Šå¤§ï¼Œæ‰©å®¹çš„é€Ÿåº¦å°±è¶Šå¿«ï¼Œè€Œé“¾è¡¨ä»éœ€ä¸€ä¸ªä¸ªæ–­å¼€é“¾æ¥å’Œé‡ç»­æ–°é“¾æ¥ã€‚\næœ€åï¼Œjdk8 ç‰ˆè¿˜å¯¹ ArrayList åšäº†æ‡’åŠ è½½ä¼˜åŒ–ï¼Œåœ¨ä¹‹å‰æ˜¯æ„é€  ArrayList æ—¶å°±é»˜è®¤å¼€è¾Ÿ 10 ä¸ªç©ºé—´ï¼Œjdk8 ä¹‹åå˜æˆäº†åªæœ‰æ”¾å…¥ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼Œæ‰ä¼šå¼€è¾Ÿ 10 ä¸ªç©ºé—´ã€‚\nâ—â—æ•°ç»„çš„èµ·å§‹é•¿åº¦æ˜¯ 0ï¼Œåœ¨å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ•°ç»„å®¹é‡æ‰©ä¸º 10ã€‚ åç»­æ‰©å®¹å› å­ä¸º 1.5 å€ã€‚æ¯æ¬¡æ‰©å®¹éƒ½æ˜¯å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ã€‚\nåˆ†åˆ«è®²ä¸€ä¸‹ Set é›†åˆå’Œ Tree è¿™ç§æ•°æ®ç»“æ„\nSet é›†åˆçš„ç‰¹ç‚¹æ˜¯å¿…é¡»æ’åºï¼Œæ²¡æœ‰ç´¢å¼•ï¼Œä¸å¯é‡å¤ã€‚Set é›†åˆåˆ†ä¸º HashSet å’Œ TreeSetï¼ŒHashSet åº•å±‚ä½¿ç”¨çš„æ˜¯å“ˆå¸Œè¡¨ï¼Œå®ƒçš„æ’åºè§„åˆ™æ˜¯æŒ‰ç…§åº• Hash å‡½æ•°å†³å®šçš„ï¼Œæ— æ³•äººä¸ºè®¾ç½®ï¼›è€Œ TreeSet çš„åº•å±‚åˆ™æ˜¯ä½¿ç”¨çº¢é»‘æ ‘ï¼Œå¯ä»¥ä½¿ç”¨è‡ªç„¶æ’åºï¼ˆè‡ªå®šä¹‰ç±»ä¸­å®ç° Comparable æ¥å£ï¼Œé‡å†™ CompareTo æ–¹æ³•ï¼‰æˆ–æ¯”è¾ƒå™¨æ’åºï¼ˆåœ¨åˆ›å»º TreeSet å¯¹è±¡åˆ›å»ºä¸€ä¸ª Comparator çš„åŒ¿åå†…éƒ¨ç±»ï¼Œå¹¶é‡å†™ Compare æ–¹æ³•ï¼‰ï¼Œæ‰©å®¹æ—¶é€šè¿‡ç»“ç‚¹é“¾æ¥ã€‚\nTreeSet ä½¿ç”¨ Iterator éå†çš„è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ\nå› ä¸º TreeSet æ˜¯æŒ‰å¤§å°æ’åºçš„ï¼Œæ‰€ä»¥ä¼šæ ¹æ®ä»å·¦å¾€å³ï¼Œä»ä¸‹å¾€ä¸Šçš„é¡ºåºæ‰“å°ã€‚\nList é›†åˆæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½ æ˜¯æ€ä¹ˆä½¿ç”¨ List é›†åˆçš„å‘¢ï¼Ÿ\nä½¿ç”¨ Collections é›†åˆå·¥å…·ç±»ï¼Œå¯¹é›†åˆè¿›è¡ŒåŒæ­¥å¤„ç†ï¼š\nÂ Â List&lt;String&gt; list = Collections.synchronizedList(newÂ ArrayList&lt;&gt;());Â \nä½†æ˜¯åœ¨å¤šçº¿ç¨‹å¼€å‘ä¸­ï¼Œå¯¹å…¶è¿›è¡Œéå†ï¼Œéœ€è¦æ·»åŠ Â synchronized å…³é”®å­—ï¼Œå› ä¸º List çš„ addã€index ç­‰æ–¹æ³•ä¸­éƒ½æ˜¯å¸¦æœ‰ synchronized å…³é”®å­—ï¼Œä½†æ˜¯åœ¨ iterator ä¸­æ²¡æœ‰ synchronized å…³é”®å­—ã€‚\nHashMap\nâ—HashMap åº•å±‚çš„æ•°æ®ç»“æ„\næ•°ç»„ + æœ€ç®€å• Hash çš„åŸç†ã€‚\nå¯¹å­˜å…¥çš„ key è¿›è¡Œ hash è®¡ç®—ï¼Œæ ¹æ®è®¡ç®—å‡ºçš„ hash å€¼ï¼Œå¯¹æ•°ç»„é•¿åº¦è¿›è¡Œå–æ¨¡ï¼Œè·å–åˆ°è¦å­˜å…¥çš„ä½ç½®ã€‚\nJDK8 ä»¥å‰ï¼ŒHash è¡¨çš„åº•å±‚æ˜¯ã€æ•°ç»„ã€‘+ã€é“¾è¡¨ã€‘\nJDK8 åŠä¹‹åï¼Œå˜æˆäº†ã€æ•°ç»„ã€‘+ã€é“¾è¡¨ã€‘+ã€çº¢é»‘æ ‘ã€‘\nâ—JDK 1.8 ä¸­å¯¹ hash ç®—æ³•å’Œå¯»å€ç®—æ³•æ˜¯å¦‚ä½•ä¼˜åŒ–çš„ï¼Ÿ\nhash ç®—æ³•ï¼šhash å€¼ä¸ hash å€¼å³ç§» 16 ä½è¿›è¡Œå¼‚æˆ–è®¡ç®—ã€‚å¾—åˆ°ç»“æœä½é«˜ 16 ä½ + é«˜ 16 ä½ä¸ä½ 16 ä½çš„å¼‚æˆ–å€¼ã€‚ï¼ˆè¿™ä¸€æ­¥ä¸»è¦ä¸ºäº†ä½ 16 ä½åœ¨ä¸‹ä¸€æ­¥å¯»å€çš„æ—¶å€™ï¼Œä½¿ä½ 16 ä½ä¿ç•™é«˜ 16 ä½çš„ç‰¹å¾ï¼Œå‡å°‘å“ˆå¸Œå†²çªï¼‰\nå¯»å€ï¼š(n - 1)&amp;hash ç®—å‡ºæ•°ç»„å†…çš„ä¸€ä¸ªä½ç½®ã€‚\nä¸ºä»€ä¹ˆä½¿ç”¨&amp;è¿ç®—ä¸ä½¿ç”¨å–æ¨¡è¿ç®—ï¼Ÿ\n\nå–æ¨¡è¿ç®—æ€§èƒ½æ¯”è¾ƒå·®ï¼Œè€Œä¸” (n - 1)&amp;hash çš„æ•ˆæœå’Œ hash å¯¹ n å–æ¨¡ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚\nä¸ºä»€ä¹ˆæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Ÿå› ä¸ºæ•°ç»„çš„é•¿åº¦ä¸€ç›´æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼Œåªè¦ä»–ä¿æŒæ•°ç»„é•¿åº¦æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼Œé‚£ä¹ˆæ•ˆæœå°±æ˜¯ä¸€æ ·çš„ã€‚\n\nâ—HashMap å¦‚ä½•è§£å†³ hash ç¢°æ’ï¼Ÿ\nhash å†²çªï¼Œé“¾è¡¨ + çº¢é»‘æ ‘ï¼ŒO(n) å’Œ O(logn)\nâ—HashMap å¦‚ä½•è¿›è¡Œæ‰©å®¹ï¼Ÿ\n2 å€æ‰©å®¹ã€‚\næ‰©å®¹ä¹‹åè¦è¿›è¡Œ rehashã€‚å³ hash å€¼ä¸æ–°æ•°ç»„é•¿åº¦ (n - 1) è¿›è¡Œä¸æ“ä½œã€‚å¦‚æœå€¼ä¸åŸæ¥ä¸ä¸€æ ·ï¼Œæ–°çš„ index å°±æ˜¯ æ—§index + oldCapï¼Œé€šè¿‡è¿™ä¸ªæ–¹å¼ï¼Œé¿å…äº† rehash çš„æ—¶å€™ï¼Œè¿›è¡Œå–æ¨¡ï¼ˆæ•ˆç‡ä¸é«˜ï¼‰ã€‚\nHash è¡¨ä¸­æ•°ç»„çš„åˆå§‹åŒ–åˆ†æ‰‹åŠ¨åˆå§‹åŒ–å’Œè‡ªåŠ¨åˆå§‹åŒ–ï¼Œè‡ªåŠ¨åˆå§‹åŒ–ä¼šåœ¨ç¬¬ä¸€æ¬¡æ’å…¥å…ƒç´ æ—¶å¼€è¾Ÿç©ºé—´ï¼Œé»˜è®¤é•¿åº¦ä¸º 16ï¼Œæ‰©å®¹å› å­ä¸º 0.75ï¼Œæ¯æ¬¡æ‰©å®¹é‡ä¸ºè‡ªèº«çš„ 2 å€é•¿åº¦ï¼Œæ‰©å®¹ä¹‹åå­˜å…¥æ•°ç»„çš„æ–°ç´¢å¼•ä½ç½®å°±ä¼šæ”¹å˜ã€‚æ‰‹åŠ¨åˆå§‹åŒ–çš„è¯ï¼Œå¯ä»¥åœ¨åˆ›å»ºå¯¹è±¡æ—¶è‡ªå®šä¹‰åˆå§‹æ•°ç»„é•¿åº¦ï¼Œä½† HashMap ä¸ä¸€å®šä¼šæŒ‰è‡ªä¸»è®¾ç½®çš„æ•°å€¼åˆå§‹åŒ–æ•°ç»„ï¼Œè€ŒæŒ‰ 2 çš„ n æ¬¡æ–¹åˆ›å»ºã€‚\nHashMap1.7 ç‰ˆæœ¬çš„çš„æ‰©å®¹æ—¶æ˜¯å…ˆåˆ¤æ–­æ˜¯å¦è¾¾åˆ°é˜ˆå€¼ï¼Œè¾¾åˆ°å…ˆæ‰©å®¹ï¼Œå†æ·»åŠ å…ƒç´ ï¼Œå¹¶ä¸”é‡‡ç”¨çš„æ˜¯å¤´æ’æ³•ï¼Œä¹Ÿå°±æ˜¯æ—§å…ƒç´ æŒ‚åœ¨æ–°å…ƒç´ ä¸‹ã€‚è€Œ HashMap1.8 çš„æ‰©å®¹æ—¶æ˜¯å…ˆæ·»åŠ å…ƒç´ ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦è¾¾åˆ°é˜ˆå€¼ï¼Œè¾¾åˆ°é˜ˆå€¼ç›´æ¥æ‰©å®¹ï¼Œä¸”ä½¿ç”¨çš„æ˜¯å°¾æ’æ³•ï¼Œå³æ–°å…ƒç´ æŒ‚åœ¨æ—§å…ƒç´ ä¸‹é¢ã€‚\nåˆå§‹åŒ–åï¼Œå½“å­˜å…¥æ–°çš„é”®å€¼å¯¹æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­æ•°ç»„é•¿åº¦æ˜¯å¦å¤§äº 64ï¼Œå†åˆ¤æ–­é“¾è¡¨å…ƒç´ æ˜¯å¦å¤§äºç­‰äº 8 ï¼Œå¦‚æœä¸¤è€…éƒ½æˆç«‹ï¼Œé“¾è¡¨ä¼šè‡ªåŠ¨è½¬æ¢æˆçº¢é»‘æ ‘ï¼Œå¦‚æœæ•°ç»„å°äº 64ï¼Œä¼šä»ç¬¬ 9 ä¸ªå¼€å§‹å…ˆæ‰©å®¹ï¼Œç›´åˆ°æ•°ç»„é•¿åº¦å¤§äºç­‰äº 64 æ—¶ï¼Œé“¾è¡¨é•¿åº¦å†å¢åŠ ï¼Œå°±ä¼šè½¬ä¸ºçº¢é»‘æ ‘ã€‚\nâ”ä¸ºä»€ä¹ˆè¦è½¬ä¸ºçº¢é»‘æ ‘å‘¢ï¼Ÿ\né“¾è¡¨å–ä¸€ä¸ªæ•°éœ€è¦éå†é“¾è¡¨ï¼Œè€Œçº¢é»‘æ ‘ç›¸å¯¹æ•ˆç‡è¦é«˜ã€‚\nâ”ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨çº¢é»‘æ ‘å‘¢ï¼Ÿ\nHashMap æºç ä¸­æœ‰ç›¸å…³æè¿°ï¼š â€œå› ä¸ºæ ‘èŠ‚ç‚¹çš„å¤§å°æ˜¯é“¾è¡¨èŠ‚ç‚¹å¤§å°çš„ä¸¤å€ï¼Œæ‰€ä»¥åªæœ‰åœ¨å®¹å™¨ä¸­åŒ…å«è¶³å¤Ÿçš„èŠ‚ç‚¹ä¿è¯ä½¿ç”¨æ—¶æ‰ç”¨å®ƒâ€ï¼Œæ˜¾ç„¶å°½ç®¡è½¬ä¸ºæ ‘ä½¿å¾—æŸ¥æ‰¾çš„é€Ÿåº¦æ›´å¿«ï¼Œä½†æ˜¯åœ¨èŠ‚ç‚¹æ•°æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œæ­¤æ—¶å¯¹äºçº¢é»‘æ ‘æ¥è¯´å†…å­˜ä¸Šçš„åŠ£åŠ¿ä¼šè¶…è¿‡æŸ¥æ‰¾ç­‰æ“ä½œçš„ä¼˜åŠ¿ï¼Œè‡ªç„¶ä½¿ç”¨é“¾è¡¨æ›´åŠ å¥½ï¼Œä½†æ˜¯åœ¨èŠ‚ç‚¹æ•°æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œç»¼åˆè€ƒè™‘ï¼Œçº¢é»‘æ ‘æ¯”é“¾è¡¨è¦å¥½ã€‚\nâ”ä¸ºä»€ä¹ˆè½¬ä¸ºçº¢é»‘æ ‘çš„æ¡ä»¶æ˜¯ 8 è€Œä¸æ˜¯ç¬¬ 9 ç¬¬ 10 ä¸ªå‘¢ï¼Ÿ\næºç ä¸­æœ‰å¯¹è¿™ä¸ªè¿›è¡Œè®¡ç®—ï¼Œæ­£å¸¸çš„éšæœºå“ˆå¸Œç ä¸‹ï¼Œå“ˆå¸Œå†²çªå¤šåˆ°è¶…è¿‡ 8 ä¸ªçš„æ¦‚ç‡ä¸åˆ°åƒä¸‡åˆ†ä¹‹ä¸€ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡äº†ï¼Œå†å¾€åè°ƒæ•´å¹¶æ²¡æœ‰å¾ˆå¤§æ„ä¹‰ã€‚\nå¦‚æœå“ˆå¸Œå†²çªæœ‰é‚£ä¹ˆå¤šï¼Œè¯´æ˜æå¤§å¯èƒ½æ˜¯äººä¸ºè®¾ç½®ï¼Œæ•…æ„åˆ¶é€ å“ˆå¸Œå†²çªå¯¼è‡´ï¼Œè¿™æ—¶å€™å°±è½¬ä¸ºåŒ–çº¢é»‘æ ‘ï¼Œæ¥ä¿è¯æŸ¥è¯¢æ•ˆç‡ã€‚\nâ”é‚£ä»€ä¹ˆæ—¶å€™é€€å‡ºçº¢é»‘æ ‘å‘¢ï¼Ÿ\nå½“å“ˆå¸Œå†²çªä¸ªæ•°ä»ç¬¬ 8 ä¸ªå˜åˆ°ç¬¬ 6 ä¸ªæ—¶ï¼Œçº¢é»‘æ ‘è½¬åŒ–ä¸ºé“¾è¡¨ã€‚\nâ”6 ä¸ 8 ä¹‹é—´çš„ç¬¬ 7 ä¸ªå†²çªæ—¶ï¼Œä¼šæ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Ÿ\nåˆ†æƒ…å†µçœ‹ã€‚8 é€€ 6ï¼Œæ˜¯çº¢é»‘æ ‘è½¬é“¾è¡¨ï¼Œ6 è¿› 8ï¼Œæ˜¯é“¾è¡¨è½¬çº¢é»‘æ ‘ï¼Œä¸­é—´çš„ 7 æ˜¯é˜²æ­¢é¢‘ç¹å˜åŠ¨åšçš„ä¸€ä¸ªé¢„ç•™ä½ï¼Œå¦‚æœæ˜¯ 8 é€€ 6ï¼Œä¸­é—´çš„ 7 å°±æ˜¯çº¢é»‘æ ‘ï¼›å¦‚æœæ˜¯ 6 è¿› 8ï¼Œä¸­é—´çš„ 7 å°±æ˜¯é“¾è¡¨ã€‚\nä¸ºä»€ä¹ˆ 1.7 æ˜¯å¤´æ’æ³•ï¼Œ1.8 æ˜¯å°¾æ’æ³•ï¼Ÿ\n1.7 ç‰ˆæœ¬ä½¿ç”¨å¤´æ’æ³•æ˜¯å› ä¸ºå¤´æ’æ³•æ˜¯æ“ä½œé€Ÿåº¦æœ€å¿«çš„ï¼Œæ‰¾åˆ°æ•°ç»„ä½ç½®å°±ç›´æ¥æ‰¾åˆ°æ’å…¥ä½ç½®äº†ï¼Œä½†è¿™æ ·æ’å…¥æ–¹æ³•åœ¨å¹¶å‘åœºæ™¯ä¸‹ä¼šå› ä¸ºå¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰©å®¹å‡ºç°å¾ªç¯åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯ Hashmap çš„æ­»é”é—®é¢˜ã€‚ï¼ˆè¯¦ç»†è§£é‡Šï¼š[https://segmentfault.com/a/1190000024510131][https://segmentfault.com/a/1190000024510131]ï¼‰\n1.8 ç‰ˆæœ¬åŠ å…¥äº†çº¢é»‘æ ‘æ¥ä¼˜åŒ–å“ˆå¸Œæ¡¶ä¸­çš„éå†æ•ˆç‡ï¼Œç›¸æ¯”å¤´æ’æ³•è€Œè¨€ï¼Œå°¾æ’æ³•åœ¨æ“ä½œé¢å¤–çš„éå†æ¶ˆè€—ï¼ˆæŒ‡éå†å“ˆå¸Œæ¡¶ï¼‰å·²ç»å°å¾ˆå¤šï¼Œä¹Ÿå¯ä»¥é¿å…ä¹‹å‰çš„å¾ªç¯åˆ—è¡¨é—®é¢˜ï¼ŒåŒæ—¶å¦‚æœå·²ç»å˜æˆçº¢é»‘æ ‘äº†ï¼Œä¹Ÿä¸èƒ½å†ç”¨å¤´æ’æ³•äº†ï¼Œè€Œæ˜¯æŒ‰çº¢é»‘æ ‘è‡ªå·±çš„è§„åˆ™æ’åˆ—äº†ã€‚\nâ—å¤šçº¿ç¨‹ä¸‹çš„ HashMap çº¿ç¨‹å®‰å…¨å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\nHashMap æœ¬èº«å°±æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå¤šçº¿ç¨‹ä¸‹ï¼Œåœ¨æ·»åŠ å…ƒç´ æ—¶å®¹æ˜“å‡ºç°æ•°æ®è¦†ç›–æƒ…å†µï¼Œè€Œä¸¢å¤±æ•°æ®ï¼Œä¹Ÿå¯èƒ½åœ¨æ‰©å®¹æ—¶è¿ç§»æ•°æ®å‡ºç°æ•°æ®è¦†ç›–æƒ…å†µï¼Œè€Œä¸¢å¤±æ•°æ®ã€‚\nâ—ConcurrentHashMap å®ç°çº¿ç¨‹å®‰å…¨çš„åº•å±‚åŸç†\nJDK1.8 ä»¥å‰ï¼Œå¤šä¸ªæ•°ç»„ï¼Œåˆ†æ®µåŠ é”ï¼Œä¸€ä¸ªæ•°ç»„ä¸€ä¸ªé”ã€‚ä»–å°†ä¸€ä¸ªå¤§çš„ ConcurrentHashMap åˆ†æˆ 16 ä¸ªå°çš„ Segmentã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åŒæ—¶æ‰¿å— 16 ä¸ªçº¿ç¨‹çš„å¹¶å‘ã€‚\nJDK1.8 ä»¥åï¼Œæ•°ç»„é‡Œæ¯ä¸ªå…ƒç´ è¿›è¡Œ put æ“ä½œï¼Œéƒ½æ˜¯æœ‰ä¸€ä¸ªä¸åŒçš„é”ï¼Œå¯¹å½“ä¸ªä½ç½®è¿›è¡Œ put æ“ä½œæ—¶ï¼Œé‡‡å–çš„æ˜¯ CAS çš„ç­–ç•¥ã€‚å¦‚æœ CAS æ“ä½œå¤±è´¥ï¼Œå°±ä½¿ç”¨ synchronized å¯¹è¿™ä¸ªä½ç½®çš„å¯¹è±¡è¿›è¡Œé”å®šï¼Œç„¶ååŸºäºé“¾è¡¨æˆ–çº¢é»‘æ ‘ï¼Œå¯¹æ•°ç»„å…ƒç´ è¿›è¡Œå†™å…¥ã€‚\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["Java","é¢è¯•","å…«è‚¡æ–‡","HashMap","JavaåŸºç¡€"]},{"title":"é¢è¯•-è®¡ç®—æœºåŸºç¡€","url":"/posts/cb03b778/","content":"\n\nå‰è¨€\nâ—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24-06-18 åˆå§‹è®°å½•24-06-21 ç½‘ç»œå®‰å…¨\n\nç½‘ç»œ\nâ—TCP IP å››å±‚ç½‘ç»œæ¨¡å‹ã€OSI ä¸ƒå±‚ç½‘ç»œæ¨¡å‹\n\nå¤§ç™½è¯æè¿°ã€‚\n\n\n\nç‰©ç†å±‚ï¼šç½‘çº¿ï¼Œç”µç¼†ï¼Œåœ¨ç‰©ç†å±‚é¢è¿æ¥ç½‘ç»œã€‚ï¼ˆå¯ä»¥å‘é€ 0ï¼Œ1 ä¿¡å·ï¼‰\n\n\næ•°æ®é“¾è·¯å±‚ï¼šå®šä¹‰ä¸€å¥—åè®®ï¼Œå¯¹ 01 æ•°æ®è¿›è¡Œåˆ†ç»„ã€‚æŠŠä¸€å † 0/1 ç”µè·¯ä¿¡å·ï¼Œå°è£…æˆæ•°æ®åŒ…ï¼ŒåŒ…å«å¤´å’Œæ•°æ®ï¼Œå¤´åŒ…å«äº†ç›®æ ‡çš„ mac åœ°å€ï¼ˆä»ä¸€å°ç”µè„‘çš„ç½‘å¡å‘é€åˆ°å¦ä¸€å°ç½‘å¡ï¼‰ã€‚\nä»¥å¤ªç½‘è§„å®šäº†æ¯ä¸ªç½‘å¡åŒ…å«ä¸€ä¸ª mac åœ°å€ï¼ˆå”¯ä¸€ï¼‰ã€‚\nåœ¨ä¸€ä¸ªå±€åŸŸç½‘/å­ç½‘å†…ï¼Œç”µè„‘æ˜¯å¹¿æ’­ç»™æ‰€æœ‰çš„ç”µè„‘ï¼ˆé€šè¿‡ç½‘ç»œäº¤æ¢æœºï¼‰ï¼Œé€šè¿‡å¤´çš„ mac åœ°å€ï¼Œå®ç°é€šä¿¡ã€‚\n\n\nç½‘ç»œå±‚ï¼šIP åè®®ã€‚å¦‚æœè®¡ç®—æœºä¸åœ¨å­ç½‘å†…ï¼Œéœ€è¦è·¯ç”±å™¨è¿›è¡Œå­ç½‘çš„è¿æ¥ï¼ˆå­ç½‘å†…çš„è¯·æ±‚æŠŠè·¯ç”±å™¨çš„ mac åœ°å€å’Œè¯·æ±‚çš„ mac åœ°å€éƒ½å†™ä¸Šï¼Œè·¯ç”±å™¨æŠŠè¯·æ±‚è½¬å‘å‡ºå»ï¼šè¿™é‡Œå¯èƒ½æ˜¯å¤šä¸ªç½‘å…³ä¸æ–­è½¬å‘ï¼‰\nåˆ¤æ–­ä¸¤ä¸ª ip æ˜¯ä¸æ˜¯åœ¨åŒä¸€ä¸ªå­ç½‘å†…ï¼Œè¦ç”¨å­ç½‘æ©ç åšä¸è¿ç®—ã€‚å†æ¯”è¾ƒå‰ 3 ä½æ˜¯å¦ä¸€è‡´ï¼ˆä»£è¡¨ç½‘ç»œï¼‰ã€‚\nARP åè®®ï¼šå±€åŸŸç½‘å†…ï¼Œæ¯ä¸ª ip åœ°å€å¯¹åº”ä¸€ä¸ª mac åœ°å€ï¼Œå±€åŸŸç½‘å†…çš„è®¾å¤‡æ˜¯äº’ç›¸çŸ¥é“çš„ã€‚\nç½‘å…³ï¼šå…¶å®å°±æ˜¯è·¯ç”±å™¨çš„ä¸€ç§ã€‚å¯ä»¥æŠŠè·¯ç”±å™¨ä¸Šçš„ ip åœ°å€è®¤ä¸ºæ˜¯ç½‘å…³ã€‚\n\n\nä¼ è¾“å±‚ï¼štcp åè®®ã€udp åè®®ã€‚ç«¯å£å¯¹ç«¯å£ã€‚ï¼ˆç«¯å£å·æ˜¯ 0~65536ï¼Œ0~1023 è¢«å ç”¨ï¼Œåˆ«çš„è¦ç”¨ 1024 ä»¥ä¸Šçš„ç«¯å£ï¼‰\nä¼ è¾“å±‚çš„ tcp åè®®ï¼Œä»…ä»…æ˜¯è§„å®šäº†ä¸€å¥—åŸºäºç«¯å£çš„ç‚¹å¯¹ç‚¹é€šä¿¡åè®®ï¼ŒåŒ…æ‹¬å¦‚ä½•å»ºç«‹è¿æ¥ï¼Œå‘é€å’Œè¯»å–æ¶ˆæ¯ï¼Œå®é™…ä¸Šè¦åŸºäº tcp åè®®å¼€å‘ï¼Œä¸€èˆ¬ä½¿ç”¨ socketã€‚\n\n\nåº”ç”¨å±‚ï¼šhttp åè®®ï¼Œstp åè®®ï¼ˆé‚®ä»¶ï¼‰ã€‚è¯»å–æ•°æ®ï¼Œå¤„ç†æ•°æ®ï¼Œå‘é€å“åº”â€¦â€¦ã€‚\n\n\n4 å±‚æ¨¡å‹ï¼šæ•°æ®é“¾è·¯å±‚ -&gt; ç½‘ç»œå±‚ -&gt; ä¼ è¾“å±‚ -&gt; åº”ç”¨å±‚\n7 å±‚æ¨¡å‹ï¼šç‰©ç†å±‚ -&gt; 4 å±‚æ¨¡å‹ï¼ˆå…¶ä¸­ï¼šä¼šè¯å±‚ï¼ˆSQLï¼‰ã€è¡¨ç¤ºå±‚ï¼ˆåŠ å¯†ã€ASCIIï¼‰ã€åº”ç”¨å±‚ï¼ˆHTTPï¼‰ -&gt; åº”ç”¨å±‚ï¼‰\nDNS åœ°å€ï¼šæŠŠåŸŸååœ°å€å‘é€ç»™ DNS æœåŠ¡å™¨ï¼ŒDNS æœåŠ¡å™¨ï¼ˆ8.8.8.8ï¼‰å‘Šè¯‰ä½ åŸŸååœ°å€å¯¹åº”çš„ ip å’Œç«¯å£å·ã€‚\nHTTP åè®®çš„ç‰¹ç‚¹æœ‰å“ªäº›ï¼Ÿ\n\n\né»˜è®¤ç«¯å£ä¸º 80ï¼›\n\n\nä¸€æ¬¡è¯·æ±‚å¯¹åº”ä¸€æ¬¡å“åº”ï¼›\n\n\næ— çŠ¶æ€ï¼šå¤šæ¬¡è¯·æ±‚å’Œå“åº”é—´çš„æ•°æ®æ˜¯ä¸å…±äº«çš„ï¼Œå¯ä»¥é€šè¿‡ä¼šè¯æŠ€æœ¯è§£å†³è¯¥é—®é¢˜ã€‚\n\n\nâ—æµè§ˆå™¨è¯·æ±‚ä¸€ä¸ªé“¾æ¥çš„å…¨è¿‡ç¨‹\n\n\næŠŠåŸŸååœ°å€å‘é€ç»™ DNS æœåŠ¡å™¨ï¼ŒDNS è§£æåŸŸååˆ°æœåŠ¡å™¨åœ°å€\n\n\nå…ˆä¼šåˆ¤æ–­ ip åœ°å€æ˜¯ä¸æ˜¯åœ¨ä¸€ä¸ªå­ç½‘å†…ï¼Œä¸æ˜¯å°±èµ°ç½‘å…³ã€‚ç›´æ¥æŠŠæµè§ˆå™¨å‘é€çš„æ•°æ®æŒ‰åº”ç”¨å±‚åè®®ï¼Œæ¯”å¦‚ http åè®®æ‰“åŒ…æˆä¸€ä¸ªåº”ç”¨å±‚æ•°æ®åŒ…ï¼ˆåŒ…å« http è¯·æ±‚æŠ¥æ–‡ï¼‰ã€‚\n\n\næŒ‰ tcp åè®®çš„è§„å®šï¼Œç”Ÿæˆ tcp æ•°æ®åŒ…ï¼Œè¯·æ±‚å¤´åŒ…å«ï¼Œå‘é€çš„ç«¯å£å’Œè¯·æ±‚çš„ç«¯å£ï¼›tcp æ•°æ®åŒ…åŒ…å« http æ•°æ®åŒ…ã€‚\n\n\næŒ‰ ip åè®®çš„è§„å®šï¼Œç”Ÿæˆ ip æ•°æ®åŒ…ï¼Œè¯·æ±‚å¤´åŒ…å«ï¼Œå‘é€çš„ ip åœ°å€å’Œè¯·æ±‚çš„ ip åœ°å€ï¼›ip æ•°æ®åŒ…åŒ…å« tcp æ•°æ®åŒ…ã€‚\n\n\næŒ‰ä»¥å¤ªç½‘çš„åè®®ï¼Œç”Ÿæˆä»¥å¤ªç½‘æ•°æ®åŒ…ï¼Œè¯·æ±‚å¤´åŒ…å«ï¼Œå‘é€çš„ç½‘å¡ mac åœ°å€å’Œè¯·æ±‚çš„ç½‘å¡ mac åœ°å€ï¼ˆç½‘å…³çš„ mac åœ°å€ï¼‰ï¼›ä»¥å¤ªç½‘æ•°æ®åŒ…ï¼ŒåŒ…å« ip æ•°æ®åŒ…ã€‚ä»¥å¤ªç½‘æ•°æ®åŒ…é™åˆ¶å¤§å° 1500 å­—èŠ‚ï¼Œæ‰€ä»¥ä¼šè¿›è¡Œåˆ‡å‰²ã€‚\n\n\næ‰“åŒ…å®Œæ¯•ï¼ŒæŠŠä»¥å¤ªç½‘æ•°æ®åŒ…é€šè¿‡ç½‘ç»œäº¤æ¢æœºå‘é€ç»™ï¼ˆè·¯ç”±å™¨ï¼‰ç½‘å…³ï¼Œç»è¿‡ç½‘å…³çš„å¤šæ¬¡è½¬å‘ï¼Œå‘é€ç»™è¯·æ±‚åŸŸåçš„æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æŒ‰åŒ…çš„åºå·é‡æ–°æ‹¼æ¥ã€å±‚å±‚è§£åŒ…ï¼Œè·å– http è¯·æ±‚æŠ¥æ–‡ã€‚ç¨‹åºè·å–è¯·æ±‚ï¼Œåšå‡ºå“åº”ï¼Œä¸€å±‚å±‚å°è£…å†å“åº”ã€‚\n\n\nâ—ç”»ä¸€ä¸‹ TCP ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹æµç¨‹å›¾ã€‚ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡ï¼Ÿ\nä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯ -&gt;æœåŠ¡ç«¯ -&gt;å®¢æˆ·ç«¯\nå››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯ -&gt;æœåŠ¡ç«¯ -&gt;æœåŠ¡ç«¯ -&gt;å®¢æˆ·ç«¯\nä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡ï¼šå¦‚æœåªæœ‰äºŒæ¬¡æ¡æ‰‹ï¼Œå¯èƒ½ä¼šå‡ºç°æ¯”å¦‚ï¼šå‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œå¡åœ¨åŠè·¯ï¼›å‘é€äºŒæ¬¡è¯·æ±‚ï¼Œæ¡æ‰‹æˆåŠŸã€‚è¿™æ—¶ä¸€æ¬¡è¯·æ±‚å‘é€æˆåŠŸï¼ŒæœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯æ— å“åº”ï¼Œèµ„æºæµªè´¹ã€‚å¦‚æœæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œç¬¬ä¸‰æ¬¡æ¡æ‰‹å¯ä»¥å¤ä½è¿æ¥ï¼Œé‡Šæ”¾èµ„æºã€‚\nâ—http çš„å·¥ä½œæµç¨‹ï¼Ÿhttp1.0ã€http1.1ã€http2.0 å…·ä½“æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\nå·¥ä½œæµç¨‹å°±æ˜¯æµè§ˆå™¨è¯·æ±‚ä¸€ä¸ªé“¾æ¥çš„å…¨è¿‡ç¨‹ã€‚\nhttp1.0ï¼štcp çŸ­è¿æ¥ã€‚ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹ï¼Œæ–­å¼€è¿æ¥ã€‚\nhttp1.1ï¼šé»˜è®¤æ”¯æŒé•¿è¿æ¥ï¼Œç¬¬ä¸€æ¬¡æ‰“å¼€ç½‘é¡µï¼Œå°±ä¼šæ‰“å¼€ä¸€ä¸ª tcp è¿æ¥ï¼Œæ¥ç€ä¸€æ®µæ—¶é—´å†…éƒ½ä¸å…³é—­ã€‚æ‰€æœ‰ç½‘é¡µèµ„æºçš„è·å–èµ°åŒä¸€ä¸ª tcp è¿æ¥ï¼Œç›´åˆ°è·å–å®Œæ¯•ï¼Œå…³é—­è¿æ¥ã€‚ä½†æ˜¯æ¯ä¸ªé€šé“éƒ½éœ€è¦ä¸€ä¸ªçº¿ç¨‹å®ˆæŠ¤ï¼Œå¤§å¤§å½±å“æœåŠ¡å™¨çš„å¹¶å‘èƒ½åŠ›ï¼ˆç›®å‰æ˜¯ä¸»æµç‰ˆæœ¬ BIOï¼‰ã€‚\nhttp2.0ï¼šæ”¯æŒå¤šè·¯å¤ç”¨ï¼Œä¸€ä¸ª tcp è¿æ¥å¯ä»¥å¹¶è¡Œå‘é€å¤šä¸ªè¯·æ±‚ä»¥åŠæ¥æ”¶å“åº”æ•°æ®ã€‚äºŒè¿›åˆ¶åˆ†å¸§ï¼Œå°†ä¼ è¾“æ•°æ®æ‹†åˆ†æˆæ›´å°çš„åŒ…ã€‚ï¼ˆåº•å±‚åŸºäº NIO çš„é€‰æ‹©å™¨æŠ€æœ¯å®ç°ï¼Œæœªæ™®åŠï¼‰\nBIOã€NIOã€AIO æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nBIOï¼šBlock IO åŒæ­¥é˜»å¡å¼ IOï¼Œå°±æ˜¯æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨çš„ä¼ ç»Ÿ IOï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ¨¡å¼ç®€å•ã€ä½¿ç”¨æ–¹ä¾¿ï¼Œå¹¶å‘å¤„ç†èƒ½åŠ›ä½ã€‚\n\n\næ¯ä¸ªå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šä¿¡éƒ½ä¼šå»ºä¸€ä¸ªé…å¯¹çš„ socket çº¿ç¨‹ã€‚ç¼ºç‚¹ï¼šè¿æ¥å®¢æˆ·ç«¯è¿‡å¤šï¼ŒæœåŠ¡å™¨ä¼šå®•æœºã€‚ä¼˜åŒ–ï¼šå»ºä¸€ä¸ªçº¿ç¨‹æ± ã€‚\n\n\nNIOï¼ˆæ¯”è¾ƒå¸¸ç”¨ï¼‰ï¼šNon IO åŒæ­¥éé˜»å¡ IOï¼Œæ˜¯ä¼ ç»Ÿ IO çš„å‡çº§ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯é€šè¿‡ Channelï¼ˆé€šé“ï¼‰é€šè®¯ï¼Œå®ç°äº†å¤šè·¯å¤ç”¨ã€‚\n\n\næœåŠ¡ç«¯æœ‰ä¸€ä¸ª selector çº¿ç¨‹ï¼ˆä¸€èˆ¬ +Cached çº¿ç¨‹æ± ï¼‰ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼Œæ³¨å†Œåˆ›å»ºä¸€ä¸ª channelã€‚å¦‚æœå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œå¯¹ channel åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼ˆä»çº¿ç¨‹æ± ï¼‰ï¼Œå¤„ç†å®Œè¯·æ±‚çº¿ç¨‹è¢«é”€æ¯ã€‚\n\n\nAIOï¼šAsynchronous IO æ˜¯ NIO çš„å‡çº§ï¼Œä¹Ÿå« NIO2ï¼Œå®ç°äº†å¼‚æ­¥éå µå¡ IO ï¼Œå¼‚æ­¥ IO çš„æ“ä½œåŸºäºäº‹ä»¶å’Œå›è°ƒæœºåˆ¶ã€‚\n\n\nNIO æ¯” BIO å¤šäº†ä¸€ä¸ª bufferï¼ˆç¼“å†²åŒºï¼‰çš„æ¦‚å¿µï¼Œçº¿ç¨‹ä» channel è¯»å–æ•°æ®ä¼šä»ç¼“å†²åŒºè¯»å–ï¼ˆè¿™ä¸ªè¯»å–æ˜¯ç›´æ¥äº¤ç»™æ“ä½œç³»ç»Ÿæ¥å¹²çš„ï¼Œæ˜¯å¼‚æ­¥çš„ï¼Œæ“ä½œç³»ç»Ÿè¯»å®Œæ•°æ®ï¼Œå†å‘Šè¯‰çº¿ç¨‹å»å¤„ç†ï¼‰ï¼Œå†™å…¥ç¼“å†²åŒºï¼ˆè¿™ä¸ªä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼‰ã€‚\n\n\nå°ç»“ï¼š\n\n\nBIO æ˜¯ä¸€ä¸ªè¿æ¥ä¸€ä¸ªçº¿ç¨‹ã€‚ï¼ˆåªè¦è¿æ¥ï¼Œå°±åˆ†é…ä¸€ä¸ªçº¿ç¨‹ï¼‰\n\n\nNIO æ˜¯ä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ã€‚ï¼ˆåªæœ‰ IO è¯·æ±‚ï¼Œæ‰åˆ†é…ä¸€ä¸ªçº¿ç¨‹ï¼‰\n\n\nAIO æ˜¯ä¸€ä¸ªæœ‰æ•ˆè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ã€‚ï¼ˆAIO æ˜¯å¼‚æ­¥çš„ NIOï¼‰\n\n\nåŒæ­¥é˜»å¡ã€åŒæ­¥éé˜»å¡ã€å¼‚æ­¥éé˜»å¡\nBIO åŒæ­¥é˜»å¡ã€‚ä¸æ˜¯å®Œå…¨ç½‘ç»œé€šä¿¡æ¨¡å‹ï¼Œæ˜¯é’ˆå¯¹ç£ç›˜æ–‡ä»¶çš„ IO è¯»å†™ã€‚\nNIO æ˜¯åŒæ­¥éé˜»å¡ã€‚å‘èµ·è¯·æ±‚åå¯ä»¥å»å¹²åˆ«çš„äº‹ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦ä¸»åŠ¨è½®è¯¢æ“ä½œç³»ç»Ÿã€‚\nAIO æ˜¯å¼‚æ­¥éé˜»å¡ã€‚æ“ä½œç³»ç»Ÿå¼‚æ­¥é€šçŸ¥ã€‚\n// todo çœ‹ demo ä»£ç \nâ—èŠèŠ HTTPS çš„å·¥ä½œåŸç†ï¼Ÿä¸ºä»€ä¹ˆç”¨ HTTPS å°±å¯ä»¥åŠ å¯†é€šä¿¡ï¼Ÿ\n\n\næµè§ˆå™¨æŠŠæ”¯æŒçš„åŠ å¯†è§„åˆ™å‘é€ç»™ç½‘ç«™ã€‚ç½‘ç«™é€‰æ‹©ä¸€å¥—åŠ å¯†ç®—æ³•å’Œ hash ç®—æ³•ã€‚\n\n\nç½‘ç«™å‘è‡ªå·±çš„è¯ä¹¦ï¼ˆç½‘ç«™åœ°å€ã€åŠ å¯†å…¬é’¥ã€é¢å‘æœºæ„ï¼‰\n\n\næµè§ˆå™¨å»éªŒè¯è¯ä¹¦æ˜¯å¦åˆæ³•ï¼ˆåˆæ³•é“¾æ¥ä¼šæœ‰ä¸€æŠŠé”ï¼‰ã€‚æµè§ˆå™¨æ¥ç€ç”Ÿæˆä¸€ä¸²éšæœºæ•°å¯†ç ï¼Œç„¶åç”¨è¯ä¹¦é‡Œçš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œè¿™å—èµ°çš„éå¯¹ç§°åŠ å¯†ï¼›å‘é€æ¶ˆæ¯çš„ hash å€¼ï¼ˆè¿™ä¸ªæ˜¯ç”¨éšæœºå¯†ç åŠ å¯†è¿‡çš„ï¼‰\n\n\nç½‘ç«™ä»æ¶ˆæ¯é‡Œæå‡ºå…¬é’¥åŠ å¯†åçš„éšæœºæ•°å¯†ç ï¼ˆç”¨ç§é’¥è§£å¯†ï¼‰ï¼Œç”¨éšæœºæ•°å¯†ç å†å¯¹æ¶ˆæ¯è¿›è¡Œè§£å¯†ï¼Œç„¶åç”¨ hash ç®—æ³•å¯¹æ¶ˆæ¯è®¡ç®— hash å€¼å¹¶ä¸æµè§ˆå™¨å‘é€çš„ hash å€¼è¿›è¡Œæ¯”å¯¹ã€‚ç½‘ç«™åŒæ ·ä¸Šé¢çš„æ­¥éª¤å‘é€ï¼Œæµè§ˆå™¨åŒæ ·è§£å¯†ã€‚\n\n\nä¹‹åæµè§ˆå™¨å’Œç½‘ç«™è¿›è¡Œçš„é€šä¿¡ï¼Œéƒ½æ˜¯èµ°éšæœºå¯†ç åŠ å¯†ï¼Œæ­¤æ—¶éšæœºå¯†ç å·²ç»å­˜åœ¨æµè§ˆå™¨å’Œç½‘ç«™çš„æœ¬åœ°ã€‚åç»­ä¸ç”¨å†é’ˆå¯¹è¿™ä¸ªè¿›è¡ŒåŠ å¯†è§£å¯†ã€‚ï¼ˆå› ä¸ºè¿™ä¸ªåŠ å¯†è§£å¯†åªåœ¨ç¬¬ä¸€æ¬¡é“¾æ¥å‘é€ï¼Œå¹¶ä¸”è¦è¯ä¹¦æ‰èƒ½åŠ å¯†è§£å¯†ï¼Œæ‰€ä»¥å®‰å…¨æ€§è¾ƒé«˜ï¼‰\n\n\nhttp çš„é•¿è¿æ¥çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\ndubbo åè®®èµ°çš„é•¿è¿æ¥ï¼Œå¯èƒ½ä¼šå¸¦åˆ°è¿™ä¸ªã€‚\n\nhttp1.0 åº•å±‚ tcp æ˜¯çŸ­è¿æ¥ï¼Œhttp1.1 å³ä»¥åéƒ½æ˜¯é•¿è¿æ¥ï¼ˆå»ºç«‹äº†è¿æ¥ä¹‹åï¼Œæ— è®ºæœ‰å¤šå°‘æ¬¡è¯·æ±‚éƒ½æ˜¯èµ°ä¸€ä¸ª tcp è¿æ¥ï¼‰ã€‚\nGET è¯·æ±‚å’Œ POST è¯·æ±‚æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ\n\n\nè¯·æ±‚å‚æ•°çš„æºå¸¦æ–¹å¼åŒï¼šget è¯·æ±‚æ”¾åœ¨è¯·æ±‚è¡Œä¸­ï¼Œpost æ”¾åœ¨è¯·æ±‚ä½“ä¸­ã€‚\n\n\nget è¯·æ±‚ï¼Œè¯·æ±‚å‚æ•°æ˜¯åœ¨è¯·æ±‚è¡Œä¸­ï¼Œæ•°æ®çš„å¤§å°å—åˆ°æµè§ˆå™¨é™åˆ¶ï¼›post è¯·æ±‚åˆ™æ˜¯æ”¾åœ¨è¯·æ±‚ä½“ä¸­ï¼Œæ•°æ®æ— å¤§å°é™åˆ¶ã€‚\n\n\nget è¯·æ±‚çš„å®‰å…¨æ€§ä½ï¼Œpost è¯·æ±‚ç›¸å¯¹å®‰å…¨æ€§é«˜ï¼ˆä¸ä¼šä½œä¸º url çš„ä¸€éƒ¨åˆ†ï¼Œä¸ä¼šè¢«ç¼“å­˜ã€ä¿å­˜åœ¨æœåŠ¡å™¨æ—¥å¿—ã€ä»¥åŠæµè§ˆå™¨æµè§ˆè®°å½•ä¸­ï¼‰ï¼Œä¸” post å¯ä»¥è¿›è¡ŒåŠ å¯†æ“ä½œã€‚\n\n\nget çš„æ•ˆç‡æ¯” post æ›´é«˜ï¼Œå› ä¸º post è¯·æ±‚åœ¨çœŸæ­£æ¥å—æ•°æ®ä¹‹å‰ä¼šå…ˆå°†è¯·æ±‚å¤´å‘é€ç»™æœåŠ¡å™¨è¿›è¡Œç¡®è®¤ï¼Œç„¶åæ‰çœŸæ­£å‘é€æ•°æ®ï¼Œæ‰€ä»¥ get ä¸€å®šæ˜¯å…ˆäº post æ‰§è¡Œçš„ã€‚\n\n\nä½†æ˜¯ï¼š æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒGET è¯·æ±‚å’Œ POST è¯·æ±‚æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œåªæ˜¯åœ¨æµè§ˆå™¨ç«¯å¯¹å®ƒä»¬çš„ä½¿ç”¨ä¸åŒè€Œå·²ï¼Œå®ƒä»¬åº•å±‚éƒ½æ˜¯åŸºäº TCPï¼ˆä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹ï¼‰çš„ Socket è¿›è¡Œæ•°æ®ä¼ è¾“çš„ã€‚\nSocket å·¥ä½œåŸç†\n\nsocket æ˜¯å±äºä¼ è¾“å±‚çš„ç¼–ç¨‹è§„èŒƒã€‚æŒ‰ç…§è§†é¢‘è®²è¿°çš„å†…å®¹ï¼šå°±æ˜¯æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚é“¾æ¥çš„éƒ¨åˆ†\n\n\n\næŒ‰ tcp åè®®çš„è§„å®šï¼Œç”Ÿæˆ tcp æ•°æ®åŒ…ï¼Œè¯·æ±‚å¤´åŒ…å«ï¼Œå‘é€çš„ç«¯å£å’Œè¯·æ±‚çš„ç«¯å£ï¼›tcp æ•°æ®åŒ…åŒ…å« http æ•°æ®åŒ…ã€‚\n\n\næŒ‰ ip åè®®çš„è§„å®šï¼Œç”Ÿæˆ ip æ•°æ®åŒ…ï¼Œè¯·æ±‚å¤´åŒ…å«ï¼Œå‘é€çš„ ip åœ°å€å’Œè¯·æ±‚çš„ ip åœ°å€ï¼›ip æ•°æ®åŒ…åŒ…å« tcp æ•°æ®åŒ…ã€‚\n\n\næŒ‰ä»¥å¤ªç½‘çš„åè®®ï¼Œç”Ÿæˆä»¥å¤ªç½‘æ•°æ®åŒ…ï¼Œè¯·æ±‚å¤´åŒ…å«ï¼Œå‘é€çš„ç½‘å¡ mac åœ°å€å’Œè¯·æ±‚çš„ç½‘å¡ mac åœ°å€ï¼ˆç½‘å…³çš„ mac åœ°å€ï¼‰ï¼›ä»¥å¤ªç½‘æ•°æ®åŒ…ï¼ŒåŒ…å« ip æ•°æ®åŒ…ã€‚ä»¥å¤ªç½‘æ•°æ®åŒ…é™åˆ¶å¤§å° 1500 å­—èŠ‚ï¼Œæ‰€ä»¥ä¼šè¿›è¡Œåˆ‡å‰²ã€‚\n\n\næ‰“åŒ…å®Œæ¯•ï¼ŒæŠŠä»¥å¤ªç½‘æ•°æ®åŒ…é€šè¿‡ç½‘ç»œäº¤æ¢æœºå‘é€ç»™ï¼ˆè·¯ç”±å™¨ï¼‰ç½‘å…³ï¼Œç»è¿‡ç½‘å…³çš„å¤šæ¬¡è½¬å‘ï¼Œå‘é€ç»™è¯·æ±‚åŸŸåçš„æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æŒ‰åŒ…çš„åºå·é‡æ–°æ‹¼æ¥ã€å±‚å±‚è§£åŒ…ï¼Œè·å– http è¯·æ±‚æŠ¥æ–‡ã€‚ç¨‹åºè·å–è¯·æ±‚ï¼Œåšå‡ºå“åº”ï¼Œä¸€å±‚å±‚å°è£…å†å“åº”ã€‚\n\n\nâ”è¿›ç¨‹é—´æ˜¯å¦‚ä½•é€šä¿¡çš„\nè¿›ç¨‹é—´çš„é€šä¿¡ï¼šç®¡é“ï¼ˆåŠåŒå·¥ï¼‰ã€å‘½åç®¡é“ï¼ˆåŠåŒå·¥ï¼‰ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å…±äº«å†…å­˜\nâ”çº¿ç¨‹é—´åˆå¦‚ä½•åˆ‡æ¢\nä¸Šä¸‹æ–‡åˆ‡æ¢ã€æ—¶é—´ç‰‡ç®—æ³•ã€‚\nåœºæ™¯é¢˜\nçº¿ä¸ŠæœåŠ¡å™¨çš„ cpu ä½¿ç”¨åˆ°è¾¾ 100%ï¼Œå¦‚ä½•æ’æŸ¥ã€å®šä½ã€è§£å†³é—®é¢˜ï¼Ÿ\n\nå°±æ˜¯æ‰¾å“ªæ®µä»£ç å‡ºäº†é—®é¢˜ã€‚\nåœºæ™¯ï¼šcatch æ—¶å†™äº†æ­»å¾ªç¯ã€‚åœ¨ catch ä¸­è°ƒç”¨äº†è‡ªå·±çš„æ–¹æ³•\n\n\n\nå®šä½è€—è´¹ cpu çš„è¿›ç¨‹\n\n\n# æ˜¾ç¤ºè¿›ç¨‹åˆ—è¡¨top -c# ç„¶åè¾“å…¥ Pï¼ŒæŒ‰ç…§ cpu ä½¿ç”¨ç‡æ’åº# è¾“å…¥ Mï¼ŒæŒ‰ç…§å†…å­˜æ’åº\n\n\nå®šä½è€—è´¹ cpu çš„çº¿ç¨‹\n\n\n# è¿™é‡Œçš„ pid å°±æ˜¯ä¸Šä¸€æ­¥æŸ¥å‡ºæ¥çš„ pidtop -Hp pid# è¿™æ ·å¯ä»¥è·å–çº¿ç¨‹çš„ pid# ç„¶åè¾“å…¥ Pï¼ŒæŒ‰ç…§ cpu ä½¿ç”¨ç‡æ’åº\n\n\nå®šä½å“ªæ®µä»£ç å¯¼è‡´çš„ cpu è¿‡é«˜\n\n\n# è¿™é‡Œçš„ pid æ˜¯ä¸Šä¸€æ­¥è·å–åˆ°çš„ çº¿ç¨‹ pid ä¸ºäº†è·å–å®ƒçš„16è¿›åˆ¶è¡¨ç¤ºprintf &quot;%x\\n&quot; pid# jstack è¿›è¡Œåˆ†æjstack è¿›ç¨‹pid | grep &#x27;çº¿ç¨‹pid&#x27; -C -color\nçº¿ä¸Šè¿›ç¨‹ kill ä¸æ‰æ€ä¹ˆåŠï¼Ÿ\n\nåœºæ™¯ï¼šå‘å¸ƒç³»ç»Ÿæäº†ä¸€ä¸ªå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›ç¨‹ã€‚æ€ä¸æ‰ã€‚\n\nkill ä¸€ä¸ªè¿›ç¨‹ kill ä¸æ‰ï¼Œè¿™ä¸ªè¿›ç¨‹å°±æ˜¯å˜æˆäº†ä¸€ä¸ªåƒµå°¸è¿›ç¨‹ï¼ˆzombieï¼‰çŠ¶æ€ã€‚å› ä¸ºè¿™ä¸ªè¿›ç¨‹é‡Šæ”¾äº†èµ„æºï¼Œä½†æ˜¯çˆ¶è¿›ç¨‹æ²¡æœ‰ç¡®è®¤ã€‚\n# æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹å’Œå…¶çŠ¶æ€ï¼Œå¯ä»¥åŠ  grep è¿‡æ»¤ps aux # æŸ¥çœ‹ STAT é‚£ä¸€æ ï¼Œå¦‚æœæ˜¯ Zï¼Œå°±æ˜¯åƒµå°¸è¿›ç¨‹ps -ef|grep åƒµå°¸è¿›ç¨‹idï¼Œå¯ä»¥æ‰¾åˆ°çˆ¶è¿›ç¨‹id# ç„¶åå…ˆ kill çˆ¶è¿›ç¨‹ï¼Œå† kill å­è¿›ç¨‹\næœåŠ¡å™¨å­˜å‚¨ç©ºé—´å¿«æ»¡äº†ï¼Œåœ¨ä¸å½±å“æœåŠ¡æ­£å¸¸è¿è¡Œçš„æƒ…å†µä¸‹æ€ä¹ˆè§£å†³ï¼Ÿ\n\n\nä¸€èˆ¬æ¥è¯´ï¼Œå¯èƒ½æ˜¯æ—¥å¿—å†™æ»¡äº†ã€‚å¯ä»¥å» spring boot ä¸‹çš„æ—¥å¿—å»çœ‹çœ‹ã€‚è¿˜å¯ä»¥å†™ä¸ª shell è„šæœ¬ï¼Œcrontab å®šæ—¶ï¼Œå®šæœŸåˆ é™¤ 7 å¤©ä»¥å‰çš„æ—¥å¿—ã€‚\n\n\n# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µdf -h\n\n\nè¦æ˜¯ä¸è¡Œ\n\n\n# æ‰¾å¤§äº100Mçš„æ–‡ä»¶find / -size +100M |xargs ls -lh# çœ‹å„ä¸ªç›®å½•å ç”¨çš„ç£ç›˜å¤§å°ã€‚è¿™ä¸ªå‘½ä»¤å¯ä»¥æŠŠå ç”¨å¤§å°å¯¼å‡ºdu -h &gt;fs_du.log\nå®‰å…¨\nâ—é»‘å®¢å¸¸ç”¨çš„ XSS ç½‘ç»œæ”»å‡»åŸç†\nXSS æ”»å‡»å’Œ SQL æ³¨å…¥æ˜¯å¤§éƒ¨åˆ†çš„é»‘å®¢è¿›è¡Œç½‘ç»œæ”»å‡»çš„æ‰‹æ®µï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ CSRFã€Session åŠ«æŒä¹‹ç±»çš„ã€‚\nXSS æ”»å‡»ï¼š\n\n\nåå°„å‹æ”»å‡»ï¼ˆåœ¨ URL é“¾æ¥é‡ŒåµŒå…¥è‡ªå·±çš„æ¶æ„è„šæœ¬ï¼‰ã€‚è¿™ä¸ª URL åœ°å€æŒ‡å‘é»‘å®¢çš„æœåŠ¡å™¨ï¼Œä»–çš„æœåŠ¡å™¨ä¼šè¿”å›ä¸€æ®µ html+javascript æ¶æ„è„šæœ¬ï¼ˆè·¨ç«™ç‚¹è„šæœ¬ï¼‰ï¼Œåœ¨ç½‘é¡µå†…è¿è¡Œï¼ˆè·³è½¬ã€ä¸‹è½½ã€ç—…æ¯’ã€æµæ°“è½¯ä»¶ï¼‰ã€‚\n\nè¿™ä¸ªè„šæœ¬ï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨è·å–å¤§é‡çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ä¸€äº› cookie/å¯†ç ã€‚å¯ä»¥åˆ©ç”¨ cookie ä¼ªé€ ç”¨æˆ·ç™»å½•çš„ session çŠ¶æ€ï¼Œä»¥ç”¨æˆ·çš„åä¹‰å¹²ä¸€äº›äº‹æƒ…ã€‚\nå¤„ç†æ–¹æ³•ï¼šHttpOnly æ–¹å¼ï¼Œåœ¨æµè§ˆå™¨å­˜æ”¾ cookie æ—¶ï¼Œè®¾ç½®ä¸€ä¸ª HttpOnly å±æ€§ã€‚\n\n\n\næŒä¹…å‹æ”»å‡»ã€‚æŠŠæ¶æ„è„šæœ¬æ”¾åˆ°è¯„è®ºå†…å®¹é‡Œé¢ï¼Œè¿™ä¸ªå†…å®¹ä¼šå­˜åˆ°æ•°æ®åº“ï¼Œç”¨æˆ·è®¿é—®æµè§ˆå™¨å°±ä¼šè®¿é—®è¿™ä¸ªæ¶æ„è„šæœ¬ã€‚\n\nå¤„ç†æ–¹æ³•ï¼šå¯¹è¯„è®ºå†…å®¹è¿›è¡Œæ¶ˆæ¯’ï¼Œå°±æ˜¯è¿›è¡Œä¸€äº›è½¬ä¹‰ï¼Œæ¯”å¦‚æŠŠ &gt; è½¬ä¹‰ä¸º &amp;gt ä¹‹ç±»çš„ã€‚è¿™æ ·å°±å¯ä»¥æŠŠæ¶æ„è„šæœ¬é‡Œçš„ htmlã€js è„šæœ¬ä¹‹ç±»çš„å¤±æ•ˆã€‚\n\n\n\nâ—SQL æ³¨å…¥æ”»å‡»èƒŒåçš„åŸç†\n\næ‰§è¡Œ SQL æ³¨å…¥å¿…é¡»è¦çŸ¥é“ä½ çš„æ•°æ®åº“è¡¨ç»“æ„ã€‚\n\nå¼€æºè½¯ä»¶ï¼Œä¼šè¢«çŸ¥é“è¡¨ç»“æ„\né”™è¯¯å›æ˜¾ã€‚å †æ ˆä¿¡æ¯è¢«æš´éœ²åˆ°å‰ç«¯ã€‚\næ ¹æ®å‚æ•°çš„åç§°ï¼Œå¤§è‡´æ¨æµ‹ï¼ˆä¸€èˆ¬ä¸ç°å®ï¼‰\n\n\nå‚æ•°ä½¿ç”¨é¢„ç¼–è¯‘å¯ä»¥é¢„é˜²ã€‚ä¾‹ï¼šmybatis ä½¿ç”¨ # ä¸ä½¿ç”¨ $\nâ—CSRF æ”»å‡»åŠèƒŒååŸç†\n(Cross Site Request Forgery) è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ã€‚é€šè¿‡æ¶æ„è„šæœ¬è·å–ç”¨æˆ· cookieï¼Œé€šè¿‡ä¼ªé€  cookieï¼Œä¼ªé€ è¯·æ±‚è·å–ä¿¡æ¯ã€‚\nå¤„ç†æ–¹æ³•\n\n\né˜²æ­¢ cookie è¢«çªƒå–ã€‚ç»™ç½‘ç«™çš„ cookie è®¾ç½® HttpOnly å±æ€§ã€‚\n\n\néšæœº tokenã€‚è¯·æ±‚æºå¸¦éšæœº tokenï¼Œå­˜æ”¾åœ¨ redis é‡Œã€‚\n\n\néªŒè¯ç ã€‚\n\n\néªŒè¯è¯·æ±‚ä¸­çš„ refererã€‚\n\n\nâ—å¦‚æœç³»ç»Ÿå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼Œæœ‰å¯èƒ½ä¼šé­åˆ°ä»€ä¹ˆæ”»å‡»\n\næ–‡ä»¶å¯èƒ½æ˜¯å¯æ‰§è¡Œçš„è„šæœ¬ã€ç—…æ¯’ã€‚\n\nå¤„ç†æ–¹æ³•\n\n\nç™½åå•æ ¡éªŒã€‚é™åˆ¶ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ï¼ˆæ ¹æ®å¼€å¤´å­—èŠ‚çš„ magic number æ¥åˆ¤æ–­æ–‡ä»¶çš„ç±»å‹ã€‚ä¾‹ï¼šFFD8FF:JEPGã€89504E47:PNGï¼‰ã€‚é™åˆ¶æ–‡ä»¶å¤§å°ã€‚å¯¹æ–‡ä»¶é‡å‘½åã€‚å¯¹æ–‡ä»¶è¿›è¡Œä¸€å®šçš„å‹ç¼©ã€‚\n\n\nâ—DDos æ”»å‡»æ˜¯ä»€ä¹ˆ\ndistributed denial of serviceï¼Œåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ã€‚\nDosã€‚å‡è®¾ä½ çš„ç³»ç»Ÿæ¯ç§’èƒ½æ¥å—çš„è¯·æ±‚ä¸º 1000ï¼Œé»‘å®¢ä»¥æ¯ç§’ 1000 çš„è¯·æ±‚è®¿é—®ï¼Œæœºå™¨å°±ä¼šå®•æœºã€‚Dos æ”»å‡»æ˜¯ä¸€å¯¹ä¸€çš„ã€‚ä½†æ˜¯ï¼Œç°åœ¨ç³»ç»Ÿéƒ½è®¾è®¡äº†é›†ç¾¤ã€‚æ”»å‡»ä¸€å°æœåŠ¡å™¨ï¼Œå…¶ä»–æœåŠ¡å™¨è¿˜æ˜¯å¯ä»¥æ¥å—è¯·æ±‚ã€‚\nDDosã€‚æ§åˆ¶å¤§é‡çš„æœºå™¨ï¼ˆè‚‰é¸¡ï¼‰ï¼Œæ¯”å¦‚ä¸€äº›å…±å…¬å¸çš„æœåŠ¡å™¨ï¼ˆè¢«æœ¨é©¬æ¤å…¥ç»™æ§åˆ¶äº†ï¼‰ï¼Œä¸€èµ·æ”»å‡»ç›®æ ‡ã€‚\n\n\nSYN Flood æ¨¡å¼çš„ DDos æ”»å‡»ä¸‰æ¬¡æ¡æ‰‹ã€‚æœåŠ¡å™¨è¿”å› SYN+ACK åï¼Œå¦‚æœæ²¡æœ‰æ¥æ”¶åˆ°è¿”å›ï¼Œä¼šè¿›å…¥ç­‰å¾…åˆ—è¡¨ï¼ˆä¼šä¸ºç­‰å¾…çš„å®¢æˆ·ç«¯é¢„ç•™ç½‘ç»œèµ„æºï¼‰ã€‚è¿™ä¸ªæ¨¡å¼æ˜¯ä¸€ä¸ªæ¼æ´ã€‚é»‘å®¢åˆ©ç”¨è‚‰é¸¡ï¼Œå‘é€å¤§é‡çš„ SYN è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šä¸ºå®ƒä»¬é¢„ç•™ç½‘ç»œèµ„æºï¼ˆç½‘ç»œèµ„æºè€—å°½ï¼‰ã€‚æ­£å¸¸ç”¨æˆ·è®¿é—®å°±ä¼šæ‹’ç»è¿æ¥ã€‚\n\n\nåŸºäº DNS Query Flood çš„ DDos æ”»å‡»æ§åˆ¶è‚‰é¸¡ä¼ªé€ å¤§é‡ä¸å­˜åœ¨çš„åŸŸåï¼ŒæŠŠ DNS æœåŠ¡å™¨ç˜«ç—ªã€‚è¿™æ—¶ç”¨æˆ·è®¿é—®åŸŸååœ°å€å°±ä¼šå¤±è´¥ã€‚\n\n\nåŸºäº Http Flood çš„ DDos æ”»å‡»ï¼ˆcc æ”»å‡»ï¼‰æ§åˆ¶å¤§é‡ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œå»ç»™ç›®æ ‡æœåŠ¡å™¨å‘é€å¤§é‡çš„ HTTP è¯·æ±‚ã€‚\n\n\nå¤„ç†æ–¹æ³•\né‡‡è´­äº‘å‚å•†çš„å®‰å…¨æœåŠ¡ã€‚DDos é«˜é˜² IPï¼Œå¯ä»¥æŠŠæ”»å‡»æµé‡éƒ½å¯¼å…¥åˆ°äº‘å‚å•†çš„é«˜é˜² IP æœåŠ¡å™¨ä¸Šã€‚\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸€å¤©-704äºŒåˆ†æŸ¥æ‰¾ã€27ç§»é™¤å…ƒç´ ","url":"/posts/1d4e4fc4/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šå¯ä»¥é€šè¿‡\n\n\næ›´æ–°\n\n\n24.04.17 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n704 äºŒåˆ†æŸ¥æ‰¾\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/binary-search/\npublic class LE704 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          int[] nums = Arrays.stream(scanner.nextLine().split(&quot;,&quot;))                  .mapToInt(Integer::parseInt)                  .toArray();          int target = Integer.parseInt(scanner.nextLine());          System.out.println(search(nums, target));      &#125;        public static int search(int[] nums, int target) &#123;          for (int i = 0, j = nums.length - 1; i &lt;= j; ) &#123;              int k = (i + j) / 2;              if (nums[k] == target) &#123;                  return k;              &#125;              if (nums[k] &gt; target) &#123;                  j = k - 1;              &#125; else &#123;                  i = k + 1;              &#125;          &#125;            return -1;      &#125;  &#125;\n27 ç§»é™¤å…ƒç´ \né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/remove-element/\npublic class LE27 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          int[] nums = Arrays.stream(scanner.nextLine().split(&quot;,&quot;))                  .mapToInt(Integer::parseInt)                  .toArray();          int val = Integer.parseInt(scanner.nextLine());          System.out.println(removeElement(nums, val));      &#125;        public static int removeElement(int[] nums, int val) &#123;          int i, j;          for (i = 0, j = nums.length - 1; i &lt;= j ; ) &#123;              // ç¬¬ä¸€æ¬¡ä¿®æ”¹ -&gt; ifæ”¹ä¸ºwhile              // ç¬¬ä¸‰æ¬¡ä¿®æ”¹ -&gt; åŠ ä¸Šjçš„è¾¹ç•Œå€¼é™åˆ¶, ä¸ç„¶ä¼šæ•°ç»„è¶Šç•Œ              while (j &gt;= 0 &amp;&amp; nums[j] == val) &#123;                  j--;              &#125;              while (i &lt;= nums.length - 1 &amp;&amp; nums[i] != val) &#123;                  i++;              &#125;              // ç¬¬äºŒæ¬¡ä¿®æ”¹ -&gt; åŠ ä¸Ši &lt; jçš„åˆ¤æ–­, å¦åˆ™æœ€åä¸€æ¬¡äº¤æ¢ä¼šæŠŠæ•°ç»„æ¢ä¹±              if (i &lt; j) &#123;                  int temp = nums[j];                  nums[j] = nums[i];                  nums[i] = temp;              &#125;          &#125;          return i;      &#125;  &#125;\nçœ‹è®²è§£\n704 äºŒåˆ†æŸ¥æ‰¾\næ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0704.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1fA4y1o715\npublic static int search(int[] nums, int target) &#123;      for (int i = 0, j = nums.length - 1; i &lt;= j; ) &#123; \t    // è¿™é‡Œéœ€è¦å†™æˆè¿™ç§æ–¹å¼é˜²æ­¢æ•´æ•°æº¢å‡º\t    // æˆ–è€…ä¹Ÿå¯ä»¥å†™æˆ int k = i + ((j - i) &gt;&gt; 1);\t    int k = i + (j - i) / 2;        // int k = (i + j) / 2;          if (nums[k] == target) &#123;              return k;          &#125;          if (nums[k] &gt; target) &#123;              j = k - 1;          &#125; else &#123;              i = k + 1;          &#125;      &#125;      return -1;  &#125;\n27 ç§»é™¤å…ƒç´ \næ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0027.%E7%A7%BB%E9%99%A4%E5%85%83%E7%B4%A0.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV12A4y1Z7LP\nå…¶å®ã€‚ã€‚ä¸€å¼€å§‹çœ‹é¢˜ç›®æˆ‘æ²¡æœ‰ååº”è¿‡æ¥æš´åŠ›è§£æ³•æ˜¯ä»€ä¹ˆã€‚ç¬¬ä¸€æ—¶é—´å½“ç„¶æ˜¯æƒ³åˆ° iterator().remove()ï¼Œä½†æ˜¯ä¸è¡Œã€‚è€å®è¯´ï¼Œé‚£ä¸ªé¢˜ç›®é‡Œçš„ O(1) é¢å¤–ç©ºé—´æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆç®—çš„ã€‚\næš´åŠ›è§£æ³•æ˜¯åŒå±‚å¾ªç¯ï¼Œåˆ é™¤ä¹‹åçš„æ‰€æœ‰éƒ½å‰ç§»ã€‚\nåŒæŒ‡é’ˆå’Œæˆ‘æƒ³çš„ä¹Ÿå®Œå…¨ä¸ä¸€æ ·ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘å†™çš„è¿™ä¸ªå«ä»€ä¹ˆã€‚ã€‚\npublic static int removeElement(int[] nums, int val) &#123;      int i = 0;      for (int j = 0; j &lt; nums.length; j++) &#123;\t    // å½“ val == nums[j]æ—¶ï¼Œåªæœ‰j++\t    // ä¸‹ä¸€æ¬¡ä¸ç›¸ç­‰æ—¶ï¼Œå‰ä¸€ä¸ªæŒ‡é’ˆçš„åä¸€ä½ç›´æ¥æŒ‡å‘å½“å‰çš„jï¼Œç›¸å½“äºä¸­é—´çš„å…ƒç´ éƒ½è¢«åˆ é™¤äº†ã€‚        if (val != nums[j]) &#123;              nums[i++]= nums[j];          &#125;      &#125;      return i;  &#125;\næ€»ç»“\nå…¶å®éƒ½å±äºå·²ç»çŸ¥é“é¢˜è§£æ–¹å¼å†å»çœ‹é¢˜ï¼ŒåŠ ä¸Šæ˜¯ç®€å•ç®—æ³•ï¼Œæ‰€ä»¥æ„Ÿè§‰éš¾åº¦ä¸æ˜¯å¾ˆå¤§ã€‚ï¼ˆä¹Ÿå¯èƒ½æˆ‘åªæ˜¯ä¸ºäº†æ‰¾å·¥ä½œï¼Œå¯¹æˆ‘æ¥è¯´è§£å‡ºæ¥å°± OKï¼‰\näºŒåˆ†æŸ¥æ‰¾\nå‰æï¼š\n1ã€æœ‰åºæ•°ç»„\n2ã€æ•°ç»„ä¸­æ— é‡å¤å…ƒç´ \næ³¨æ„ï¼š\næ•´æ•°æ•°å€¼è¶Šç•Œçš„é—®é¢˜\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["äºŒåˆ†æŸ¥æ‰¾","åŒæŒ‡é’ˆ","æ•°ç»„"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒå¤©-977æœ‰åºæ•°ç»„çš„å¹³æ–¹ã€209é•¿åº¦æœ€å°çš„å­æ•°ç»„ã€59èºæ—‹çŸ©é˜µII","url":"/posts/d3cf0d1c/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š977ã€209 é€šè¿‡ã€‚59 æ²¡æœ‰æ€è·¯\n\n\næ›´æ–°\n\n\n24.04.18 åˆå§‹è®°å½•24.04.21 è¡¥å……èºæ—‹çŸ©é˜µçš„é¢˜è§£\n\nåˆæ­¥é¢˜è§£\n977 æœ‰åºæ•°ç»„çš„å¹³æ–¹\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/squares-of-a-sorted-array/\npublic class LE977 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          String s = scanner.nextLine();          int[] nums = Arrays.stream(s.substring(1, s.length() - 1).split(&quot;,&quot;))                  .mapToInt(Integer::parseInt)                  .toArray();          System.out.println(Arrays.toString(sortedSquares(nums)));      &#125;  \t// å…³é”®åœ¨äºéé€’å¢é¡ºåºï¼Œè·å–å¹³æ–¹æ•°ï¼Œç»„æˆæ–°çš„éé€’å¢åºåˆ—\t// æ–°æ•°ç»„çš„æœ€å¤§æ•°ä¸€å®šæ¥è‡ªäºæ—§æ•°ç»„çš„ä¸¤ç«¯ã€‚å¹³æ–¹çš„å¤§å°ä¸€å®šä»ä¸¤è¾¹å‘ä¸­é—´é€’å‡\t// ç”¨åŒæŒ‡é’ˆï¼Œä¾æ¬¡å°†æœ€å¤§å€¼æ·»åŠ åˆ°æ–°æ•°ç»„ï¼Œå¹¶å‘å†…ç§»åŠ¨    public static int[] sortedSquares(int[] nums) &#123;          int i = 0;          int j = nums.length - 1;          int k = nums.length - 1;          int[] ints = new int[nums.length];            while (i &lt;= j) &#123;              int i2 = nums[i] * nums[i];              int j2 = nums[j] * nums[j];              ints[k] = Math.max(i2, j2);              k--;              if (i2 &gt;= j2) &#123;                  i++;              &#125; else &#123;                  j--;              &#125;          &#125;        return ints;      &#125;  &#125;\n209 é•¿åº¦æœ€å°çš„å­æ•°ç»„\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/minimum-size-subarray-sum/\npublic class LE209 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          int target = Integer.parseInt(scanner.nextLine());          String s = scanner.nextLine();          int[] nums = Arrays.stream(s.substring(1, s.length() - 1).split(&quot;,&quot;))                  .mapToInt(Integer::parseInt)                  .toArray();          System.out.println(minSubArrayLen(target, nums));      &#125;  \t// çœ‹é¢˜å°±çŸ¥é“æ˜¯æ»‘åŠ¨çª—å£ï¼Œå‰å‡ å¤©åˆšå¥½åšè¿‡    public static int minSubArrayLen(int target, int[] nums) &#123;          int min = 0;          for (int i = 0, j = 0; i &lt; nums.length &amp;&amp; j &lt; nums.length; ) &#123;              int subArraySum = getSum(nums, i, j);              if (target == subArraySum) &#123;                  min = Math.min(min, j - i + 1);                  i++;                  j = i;                  if (min == 1) &#123;                      break;                  &#125;              &#125; else if (target &lt; subArraySum) &#123;                  i++;                  j = i;              &#125; else &#123;                  j++;              &#125;          &#125;          return min;      &#125;        private static int getSum(int[] nums, int i, int j) &#123;          int sum = 0;          for (int k = i; k &lt;= j; k++) &#123;              sum += nums[k];          &#125;          return sum;      &#125;  &#125;\n59 èºæ—‹çŸ©é˜µ II\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/spiral-matrix-ii/\n// çœ‹äº†é¢˜ç›®æ²¡æœ‰ä»€ä¹ˆç®—æ³•ä¸Šçš„æ€è·¯ï¼Œæ‰“ç®—ç›´æ¥çœ‹é¢˜è§£\nçœ‹è®²è§£\n977 æœ‰åºæ•°ç»„çš„å¹³æ–¹\næ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0977.%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E7%9A%84%E5%B9%B3%E6%96%B9.html\nè§†é¢‘è®²è§£ï¼šÂ https://www.bilibili.com/video/BV1QB4y1D7ep\n// è¿™é‡Œçš„é¢˜è§£å’Œæˆ‘çš„æƒ³æ³•å·®ä¸å¤šï¼Œå°±ä¸å¤šå†™äº†\n209 é•¿åº¦æœ€å°çš„å­æ•°ç»„\næ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0209.%E9%95%BF%E5%BA%A6%E6%9C%80%E5%B0%8F%E7%9A%84%E5%AD%90%E6%95%B0%E7%BB%84.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1tZ4y1q7XE\nè¿˜æœ‰ä¸€ä¸ªè¿›é˜¶çš„è§£æ³•ï¼Œæ‰“ç®—æ˜å¤©å†çœ‹çœ‹ï¼Œä¸èƒ½å†ç†¬å¤œäº†ã€‚\n// è¿™é‡Œçš„é¢˜è§£å’Œæˆ‘çš„æƒ³æ³•å·®ä¸å¤šï¼Œå°±ä¸å¤šå†™äº†// è¿›é˜¶éƒ¨åˆ†ç­‰ä¹‹åæœ‰æ—¶é—´äº†è¡¥å……\n59 èºæ—‹çŸ©é˜µ II\næ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0059.%E8%9E%BA%E6%97%8B%E7%9F%A9%E9%98%B5II.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1SL4y1N7mV/\n// å¤§è‡´çœ‹äº†æ–‡ç« è®²è§£ï¼Œå°±æ˜¯æŠŠå››æ¡è¾¹æŒ‰è§„å¾‹è¯»å‡ºã€‚// æ²¡æœ‰çœ‹ç­”æ¡ˆï¼ŒæŒ‰è®²è§£å†™äº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œä½†æ˜¯å¾ˆå¥‡æ€ªï¼Œè¾“å‡ºçš„xyå’Œæˆ‘æƒ³è±¡ä¸­çš„ä¸ä¸€æ ·// æ‰“äº†æ–­ç‚¹æ‰å‘ç°ï¼ŒäºŒç»´æ•°ç»„çš„è¡¨ç°å’Œåæ ‡ä¸ä¸€æ ·ã€‚public class LE59 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          int n = Integer.parseInt(scanner.nextLine());          System.out.println(Arrays.deepToString(generateMatrix(n)));      &#125;        public static int[][] generateMatrix(int n) &#123;          int[][] ints = new int[n][n];          int startX = 0;          int startY = 0;          int k = 1;          int loop = 1;          int i, j;          // è¿™è¾¹éœ€è¦åŠ ä¸Šè¾¹ç•Œæ¡ä»¶        while (k &lt;= n * n &amp;&amp; loop &lt;= n / 2) &#123;              for (i = startX; i &lt; n - loop; i++) &#123;                  ints[i][startY] = k++;              &#125;              for (j = startY; j &lt; n - loop; j++) &#123;                  ints[i][j] = k++;              &#125;              for (; i &gt; startX; i--) &#123;                  ints[i][j] = k++;              &#125;              for (; j &gt; startY ; j--) &#123;                  ints[i][j] = k++;              &#125;              startX++;              startY++;              loop++;          &#125;          // å¥‡æ•°çŸ©é˜µéœ€è¦ç‰¹æ®Šå¤„ç†        if (n % 2 == 1) &#123;              ints[startX][startY] = k;          &#125;          return ints;      &#125;  &#125;// é‡æ–°æŒ‰äºŒç»´æ•°ç»„çš„å†™æ³•å†™äº†ä¸€éã€‚è¿™ä¸ªéœ€è¦åŠ åˆ°æ€»ç»“ä¸­// äºŒä½æ•°ç»„ä¸­ï¼šjæ‰æ˜¯æ¨ªåæ ‡ï¼Œiæ˜¯çºµåæ ‡public static int[][] generateMatrix(int n) &#123;      int[][] ints = new int[n][n];      int startX = 0;      int startY = 0;      int k = 1;      int loop = 1;      int i, j;        while (k &lt;= n * n &amp;&amp; loop &lt;= n / 2) &#123;          for (j = startY; j &lt; n - loop; j++) &#123;              ints[startX][j] = k++;          &#125;          for (i = startX; i &lt; n - loop; i++) &#123;              ints[i][j] = k++;          &#125;          for (; j &gt; startY ; j--) &#123;              ints[i][j] = k++;          &#125;          for (; i &gt; startX; i--) &#123;              ints[i][j] = k++;          &#125;          startX++;          startY++;          loop++;      &#125;      if (n % 2 == 1) &#123;          ints[startX][startY] = k;      &#125;      return ints;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŒæŒ‡é’ˆ","æ•°ç»„","æ»‘åŠ¨çª—å£","èºæ—‹æ•°ç»„"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰å¤©-203ç§»é™¤é“¾è¡¨å…ƒç´ ã€707è®¾è®¡é“¾è¡¨ã€206åè½¬é“¾è¡¨","url":"/posts/a242ea05/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šé“¾è¡¨å®šä¹‰æœ‰ç‚¹ä¸ä¼šï¼ŒåŸºæœ¬ä¸Šæ˜¯éƒ½æ˜¯çœ‹äº†ä¸€åŠå›¾è§£åå†™å‡ºæ¥çš„ï¼Œè€Œä¸”è€—æ—¶æ¯”è¾ƒé•¿ï¼Œå¯èƒ½äºŒåˆ·ä¼šå¥½ä¸€ç‚¹å§ã€‚\n\n\næ›´æ–°\n\n\n24.04.24 åˆå§‹è®°å½•24.05.15 å®Œæˆé¢˜ç›®\n\nåˆæ­¥é¢˜è§£\n203 ç§»é™¤é“¾è¡¨å…ƒç´ \né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/remove-linked-list-elements/description/\nåˆšå¼€å§‹çœ‹åˆ°æœ‰ç‚¹æ‡µï¼Œä¹ æƒ¯äº†å†™è¾“å…¥è¾“å‡ºï¼Œè¿™é‡Œä¸çŸ¥é“æ€ä¹ˆè¾“å…¥äº†ã€‚é“¾è¡¨è¿™å—éœ€è¦å…ˆåˆå§‹åŒ–é“¾è¡¨ã€‚æ²¡æœ‰å†™å‡ºæ¥åé¢æ˜¯æŸ¥çœ‹äº†è§£æã€‚\nåœ¨å…·ä½“æ–¹æ³•é‚£é‡Œï¼Œä¸€ç›´å°è¯•åªç”¨ä¸€ä¸ªé“¾è¡¨åšæ“ä½œï¼Œä½†æ˜¯è¿è¡Œæ€»æ˜¯å¾—ä¸åˆ°æƒ³è¦çš„ç»“æœã€‚\npublic class LE203 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          String s = scanner.nextLine();          if (&quot;&quot;.equals(s.trim())) &#123;              System.out.println(new LinkedList());              return;          &#125;          List&lt;Integer&gt; head = Arrays.stream(s.split(&quot;,&quot;)).map(Integer::parseInt).collect(Collectors.toList());          int val = Integer.parseInt(scanner.nextLine());            // åˆå§‹åŒ–é“¾è¡¨          LinkedList linkedList = new LinkedList();          for (Integer integer : head) &#123;              linkedList.add(integer);          &#125;              ListNode listNode = removeElements(linkedList.head, val);          System.out.println(listNode);      &#125;  \t// ä¸€å¼€å§‹åªèƒ½å†™æˆè¿™ä¸ªæ ·å­    public static ListNode removeElements(ListNode head, int val) &#123;  \t\twhile (head != null &amp;&amp; head.val == val) &#123;  \t\t    head = head.next;  \t\t&#125;  \t\t  \t\tif (head == null) &#123;  \t\t    return head;  \t\t&#125;    &#125;        /**       * é“¾è¡¨çš„å®šä¹‰       */      public static class ListNode &#123;          int val;          ListNode next;            ListNode() &#123;          &#125;            ListNode(int val) &#123;              this.val = val;          &#125;            ListNode(int val, ListNode next) &#123;              this.val = val;              this.next = next;          &#125;      &#125;        public static class LinkedList &#123;          private ListNode head;            public ListNode getHead() &#123;              return head;          &#125;            public void setHead(ListNode head) &#123;              this.head = head;          &#125;            public ListNode getCurrent() &#123;              return current;          &#125;            public void setCurrent(ListNode current) &#123;              this.current = current;          &#125;            private ListNode current;            public void add(int val) &#123;              if (head == null) &#123;                  head = new ListNode(val);                  current = head;              &#125; else &#123;                  current.next = new ListNode(val);                  current = current.next;              &#125;          &#125;      &#125;  &#125;\n707 è®¾è®¡é“¾è¡¨\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/design-linked-list/description/\nä¿®ä¿®æ”¹æ”¹äº†å¾ˆä¹…æ‰é€šè¿‡ï¼Œè¦è€ƒè™‘å¤´èŠ‚ç‚¹ï¼Œå°¾èŠ‚ç‚¹ã€‚\npublic class LE707 &#123;      public static void main(String[] args) &#123;          MyLinkedList myLinkedList = new MyLinkedList();          myLinkedList.addAtHead(1);          myLinkedList.addAtTail(3);          // é“¾è¡¨å˜ä¸º 1-&gt;2-&gt;3        myLinkedList.addAtIndex(1, 2);          // è¿”å› 2        myLinkedList.get(1);          // ç°åœ¨ï¼Œé“¾è¡¨å˜ä¸º 1-&gt;3        myLinkedList.deleteAtIndex(1);          // è¿”å› 3        myLinkedList.get(1);      &#125;        public static class ListNode &#123;          private int val;          private ListNode next;            public ListNode() &#123;          &#125;            public ListNode(int val) &#123;              this.val = val;          &#125;      &#125;        public static class MyLinkedList &#123;          private int size;          private ListNode head;            public MyLinkedList() &#123;              size = 0;              head = new ListNode(0);          &#125;            public int get(int index) &#123;              if (index &lt;= -1 || index &gt;= size) &#123;                  return -1;              &#125;                ListNode indexNode = head;              for (int i = 0; i &lt; index; i++) &#123;                  indexNode = indexNode.next;              &#125;                return indexNode.val;          &#125;            public void addAtHead(int val) &#123;              if (size == 0) &#123;                  size++;                  head = new ListNode(val);                  return;              &#125;              addAtIndex(0, val);          &#125;            public void addAtTail(int val) &#123;              addAtIndex(size, val);          &#125;            public void addAtIndex(int index, int val) &#123;              if (index &gt; size) &#123;                  return;              &#125;                if (index &lt; 0) &#123;                  index = 0;              &#125;                ListNode pre = head;              // æ‰¾åˆ°å‰ä¸€ä¸ªèŠ‚ç‚¹çš„ä½ç½®              for (int i = 0; i &lt; index - 1; i++) &#123;                  pre = pre.next;              &#125;                ListNode listNode = new ListNode(val);              // å¦‚æœæ’å…¥èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹              if (index == 0) &#123;                  listNode.next = pre;                  head = listNode;                  // é•¿åº¦++                  size++;                  return;              &#125;              // å¦‚æœæ’å…¥ä½ç½®æ­£å¥½æ˜¯å°¾èŠ‚ç‚¹ ç›´æ¥å‰èŠ‚ç‚¹æŒ‡å‘è¿™ä¸ªèŠ‚ç‚¹ ç„¶åreturn              if (index == size) &#123;                  pre.next = listNode;                  // é•¿åº¦++                  size++;                  return;              &#125;                // å¦åˆ™              // å…ˆæŠŠå½“å‰èŠ‚ç‚¹çš„åæŒ‡é’ˆæŒ‡å‘å‰èŠ‚ç‚¹çš„next              listNode.next = pre.next;              // å†æŠŠå‰èŠ‚ç‚¹çš„åæŒ‡é’ˆæŒ‡å‘å½“å‰èŠ‚ç‚¹              pre.next = listNode;              // é•¿åº¦++              size++;          &#125;            public void deleteAtIndex(int index) &#123;              if (index &gt;= size || index &lt; 0) &#123;                  return;              &#125;                ListNode pre = head;              for (int i = 0; i &lt; index - 1; i++) &#123;                  pre = pre.next;              &#125;              // å¦‚æœåˆ é™¤èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹              if (index == 0) &#123;                  head = head.next;                  size--;                  return;              &#125;              // å¦‚æœåˆ é™¤ä½ç½®æ­£å¥½æ˜¯å°¾èŠ‚ç‚¹ ç›´æ¥å‰èŠ‚ç‚¹æŒ‡å‘null ç„¶åreturn              if (index + 1 == size) &#123;                  pre.next = null;                  // é•¿åº¦++                  size--;                  return;              &#125;              // æ”¹å˜å½“å‰èŠ‚ç‚¹çš„å‰èŠ‚ç‚¹çš„åæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹              pre.next = pre.next.next;              // é•¿åº¦--              size--;          &#125;      &#125;  &#125;\n206 åè½¬é“¾è¡¨\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/reverse-linked-list/description/\nå·å·çœ‹äº†ä¸‹è§†é¢‘å›¾è§£ï¼ŒæŒ‰è¿™ä¸ªæ€è·¯å†™çš„ä»£ç ï¼šè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„\n\npublic static LE707.ListNode reverseList(LE707.ListNode head) &#123;      LE707.ListNode pre = null;      LE707.ListNode cur = head;      while (cur != null) &#123;          LE707.ListNode temp = cur.next;          cur.next = pre;          pre = cur;          cur = temp;      &#125;        return pre;  &#125;\nçœ‹è®²è§£\n203 ç§»é™¤é“¾è¡¨å…ƒç´ \né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼šï¼šhttps://programmercarl.com/0203.%E7%A7%BB%E9%99%A4%E9%93%BE%E8%A1%A8%E5%85%83%E7%B4%A0.html\n// ä¸€å¼€å§‹æ²¡æœ‰ææ‡‚ï¼Œå‰é¢ä¸€ä¸ªå¾ªç¯æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ã€‚// ä½†æ˜¯å»é™¤å‰é¢ä¸€æ­¥ï¼Œæ‰§è¡Œ[7,7,7,7] 7 è¿™ä¸ªç”¨ä¾‹ä¼šå¤šå‡ºä¸€ä¸ª7public static ListNode removeElements(ListNode head, int val) &#123;      while (head != null &amp;&amp; head.val == val) &#123;          head = head.next;      &#125;        if (head == null) &#123;          return head;      &#125;        ListNode pre = head;      ListNode cur = head.next;      while (cur != null) &#123;          if (cur.val == val) &#123;              pre.next = cur.next;          &#125; else &#123;              pre = cur;          &#125;          cur = cur.next;      &#125;      return head;  &#125;\nè¿™ä¸ªé¢˜å…±æœ‰ä¸‰ç§é¢˜è§£æ³•ï¼š\n\n\nç¬¬ä¸€ç§ï¼šæ·»åŠ è™šèŠ‚ç‚¹ã€‚åœ¨åŸå…ˆçš„é“¾è¡¨å‰ï¼Œæ·»åŠ ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œç”¨äºå¤„ç†å¯èƒ½è¢«åˆ é™¤çš„å¤´èŠ‚ç‚¹ã€‚å› ä¸ºåˆ é™¤å¯èƒ½æ¶‰åŠåˆ°å¤´èŠ‚ç‚¹ï¼Œæ‰€ä»¥åœ¨æ–¹æ³•äºŒä¸­ï¼Œç¬¬ä¸€ä¸ªå¾ªç¯æŠŠå¤´èŠ‚ç‚¹å¯èƒ½éœ€è¦åˆ é™¤çš„æƒ…å†µç›´æ¥å¤„ç†æ‰ã€‚\n\n\nç¬¬äºŒç§ï¼šä¸æ·»åŠ è™šèŠ‚ç‚¹ã€‚ç”¨ä¸€ä¸ªå¾ªç¯å¤„ç†å¯èƒ½ä¼šè¢«åˆ é™¤çš„å¤´èŠ‚ç‚¹ã€‚\n\n\nç¬¬ä¸‰ç§ï¼šä¸åŠ è™šèŠ‚ç‚¹ï¼ŒåŒæ—¶ä¸æ·»åŠ  pre èŠ‚ç‚¹ã€‚åŠ ä¸Šåˆ¤æ–­åˆ é™¤èŠ‚ç‚¹æ˜¯å¦æ˜¯å°¾èŠ‚ç‚¹ã€‚\n\n\n707 è®¾è®¡é“¾è¡¨\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼šhttps://programmercarl.com/0707.%E8%AE%BE%E8%AE%A1%E9%93%BE%E8%A1%A8.html\n//å•é“¾è¡¨class ListNode &#123;    int val;    ListNode next;    ListNode()&#123;&#125;    ListNode(int val) &#123;        this.val=val;    &#125;&#125;class MyLinkedList &#123;    //sizeå­˜å‚¨é“¾è¡¨å…ƒç´ çš„ä¸ªæ•°    int size;    //è™šæ‹Ÿå¤´ç»“ç‚¹    ListNode head;    //åˆå§‹åŒ–é“¾è¡¨    public MyLinkedList() &#123;        size = 0;        head = new ListNode(0);    &#125;    //è·å–ç¬¬indexä¸ªèŠ‚ç‚¹çš„æ•°å€¼ï¼Œæ³¨æ„indexæ˜¯ä»0å¼€å§‹çš„ï¼Œç¬¬0ä¸ªèŠ‚ç‚¹å°±æ˜¯å¤´ç»“ç‚¹    public int get(int index) &#123;        //å¦‚æœindexéæ³•ï¼Œè¿”å›-1        if (index &lt; 0 || index &gt;= size) &#123;            return -1;        &#125;        ListNode currentNode = head;        //åŒ…å«ä¸€ä¸ªè™šæ‹Ÿå¤´èŠ‚ç‚¹ï¼Œæ‰€ä»¥æŸ¥æ‰¾ç¬¬ index+1 ä¸ªèŠ‚ç‚¹        for (int i = 0; i &lt;= index; i++) &#123;            currentNode = currentNode.next;        &#125;        return currentNode.val;    &#125;    //åœ¨é“¾è¡¨æœ€å‰é¢æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç­‰ä»·äºåœ¨ç¬¬0ä¸ªå…ƒç´ å‰æ·»åŠ     public void addAtHead(int val) &#123;        addAtIndex(0, val);    &#125;    //åœ¨é“¾è¡¨çš„æœ€åæ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç­‰ä»·äºåœ¨(æœ«å°¾+1)ä¸ªå…ƒç´ å‰æ·»åŠ     public void addAtTail(int val) &#123;        addAtIndex(size, val);    &#125;    // åœ¨ç¬¬ index ä¸ªèŠ‚ç‚¹ä¹‹å‰æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œä¾‹å¦‚indexä¸º0ï¼Œé‚£ä¹ˆæ–°æ’å…¥çš„èŠ‚ç‚¹ä¸ºé“¾è¡¨çš„æ–°å¤´èŠ‚ç‚¹ã€‚    // å¦‚æœ index ç­‰äºé“¾è¡¨çš„é•¿åº¦ï¼Œåˆ™è¯´æ˜æ˜¯æ–°æ’å…¥çš„èŠ‚ç‚¹ä¸ºé“¾è¡¨çš„å°¾ç»“ç‚¹    // å¦‚æœ index å¤§äºé“¾è¡¨çš„é•¿åº¦ï¼Œåˆ™è¿”å›ç©º    public void addAtIndex(int index, int val) &#123;        if (index &gt; size) &#123;            return;        &#125;        if (index &lt; 0) &#123;            index = 0;        &#125;        size++;        //æ‰¾åˆ°è¦æ’å…¥èŠ‚ç‚¹çš„å‰é©±        ListNode pred = head;        for (int i = 0; i &lt; index; i++) &#123;            pred = pred.next;        &#125;        ListNode toAdd = new ListNode(val);        toAdd.next = pred.next;        pred.next = toAdd;    &#125;    //åˆ é™¤ç¬¬indexä¸ªèŠ‚ç‚¹    public void deleteAtIndex(int index) &#123;        if (index &lt; 0 || index &gt;= size) &#123;            return;        &#125;        size--;        if (index == 0) &#123;            head = head.next;\t    return;        &#125;        ListNode pred = head;        for (int i = 0; i &lt; index ; i++) &#123;            pred = pred.next;        &#125;        pred.next = pred.next.next;    &#125;&#125;\nå‚è€ƒä¸­æ˜¯ç›´æ¥è®¾ç½®äº†è™šæ‹Ÿå¤´èŠ‚ç‚¹è§£å†³çš„ï¼Œä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚è¿˜æœ‰ä¸€ç§åŒå‘é“¾è¡¨çš„æ–¹æ³•ï¼Œæ²¡æœ‰ä»”ç»†ç ”ç©¶ã€‚\n206 åè½¬é“¾è¡¨\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼šhttps://programmercarl.com/0206.%E7%BF%BB%E8%BD%AC%E9%93%BE%E8%A1%A8.html\n// é€’å½’ class Solution &#123;    public ListNode reverseList(ListNode head) &#123;        return reverse(null, head);    &#125;    private ListNode reverse(ListNode prev, ListNode cur) &#123;        if (cur == null) &#123;            return prev;        &#125;        ListNode temp = null;        temp = cur.next;// å…ˆä¿å­˜ä¸‹ä¸€ä¸ªèŠ‚ç‚¹        cur.next = prev;// åè½¬        // æ›´æ–°prevã€curä½ç½®        // prev = cur;        // cur = temp;        // æ­¤æ—¶curä¸ºå‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œtempä¸ºåä¸€ä¸ªèŠ‚ç‚¹ã€‚ä¸¤ä¸ªèŠ‚ç‚¹ä½ç½®äº¤æ¢ï¼Œåšé€’å½’ã€‚        return reverse(cur, temp);    &#125;&#125;\næŒ‰ç…§è®²è§£ï¼Œä¸€å¼€å§‹å†™çš„æ˜¯åŒæŒ‡é’ˆæ–¹æ³•ã€‚\nLeetCode è¿›é˜¶å¤„å†™äº†è¿˜å¯ä»¥ä½¿ç”¨é€’å½’è§£å†³ã€‚è§£æ³•åœ¨è§£æä¸­ç»™å‡ºã€‚\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŒæŒ‡é’ˆ","é“¾è¡¨","è™šæ‹Ÿå¤´èŠ‚ç‚¹"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å››å¤©-24ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€19åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹ã€é¢è¯•é¢˜02.07.é“¾è¡¨ç›¸äº¤ã€142ç¯å½¢é“¾è¡¨II","url":"/posts/b46047ed/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š24 éœ€è¦çœ‹éƒ¨åˆ†é¢˜è§£æ‰èƒ½ ACï¼Œ19 ç›´æ¥çœ‹çš„é¢˜è§£è§£é¢˜ï¼Œé¢è¯•é¢˜ 02.07 å¯ä»¥ ACï¼ˆä½†æ˜¯è¿˜æœ‰ä¸€ç§è§£æ³•ï¼Œå®Œå…¨æƒ³ä¸åˆ°ï¼‰ï¼Œ142 ä¸ä¼šï¼ˆç¬¬ä¸€æ¬¡åšçœŸçš„æœ‰äººèƒ½æœ‰æ€è·¯å—ğŸ¥²ï¼‰\n\n\næ›´æ–°\n\n\n24.05.16 åˆå§‹è®°å½•24.05.22 åä¸¤é¢˜çš„å®Œæˆ\n\nåˆæ­¥é¢˜è§£\n24 ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/swap-nodes-in-pairs/description/)\n// ç¬¬ä¸€éå®Œå…¨æ²¡æœ‰çœ‹é¢˜è§£çš„å†™æ³•ï¼Œä¸èƒ½é€šè¿‡public static LE707.ListNode swapPairs(LE707.ListNode head) &#123;      while (head.next != null) &#123;          LE707.ListNode temp = head.next.next;          head.next.next = head;          head.next = temp;          head = head.next.next;      &#125;      return head;  &#125;// ç¬¬äºŒéçœ‹äº†éƒ¨åˆ†æ–‡å­—é¢˜è§£// å‘ç°å°‘äº†å¤´èŠ‚ç‚¹ï¼Œå³å‰ä¸€ä¸ªèŠ‚ç‚¹çš„åèŠ‚ç‚¹çš„æŒ‡å‘é‚£ä¸€æ­¥public static LE707.ListNode swapPairs(LE707.ListNode head) &#123;      LE707.ListNode dumyHead = new LE707.ListNode(-1);      dumyHead.next = head;        // è®°å½•å½“å‰èŠ‚ç‚¹çš„ä½ç½®ï¼Œä¾¿äºå¾ªç¯      LE707.ListNode cur = dumyHead;      while (cur.next != null &amp;&amp; cur.next.next != null) &#123;          // è®°å½•åŸæ¥ï¼Œåä¸€ä¸ªèŠ‚ç‚¹éœ€è¦æŒ‡å‘çš„èŠ‚ç‚¹          LE707.ListNode temp = cur.next.next.next;          LE707.ListNode node2 = cur.next.next;          LE707.ListNode node1 = cur.next;          cur.next = node2;          cur.next.next = node1;          cur.next.next.next = temp;          cur = node1;      &#125;      return dumyHead.next;  &#125;\n19 åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªèŠ‚ç‚¹\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/remove-nth-node-from-end-of-list/description/\nè¿™é“é¢˜ç›´æ¥çœ‹çš„è§£æã€‚\né¢è¯•é¢˜ 02.07 é“¾è¡¨ç›¸äº¤\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/intersection-of-two-linked-lists-lcci/description/\næäº¤æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æœ¬åœ°è·‘ä¸è¡Œï¼Œçœ‹äº†ä¸€ä¸‹å¯èƒ½æ˜¯æœ¬åœ°æµ‹è¯•çš„ add æ–¹æ³•ï¼Œæ¯æ¬¡éƒ½æ˜¯æ–°å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸¤ä¸ªé“¾è¡¨ä¸­çš„å¯¹è±¡åœ°å€æ˜¯ä¸ä¸€è‡´çš„ï¼Œå¯¼è‡´ tempA == tempB è¿™ä¸€æ­¥å§‹ç»ˆåˆ¤æ–­å¤±è´¥ã€‚\n/**   * æ€è·¯ï¼šæœ€åéƒ½ä¼šåˆæˆåˆ°ä¸€ä¸ªé“¾   * å¯ä»¥æŠŠä¸¤ä¸ªé“¾æŒ‰æœ«å°¾å¯¹å…¶ï¼Œå³è¾ƒé•¿é“¾çš„æŒ‡é’ˆèµ·å§‹ä¸çŸ­é“¾å¯¹é½   * @param headA headA   * @param headB headB   * @return ç›¸äº¤éƒ¨åˆ†   */  public static LE707.ListNode getIntersectionNode(LE707.ListNode headA, LE707.ListNode headB) &#123;      int intersectVal = 0;      int skipA = 0;      int skipB = 0;        LE707.ListNode tempA = headA;      LE707.ListNode tempB = headB;        int sizeA = 0;      while (tempA != null) &#123;          sizeA++;          tempA = tempA.next;      &#125;        int sizeB = 0;      while (tempB != null) &#123;          sizeB++;          tempB = tempB.next;      &#125;        if (sizeA == 0 || sizeB == 0) &#123;          return null;      &#125;        tempA = headA;      tempB = headB;      // å°¾ç«¯å¯¹å…¶      if (sizeA &gt;= sizeB) &#123;          for (int i = 0; i &lt; (sizeA - sizeB); i++) &#123;              tempA = tempA.next;              skipA++;          &#125;      &#125; else &#123;          for (int i = 0; i &lt; (sizeB - sizeA); i++) &#123;              tempB = tempB.next;              skipB++;          &#125;      &#125;        // ä¸ç›¸åŒï¼ŒæŒ‡é’ˆåç§»      while (tempA != null) &#123;          if (tempA == tempB) &#123;              intersectVal = tempA.val;              return tempA;          &#125;          tempA = tempA.next;          tempB = tempB.next;          skipA++;          skipB++;      &#125;        return null;  &#125;\n142 ç¯å½¢é“¾è¡¨ II\né¢˜ç›®é“¾æ¥ï¼šhttps://leetcode.cn/problems/linked-list-cycle-ii/description/\nä¸ä¼šï¼Œç›´æ¥çœ‹çš„è§£æã€‚\nçœ‹è®²è§£\n24 ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼šï¼šhttps://programmercarl.com/0203.%E7%A7%BB%E9%99%A4%E9%93%BE%E8%A1%A8%E5%85%83%E7%B4%A0.html\nè¿™é¢˜çœ‹é¢˜è§£å›¾ä¼šæ¯”è¾ƒå®¹æ˜“ï¼š\n\nçœ‹å®Œæ ¹æ®è¿™ä¸ªå›¾ï¼Œæ€»ç®—æ˜¯å†™å‡ºæ¥äº†ã€‚\nä¹Ÿè¿˜æœ‰åˆ«çš„æ–¹æ³•ï¼ˆé€’å½’ï¼‰ï¼š\npublic ListNode swapPairs(ListNode head) &#123;        // base case é€€å‡ºæäº¤        if(head == null || head.next == null) return head;        // è·å–å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹        ListNode next = head.next;        // è¿›è¡Œé€’å½’        ListNode newNode = swapPairs(next.next);        // è¿™é‡Œè¿›è¡Œäº¤æ¢        next.next = head;        head.next = newNode;        return next;    &#125;\næ³¨ï¼šå°†æ­¥éª¤äºŒä¸‰äº’æ¢ï¼Œå¯ä»¥ä¸å®šä¹‰ temp èŠ‚ç‚¹ã€‚\n19 åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªèŠ‚ç‚¹\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼šhttps://programmercarl.com/0019.%E5%88%A0%E9%99%A4%E9%93%BE%E8%A1%A8%E7%9A%84%E5%80%92%E6%95%B0%E7%AC%ACN%E4%B8%AA%E8%8A%82%E7%82%B9.html\n/**   * ç¬¬ä¸€æƒ³æ³•æ˜¯è·å–é•¿åº¦ï¼Œç„¶åé•¿åº¦-nå¾—åˆ°èŠ‚ç‚¹ä½ç½®ã€‚å› ä¸ºèŠ‚ç‚¹è¿™ä¸ªåˆå§‹åŒ–æ“ä½œä¹‹å‰æ˜¯å†™äº†sizeçš„   * ä½†æ˜¯é¢˜ç›®ä¸­æ˜¯æ²¡æœ‰è¿™ä¸ªåˆå§‹åŒ–æ“ä½œçš„ã€‚   * ç›´æ¥çœ‹çš„è§£æï¼Œè¯´æ˜¯ç”¨å¿«æ…¢åŒæŒ‡é’ˆçš„æ–¹å¼ã€‚   */  public static LE707.ListNode removeNthFromEnd(LE707.ListNode head, int n) &#123;      // æ·»åŠ ä¸€ä¸ªè™šæ‹Ÿå¤´èŠ‚ç‚¹      LE707.ListNode dumyHead = new LE707.ListNode(-1);      dumyHead.next = head;        LE707.ListNode fast = dumyHead;      for (int i = 0; i &lt; n; i++) &#123;          fast = fast.next;      &#125;      LE707.ListNode slow = dumyHead;      while (fast != null &amp;&amp; fast.next != null) &#123;          fast = fast.next;          slow = slow.next;      &#125;        // æ­¤æ—¶æ…¢æŒ‡é’ˆæŒ‡å‘çš„ä¸ºè¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹      slow.next = slow.next.next;        return dumyHead.next;  &#125;\næ­¥éª¤ä¸€ï¼šå…ˆç§»åŠ¨å¿«æŒ‡é’ˆï¼Œå¿«æŒ‡é’ˆç§»åŠ¨çš„ä½ç½®ä¸ n ç›¸åŒã€‚\næ­¥éª¤äºŒï¼šåŒæ—¶ç§»åŠ¨å¿«æ…¢æŒ‡é’ˆï¼Œå½“å¿«æŒ‡é’ˆä¸‹ä¸€èŠ‚ç‚¹çš„ä½ç½®ä¸º 0 æ—¶ï¼Œæ­¤æ—¶æ…¢æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ä¸ºè¦åˆ é™¤çš„èŠ‚ç‚¹çš„å‰ä¸€èŠ‚ç‚¹ã€‚\næ­¥éª¤ä¸‰ï¼šåˆ é™¤æŒ‡å®šèŠ‚ç‚¹ã€‚\næ³¨ï¼šä¸ºäº†é¿å…å¤šå¤„ç†å¤´èŠ‚ç‚¹çš„æƒ…å†µï¼Œæ·»åŠ è™šæ‹Ÿå¤´èŠ‚ç‚¹ã€‚\né¢è¯•é¢˜ 02.07 é“¾è¡¨ç›¸äº¤\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/%E9%9D%A2%E8%AF%95%E9%A2%9802.07.%E9%93%BE%E8%A1%A8%E7%9B%B8%E4%BA%A4.html\né™¤äº†åˆæ­¥é¢˜è§£é‚£ç§è§£æ³•ï¼Œè¿˜æœ‰ä¸€ç§ï¼Œä½†æ˜¯ä¸æ˜¯å¾ˆèƒ½çœ‹æ‡‚ç†è§£ï¼Œå¯ä»¥è¯´ç¬¬ä¸€æ¬¡å®Œå…¨æƒ³ä¸åˆ°ï¼Œä¸‹é¢æ˜¯è§£æ³•å’Œå›¾è§£ï¼š\nhttps://leetcode.cn/problems/intersection-of-two-linked-lists-lcci/solutions/1190240/mian-shi-ti-0207-lian-biao-xiang-jiao-sh-b8hn/\n// åˆå¹¶é“¾è¡¨å®ç°ç§»åŠ¨public ListNode getIntersectionNode(ListNode headA, ListNode headB) &#123;\t// p1 æŒ‡å‘ A é“¾è¡¨å¤´ç»“ç‚¹ï¼Œp2 æŒ‡å‘ B é“¾è¡¨å¤´ç»“ç‚¹\tListNode p1 = headA, p2 = headB;\twhile (p1 != p2) &#123;\t\t// p1 èµ°ä¸€æ­¥ï¼Œå¦‚æœèµ°åˆ° A é“¾è¡¨æœ«å°¾ï¼Œè½¬åˆ° B é“¾è¡¨\t\tif (p1 == null) p1 = headB;\t\telse            p1 = p1.next;\t\t// p2 èµ°ä¸€æ­¥ï¼Œå¦‚æœèµ°åˆ° B é“¾è¡¨æœ«å°¾ï¼Œè½¬åˆ° A é“¾è¡¨\t\tif (p2 == null) p2 = headA;\t\telse            p2 = p2.next;\t&#125;\treturn p1;&#125;\n142 ç¯å½¢é“¾è¡¨ II\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼šhttps://programmercarl.com/0142.%E7%8E%AF%E5%BD%A2%E9%93%BE%E8%A1%A8II.html\n\né¢˜è§£æ€è·¯ï¼š\n\n\nå¦‚ä½•åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯ï¼šé¦–å…ˆè¿™é¢˜ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆè§£æ³•ã€‚å¦‚æœæ— ç¯ï¼Œé‚£ä¹ˆå¿«æŒ‡é’ˆåˆ°æœ€åä¹Ÿä¸ä¼šä¸æ…¢æŒ‡é’ˆç›¸é‡ï¼›å¦‚æœå¯ä»¥ç›¸é‡ï¼Œåˆ™è¯´æ˜æœ‰ç¯ã€‚\n\n\nå¿«æŒ‡é’ˆä¸€å®šå…ˆè¿›å…¥ç¯å½¢ï¼Œæ…¢æŒ‡é’ˆåè¿›å…¥ç¯å½¢ã€‚å½“æ…¢æŒ‡é’ˆè¿›å…¥ç¯å½¢æ—¶ï¼Œå°±å˜æˆäº†è¿½å‡»é—®é¢˜ï¼Œç”±å¿«è¿½å‡»æ…¢ã€‚å› ä¸ºæŒ‡å®šå¿«æŒ‡é’ˆé€Ÿåº¦ä¸º 2 ä¸ªèŠ‚ç‚¹ï¼Œæ…¢æŒ‡é’ˆä¸º 1 ä¸ªèŠ‚ç‚¹ï¼Œç›¸å¯¹é€Ÿåº¦ä¸º 1 ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤å¿«æ…¢ä¸€å®šä¼šåœ¨ç¯å†…ç›¸é‡ã€‚\n\n\nå¦‚å›¾æ‰€ç¤ºï¼šå‡è®¾ç›¸é‡åœ¨ç‚¹ Pï¼Œå…¥å£åœ¨ startï¼Œä¸‰æ®µè·¯å¾„åˆ†åˆ«å¦‚å›¾æ‰€ç¤ºï¼Œåˆ™æ­¤æ—¶ A çš„è¡Œèµ°è·¯å¾„ä¸ºï¼šx + n(y + z) + yï¼ŒB çš„è¡Œèµ°è·¯å¾„ä¸º x + y\n\n\nåˆå› ä¸ºå¿«æŒ‡é’ˆé€Ÿåº¦ä¸ºæ»¡æŒ‡é’ˆçš„ä¸¤å€ï¼Œæ‰€ä»¥ x + n(y + z) + y = 2(x + y)ï¼Œå¾—å‡º x = n(y + z) - yï¼Œç­‰å¼å˜å½¢ä¸º x = (n - 1)(y + z) + zï¼Œåˆ n &gt;= 1ã€‚å¯ä»¥ç®€åŒ–ä¸ºï¼Œåœ¨ç›¸é‡å¤„ï¼Œå‡ºå‘å¤„å„è®¾ä¸€ä¸ªæŒ‡é’ˆï¼Œä¸€èµ·ç§»åŠ¨ï¼Œä¸¤ä¸ªæŒ‡é’ˆä¸€å®šä¼šç›¸é‡ã€‚ç›¸é‡å¤„å³ä¸º startã€‚\n\n\nç–‘éš¾ç‚¹ï¼š\nQï¼šä¸ºä»€ä¹ˆBçš„è·¯å¾„ä¸€å®šåœ¨ä¸€åœˆä»¥å†…ï¼Ÿ\nAï¼šå…³é”®åœ¨å½“æ…¢æŒ‡é’ˆè¿›å…¥ç¯å½¢æ—¶ï¼Œå°±å˜æˆäº†è¿½å‡»é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¿«æŒ‡é’ˆçš„è¿½å‡»è·¯çº¿ä¸€å®šå°äºä¸€åœˆï¼Œå³è¿½å‡»æ—¶é—´ä¸€å®šä¸å¤Ÿæ…¢æŒ‡é’ˆè·‘æ»¡ä¸€åœˆã€‚\nQï¼šå¿«æ…¢æŒ‡é’ˆä¸€å®šä¼šåœ¨ç¯å†…ç›¸é‡ï¼Ÿ\nAï¼šå› ä¸ºæŒ‡å®šå¿«æŒ‡é’ˆé€Ÿåº¦ä¸º 2 ä¸ªèŠ‚ç‚¹ï¼Œæ…¢æŒ‡é’ˆä¸º 1 ä¸ªèŠ‚ç‚¹ï¼Œç›¸å¯¹é€Ÿåº¦ä¸º 1 ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤å¿«æ…¢ä¸€å®šä¼šåœ¨ç¯å†…ç›¸é‡ã€‚ï¼ˆå¦‚æœå¿«æŒ‡é’ˆçš„é€Ÿåº¦ä¸º 3ï¼Œé‚£å°±å¯èƒ½ä¼šè·³è¿‡äº†ï¼‰\npublic LE707.ListNode detectCycle(LE707.ListNode head) &#123;      LE707.ListNode fast = head;      LE707.ListNode slow = head;        while (fast!= null  &amp;&amp; fast.next != null) &#123;          fast = fast.next.next;          slow = slow.next;          // æ‰¾åˆ°ç›¸é‡ç‚¹          if (slow == fast) &#123;              LE707.ListNode index1 = head;              LE707.ListNode index2 = fast;              while (index1 != index2) &#123;                  index1 = index1.next;                  index2 = index2.next;              &#125;              return index1;          &#125;      &#125;      return null;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŒæŒ‡é’ˆ","é“¾è¡¨","è™šæ‹Ÿå¤´èŠ‚ç‚¹","ç¯å½¢é“¾è¡¨"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å…­å¤©-454å››æ•°ç›¸åŠ IIã€383èµé‡‘ä¿¡ã€15ä¸‰æ•°ä¹‹å’Œã€18å››æ•°ä¹‹å’Œ","url":"/posts/27f1326/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š454 å’Œ 383 å¯ä»¥ ACï¼Œ15 è¶…æ—¶ï¼Œ18 æ ¹æ® 15 åšå‡ºï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–\n\n\næ›´æ–°\n\n\n24.05.24 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n454 å››æ•°ç›¸åŠ  II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/4sum-ii/)\npublic class LE454 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          int[] nums1 = Arrays.stream(scanner.nextLine().split(&quot;,&quot;)).filter(Objects::nonNull).mapToInt(Integer::parseInt).toArray();          int[] nums2 = Arrays.stream(scanner.nextLine().split(&quot;,&quot;)).filter(Objects::nonNull).mapToInt(Integer::parseInt).toArray();          int[] nums3 = Arrays.stream(scanner.nextLine().split(&quot;,&quot;)).filter(Objects::nonNull).mapToInt(Integer::parseInt).toArray();          int[] nums4 = Arrays.stream(scanner.nextLine().split(&quot;,&quot;)).filter(Objects::nonNull).mapToInt(Integer::parseInt).toArray();          System.out.println(fourSumCount(nums1, nums2, nums3, nums4));      &#125;  \t// å’Œæ˜¨å¤©çš„æœ€åä¸€é¢˜å·®ä¸å¤š    public static int fourSumCount(int[] nums1, int[] nums2, int[] nums3, int[] nums4) &#123;          int res = 0;          HashMap&lt;Integer, Integer&gt; map = new HashMap();          for (int k : nums1) &#123;              for (int i : nums2) &#123;                  int sum = k + i;                  map.put(sum, map.getOrDefault(sum, 0) + 1);              &#125;          &#125;            for (int i : nums3) &#123;              for (int j : nums4) &#123;                  res += map.getOrDefault(-i - j, 0);              &#125;          &#125;            return res;      &#125;  &#125;\n383 èµé‡‘ä¿¡\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/ransom-note/submissions/534463469/)\npublic class LE383 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          String ransomNote = scanner.nextLine();          String magazine = scanner.nextLine();          System.out.println(canConstruct(ransomNote, magazine));      &#125;  \t// å’Œ242ä¸€æ ·çš„æ€è·¯    public static boolean canConstruct(String ransomNote, String magazine) &#123;          int[] ints = new int[26];          // éå†å­˜å‚¨æ•°é‡          for (int i = 0; i &lt; magazine.length(); i++) &#123;              ints[magazine.charAt(i) - 97]++;          &#125;          // éå†æ‰£é™¤æ•°é‡          for (int i = 0; i &lt; ransomNote.length(); i++) &#123;              ints[ransomNote.charAt(i) - 97]--;          &#125;          for (int i : ints) &#123;              if (i &lt; 0) &#123;                  return false;              &#125;          &#125;          return true;      &#125;  &#125;\n15 ä¸‰æ•°ä¹‹å’Œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/3sum/description/)\næš´åŠ›è§£æ³•ï¼Œä½†æ˜¯è¿™æ ·è¶…æ—¶äº†ã€‚\npublic static List&lt;List&lt;Integer&gt;&gt; threeSum(int[] nums) &#123;      // åˆ¤æ–­æ˜¯å¦é‡å¤      HashMap&lt;String, List&lt;Integer&gt;&gt; map = new HashMap&lt;&gt;();        for (int i = 0; i &lt; nums.length; i++) &#123;          for (int j = i + 1; j &lt; nums.length; j++) &#123;              for (int k = j + 1; k &lt; nums.length; k++) &#123;                  if (nums[i] + nums[j] + nums[k] == 0) &#123;                      List&lt;Integer&gt; list = new ArrayList&lt;&gt;();                      list.add(nums[i]);                      list.add(nums[j]);                      list.add(nums[k]);                      list.sort(Integer::compareTo);                      map.put(list.stream().map(integer -&gt; integer + &quot;&quot;).collect(Collectors.joining(&quot;,&quot;)), list);                  &#125;              &#125;          &#125;      &#125;      List&lt;List&lt;Integer&gt;&gt; list = new ArrayList&lt;&gt;();      for (Map.Entry&lt;String, List&lt;Integer&gt;&gt; stringListEntry : map.entrySet()) &#123;          list.add(stringListEntry.getValue());      &#125;      return list;  &#125;\nçœ‹äº†éƒ¨åˆ†è§£ææ”¹ç”¨åŒæŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡ï¼Œä½†æ˜¯æ¯”è¾ƒæ…¢ã€‚è€Œä¸”è´¹æ—¶\npublic static List&lt;List&lt;Integer&gt;&gt; threeSum(int[] nums) &#123;      nums = Arrays.stream(nums).sorted().toArray();      ArrayList&lt;List&lt;Integer&gt;&gt; list = new ArrayList&lt;&gt;();      // é€’å¢åºåˆ—ï¼Œå‰ä¸‰ä½å’Œå¤§äº0ï¼Œç›´æ¥è¿”å›      if (nums[0] + nums[1] + nums[2] &gt; 0) &#123;          return list;      &#125;        int i = 0;      int j = i + 1;      int k = nums.length - 1;      while (i &lt; j &amp;&amp; j &lt; k) &#123;          System.out.println(i + &quot; &quot; + j + &quot; &quot; + k);          int sum = nums[i] + nums[j] + nums[k];          if (sum == 0) &#123;              list.add(Arrays.asList(nums[i], nums[j], nums[k]));              j++;          &#125; else if (sum &lt; 0) &#123;              j++;          &#125; else &#123;              k--;          &#125;          while (j &gt; i + 1 &amp;&amp; j &lt;= nums.length - 1 &amp;&amp; nums[j] == nums[j - 1]) &#123;              j++;          &#125;          while (k &gt; j &amp;&amp; k != nums.length - 1 &amp;&amp; nums[k] == nums[k + 1]) &#123;              k--;          &#125;          if (j &gt;= k) &#123;              i = i + 1;              while (i != 0 &amp;&amp; i &lt;= nums.length - 1 &amp;&amp; nums[i] == nums[i - 1]) &#123;                  i++;              &#125;              j = i + 1;              k = nums.length - 1;          &#125;      &#125;      return list;  &#125;\n18 å››æ•°ä¹‹å’Œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/4sum/description/)\nçœ‹åˆ°é¢˜ç›®ï¼Œå°±è§‰å¾—æ˜¯ 15 çš„è¿›é˜¶ç‰ˆï¼ŒæŒ‰ç…§ä¸Šä¸€é¢˜çš„æ€è·¯å†™äº†ä¸€ä¸‹\npublic static List&lt;List&lt;Integer&gt;&gt; fourSum(int[] nums, int target) &#123;      Arrays.sort(nums);        ArrayList&lt;List&lt;Integer&gt;&gt; list = new ArrayList&lt;&gt;();      for (int i = 0; i &lt; nums.length; i++) &#123;          if (i != 0 &amp;&amp; nums[i] == nums[i - 1]) &#123;              continue;          &#125;            for (int j = i + 1; j &lt; nums.length; j++) &#123;              if (j != i + 1 &amp;&amp; nums[j] == nums[j - 1]) &#123;                  continue;              &#125;                int left = j + 1;              int right = nums.length - 1;              while (left &lt; right) &#123;                  long sum = (long) nums[i] + (long) nums[j] + (long) nums[left] + (long) nums[right];                  if (sum &lt; target) &#123;                      left++;                  &#125; else if (sum &gt; target) &#123;                      right--;                  &#125; else &#123;                      list.add(Arrays.asList(nums[i], nums[j], nums[left], nums[right]));                      while (left &lt; right &amp;&amp; nums[left] == nums[left + 1]) &#123;                          left++;                      &#125;                      while (left &lt; right &amp;&amp; nums[right] == nums[right - 1]) &#123;                          right--;                      &#125;                      left++;                      right--;                  &#125;              &#125;          &#125;      &#125;      return list;  &#125;\nçœ‹è®²è§£\n454 å››æ•°ç›¸åŠ  II\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0454.å››æ•°ç›¸åŠ II.html)\n383 èµé‡‘ä¿¡\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0383.èµé‡‘ä¿¡.html)\n15 ä¸‰æ•°ä¹‹å’Œ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0015.ä¸‰æ•°ä¹‹å’Œ.html)\nç¡®å®ç”¨ for å¾ªç¯æ›´å¥½ç†è§£ã€‚é¢˜è§£çš„æ€è·¯æ›´åŠ æ¸…æ™°ï¼Œè€Œä¸”æ›´å¿«ã€‚\npublic static List&lt;List&lt;Integer&gt;&gt; threeSum(int[] nums) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      Arrays.sort(nums);      for (int i = 0; i &lt; nums.length; i++) &#123;          // æ’åºä¹‹åå¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ å·²ç»å¤§äºé›¶ï¼Œé‚£ä¹ˆæ— è®ºå¦‚ä½•ç»„åˆéƒ½ä¸å¯èƒ½å‡‘æˆä¸‰å…ƒç»„ï¼Œç›´æ¥è¿”å›ç»“æœå°±å¯ä»¥äº†          if (nums[i] &gt; 0) &#123;              return result;          &#125;            /**           * åªèƒ½æ˜¯ä¸å‰ä¸€ä¸ªæ¯”è¾ƒè¿›è¡Œå»é‡           */          if (i &gt; 0 &amp;&amp; nums[i] == nums[i - 1]) &#123;              continue;          &#125;            int left = i + 1;          int right = nums.length - 1;          while (right &gt; left) &#123;              int sum = nums[i] + nums[left] + nums[right];              if (sum &gt; 0) &#123;                  right--;              &#125; else if (sum &lt; 0) &#123;                  left++;              &#125; else &#123;                  result.add(Arrays.asList(nums[i], nums[left], nums[right]));                  /**                   * å»é‡é€»è¾‘åº”è¯¥æ”¾åœ¨æ‰¾åˆ°ä¸€ä¸ªä¸‰å…ƒç»„ä¹‹å                   * å¦åˆ™è·å–ä¸åˆ°ç»“æœé›†                   */                  while (right &gt; left &amp;&amp; nums[right] == nums[right - 1]) &#123;                      right--;                  &#125;                  while (right &gt; left &amp;&amp; nums[left] == nums[left + 1]) &#123;                      left++;                  &#125;                    right--;                  left++;              &#125;          &#125;      &#125;      return result;  &#125;\n18 å››æ•°ä¹‹å’Œ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0018.å››æ•°ä¹‹å’Œ.html)\nçœ‹äº†è§£æã€‚åŠ ä¸Šå‰ªææ“ä½œã€‚\npublic static List&lt;List&lt;Integer&gt;&gt; fourSum(int[] nums, int target) &#123;      Arrays.sort(nums);        ArrayList&lt;List&lt;Integer&gt;&gt; list = new ArrayList&lt;&gt;();      for (int i = 0; i &lt; nums.length; i++) &#123;          // nums[i] &gt; target ç›´æ¥è¿”å›, å‰ªææ“ä½œ          if (nums[i] &gt; 0 &amp;&amp; nums[i] &gt; target) &#123;              return list;          &#125;            for (int j = i + 1; j &lt; nums.length; j++) &#123; \t        // äºŒçº§å‰ªæ            if (nums[i] + nums[j] &gt; 0 &amp;&amp; nums[i] + nums[j] &gt; target) &#123;                  break;              &#125;                if (j != i + 1 &amp;&amp; nums[j] == nums[j - 1]) &#123;                  continue;              &#125;                int left = j + 1;              int right = nums.length - 1;              while (left &lt; right) &#123;                  long sum = (long) nums[i] + (long) nums[j] + (long) nums[left] + (long) nums[right];                  if (sum &lt; target) &#123;                      left++;                  &#125; else if (sum &gt; target) &#123;                      right--;                  &#125; else &#123;                      list.add(Arrays.asList(nums[i], nums[j], nums[left], nums[right]));                      while (left &lt; right &amp;&amp; nums[left] == nums[left + 1]) &#123;                          left++;                      &#125;                      while (left &lt; right &amp;&amp; nums[right] == nums[right - 1]) &#123;                          right--;                      &#125;                      left++;                      right--;                  &#125;              &#125;          &#125;      &#125;      return list;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŒæŒ‡é’ˆ","å“ˆå¸Œè¡¨"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äº”å¤©-242æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯ã€349ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†ã€202å¿«ä¹æ•°ã€1ä¸¤æ•°ä¹‹å’Œ","url":"/posts/bed5d8f6/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šå…¨éƒ¨å¯ä»¥ ACã€‚çœ‹äº†è§£æä¹‹åï¼Œ242ã€202 å¯å†ä¼˜åŒ–ã€‚\n\n\næ›´æ–°\n\n\n24.05.23 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n242 æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/valid-anagram/description/)\npublic class LE242 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          String s = scanner.nextLine();          String t = scanner.nextLine();          System.out.println(isAnagram(s, t));      &#125;        /**       * æ€è·¯ï¼š       * 1.ç”¨mapæ¥æ”¶æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°       * 2.æ¯”è¾ƒæ¬¡æ•°æ˜¯å¦ç›¸åŒ       */      public static boolean isAnagram(String s, String t) &#123;          char[] charsS = s.toCharArray();          char[] charsT = t.toCharArray();            HashMap&lt;String, Integer&gt; numMapS = getNumMap(charsS);          HashMap&lt;String, Integer&gt; numMapT = getNumMap(charsT);            if (numMapS.size() != numMapT.size()) &#123;              return false;          &#125;          for (String key : numMapS.keySet()) &#123;              if (!numMapS.get(key).equals(numMapT.get(key))) &#123;                  return false;              &#125;          &#125;          return true;      &#125;        /**       * è·å–æ¯ä¸ªå­—ç¬¦çš„æ•°é‡       * @param charsS å­—ç¬¦ä¸²       * @return æ¯ä¸ªå­—ç¬¦çš„æ•°é‡       */      private static HashMap&lt;String, Integer&gt; getNumMap(char[] charsS) &#123;          HashMap&lt;String, Integer&gt; map = new HashMap&lt;&gt;();          for (char c : charsS) &#123;              if (map.containsKey(String.valueOf(c))) &#123;                  map.put(String.valueOf(c) , map.get(String.valueOf(c)) + 1);              &#125; else &#123;                  map.put(String.valueOf(c), 1);              &#125;          &#125;          return map;      &#125;  &#125;\n349 ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/intersection-of-two-arrays/description/)\npublic class LE349 &#123;    public static void main(String[] args) &#123;        Scanner scanner = new Scanner(System.in);        int[] nums1 = Arrays.stream(scanner.nextLine().split(&quot;,&quot;)).filter(Objects::nonNull).mapToInt(Integer::parseInt).toArray();        int[] nums2 = Arrays.stream(scanner.nextLine().split(&quot;,&quot;)).filter(Objects::nonNull).mapToInt(Integer::parseInt).toArray();        int[] intersection = intersection(nums1, nums2);    &#125;    public static int[] intersection(int[] nums1, int[] nums2) &#123;        HashSet&lt;Integer&gt; set = new HashSet&lt;&gt;();        HashSet&lt;Integer&gt; intersection = new HashSet&lt;&gt;();        for (int i : nums1) &#123;            set.add(i);        &#125;        for (int i : nums2) &#123;            if (set.contains(i)) &#123;                intersection.add(i);            &#125;        &#125;        return intersection.stream().filter(Objects::nonNull).mapToInt(i -&gt; i).toArray();    &#125;&#125;\n202 å¿«ä¹æ•°\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/happy-number/description/)\npublic class LE202 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          String s = scanner.nextLine();          System.out.println(isHappy(Integer.parseInt(s)));      &#125;        /**       * æ€è·¯ï¼šæ”¾åˆ°setä¸­ï¼Œé‡å¤æˆ–è€…ä¸º1ï¼Œè·³å‡ºå¾ªç¯       * @param n æ•°       * @return æ˜¯å¦æ˜¯å¿«ä¹æ•°       */      public static boolean isHappy(int n) &#123;          HashSet&lt;Integer&gt; set = new HashSet&lt;&gt;();          String num = n + &quot;&quot;;          set.add(n);          while (true) &#123;              int sum = 0;              for (int i = 0; i &lt; num.length(); i++) &#123;                  sum += Math.pow(Integer.parseInt(num.charAt(i) + &quot;&quot;), 2);              &#125;                if (sum == 1) &#123;                  return true;              &#125;                if (set.contains(sum)) &#123;                  return false;              &#125;              num = sum + &quot;&quot;;              set.add(sum);          &#125;      &#125;  &#125;\n1 ä¸¤æ•°ä¹‹å’Œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/two-sum/)\npublic class LE1 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          int[] nums = Arrays.stream(scanner.nextLine().split(&quot;,&quot;)).filter(Objects::nonNull).mapToInt(Integer::parseInt).toArray();          int target = Integer.parseInt(scanner.next());          twoSum(nums, target);      &#125;        /**       * æš´åŠ›è§£æ³•è‚¯å®šæ˜¯å¾ªç¯ä¸¤é       * ä½†æ˜¯è¿™é¢˜æ”¾åœ¨å“ˆå¸Œè¡¨ä¸“é¢˜é‡Œï¼Œå°±åº”è¯¥å“ˆå¸Œè¡¨ä¹Ÿèƒ½è§£å†³       * ç”¨å€¼ä¸ºkeyï¼Œä¸‹æ ‡ä¸ºvalueæ”¾å…¥map       */         public static int[] twoSum(int[] nums, int target) &#123;          HashMap&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();          for (int i = 0; i &lt; nums.length; i++) &#123;              if (map.containsKey(target - nums[i])) &#123;                  return new int[]&#123;map.get(target - nums[i]), i&#125;;              &#125;              map.put(nums[i], i);          &#125;            return null;      &#125;  &#125;\nçœ‹è®²è§£\n242 æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0242.æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯.html)\n/**   * ä¼˜åŒ–ï¼š   * æ”¹ä¸ºå®šä¹‰æ•°ç»„å»æ¥æ”¶æ•°å€¼ï¼ˆå…¶å®å’Œmapæ˜¯ä¸€æ ·çš„æ€æƒ³ï¼Œä½†æ˜¯è¿™æ ·ä»£ç é‡æ›´å°‘ï¼‰   * æ”¹ä¸ºç¬¬äºŒæ¬¡éå†ï¼Œåœ¨åŸæ•°ç»„ä¸Šç›´æ¥--ï¼ˆç©ºé—´ç”¨å¾—æ›´å°‘äº†ï¼‰   */  public static boolean isAnagram1(String s, String t) &#123;      int[] record = new int[26];        for (int i = 0; i &lt; s.length(); i++) &#123;          record[s.charAt(i) - &#x27;a&#x27;]++;      &#125;        for (int i = 0; i &lt; t.length(); i++) &#123;          record[t.charAt(i) - &#x27;a&#x27;]--;      &#125;        for (int count : record) &#123;          if (count != 0) &#123;              return false;          &#125;      &#125;      return true;  &#125;\n349 ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0349.ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†.html)\n202 å¿«ä¹æ•°\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0202.å¿«ä¹æ•°.html)\n// å¯ä»¥å†ä¼˜åŒ–ï¼Œä¸€ä¸ªæ•°å„ä¸ªä½æ•°å¹³æ–¹æ±‚å’Œwhile (n &gt; 0) &#123;      int temp = n % 10;      sum += temp * temp;      n = n / 10;  &#125;\n1 ä¸¤æ•°ä¹‹å’Œ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0001.ä¸¤æ•°ä¹‹å’Œ.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å“ˆå¸Œè¡¨"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸ƒå¤©-344åè½¬å­—ç¬¦ä¸²ã€541åè½¬å­—ç¬¦ä¸²IIã€å¡ç ç½‘54æ›¿æ¢æ•°å­—ã€151ç¿»è½¬å­—ç¬¦ä¸²é‡Œçš„å•è¯ã€å¡ç ç½‘55å³æ—‹è½¬å­—ç¬¦ä¸²","url":"/posts/b80d2810/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šéƒ½æ˜¯å¯ä»¥å†™å‡ºæ¥çš„ã€‚ä½†æ˜¯æœ‰äº›ä¸å‚è€ƒç§ç»™å‡ºçš„è§£ææ€è·¯ä¸åŒã€‚\n\n\næ›´æ–°\n\n\n24.05.27 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n344 åè½¬å­—ç¬¦ä¸²\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/reverse-string/description/)\npublic class LE344 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          reverseString(scanner.nextLine().toCharArray());      &#125;        public static void reverseString(char[] s) &#123;          for (int i = 0, j = s.length - 1; i &lt;= j; i++, j--) &#123;              char temp = s[i];              s[i] = s[j];              s[j] = temp;          &#125;          System.out.println(Arrays.toString(s));      &#125;  &#125;\n541 åè½¬å­—ç¬¦ä¸² II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/reverse-string-ii/description/)\npublic class LE541 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          System.out.println(reverseStr(scanner.nextLine(), Integer.parseInt(scanner.nextLine())));      &#125;        /**       * ç”»å›¾ç¿»è¯‘äº†ä¸€ä¸‹       * å¤§æ¦‚æ„æ€å°±æ˜¯å¥‡æ•°æ®µåè½¬       */      public static String reverseStr(String s, int k) &#123;          // åˆ¤æ–­èƒ½æ‹†åˆ†æˆå‡ æ®µ          int size = s.length() / k;          if (s.length() % k != 0) &#123;              size = size + 1;          &#125;            StringBuilder reverseStr = new StringBuilder();          for (int i = 1; i &lt;= size; i++) &#123;              String substring = s.substring((i - 1) * k, Math.min(i * k, s.length()));              if (i % 2 != 0) &#123;                  char[] chars = substring.toCharArray();                  for (int n = 0, m = chars.length - 1; n &lt;= m; n++, m--) &#123;                      char temp = chars[n];                      chars[n] = chars[m];                      chars[m] = temp;                  &#125;                  reverseStr.append(chars);              &#125; else &#123;                  reverseStr.append(substring);              &#125;          &#125;            return reverseStr.toString();      &#125;  &#125;\nå¡ç ç½‘ 54 æ›¿æ¢æ•°å­—\né¢˜ç›®é“¾æ¥ï¼š(https://kamacoder.com/problempage.php?pid=1064)\npublic class CM54 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          System.out.println(replaceNumber(scanner.nextLine()));      &#125;        public static String replaceNumber(String s) &#123;          StringBuilder stringBuilder = new StringBuilder();          char[] chars = s.toCharArray();          for (char c : chars) &#123;              if (&#x27;0&#x27; &lt;= c &amp;&amp; &#x27;9&#x27; &gt;= c) &#123;                  stringBuilder.append(&quot;number&quot;);              &#125; else &#123;                  stringBuilder.append(c);              &#125;          &#125;          return stringBuilder.toString();      &#125;  &#125;\n151 ç¿»è½¬å­—ç¬¦ä¸²é‡Œçš„å•è¯\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/reverse-words-in-a-string/description/)\npublic static void main(String[] args) &#123;      Scanner scanner = new Scanner(System.in);      System.out.println(reverseWords(scanner.nextLine()));  &#125;    private static String reverseWords(String s) &#123;      String[] split = s.trim().split(&quot; &quot;);      StringBuilder stringBuilder = new StringBuilder();      for (int i = split.length - 1; i &gt;= 0; i--) &#123;          String trim = split[i].trim();          if (&quot;&quot;.equals(trim)) &#123;              continue;          &#125;          stringBuilder.append(trim).append(&quot; &quot;);      &#125;        return stringBuilder.toString().trim();  &#125;\nå¡ç ç½‘ 55 å³æ—‹è½¬å­—ç¬¦ä¸²\né¢˜ç›®é“¾æ¥ï¼š(https://kamacoder.com/problempage.php?pid=1065)\npublic class CM55 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          int k = Integer.parseInt(scanner.nextLine());          String s = scanner.nextLine();          System.out.println(rightString(k, s));      &#125;        private static String rightString(int k, String s) &#123;          // è¿‡ç•Œåˆ¤æ–­          if (k &gt;= s.length() || k &lt;= 0) &#123;              return s;          &#125;            return s.substring(s.length() - k) + s.substring(0, s.length() - k);      &#125;  &#125;\nçœ‹è®²è§£\n344 åè½¬å­—ç¬¦ä¸²\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0344.åè½¬å­—ç¬¦ä¸².html)\n541 åè½¬å­—ç¬¦ä¸² II\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0541.åè½¬å­—ç¬¦ä¸²II.html)\nå¡ç ç½‘ 54 æ›¿æ¢æ•°å­—\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/kamacoder/0054.æ›¿æ¢æ•°å­—.html)\næ ¹æ®è®²è§£ï¼Œè¿™é¢˜æœ¬æ„æ˜¯å…ˆæ‰©å……å†åˆ†é…ã€‚è¦ç”¨åˆ°åŒæŒ‡é’ˆçš„æ–¹æ³•ã€‚\npublic class Main &#123;    public static String replaceNumber(String s) &#123;        int count = 0; // ç»Ÿè®¡æ•°å­—çš„ä¸ªæ•°        int sOldSize = s.length();        for (int i = 0; i &lt; s.length(); i++) &#123;            if(Character.isDigit(s.charAt(i)))&#123;                count++;            &#125;        &#125;        // æ‰©å……å­—ç¬¦ä¸²sçš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªç©ºæ ¼æ›¿æ¢æˆ&quot;number&quot;ä¹‹åçš„å¤§å°        char[] newS = new char[s.length() + count * 5];        int sNewSize = newS.length;        // å°†æ—§å­—ç¬¦ä¸²çš„å†…å®¹å¡«å…¥æ–°æ•°ç»„        System.arraycopy(s.toCharArray(), 0, newS, 0, sOldSize);        // ä»åå…ˆå‰å°†ç©ºæ ¼æ›¿æ¢ä¸º&quot;number&quot;        for (int i = sNewSize - 1, j = sOldSize - 1; j &lt; i; j--, i--) &#123;            if (!Character.isDigit(newS[j])) &#123;                newS[i] = newS[j];            &#125; else &#123;                newS[i] = &#x27;r&#x27;;                newS[i - 1] = &#x27;e&#x27;;                newS[i - 2] = &#x27;b&#x27;;                newS[i - 3] = &#x27;m&#x27;;                newS[i - 4] = &#x27;u&#x27;;                newS[i - 5] = &#x27;n&#x27;;                i -= 5;            &#125;        &#125;        return new String(newS);    &#125;;    public static void main(String[] args) &#123;        Scanner scanner = new Scanner(System.in);        String s = scanner.next();        System.out.println(replaceNumber(s));        scanner.close();    &#125;&#125;\n151 ç¿»è½¬å­—ç¬¦ä¸²é‡Œçš„å•è¯\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0151.ç¿»è½¬å­—ç¬¦ä¸²é‡Œçš„å•è¯.html)\nè¿™é¢˜ã€‚ã€‚ã€‚Java ä¸å¥½åƒæ²¡æœ‰åŠæ³•ç©ºé—´å¤æ‚åº¦ä¸º O(n)ã€‚ï¼ˆé¢è¯•çš„è¯ï¼Œä¸å¤ªæ¸…æ¥šä¼šä¸ä¼šè¿™ä¹ˆç»†ï¼Œå¹³æ—¶å¯èƒ½å°±ç›´æ¥ API æå®šäº†ã€‚ã€‚ã€‚ä¸€èˆ¬æœºè€ƒä¹Ÿä¸ä¼šè€ƒè¿™ä¸ªå§ğŸ˜¶â€ğŸŒ«ï¸ï¼‰\nåªèƒ½è¯´æ€è·¯å¾ˆé‡è¦ï¼š\n\n\nç§»é™¤å¤šä½™ç©ºæ ¼ï¼ˆï¼‰\n\n\nå°†æ•´ä¸ªå­—ç¬¦ä¸²åè½¬\n\n\nå°†æ¯ä¸ªå•è¯åè½¬\n\n\npublic class LE151 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          System.out.println(reverseWords(scanner.nextLine()));      &#125;        /**       * æœ¬é¢˜è€ƒå¯Ÿç‚¹åº”è¯¥å’Œä¸Šä¸€é¢˜ä¸€æ ·       * æ­¥éª¤å¦‚ä¸‹:       * 1.ç§»é™¤å­—ç¬¦ä¸²ä¸­çš„ç©ºæ ¼       * 2.å€’åº       * 3.æ¯ä¸ªå•è¯å†åè½¬       * è¦æ±‚ï¼šä¸ä½¿ç”¨ä»»ä½•å†…ç½®API       */    public static String reverseWords(String s) &#123;          String removeSpace = removeSpace(s);          System.out.println(removeSpace);          return reverseWord(removeSpace);      &#125;        /**       * å•ä¸ªå•è¯å€’ç½®       */      private static String reverseWord(String s) &#123;          String[] list = s.split(&quot; &quot;);          if (list.length &lt;= 0) &#123;              return &quot;&quot;;          &#125;          StringBuilder stringBuilder = new StringBuilder();          for (String s1 : list) &#123;              char[] chars = s1.toCharArray();              for (int i = 0, j = chars.length - 1; i &lt;= j; i++, j--) &#123;                  char temp = chars[i];                  chars[i] = chars[j];                  chars[j] = temp;              &#125;              stringBuilder.append(chars).append(&quot; &quot;);          &#125;          return stringBuilder.substring(0, stringBuilder.length() - 1);      &#125;        /**       * å»é™¤å­—ç¬¦ä¸²ä¸­çš„å¤šä½™ç©ºæ ¼       * å¹¶è¿›è¡Œå€’åº       */      private static String removeSpace(String s) &#123;          char[] chars = s.toCharArray();          int start = 0;          int end = s.length() - 1;          while (s.charAt(start) == &#x27; &#x27;) &#123;              start++;          &#125;          while (s.charAt(end) == &#x27; &#x27;) &#123;              end--;          &#125;          if (start &gt; end) &#123;              return &quot;&quot;;          &#125;          StringBuilder stringBuilder = new StringBuilder();          for (int i = end; i &gt;= start; i--) &#123;              if (chars[i] == &#x27; &#x27; &amp;&amp; chars[i - 1] == &#x27; &#x27;) &#123;                  continue;              &#125;              stringBuilder.append(chars[i]);          &#125;          return stringBuilder.toString();      &#125;    &#125;\nå¡ç ç½‘ 55 å³æ—‹è½¬å­—ç¬¦ä¸²\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/kama55.å³æ—‹å­—ç¬¦ä¸².html)\nè¿™é¢˜ä¹Ÿæ˜¯ã€‚ã€‚ã€‚åæ­£ç›´æ¥ç”¨ API äº†ï¼Œçœ‹äº†è¯´ã€Šå‰‘æŒ‡ Offerã€‹æœ‰å·®ä¸å¤šçš„é¢˜ç›®ã€‚\næ²¡æœ‰å†å†™ä¸€éï¼Œç›´æ¥æŠ„äº†è§£æä¸­çš„å†™æ³•ã€‚\npublic class Main &#123;    public static void main(String[] args) &#123;        Scanner in = new Scanner(System.in);        int n = Integer.parseInt(in.nextLine());        String s = in.nextLine();        int len = s.length();  //è·å–å­—ç¬¦ä¸²é•¿åº¦        char[] chars = s.toCharArray();        reverseString(chars, 0, len - 1);  //åè½¬æ•´ä¸ªå­—ç¬¦ä¸²        reverseString(chars, 0, n - 1);  //åè½¬å‰ä¸€æ®µå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶çš„å­—ç¬¦ä¸²é¦–å°¾å°¾æ˜¯0,n - 1        reverseString(chars, n, len - 1);  //åè½¬åä¸€æ®µå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶çš„å­—ç¬¦ä¸²é¦–å°¾å°¾æ˜¯n,len - 1                System.out.println(chars);    &#125;    public static void reverseString(char[] ch, int start, int end) &#123;        //å¼‚æˆ–æ³•åè½¬å­—ç¬¦ä¸²ï¼Œå‚ç…§é¢˜ç›® 344.åè½¬å­—ç¬¦ä¸²çš„è§£é‡Š        while (start &lt; end) &#123;            ch[start] ^= ch[end];            ch[end] ^= ch[start];            ch[start] ^= ch[end];            start++;            end--;        &#125;    &#125;&#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŒæŒ‡é’ˆ","åè½¬","å­—ç¬¦ä¸²"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¹å¤©-232ç”¨æ ˆå®ç°é˜Ÿåˆ—ã€225ç”¨é˜Ÿåˆ—å®ç°æ ˆ","url":"/posts/64880820/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šéƒ½æ˜¯ç›´æ¥çœ‹çš„è§£æï¼Œä¸æ˜¯å¾ˆéš¾ã€‚\n\n\næ›´æ–°\n\n\n24.05.30 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n232 ç”¨æ ˆå®ç°é˜Ÿåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/implement-queue-using-stacks/description/)\npublic class LE232 &#123;      public static void main(String[] args) &#123;          MyQueue queue = new MyQueue();          queue.push(1);          queue.push(2);          System.out.println(&quot;queue.peek() = &quot; + queue.peek());          System.out.println(&quot;queue.pop() = &quot; + queue.pop());          System.out.println(&quot;queue.empty() = &quot; + queue.empty());      &#125;        static class MyQueue &#123;          Stack&lt;Integer&gt; stackIn;          Stack&lt;Integer&gt; stackOut;            public MyQueue() &#123;              stackIn = new Stack&lt;&gt;();              stackOut = new Stack&lt;&gt;();          &#125;            public void push(int x) &#123;              stackIn.push(x);          &#125;            public int pop() &#123;              // æŠŠinçš„å†…å®¹å¤åˆ¶åˆ°out              in2out();              return stackOut.pop();          &#125;            private void in2out() &#123;              if (stackOut.isEmpty()) &#123;                  while (!stackIn.isEmpty()) &#123;                      stackOut.push(stackIn.pop());                  &#125;              &#125;          &#125;            /**           * è¿”å›åˆ—è¡¨å¼€å¤´çš„æ•°æ®           * @return ç»“æœ           */          public int peek() &#123;              // æŠŠinçš„å†…å®¹å¤åˆ¶åˆ°out              in2out();              return stackOut.peek();          &#125;            public boolean empty() &#123;              return stackIn.empty() &amp;&amp; stackOut.empty();          &#125;      &#125;  &#125;\n225 ç”¨é˜Ÿåˆ—å®ç°æ ˆ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/implement-queue-using-stacks/description/)\npublic class LE225 &#123;      public static void main(String[] args) &#123;          MyStack myStack = new MyStack();          myStack.push(1);          myStack.push(2);          System.out.println(&quot;myStack.top() = &quot; + myStack.top());          System.out.println(&quot;myStack.pop() = &quot; + myStack.pop());          System.out.println(&quot;myStack.empty() = &quot; + myStack.empty());      &#125;        static class MyStack &#123;          Queue&lt;Integer&gt; queue;            public MyStack() &#123;              queue = new LinkedList&lt;&gt;();          &#125;            public void push(int x) &#123;              queue.offer(x);              int size = queue.size() - 1;              while (size != 0) &#123;                  size--;                  queue.offer(queue.poll());              &#125;          &#125;            public int pop() &#123;              return queue.poll();          &#125;            public int top() &#123;              return queue.peek();          &#125;            /**           * åˆ¤æ–­æ˜¯å¦ä¸ºç©º           */          public boolean empty() &#123;              return queue.isEmpty();          &#125;      &#125;  &#125;\nçœ‹è®²è§£\n232 ç”¨æ ˆå®ç°é˜Ÿåˆ—\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0232.ç”¨æ ˆå®ç°é˜Ÿåˆ—.html)\næ€è·¯ï¼šç”¨æ ˆæ¨¡æ‹Ÿé˜Ÿåˆ—éœ€è¦ä¸¤ä¸ªæ ˆã€‚ä¸€ä¸ªæ ˆä½œä¸ºå…¥æ ˆï¼Œä¸€ä¸ªæ ˆä½œä¸ºå‡ºæ ˆã€‚å¦‚æœå‡ºæ ˆä¸ºç©ºï¼Œå°†å…¥æ ˆä¸­çš„å…ƒç´ å‹å…¥å‡ºæ ˆã€‚\n\n225 ç”¨é˜Ÿåˆ—å®ç°æ ˆ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0225.ç”¨é˜Ÿåˆ—å®ç°æ ˆ.html)\næ€è·¯ï¼šç”¨é˜Ÿåˆ—æ¨¡æ‹Ÿæ ˆï¼Œå¯ä»¥åªç”¨ä¸€ä¸ªé˜Ÿåˆ—ã€‚æ¯å½“æœ‰æ–°å…ƒç´ å…¥é˜Ÿåˆ—ï¼Œå°†åŸæœ‰çš„æ—§å…ƒç´ é‡æ–°å…¥é˜Ÿåˆ—ï¼Œè¿™æ ·æ–°å…ƒç´ å°±å˜æˆæ ˆé¡¶å…ƒç´ ã€‚ï¼ˆä¸€ä¸ªé˜Ÿåˆ—åœ¨æ¨¡æ‹Ÿæ ˆå¼¹å‡ºå…ƒç´ çš„æ—¶å€™åªè¦å°†é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ ï¼ˆé™¤äº†æœ€åä¸€ä¸ªå…ƒç´ å¤–ï¼‰ é‡æ–°æ·»åŠ åˆ°é˜Ÿåˆ—å°¾éƒ¨ï¼Œæ­¤æ—¶å†å»å¼¹å‡ºå…ƒç´ å°±æ˜¯æ ˆçš„é¡ºåºäº†ã€‚ï¼‰\n\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["æ ˆ","é˜Ÿåˆ—"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åå¤©-20æœ‰æ•ˆçš„æ‹¬å·ã€1047åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç›¸é‚»é‡å¤é¡¹ã€150é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼","url":"/posts/d079314e/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š20ACï¼Œ1047ACï¼Œ150AC\n\n\næ›´æ–°\n\n\n24.05.30 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n20 æœ‰æ•ˆçš„æ‹¬å·\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/valid-parentheses/description/)\npublic class LE20 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          System.out.println(isValid(scanner.nextLine()));      &#125;        public static boolean isValid(String s) &#123;          Stack&lt;Character&gt; stack = new Stack&lt;&gt;();          for (char c : s.toCharArray()) &#123;              if (c == &#x27;(&#x27; || c == &#x27;[&#x27; || c == &#x27;&#123;&#x27;) &#123;                  stack.push(c);                  continue;              &#125;              if (stack.isEmpty()) &#123;                  return false;              &#125;              Character pop = stack.pop();              if ((c == &#x27;)&#x27; &amp;&amp; pop != &#x27;(&#x27; ) || (c == &#x27;]&#x27; &amp;&amp; pop != &#x27;[&#x27; ) || (c == &#x27;&#125;&#x27; &amp;&amp; pop != &#x27;&#123;&#x27; )) &#123;                  return false;              &#125;          &#125;          return stack.isEmpty();      &#125;  &#125;\n1047 åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç›¸é‚»é‡å¤é¡¹\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/remove-all-adjacent-duplicates-in-string/description/)\npublic static void main(String[] args) &#123;      Scanner scanner = new Scanner(System.in);      System.out.println(removeDuplicates(scanner.nextLine()));  &#125;    public static String removeDuplicates(String s) &#123;      Stack&lt;Character&gt; stack = new Stack&lt;&gt;();      for (char c : s.toCharArray()) &#123;          if (stack.isEmpty()) &#123;              stack.push(c);              continue;          &#125;          if (c == stack.peek()) &#123;              stack.pop();          &#125; else &#123;              stack.push(c);          &#125;      &#125;        StringBuilder str = new StringBuilder();      int size = stack.size();      for (int i = 0; i &lt; size; i++) &#123;          str.insert(0, stack.pop());      &#125;      return str.toString();  &#125;\n150 é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/evaluate-reverse-polish-notation/description/)\nå¯ä»¥ç›´æ¥æ ¹æ®é¢˜ç›®ä¸­ç»™çš„é“¾æ¥æŸ¥çœ‹ é€†æ³¢å…°è¡¨ç¤ºæ³• çš„æ„æ€\npublic int evalRPN(String[] tokens) &#123;      Stack&lt;Integer&gt; stack = new Stack&lt;&gt;();      int num = Integer.parseInt(tokens[0]);      for (String token : tokens) &#123;          switch (token) &#123;              case &quot;+&quot;: &#123;                  num = stack.pop() + stack.pop();                  stack.push(num);                  break;              &#125;              case &quot;-&quot;: &#123;                  Integer num2 = stack.pop();                  Integer num1 = stack.pop();                  num = num1 - num2;                  stack.push(num);                  break;              &#125;              case &quot;*&quot;: &#123;                  num = stack.pop() * stack.pop();                  stack.push(num);                  break;              &#125;              case &quot;/&quot;: &#123;                  Integer num2 = stack.pop();                  Integer num1 = stack.pop();                  num = num1 / num2;                  stack.push(num);                  break;              &#125;              default: &#123;                  stack.push(Integer.parseInt(token));              &#125;          &#125;      &#125;      return num;  &#125;\nçœ‹è§£æ\n20 æœ‰æ•ˆçš„æ‹¬å·\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0020.æœ‰æ•ˆçš„æ‹¬å·.html)\n1047 åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç›¸é‚»é‡å¤é¡¹\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/1047.åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç›¸é‚»é‡å¤é¡¹.html)\n150 é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0150.é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["æ ˆ"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åä¸€å¤©-239æ»‘åŠ¨çª—å£æœ€å¤§å€¼ã€347å‰ K ä¸ªé«˜é¢‘å…ƒç´ ","url":"/posts/e45cf8/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š239 è¶…æ—¶ï¼Œ347 ç›´æ¥ç”¨çš„ Stream æµã€‚\n\n\næ›´æ–°\n\n\n24.05.31 åˆå§‹è®°å½•24.06.01 å®Œæˆé¢˜ç›®\n\nåˆæ­¥é¢˜è§£\n239 æ»‘åŠ¨çª—å£æœ€å¤§å€¼\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/sliding-window-maximum/description/)\næš´åŠ›è§£æ³•ï¼šå¾ªç¯åˆ¤æ–­æœ€å¤§å€¼ï¼ˆè¶…æ—¶ï¼‰\npublic class LE239 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          String s = scanner.nextLine();          int[] split = Arrays.stream(s.split(&quot;,&quot;)).mapToInt(Integer::parseInt).toArray();          int[] ints = maxSlidingWindow(split, Integer.parseInt(scanner.nextLine()));          for (int anInt : ints) &#123;              System.out.println(anInt);          &#125;      &#125;        public static int[] maxSlidingWindow(int[] nums, int k) &#123;          if (nums.length &lt;= k) &#123;              return new int[]&#123;getMax(nums, 0, nums.length - 1)&#125;;          &#125;            ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();          for (int i = 0; i &lt;= nums.length - k; i++) &#123;              int max = getMax(nums, i, i + k - 1);              list.add(max);          &#125;          return list.stream().mapToInt(i -&gt; i).toArray();      &#125;        private static int getMax(int[] nums, int i, int j) &#123;          int max = Integer.MIN_VALUE;          for (int k = i; k &lt;= j; k++) &#123;              max = Math.max(max, nums[k]);          &#125;          return max;      &#125;  &#125;\n347 å‰ K ä¸ªé«˜é¢‘å…ƒç´ \né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/top-k-frequent-elements/description/)\nç›´æ¥ç”¨ Stream æµçš„è§£æ³•ï¼Œä¼°è®¡ä¸Šç­ä¼šç”¨è¿™ä¸ªã€‚ã€‚ã€‚ç”šè‡³å¯ä»¥ä¼˜åŒ–æˆä¸€è¡Œ\npublic static int[] topKFrequent(int[] nums, int k) &#123;      // mapç”¨äºè®¡æ•°      TreeMap&lt;Integer, Integer&gt; map = new TreeMap&lt;&gt;();      for (int num : nums) &#123;          map.put(num, map.getOrDefault(num, 0) + 1);      &#125;        return map.entrySet().stream()              .sorted((o1, o2) -&gt; o2.getValue() - o1.getValue())              .limit(k)              .map(Map.Entry::getKey)              .mapToInt(i -&gt; i)              .toArray();  &#125;\nçœ‹è§£æ\n239 æ»‘åŠ¨çª—å£æœ€å¤§å€¼\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0239.æ»‘åŠ¨çª—å£æœ€å¤§å€¼.html#æ€è·¯)\n\næ€è·¯ï¼šè¿™é¢˜æ”¾åœ¨é˜Ÿåˆ—ä¸“é¢˜ï¼Œè‚¯å®šæ˜¯è¦ç”¨åˆ°é˜Ÿåˆ—æ€æƒ³çš„ã€‚æŒ‰æš´åŠ›çš„è§£æ³•ï¼Œæ±‚æœ€å¤§å€¼çš„é‚£ä¸ªå¾ªç¯ï¼ˆè¿™æ ·æ•ˆç‡å°±æ˜¯ O(n * k)ï¼‰ï¼Œåœ¨è¿™è¾¹å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—è§£å†³ã€‚\nå…¶å®é˜Ÿåˆ—æ²¡æœ‰å¿…è¦ç»´æŠ¤çª—å£é‡Œçš„æ‰€æœ‰å…ƒç´ ï¼Œåªéœ€è¦ç»´æŠ¤æœ‰å¯èƒ½æˆä¸ºçª—å£é‡Œæœ€å¤§å€¼çš„å…ƒç´ å°±å¯ä»¥äº†ï¼ŒåŒæ—¶ä¿è¯é˜Ÿåˆ—é‡Œçš„å…ƒç´ æ•°å€¼æ˜¯ç”±å¤§åˆ°å°çš„ã€‚\né‚£ä¹ˆè¿™ä¸ªç»´æŠ¤å…ƒç´ å•è°ƒé€’å‡çš„é˜Ÿåˆ—å°±å«åšå•è°ƒé˜Ÿåˆ—ï¼Œå³å•è°ƒé€’å‡æˆ–å•è°ƒé€’å¢çš„é˜Ÿåˆ—ã€‚Java ä¸­æ²¡æœ‰ç›´æ¥æ”¯æŒå•è°ƒé˜Ÿåˆ—ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ¥å®ç°ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—\n\nè®¾è®¡å•è°ƒé˜Ÿåˆ—çš„æ—¶å€™ï¼Œpopï¼Œå’Œ push æ“ä½œè¦ä¿æŒå¦‚ä¸‹è§„åˆ™ï¼š\n\n\npop(value)ï¼šå¦‚æœçª—å£ç§»é™¤çš„å…ƒç´  value ç­‰äºå•è°ƒé˜Ÿåˆ—çš„å‡ºå£å…ƒç´ ï¼Œé‚£ä¹ˆé˜Ÿåˆ—å¼¹å‡ºå…ƒç´ ï¼Œå¦åˆ™ä¸ç”¨ä»»ä½•æ“ä½œ\n\n\npush(value)ï¼šå¦‚æœ push çš„å…ƒç´  value å¤§äºå…¥å£å…ƒç´ çš„æ•°å€¼ï¼Œé‚£ä¹ˆå°±å°†é˜Ÿåˆ—å…¥å£çš„å…ƒç´ å¼¹å‡ºï¼Œç›´åˆ° push å…ƒç´ çš„æ•°å€¼å°äºç­‰äºé˜Ÿåˆ—å…¥å£å…ƒç´ çš„æ•°å€¼ä¸ºæ­¢ï¼ˆæ‰€ä»¥è¿™é‡Œè¦ç”¨ whileï¼‰\n\n\nä¿æŒå¦‚ä¸Šè§„åˆ™ï¼Œæ¯æ¬¡çª—å£ç§»åŠ¨çš„æ—¶å€™ï¼Œåªè¦é—® que.peek() å°±å¯ä»¥è¿”å›å½“å‰çª—å£çš„æœ€å¤§å€¼ã€‚\n/**   * å®šä¹‰ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—   */  static class MyQueue &#123;      Deque&lt;Integer&gt; deque = new LinkedList&lt;&gt;();        public void push(int num) &#123;          while (!deque.isEmpty() &amp;&amp; num &gt; deque.getLast()) &#123;              deque.removeLast();          &#125;          deque.add(num);      &#125;        /**       * åˆ¤æ–­é˜Ÿé¡¶å…ƒç´ æ˜¯å¦æ˜¯è¦ç§»é™¤çš„å…ƒç´        */      public void pull(int num) &#123;          if (!deque.isEmpty() &amp;&amp; deque.peek() == num) &#123;              deque.poll();          &#125;      &#125;        public int peek() &#123;          return deque.peek();      &#125;  &#125;    public static int[] maxSlidingWindow(int[] nums, int k) &#123;      MyQueue myQueue = new MyQueue();      for (int i = 0; i &lt; k; i++) &#123;          myQueue.push(nums[i]);      &#125;        int j = 0;      int[] ints = new int[nums.length - k + 1];      ints[j++] = myQueue.peek();      for (int i = k; i &lt;nums.length; i++) &#123;          // çª—å£æ»‘åŠ¨ï¼Œç§»é™¤å…ƒç´ ï¼ˆç§»é™¤æ—¶è¦åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å•è°ƒé˜Ÿåˆ—å†…ï¼‰          myQueue.pull(nums[i - k]);          // çª—å£æ»‘åŠ¨ï¼Œæ·»åŠ æœ€æ–°å…ƒç´ åˆ°å•è°ƒé˜Ÿåˆ—          myQueue.push(nums[i]);          // è·å–å•è°ƒé˜Ÿåˆ—é˜Ÿé¡¶å…ƒç´ ï¼ˆæ ¹æ®å®šä¹‰çš„è§„åˆ™ï¼Œä¸€å®šæ˜¯åŒºé—´å†…æœ€å¤§çš„ï¼‰          ints[j++] = myQueue.peek();      &#125;      return ints;  &#125;\n347 å‰ K ä¸ªé«˜é¢‘å…ƒç´ \né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0347.å‰Kä¸ªé«˜é¢‘å…ƒç´ .html)\nè¿™é¢˜å±äºï¼šå‰ K ä¸ªå¤§æ•°é—®é¢˜ã€‚è¿™ç§é—®é¢˜ä¸€èˆ¬ç”¨å¤§é¡¶å †ï¼ˆæ ¹èŠ‚ç‚¹æœ€å¤§ï¼‰æˆ–å°é¡¶å †ï¼ˆæ ¹èŠ‚ç‚¹æœ€å°ï¼‰ã€‚éœ€è¦ä½¿ç”¨å°é¡¶å †ï¼Œå› ä¸ºè¦ç»Ÿè®¡æœ€å¤§å‰ k ä¸ªå…ƒç´ ï¼Œåªæœ‰å°é¡¶å †æ¯æ¬¡å°†æœ€å°çš„å…ƒç´ å¼¹å‡ºï¼Œæœ€åå°é¡¶å †é‡Œç§¯ç´¯çš„æ‰æ˜¯å‰ k ä¸ªæœ€å¤§å…ƒç´ ã€‚\nemmmmm æ„Ÿè§‰å’Œ Stream æµæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ˆå¯èƒ½åœ¨äºä»–ç”¨çš„å®¹å™¨å§ï¼‰ã€‚\n/*Comparatoræ¥å£è¯´æ˜: * è¿”å›è´Ÿæ•°ï¼Œå½¢å‚ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ’åœ¨å‰é¢ï¼›è¿”å›æ­£æ•°ï¼Œå½¢å‚ä¸­ç¬¬äºŒä¸ªå‚æ•°æ’åœ¨å‰é¢ * å¯¹äºé˜Ÿåˆ—ï¼šæ’åœ¨å‰é¢æ„å‘³ç€å¾€é˜Ÿå¤´é  * å¯¹äºå †ï¼ˆä½¿ç”¨PriorityQueueå®ç°ï¼‰ï¼šä»é˜Ÿå¤´åˆ°é˜Ÿå°¾æŒ‰ä»å°åˆ°å¤§æ’å°±æ˜¯æœ€å°å †ï¼ˆå°é¡¶å †ï¼‰ï¼Œ *                                ä»é˜Ÿå¤´åˆ°é˜Ÿå°¾æŒ‰ä»å¤§åˆ°å°æ’å°±æ˜¯æœ€å¤§å †ï¼ˆå¤§é¡¶å †ï¼‰---&gt;é˜Ÿå¤´å…ƒç´ ç›¸å½“äºå †çš„æ ¹èŠ‚ç‚¹ * */class Solution &#123;    //è§£æ³•1ï¼šåŸºäºå¤§é¡¶å †å®ç°    public int[] topKFrequent1(int[] nums, int k) &#123;        Map&lt;Integer,Integer&gt; map = new HashMap&lt;&gt;(); //keyä¸ºæ•°ç»„å…ƒç´ å€¼,valä¸ºå¯¹åº”å‡ºç°æ¬¡æ•°        for (int num : nums) &#123;            map.put(num, map.getOrDefault(num,0) + 1);        &#125;        //åœ¨ä¼˜å…ˆé˜Ÿåˆ—ä¸­å­˜å‚¨äºŒå…ƒç»„(num, cnt),cntè¡¨ç¤ºå…ƒç´ å€¼numåœ¨æ•°ç»„ä¸­çš„å‡ºç°æ¬¡æ•°        //å‡ºç°æ¬¡æ•°æŒ‰ä»é˜Ÿå¤´åˆ°é˜Ÿå°¾çš„é¡ºåºæ˜¯ä»å¤§åˆ°å°æ’,å‡ºç°æ¬¡æ•°æœ€å¤šçš„åœ¨é˜Ÿå¤´(ç›¸å½“äºå¤§é¡¶å †)        PriorityQueue&lt;int[]&gt; pq = new PriorityQueue&lt;&gt;((pair1, pair2) -&gt; pair2[1] - pair1[1]);        for (Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123;//å¤§é¡¶å †éœ€è¦å¯¹æ‰€æœ‰å…ƒç´ è¿›è¡Œæ’åº            pq.add(new int[]&#123;entry.getKey(), entry.getValue()&#125;);        &#125;        int[] ans = new int[k];        for (int i = 0; i &lt; k; i++) &#123; //ä¾æ¬¡ä»é˜Ÿå¤´å¼¹å‡ºkä¸ª,å°±æ˜¯å‡ºç°é¢‘ç‡å‰ké«˜çš„å…ƒç´             ans[i] = pq.poll()[0];        &#125;        return ans;    &#125;    //è§£æ³•2ï¼šåŸºäºå°é¡¶å †å®ç°    public int[] topKFrequent2(int[] nums, int k) &#123;        Map&lt;Integer,Integer&gt; map = new HashMap&lt;&gt;(); //keyä¸ºæ•°ç»„å…ƒç´ å€¼,valä¸ºå¯¹åº”å‡ºç°æ¬¡æ•°        for (int num : nums) &#123;            map.put(num, map.getOrDefault(num, 0) + 1);        &#125;        //åœ¨ä¼˜å…ˆé˜Ÿåˆ—ä¸­å­˜å‚¨äºŒå…ƒç»„(num, cnt),cntè¡¨ç¤ºå…ƒç´ å€¼numåœ¨æ•°ç»„ä¸­çš„å‡ºç°æ¬¡æ•°        //å‡ºç°æ¬¡æ•°æŒ‰ä»é˜Ÿå¤´åˆ°é˜Ÿå°¾çš„é¡ºåºæ˜¯ä»å°åˆ°å¤§æ’,å‡ºç°æ¬¡æ•°æœ€ä½çš„åœ¨é˜Ÿå¤´(ç›¸å½“äºå°é¡¶å †)        PriorityQueue&lt;int[]&gt; pq = new PriorityQueue&lt;&gt;((pair1, pair2) -&gt; pair1[1] - pair2[1]);        for (Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123; //å°é¡¶å †åªéœ€è¦ç»´æŒkä¸ªå…ƒç´ æœ‰åº            if (pq.size() &lt; k) &#123; //å°é¡¶å †å…ƒç´ ä¸ªæ•°å°äºkä¸ªæ—¶ç›´æ¥åŠ                 pq.add(new int[]&#123;entry.getKey(), entry.getValue()&#125;);            &#125; else &#123;                if (entry.getValue() &gt; pq.peek()[1]) &#123; //å½“å‰å…ƒç´ å‡ºç°æ¬¡æ•°å¤§äºå°é¡¶å †çš„æ ¹ç»“ç‚¹(è¿™kä¸ªå…ƒç´ ä¸­å‡ºç°æ¬¡æ•°æœ€å°‘çš„é‚£ä¸ª)                    pq.poll(); //å¼¹å‡ºé˜Ÿå¤´(å°é¡¶å †çš„æ ¹ç»“ç‚¹),å³æŠŠå †é‡Œå‡ºç°æ¬¡æ•°æœ€å°‘çš„é‚£ä¸ªåˆ é™¤,ç•™ä¸‹çš„å°±æ˜¯å‡ºç°æ¬¡æ•°å¤šçš„äº†                    pq.add(new int[]&#123;entry.getKey(), entry.getValue()&#125;);                &#125;            &#125;        &#125;        int[] ans = new int[k];        for (int i = k - 1; i &gt;= 0; i--) &#123; //ä¾æ¬¡å¼¹å‡ºå°é¡¶å †,å…ˆå¼¹å‡ºçš„æ˜¯å †çš„æ ¹,å‡ºç°æ¬¡æ•°å°‘,åé¢å¼¹å‡ºçš„å‡ºç°æ¬¡æ•°å¤š            ans[i] = pq.poll()[0];        &#125;        return ans;    &#125;&#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["é˜Ÿåˆ—","å•è°ƒé˜Ÿåˆ—","ä¼˜å…ˆçº§é˜Ÿåˆ—"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åäºŒå¤©-äºŒå‰æ ‘ç†è®ºåŸºç¡€ã€é€’å½’éå†ã€è¿­ä»£éå†ã€ç»Ÿä¸€è¿­ä»£","url":"/posts/a297f438/","content":"\n\nå‰è¨€é€’å½’ã€è¿­ä»£ã€ç»Ÿä¸€è¿­ä»£ã€‚éƒ½æ˜¯çœ‹å®Œè§£æä¹‹åå®Œæˆçš„ã€‚ç»Ÿä¸€è¿­ä»£æœ‰ç‚¹éš¾ç†è§£ã€‚\n\n\næ›´æ–°\n\n\n24-06-03 åˆå§‹è®°å½•\n\n144 äºŒå‰æ ‘çš„å‰åºéå†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/binary-tree-preorder-traversal/description/)\npublic List&lt;Integer&gt; preorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      preOrder(root, list);      return list;  &#125;/**   * å‰åºéå† * @param root èŠ‚ç‚¹   * @param list éå†ç»“æœ   */  private void preOrder(TreeNode root, ArrayList&lt;Integer&gt; list) &#123;      if (root == null) &#123;          return;      &#125;      // å½“å‰      list.add(root.val);      // å·¦å­æ ‘      preOrder(root.left, list);      // å³å­æ ‘      preOrder(root.right, list);  &#125;\n/**   * è¿­ä»£æ³•   * å‰åºéå† ä¸­å·¦å³   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public List&lt;Integer&gt; preorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      if (root == null) &#123;          return list;      &#125;      Stack&lt;TreeNode&gt; stack = new Stack&lt;&gt;();      stack.push(root);      while (!stack.isEmpty()) &#123;          TreeNode pop = stack.pop();          list.add(pop.val);            // æ ˆå…ˆè¿›åå‡ºï¼Œå…ˆè¿›å³          if (pop.right != null) &#123;              stack.push(pop.right);          &#125;          if (pop.left != null) &#123;              stack.push(pop.left);          &#125;      &#125;        return list;  &#125;\npublic List&lt;Integer&gt; preorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      Stack&lt;TreeNode&gt; stack = new Stack&lt;&gt;();      if (root != null) &#123;          stack.push(root);      &#125;      while (!stack.isEmpty()) &#123;          TreeNode node = stack.peek();          if (node != null) &#123;              stack.pop();              // åˆ¤æ–­å³èŠ‚ç‚¹              if (node.right != null) &#123;                  stack.push(node.right);              &#125;              // å·¦èŠ‚ç‚¹              if (node.left != null) &#123;                  stack.push(node.left);              &#125;              // ä¸­é—´èŠ‚ç‚¹              stack.push(node);              stack.push(null);              // åªæœ‰åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰ä¼šè¿›è¿™ä¸ªelse          &#125; else &#123;              // é‡åˆ°ç©ºèŠ‚ç‚¹ï¼Œè¯´æ˜åä¸€ä¸ªæ˜¯è¦å¤„ç†çš„èŠ‚ç‚¹ï¼Œå…ˆå¼¹å‡ºç©ºèŠ‚ç‚¹              stack.pop();                // å†æŠŠè¦å¤„ç†çš„èŠ‚ç‚¹å¼¹å‡ºå¹¶åŠ å…¥åˆ°åˆ—è¡¨ä¸­              node = stack.peek();              stack.pop();              list.add(node.val);          &#125;      &#125;      return list;  &#125;\n94 äºŒå‰æ ‘çš„ä¸­åºéå†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/binary-tree-inorder-traversal/description/)\nä¸­åºéå†æ˜¯å·¦ä¸­å³ï¼Œå…ˆè®¿é—®çš„æ˜¯äºŒå‰æ ‘é¡¶éƒ¨çš„èŠ‚ç‚¹ï¼Œç„¶åä¸€å±‚ä¸€å±‚å‘ä¸‹è®¿é—®ï¼Œç›´åˆ°åˆ°è¾¾æ ‘å·¦é¢çš„æœ€åº•éƒ¨ï¼Œå†å¼€å§‹å¤„ç†èŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯åœ¨æŠŠèŠ‚ç‚¹çš„æ•°å€¼æ”¾è¿› result æ•°ç»„ä¸­ï¼‰ï¼Œè¿™å°±é€ æˆäº†å¤„ç†é¡ºåºå’Œè®¿é—®é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ã€‚\né‚£ä¹ˆåœ¨ä½¿ç”¨è¿­ä»£æ³•å†™ä¸­åºéå†ï¼Œå°±éœ€è¦å€Ÿç”¨æŒ‡é’ˆçš„éå†æ¥å¸®åŠ©è®¿é—®èŠ‚ç‚¹ï¼Œæ ˆåˆ™ç”¨æ¥å¤„ç†èŠ‚ç‚¹ä¸Šçš„å…ƒç´ ã€‚\npublic List&lt;Integer&gt; inorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      inOrder(root, list);      return list;  &#125;/**   * ä¸­åºéå†   * @param root èŠ‚ç‚¹   * @param list éå†ç»“æœ   */  private void inOrder(TreeNode root, ArrayList&lt;Integer&gt; list) &#123;      if (root == null) &#123;          return;      &#125;      inOrder(root.left, list);      list.add(root.val);      inOrder(root.right, list);  &#125;\n/**   * è¿­ä»£æ³•   * ä¸­åºéå† å·¦ä¸­å³   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public List&lt;Integer&gt; inorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      if (root == null) &#123;          return list;      &#125;      Stack&lt;TreeNode&gt; stack = new Stack&lt;&gt;();      TreeNode cur = root;      while (!stack.isEmpty() || cur != null) &#123;          if (cur != null) &#123;              // å…ˆéå†å·¦å­èŠ‚ç‚¹(ç›´è‡³åˆ°æœ€åä¸€ä¸ªå·¦å­èŠ‚ç‚¹)              stack.push(cur);              cur = cur.left;          &#125; else &#123;              // æ­¤æ—¶ä»æ ˆé‡Œå¼¹å‡ºçš„æ•°æ®ï¼Œå°±æ˜¯è¦å¤„ç†çš„æ•°æ®              cur = stack.pop();              list.add(cur.val);              cur = cur.right;          &#125;      &#125;        return list;  &#125;\n/**   * ä¸­åºéå†   * @param root æ ¹èŠ‚ç‚¹   * @return è¿”å›éå†ç»“æœ   */  public List&lt;Integer&gt; inorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      Stack&lt;TreeNode&gt; stack = new Stack&lt;&gt;();      if (root != null) &#123;          stack.push(root);      &#125;      while (!stack.isEmpty()) &#123;          TreeNode node = stack.peek();          if (node != null) &#123;              stack.pop();              // åˆ¤æ–­å³èŠ‚ç‚¹              if (node.right != null) &#123;                  stack.push(node.right);              &#125;              // ä¸­é—´èŠ‚ç‚¹              stack.push(node);              stack.push(null);              // å·¦èŠ‚ç‚¹              if (node.left != null) &#123;                  stack.push(node.left);              &#125;              // åªæœ‰åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰ä¼šè¿›è¿™ä¸ªelse          &#125; else &#123;              // é‡åˆ°ç©ºèŠ‚ç‚¹ï¼Œè¯´æ˜åä¸€ä¸ªæ˜¯è¦å¤„ç†çš„èŠ‚ç‚¹ï¼Œå…ˆå¼¹å‡ºç©ºèŠ‚ç‚¹              stack.pop();                // å†æŠŠè¦å¤„ç†çš„èŠ‚ç‚¹å¼¹å‡ºå¹¶åŠ å…¥åˆ°åˆ—è¡¨ä¸­              node = stack.peek();              stack.pop();              list.add(node.val);          &#125;      &#125;      return list;  &#125;\n145 äºŒå‰æ ‘çš„ååºéå†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/binary-tree-postorder-traversal/description/)\n// é€’å½’æ³•public List&lt;Integer&gt; postorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      postOrder(root, list);      return list;  &#125;    /**   * ååºéå†   * @param root èŠ‚ç‚¹   * @param list éå†ç»“æœ   */  private void postOrder(TreeNode root, ArrayList&lt;Integer&gt; list) &#123;      if (root == null) &#123;          return;      &#125;      postOrder(root.left, list);      postOrder(root.right, list);      list.add(root.val);  &#125;\n/**   * ååºéå† å·¦å³ä¸­   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public List&lt;Integer&gt; postorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      if (root == null) &#123;          return list;      &#125;      Stack&lt;TreeNode&gt; stack = new Stack&lt;&gt;();      stack.push(root);      while (!stack.isEmpty()) &#123;          TreeNode pop = stack.pop();          list.add(pop.val);            // æ ˆå…ˆè¿›åå‡ºï¼Œå…ˆè¿›å³          if (pop.left != null) &#123;              stack.push(pop.left);          &#125;          if (pop.right != null) &#123;              stack.push(pop.right);          &#125;      &#125;      // ä¸Šéƒ¨åˆ†ä»£ç ä¸å‰åºç›¸åŒï¼Œleftå’Œrightéå†é¡ºåºé¢ å€’ã€‚å¾—åˆ°çš„æ•°ç»„ä¸ºä¸­å³å·¦éå†å¾—å‡ºçš„ç»“æœ      // ç¿»è½¬å¾—åˆ°çš„ç»“æœï¼Œå³ä¸ºå·¦å³ä¸­éå†å¾—å‡ºçš„ç»“æœ      Collections.reverse(list);      return list;  &#125;\npublic List&lt;Integer&gt; postorderTraversal(TreeNode root) &#123;      ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();      Stack&lt;TreeNode&gt; stack = new Stack&lt;&gt;();      if (root != null) &#123;          stack.push(root);      &#125;      while (!stack.isEmpty()) &#123;          TreeNode node = stack.peek();          if (node != null) &#123;              stack.pop();              // ä¸­é—´èŠ‚ç‚¹              stack.push(node);              stack.push(null);              // åˆ¤æ–­å³èŠ‚ç‚¹              if (node.right != null) &#123;                  stack.push(node.right);              &#125;              // å·¦èŠ‚ç‚¹              if (node.left != null) &#123;                  stack.push(node.left);              &#125;              // åªæœ‰åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰ä¼šè¿›è¿™ä¸ªelse          &#125; else &#123;              // é‡åˆ°ç©ºèŠ‚ç‚¹ï¼Œè¯´æ˜åä¸€ä¸ªæ˜¯è¦å¤„ç†çš„èŠ‚ç‚¹ï¼Œå…ˆå¼¹å‡ºç©ºèŠ‚ç‚¹              stack.pop();                // å†æŠŠè¦å¤„ç†çš„èŠ‚ç‚¹å¼¹å‡ºå¹¶åŠ å…¥åˆ°åˆ—è¡¨ä¸­              node = stack.peek();              stack.pop();              list.add(node.val);          &#125;      &#125;      return list;  &#125;\nçœ‹è§£æ\nâ—é€’å½’çš„ä¸‰è¦ç´ \næ–‡ç« è®²è§£ï¼š(https://programmercarl.com/äºŒå‰æ ‘çš„é€’å½’éå†.html)\n\n\nç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ï¼šÂ ç¡®å®šå“ªäº›å‚æ•°æ˜¯é€’å½’çš„è¿‡ç¨‹ä¸­éœ€è¦å¤„ç†çš„ï¼Œé‚£ä¹ˆå°±åœ¨é€’å½’å‡½æ•°é‡ŒåŠ ä¸Šè¿™ä¸ªå‚æ•°ï¼Œ å¹¶ä¸”è¿˜è¦æ˜ç¡®æ¯æ¬¡é€’å½’çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆè¿›è€Œç¡®å®šé€’å½’å‡½æ•°çš„è¿”å›ç±»å‹ã€‚\n\n\nç¡®å®šç»ˆæ­¢æ¡ä»¶ï¼šÂ å†™å®Œäº†é€’å½’ç®—æ³•, è¿è¡Œçš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°æ ˆæº¢å‡ºçš„é”™è¯¯ï¼Œå°±æ˜¯æ²¡å†™ç»ˆæ­¢æ¡ä»¶æˆ–è€…ç»ˆæ­¢æ¡ä»¶å†™çš„ä¸å¯¹ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿæ˜¯ç”¨ä¸€ä¸ªæ ˆçš„ç»“æ„æ¥ä¿å­˜æ¯ä¸€å±‚é€’å½’çš„ä¿¡æ¯ï¼Œå¦‚æœé€’å½’æ²¡æœ‰ç»ˆæ­¢ï¼Œæ“ä½œç³»ç»Ÿçš„å†…å­˜æ ˆå¿…ç„¶å°±ä¼šæº¢å‡ºã€‚\n\n\nç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘ï¼šÂ ç¡®å®šæ¯ä¸€å±‚é€’å½’éœ€è¦å¤„ç†çš„ä¿¡æ¯ã€‚åœ¨è¿™é‡Œä¹Ÿå°±ä¼šé‡å¤è°ƒç”¨è‡ªå·±æ¥å®ç°é€’å½’çš„è¿‡ç¨‹ã€‚\n\n\nè¿­ä»£æ³•\né€’å½’çš„å®ç°å°±æ˜¯ï¼šæ¯ä¸€æ¬¡é€’å½’è°ƒç”¨éƒ½ä¼šæŠŠå‡½æ•°çš„å±€éƒ¨å˜é‡ã€å‚æ•°å€¼å’Œè¿”å›åœ°å€ç­‰å‹å…¥è°ƒç”¨æ ˆä¸­æ‰€ä»¥æ‰€æœ‰é€’å½’çš„é¢˜ç›®ï¼Œç†è®ºä¸Šéƒ½å¯ä»¥ä½¿ç”¨æ ˆè§£å†³ã€‚\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/äºŒå‰æ ‘çš„è¿­ä»£éå†.html)\nç»Ÿä¸€è¿­ä»£\nè¿­ä»£æ³•å®ç°çš„å…ˆä¸­ååºï¼Œå…¶å®é£æ ¼ä¹Ÿä¸æ˜¯é‚£ä¹ˆç»Ÿä¸€ï¼Œé™¤äº†å…ˆåºå’Œååºï¼Œæœ‰å…³è”ï¼Œä¸­åºå®Œå…¨å°±æ˜¯å¦ä¸€ä¸ªé£æ ¼äº†ï¼Œä¸€ä¼šç”¨æ ˆéå†ï¼Œä¸€ä¼šåˆç”¨æŒ‡é’ˆæ¥éå†ã€‚\nåœ¨è¿­ä»£æ³•çš„ä¸­åºéå†ä¸­æåˆ°è¯´ä½¿ç”¨æ ˆçš„è¯ï¼Œæ— æ³•åŒæ—¶è§£å†³è®¿é—®èŠ‚ç‚¹ï¼ˆéå†èŠ‚ç‚¹ï¼‰å’Œå¤„ç†èŠ‚ç‚¹ï¼ˆå°†å…ƒç´ æ”¾è¿›ç»“æœé›†ï¼‰ä¸ä¸€è‡´çš„æƒ…å†µã€‚é‚£æˆ‘ä»¬å°±å°†è®¿é—®çš„èŠ‚ç‚¹æ”¾å…¥æ ˆä¸­ï¼ŒæŠŠè¦å¤„ç†çš„èŠ‚ç‚¹ä¹Ÿæ”¾å…¥æ ˆä¸­ä½†æ˜¯è¦åšæ ‡è®°ã€‚å°±æ˜¯è¦å¤„ç†çš„èŠ‚ç‚¹æ”¾å…¥æ ˆä¹‹åï¼Œç´§æ¥ç€æ”¾å…¥ä¸€ä¸ªç©ºæŒ‡é’ˆä½œä¸ºæ ‡è®°ã€‚Â è¿™ç§æ–¹æ³•ä¹Ÿå¯ä»¥å«åšæ ‡è®°æ³•ã€‚\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/äºŒå‰æ ‘çš„ç»Ÿä¸€è¿­ä»£æ³•.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["äºŒå‰æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åä¸‰å¤©-å±‚åºéå†ã€226ç¿»è½¬äºŒå‰æ ‘ã€101å¯¹ç§°äºŒå‰æ ‘","url":"/posts/b6d70614/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šå±‚åºéå†ç›´æ¥çœ‹è§£æã€‚226ã€101 çœ‹äº†éƒ¨åˆ†è§£æã€‚å¯ä»¥å®Œæˆé€’å½’æ³•ã€‚\n\n\næ›´æ–°\n\n\n24.06.03 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n102 äºŒå‰æ ‘çš„å±‚åºéå†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/binary-tree-level-order-traversal/description/)\npublic List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) &#123;      ArrayList&lt;List&lt;Integer&gt;&gt; resultList = new ArrayList&lt;&gt;();      levelOrderDFS(root, 0, resultList);      levelOrderBFS(root, resultList);      return resultList;  &#125;    /**   * è¿­ä»£æ³•å®ç°å±‚åºéå†ï¼ˆå¹¿åº¦ä¼˜å…ˆï¼‰   * @param root æ ¹èŠ‚ç‚¹   * @param resultList è¿”å›çš„list   */private void levelOrderBFS(TreeNode root, ArrayList&lt;List&lt;Integer&gt;&gt; resultList) &#123;      if (root == null) &#123;          return;      &#125;        Queue&lt;TreeNode&gt; queue = new LinkedList&lt;&gt;();      queue.offer(root);      while (!queue.isEmpty()) &#123;          ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();          int size = queue.size();            // éå†å½“å‰å±‚æ‰€æœ‰èŠ‚ç‚¹          while (size &gt; 0) &#123;              TreeNode node = queue.poll();              list.add(node.val);                // æŠŠè¿™å±‚æ‰€æœ‰çš„å·¦èŠ‚ç‚¹åŠ å…¥              if (node.left != null) &#123;                  queue.offer(node.left);              &#125;              // æŠŠè¿™å±‚æ‰€æœ‰çš„å³èŠ‚ç‚¹åŠ å…¥              if (node.right != null) &#123;                  queue.offer(node.right);              &#125;              size--;          &#125;          resultList.add(list);      &#125;  &#125;    /**   * é€’å½’æ–¹å¼å®ç°å±‚åºéå†(æ·±åº¦ä¼˜å…ˆ)   * @param root æ ¹èŠ‚ç‚¹   * @param i å±‚æ•°   * @param resultList éå†ç»“æœ   */  private void levelOrderDFS(TreeNode root, int i, ArrayList&lt;List&lt;Integer&gt;&gt; resultList) &#123;      if (root == null) &#123;          return;      &#125;        i++;        // å¦‚æœå°äºï¼Œè¯´æ˜ç¬¬ä¸€æ¬¡è¿›è¿™å±‚ï¼Œéœ€è¦åˆå§‹åŒ–è¿™ä¸ªä½ç½®çš„list      if (resultList.size() &lt; i) &#123;          ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();          resultList.add(list);      &#125;      resultList.get(i - 1).add(root.val);        levelOrderDFS(root.left, i, resultList);      levelOrderDFS(root.right, i, resultList);  &#125;\n226 ç¿»è½¬äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/invert-binary-tree/description/)\nçœ‹äº†ä¸€éƒ¨åˆ†çš„é¢˜ç›®è§£æï¼Œçªç„¶ååº”è¿‡æ¥ tree ä¸ç”¨è‡ªå·±æ„å»ºï¼Œç›´æ¥ç”¨æ–¹æ³•ç®€å•å¾ˆå¤šã€‚\n/**   * DFSé€’å½’   * @param root æ ¹èŠ‚ç‚¹   * @return ç¿»è½¬ç»“æœ   */  public TreeNode invertTree(TreeNode root) &#123;      invertTreePreorder(root);      return root;  &#125;    private void invertTreePreorder(TreeNode root) &#123;      if (root == null) &#123;          return;      &#125;      TreeNode temp = new TreeNode();      // æŒ‡é’ˆäº¤æ¢      temp = root.left;      root.left = root.right;      root.right = temp;        if (root.left != null) &#123;          invertTreePreorder(root.left);      &#125;      if (root.right != null) &#123;          invertTreePreorder(root.right);      &#125;  &#125;\n101 å¯¹ç§°äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/symmetric-tree/description/)\n/**   * è¿™é¢˜å’Œç¿»è½¬æ”¾åœ¨ä¸€èµ·   * ç¬¬ä¸€æ€è·¯å°±æ˜¯ç¿»è½¬ä¹‹åæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰(ä½†æ˜¯æ˜¯æŒ‡é’ˆå¼•ç”¨ï¼Œç¿»è½¬ä¹‹åæ˜¯ä¸èƒ½è¿›è¡Œæ¯”è¾ƒçš„)   * çœ‹äº†éƒ¨åˆ†è®²è§£ï¼Œè¯´æ˜¯æŠŠå·¦å­ï¼Œå³å­æ‹†åˆ†æˆä¸¤æ£µæ ‘æ¥çœ‹.   * å¯ä»¥æ‹†åˆ†ä¹‹åç¿»è½¬ä¸€æ£µæ ‘ï¼Œç„¶åæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚   *   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public static boolean isSymmetric(TreeNode root) &#123;      if (root == null) &#123;          return true;      &#125;      TreeNode right = root.right;      TreeNode left = root.left;        // å·¦å­æ ‘ç¿»è½¬      invertTreePreorder(left);      return isEqual(right, left);  &#125;    private static boolean isEqual(TreeNode right, TreeNode left) &#123;      if (right == null &amp;&amp; left == null) &#123;          return true;      &#125;      if ((right == null &amp;&amp; left != null) || (right != null &amp;&amp; left == null)) &#123;          return false;      &#125;      if (right.val != left.val) &#123;          return false;      &#125;        return isEqual(right.right, left.right) &amp;&amp; isEqual(right.left, left.left);  &#125;    private static void invertTreePreorder(TreeNode root) &#123;      if (root == null) &#123;          return;      &#125;      TreeNode temp;      // æŒ‡é’ˆäº¤æ¢      temp = root.left;      root.left = root.right;      root.right = temp;        if (root.left != null) &#123;          invertTreePreorder(root.left);      &#125;      if (root.right != null) &#123;          invertTreePreorder(root.right);      &#125;  &#125;\nçœ‹è§£æ\n102 äºŒå‰æ ‘çš„å±‚åºéå†\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0102.äºŒå‰æ ‘çš„å±‚åºéå†.html)\nå±‚åºéå†ä¸€ä¸ªäºŒå‰æ ‘ã€‚éœ€è¦å€Ÿç”¨ä¸€ä¸ªè¾…åŠ©æ•°æ®ç»“æ„å³é˜Ÿåˆ—æ¥å®ç°ï¼Œé˜Ÿåˆ—å…ˆè¿›å…ˆå‡ºï¼Œç¬¦åˆä¸€å±‚ä¸€å±‚éå†çš„é€»è¾‘ï¼Œè€Œç”¨æ ˆå…ˆè¿›åå‡ºé€‚åˆæ¨¡æ‹Ÿæ·±åº¦ä¼˜å…ˆéå†ä¹Ÿå°±æ˜¯é€’å½’çš„é€»è¾‘ã€‚\nè€Œè¿™ç§å±‚åºéå†æ–¹å¼å°±æ˜¯å›¾è®ºä¸­çš„å¹¿åº¦ä¼˜å…ˆéå†ï¼Œåªä¸è¿‡æˆ‘ä»¬åº”ç”¨åœ¨äºŒå‰æ ‘ä¸Šã€‚\n226 ç¿»è½¬äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0226.ç¿»è½¬äºŒå‰æ ‘.html)\né€’å½’çš„ä¸­åºéå†æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºä½¿ç”¨é€’å½’çš„ä¸­åºéå†ï¼ŒæŸäº›èŠ‚ç‚¹çš„å·¦å³å­©å­ä¼šç¿»è½¬ä¸¤æ¬¡ã€‚\n101 å¯¹ç§°äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0101.å¯¹ç§°äºŒå‰æ ‘.html)\næœ¬é¢˜éå†åªèƒ½æ˜¯â€œååºéå†â€ï¼Œå› ä¸ºæˆ‘ä»¬è¦é€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›å€¼æ¥åˆ¤æ–­ä¸¤ä¸ªå­æ ‘çš„å†…ä¾§èŠ‚ç‚¹å’Œå¤–ä¾§èŠ‚ç‚¹æ˜¯å¦ç›¸ç­‰ã€‚\næ­£æ˜¯å› ä¸ºè¦éå†ä¸¤æ£µæ ‘è€Œä¸”è¦æ¯”è¾ƒå†…ä¾§å’Œå¤–ä¾§èŠ‚ç‚¹ï¼Œæ‰€ä»¥å‡†ç¡®çš„æ¥è¯´æ˜¯ä¸€ä¸ªæ ‘çš„éå†é¡ºåºæ˜¯å·¦å³ä¸­ï¼Œä¸€ä¸ªæ ‘çš„éå†é¡ºåºæ˜¯å³å·¦ä¸­ã€‚\n/**    * çœ‹å®Œè§£æåçš„æ€è·¯ï¼Œä¸ç”¨ç¿»è½¬ç›´æ¥æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰   *   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */public static boolean isSymmetric(TreeNode root) &#123;      if (root == null) &#123;          return true;      &#125;      TreeNode right = root.right;      TreeNode left = root.left;        return compare(right, left);  &#125;    private static boolean compare(TreeNode right, TreeNode left) &#123;      if (right == null &amp;&amp; left == null) &#123;          return true;      &#125;      if ((right == null &amp;&amp; left != null) || (right != null &amp;&amp; left == null)) &#123;          return false;      &#125;      if (right.val != left.val) &#123;          return false;      &#125;        return compare(right.right, left.left) &amp;&amp; compare(right.left, left.right);  &#125;\n    /**     * è¿­ä»£æ³•     * ä½¿ç”¨åŒç«¯é˜Ÿåˆ—ï¼Œç›¸å½“äºä¸¤ä¸ªæ ˆ     */    public boolean isSymmetric2(TreeNode root) &#123;        Deque&lt;TreeNode&gt; deque = new LinkedList&lt;&gt;();        deque.offerFirst(root.left);        deque.offerLast(root.right);        while (!deque.isEmpty()) &#123;            TreeNode leftNode = deque.pollFirst();            TreeNode rightNode = deque.pollLast();            if (leftNode == null &amp;&amp; rightNode == null) &#123;                continue;            &#125;//            if (leftNode == null &amp;&amp; rightNode != null) &#123;//                return false;//            &#125;//            if (leftNode != null &amp;&amp; rightNode == null) &#123;//                return false;//            &#125;//            if (leftNode.val != rightNode.val) &#123;//                return false;//            &#125;            // ä»¥ä¸Šä¸‰ä¸ªåˆ¤æ–­æ¡ä»¶åˆå¹¶            if (leftNode == null || rightNode == null || leftNode.val != rightNode.val) &#123;                return false;            &#125;            deque.offerFirst(leftNode.left);            deque.offerFirst(leftNode.right);            deque.offerLast(rightNode.right);            deque.offerLast(rightNode.left);        &#125;        return true;    &#125;    /**     * è¿­ä»£æ³•     * ä½¿ç”¨æ™®é€šé˜Ÿåˆ—     */    public boolean isSymmetric3(TreeNode root) &#123;        Queue&lt;TreeNode&gt; deque = new LinkedList&lt;&gt;();        deque.offer(root.left);        deque.offer(root.right);        while (!deque.isEmpty()) &#123;            TreeNode leftNode = deque.poll();            TreeNode rightNode = deque.poll();            if (leftNode == null &amp;&amp; rightNode == null) &#123;                continue;            &#125;//            if (leftNode == null &amp;&amp; rightNode != null) &#123;//                return false;//            &#125;//            if (leftNode != null &amp;&amp; rightNode == null) &#123;//                return false;//            &#125;//            if (leftNode.val != rightNode.val) &#123;//                return false;//            &#125;            // ä»¥ä¸Šä¸‰ä¸ªåˆ¤æ–­æ¡ä»¶åˆå¹¶            if (leftNode == null || rightNode == null || leftNode.val != rightNode.val) &#123;                return false;            &#125;            // è¿™é‡Œé¡ºåºä¸ä½¿ç”¨Dequeä¸åŒ            deque.offer(leftNode.left);            deque.offer(rightNode.right);            deque.offer(leftNode.right);            deque.offer(rightNode.left);        &#125;        return true;    &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["äºŒå‰æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åå››å¤©-104äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ã€111äºŒå‰æ ‘çš„æœ€å°æ·±åº¦ã€222å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°","url":"/posts/39075b30/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š104ã€111 å¯ä»¥ ACï¼Œ222 æ²¡æœ‰æ€è·¯\n\n\næ›´æ–°\n\n\n24.06.04 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n104 äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/maximum-depth-of-binary-tree/description/)\n/**   * æ€è·¯ï¼šé€’å½’è®¡ç®—å·¦å³å­æ ‘çš„æ·±åº¦ã€‚å–è¾ƒå¤§å€¼   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public int maxDepth(TreeNode root) &#123;      if (root == null) &#123;          return 0;      &#125;      int leftLength = maxDepth(root.left);      int rightLength = maxDepth(root.right);      return 1 + Math.max(leftLength, rightLength);  &#125;\n111 äºŒå‰æ ‘çš„æœ€å°æ·±åº¦\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/minimum-depth-of-binary-tree/description/)\n/**   * æ€è·¯ï¼š   * é€’å½’ç»ˆæ­¢æ¡ä»¶   * 1.æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œç›´æ¥è¿”å›0   * 2.æ ¹èŠ‚ç‚¹çš„å·¦å³èŠ‚ç‚¹æœ‰ä¸€ä¸ªä¸ºç©ºï¼Œè¿”å›å¦ä¸€ä¸ªèŠ‚ç‚¹çš„æœ€å°æ·±åº¦   *   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public int minDepth(TreeNode root) &#123;      if (root == null) &#123;          return 0;      &#125;        if (root.right == null) &#123;          return 1 + minDepth(root.left);      &#125;      if (root.left == null) &#123;          return 1 + minDepth(root.right);      &#125;        return 1 + Math.min(minDepth(root.right), minDepth(root.left));  &#125;\n222 å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°\né¢˜ç›®é“¾æ¥:(https://leetcode.cn/problems/count-complete-tree-nodes/description/)\næ²¡æœ‰ ACï¼Œæ€è·¯åªæœ‰ä¸€åŠã€‚æ ¹æ®é¢˜è§£ï¼šé€’å½’åˆ°æŸä¸€æ·±åº¦ä¸€å®šä¼šæœ‰å·¦å­©å­æˆ–è€…å³å­©å­ä¸ºæ»¡äºŒå‰æ ‘ï¼Œç„¶åæŒ‰æ»¡äºŒå‰æ ‘çš„æƒ…å†µæ¥ç®—ã€‚\n// é”™è¯¯è§£æ³•ï¼Œæ­£ç¡®è§£æ³•åœ¨çœ‹è§£æéƒ¨åˆ†ã€‚/**   * æ€è·¯ï¼šæ—¢ç„¶æ˜¯å®Œå…¨äºŒå‰æ ‘ã€‚æ·±åº¦å¯ä»¥å¾ˆç®€å•çš„æ±‚å‡ºæ¥   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public int countNodes(TreeNode root) &#123;      int depth = getDepth(root);      // n - 1 å±‚çš„èŠ‚ç‚¹æ•°é‡      int num = (depth - 1) ^ 2 - 1;  &#125;      /**   * æ±‚å®Œå…¨äºŒå‰æ ‘çš„æ·±åº¦   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  private int getDepth(TreeNode root) &#123;      int depth = 0;      while (root != null) &#123;          depth++;          root = root.left;      &#125;      return depth;  &#125;\nçœ‹è§£æ\n104 äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0104.äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦.html)\næœ¬é¢˜å¯ä»¥ä½¿ç”¨å‰åºï¼ˆä¸­å·¦å³ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ååºéå†ï¼ˆå·¦å³ä¸­ï¼‰ï¼Œä½¿ç”¨å‰åºæ±‚çš„å°±æ˜¯æ·±åº¦ï¼Œä½¿ç”¨ååºæ±‚çš„æ˜¯é«˜åº¦ã€‚\n\n\näºŒå‰æ ‘èŠ‚ç‚¹çš„æ·±åº¦ï¼šæŒ‡ä»æ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹çš„æœ€é•¿ç®€å•è·¯å¾„è¾¹çš„æ¡æ•°æˆ–è€…èŠ‚ç‚¹æ•°ï¼ˆå–å†³äºæ·±åº¦ä» 0 å¼€å§‹è¿˜æ˜¯ä» 1 å¼€å§‹ï¼‰\n\n\näºŒå‰æ ‘èŠ‚ç‚¹çš„é«˜åº¦ï¼šæŒ‡ä»è¯¥èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„æœ€é•¿ç®€å•è·¯å¾„è¾¹çš„æ¡æ•°æˆ–è€…èŠ‚ç‚¹æ•°ï¼ˆå–å†³äºé«˜åº¦ä» 0 å¼€å§‹è¿˜æ˜¯ä» 1 å¼€å§‹ï¼‰\næ ¹èŠ‚ç‚¹çš„é«˜åº¦å°±æ˜¯äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ã€‚\n\n\n559. N å‰æ ‘çš„æœ€å¤§æ·±åº¦\né¢˜ç›®é“¾æ¥ (https://leetcode.cn/problems/maximum-depth-of-n-ary-tree/)\npublic int maxDepth(Node root) &#123;      if (root == null) &#123;          return 0;      &#125;        int max = 0;      for (Node child : root.children) &#123;          max = Math.max(maxDepth(child), max);      &#125;      return 1 + max;  &#125;\n111 äºŒå‰æ ‘çš„æœ€å°æ·±åº¦\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0111.äºŒå‰æ ‘çš„æœ€å°æ·±åº¦.html)\næœ€å°æ·±åº¦æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°æœ€è¿‘å¶å­èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ•°é‡ã€‚ æ³¨æ„æ˜¯å¶å­èŠ‚ç‚¹ã€‚ï¼ˆå·¦å³å­©å­éƒ½ä¸ºç©ºçš„èŠ‚ç‚¹æ‰æ˜¯å¶å­èŠ‚ç‚¹ï¼‰\n222 å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0222.å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°.html)\né€’å½’åˆ°æŸä¸€æ·±åº¦ä¸€å®šä¼šæœ‰å·¦å­©å­æˆ–è€…å³å­©å­ä¸ºæ»¡äºŒå‰æ ‘ï¼Œç„¶åæŒ‰æ»¡äºŒå‰æ ‘çš„æƒ…å†µæ¥ç®—ã€‚æ‰€ä»¥éœ€è¦åˆ¤æ–­æ˜¯å¦æ˜¯æ»¡äºŒå‰æ ‘\n/**   * å®Œå…¨äºŒå‰æ ‘æ±‚èŠ‚ç‚¹   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public int countNodes(TreeNode root) &#123;      if (root == null) &#123;          return 0;      &#125;        TreeNode left = root.left;      TreeNode right = root.right;        int leftLength = 0, rightLength = 0;      while (left != null) &#123;          left = left.left;          leftLength++;      &#125;      while (right != null) &#123;          right = right.right;          rightLength++;      &#125;      if (leftLength == rightLength) &#123;          return (2 &lt;&lt; leftLength) - 1;      &#125;      return countNodes(root.left) + countNodes(root.right) + 1;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["äºŒå‰æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åäº”å¤©-110å¹³è¡¡äºŒå‰æ ‘ ã€257äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„ã€404å·¦å¶å­ä¹‹å’Œ","url":"/posts/eb9bb750/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š110ï¼Œ404ACï¼Œ257 ä¸ä¼šã€‚è¿­ä»£æ³•æ²¡æœ‰å†™\n\n\næ›´æ–°\n\n\n24.06.06 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n110 å¹³è¡¡äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/balanced-binary-tree/)\npublic class LE110 &#123;      public boolean isBalanced(TreeNode root) &#123;          return getHeight(root) != -1;      &#125;        private int getHeight(TreeNode root) &#123;          if (root == null) &#123;              return 0;          &#125;            int leftHeight = getHeight(root.left);          if (leftHeight == -1) &#123;              return -1;          &#125;          int rightHeight = getHeight(root.right);          if (rightHeight == -1) &#123;              return -1;          &#125;            if (Math.abs(leftHeight - rightHeight) &gt; 1) &#123;              return -1;          &#125;          return 1 + Math.max(leftHeight, rightHeight);      &#125;  &#125;\n257 äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/binary-tree-paths/description/)\n(ä¸ä¼š)\n404 å·¦å¶å­ä¹‹å’Œ\npublic int sumOfLeftLeaves(TreeNode root) &#123;      if (root == null) &#123;          return 0;      &#125;        int sum = 0;      if (root.left != null &amp;&amp; root.left.left == null &amp;&amp; root.left.right == null) &#123;          sum += root.left.val;      &#125;      return sum + sumOfLeftLeaves(root.left) + sumOfLeftLeaves(root.right);  &#125;\nçœ‹è§£æ\n110 å¹³è¡¡äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0110.å¹³è¡¡äºŒå‰æ ‘.html)\nåˆ†åˆ«æ±‚å‡ºå…¶å·¦å³å­æ ‘çš„é«˜åº¦ï¼Œç„¶åå¦‚æœå·®å€¼å°äºç­‰äº 1ï¼Œåˆ™è¿”å›å½“å‰äºŒå‰æ ‘çš„é«˜åº¦ï¼Œå¦åˆ™è¿”å› -1ï¼Œè¡¨ç¤ºå·²ç»ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘äº†ã€‚\n257 äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0257.äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„.html)\nä¸»è¦æ˜¯è¿™ä¸ªå›æº¯æœ‰ç‚¹æ‡µï¼Œä¸çŸ¥é“æ€ä¹ˆå†™äº†ã€‚ä½†æ˜¯å†™å®Œä»£ç è·Ÿç€æ–­ç‚¹è·‘ä¸€éï¼Œå¯ä»¥çœ‹åˆ°ï¼šåœ¨æœ‰ä¸‹ä¸ªèŠ‚ç‚¹æ—¶ï¼Œä¼šä¸€ç›´é€’å½’ï¼Œç›´åˆ°è¿›å…¥åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ã€‚åœ¨è¿”å›çš„é€”ä¸­ï¼Œä¼šæŠŠæ‰€æœ‰çš„è¿›å…¥æ“ä½œï¼Œå›é€€å›å»ï¼ˆå³å›é€€åˆ°äº¤å‰èŠ‚ç‚¹é‚£ä¸ªä½ç½®ï¼‰ã€‚å¯èƒ½è¡¨è¿°çš„ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå†™å®Œä»£ç è·‘ä¸€éå°±æ¸…æ¥šäº†ã€‚\npublic static List&lt;String&gt; binaryTreePaths(TreeNode root) &#123;      List&lt;String&gt; pathString = new ArrayList&lt;&gt;();      if (root == null) &#123;          return pathString;      &#125;      List&lt;Integer&gt; path = new ArrayList&lt;&gt;();      binaryTree(root, path, pathString);      return pathString;  &#125;    private static void binaryTree(TreeNode root, List&lt;Integer&gt; path, List&lt;String&gt; pathString) &#123;     path.add(root.val);        if (root != null &amp;&amp; (root.right == null &amp;&amp; root.left == null)) &#123;          pathString.add(path.stream().map(Object::toString).collect(Collectors.joining(&quot;-&gt;&quot;)));          return;      &#125;        if (root.left != null) &#123;          binaryTree(root.left, path, pathString);          path.remove(path.size() - 1);      &#125;      if (root.right != null) &#123;          binaryTree(root.right, path, pathString);          path.remove(path.size() - 1);      &#125;  &#125;\n404 å·¦å¶å­ä¹‹å’Œ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0404.å·¦å¶å­ä¹‹å’Œ.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["äºŒå‰æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åå…­å¤©-513æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼ã€112è·¯å¾„æ€»å’Œã€113è·¯å¾„æ€»å’Œiiã€106ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ã€105ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘","url":"/posts/2305b4a/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š513 ç”¨å±‚åº ACã€112ACï¼ˆä½†æ—¶é—´å¤æ‚åº¦è¾ƒé«˜ï¼‰ï¼‰ï¼ˆè§£æä¸­ç»™çš„æ–¹æ³•å’Œæƒ³çš„ä¸ä¸€æ ·ï¼‰ï¼Œ113ACã€106 ä¸ä¼š\n\n\næ›´æ–°\n\n\n24.06.07 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n513 æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/find-bottom-left-tree-value)\n/**   * çœ‹é¢˜ç›®æ„Ÿè§‰å±‚åºéå†ç®€å•ä¸€ç‚¹   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public int findBottomLeftValue(TreeNode root) &#123;      List&lt;List&lt;Integer&gt;&gt; list = new ArrayList&lt;&gt;();      findBottomDFS(root, 0, list);      List&lt;Integer&gt; theLastLayer = list.get(list.size() - 1);      return theLastLayer.stream().filter(Objects::nonNull).collect(Collectors.toList()).get(0);  &#125;    private void findBottomDFS(TreeNode root, int i, List&lt;List&lt;Integer&gt;&gt; list) &#123;      if (root == null) &#123;          return;      &#125;        // æ·±åº¦å¢åŠ       i++;        if (list.size() &lt; i) &#123;          ArrayList&lt;Integer&gt; innerList = new ArrayList&lt;&gt;();          list.add(innerList);      &#125;      list.get(i - 1).add(root.val);        findBottomDFS(root.left, i, list);      findBottomDFS(root.right, i, list);  &#125;\n112 è·¯å¾„æ€»å’Œã€113 è·¯å¾„æ€»å’Œ ii\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/path-sum/description/)\n/**   * æ„Ÿè§‰ä¹‹å‰åšè¿‡æ±‚è·¯å¾„çš„é¢˜ï¼ˆé€’å½’+è¿­ä»£ï¼‰è¿™é¢˜åº”è¯¥å˜æ¢ä¸€ä¸‹   * æ—¶é—´å¤æ‚åº¦å¥½åƒæœ‰ç‚¹é«˜ï¼Œå‰©ä¸‹é‚£é¢˜ç­‰çœ‹å®Œè§£æåå†å†™ * åé¢æ”¹ç”¨sumç›´æ¥åŠ å‡ä¸éå†æ±‚æ€»å’Œï¼Œä½†æ˜¯leetcodeä¸é€šè¿‡ï¼Œæœ¬åœ°å€’æ˜¯æµ‹è¯•æ²¡é—®é¢˜ * @param root æ ¹èŠ‚ç‚¹   * @param targetSum ç›®æ ‡å’Œ   * @return ç»“æœ   */  public boolean hasPathSum(TreeNode root, int targetSum) &#123;      if (root == null) &#123;          return false;      &#125;      List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;();      return hasPathSumBFS(root, list, targetSum);  &#125;    private boolean hasPathSumBFS(TreeNode root, List&lt;Integer&gt; list, int targetSum) &#123;      list.add(root.val);        if (root.left == null &amp;&amp; root.right == null) &#123;          // æ±‚listä¸­çš„æ€»å’Œ          long sum = list.stream().collect(Collectors.summarizingInt(value -&gt; value)).getSum();          return sum == targetSum;      &#125;        boolean left = false;      boolean right = false;      if (root.left != null) &#123;          left = hasPathSumBFS(root.left, list, targetSum);          list.remove(list.size() - 1);      &#125;      if (root.right != null) &#123;          right = hasPathSumBFS(root.right, list, targetSum);          list.remove(list.size() - 1);      &#125;            return left || right;  &#125;\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/path-sum-ii/)\npublic static List&lt;List&lt;Integer&gt;&gt; pathSum(TreeNode root, int targetSum) &#123;      List&lt;Integer&gt; list = new ArrayList&lt;&gt;();      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      pathSumBFS(root, targetSum, result, list);      return result;  &#125;    private static void pathSumBFS(TreeNode root, int targetSum, List&lt;List&lt;Integer&gt;&gt; result, List&lt;Integer&gt; list) &#123;      if (root == null) &#123;          return;      &#125;        targetSum -= root.val;      list.add(root.val);        if (root.left == null &amp;&amp; root.right == null) &#123;          if (targetSum == 0) &#123;              List&lt;Integer&gt; arrayList = new ArrayList&lt;&gt;(list);              result.add(arrayList);          &#125;      &#125;        if (root.left != null) &#123;          pathSumBFS(root.left, targetSum, result, list);          list.remove(list.size() - 1);      &#125;      if (root.right != null) &#123;          pathSumBFS(root.right, targetSum, result, list);          list.remove(list.size() - 1);      &#125;  &#125;\n106 ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ã€105 ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/construct-binary-tree-from-inorder-and-postorder-traversal/description/)\nä¸ä¼šï¼Œç›´æ¥çœ‹è§£æ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-inorder-traversal/)\næ›´å¿«çš„è§£æ³•æ˜¯æŠŠ inorder æ”¾åˆ° map å†…ï¼Œè¿™æ ·æŸ¥æ‰¾ä¸ç”¨éå†ã€‚\npublic static TreeNode buildTree(int[] preorder, int[] inorder) &#123;      if (preorder.length == 0) &#123;          return null;      &#125;      TreeNode root = new TreeNode(preorder[0]);      if (preorder.length == 1) &#123;          return root;      &#125;        int indexIn = -1;      for (int i = 0; i &lt; inorder.length; i++) &#123;          if (inorder[i] == preorder[0]) &#123;              indexIn = i;              break;          &#125;      &#125;      // å·¦å­æ ‘      int[] leftTreeInorder = Arrays.copyOfRange(inorder, 0, indexIn);      // å³å­æ ‘      int[] rightTreeInorder = Arrays.copyOfRange(inorder, indexIn + 1, inorder.length);        root.left = buildTree(Arrays.copyOfRange(preorder, 1, leftTreeInorder.length + 1), leftTreeInorder);      root.right = buildTree(Arrays.copyOfRange(preorder, inorder.length - rightTreeInorder.length, inorder.length), rightTreeInorder);      return root;  &#125;\nçœ‹è§£æ\n513 æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0513.æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼.html)\né‚£ä¹ˆå¦‚ä½•æ‰¾æœ€å·¦è¾¹çš„å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨å‰åºéå†ï¼ˆå½“ç„¶ä¸­åºï¼Œååºéƒ½å¯ä»¥ï¼Œå› ä¸ºæœ¬é¢˜æ²¡æœ‰ ä¸­é—´èŠ‚ç‚¹çš„å¤„ç†é€»è¾‘ï¼Œåªè¦å·¦ä¼˜å…ˆå°±è¡Œï¼‰ï¼Œä¿è¯ä¼˜å…ˆå·¦è¾¹æœç´¢ï¼Œç„¶åè®°å½•æ·±åº¦æœ€å¤§çš„å¶å­èŠ‚ç‚¹ï¼Œæ­¤æ—¶å°±æ˜¯æ ‘çš„æœ€åä¸€è¡Œæœ€å·¦è¾¹çš„å€¼ã€‚\n// é€’å½’æ³•int value;  int maxDeep = Integer.MIN_VALUE;  public int findBottomLeftValueBFS(TreeNode root) &#123;      value = root.val;      findLeftValue(root,0);      return value;  &#125;    private void findLeftValue(TreeNode root, int deep) &#123;      if (root == null) &#123;          return;      &#125;      if (root.left == null &amp;&amp; root.right == null) &#123;          if (deep &gt; maxDeep) &#123;              value = root.val;              maxDeep = deep;          &#125;      &#125;        if (root.left != null) &#123;          findLeftValue(root.left, deep + 1);      &#125;      if (root.right != null) &#123;          findLeftValue(root.right, deep + 1);      &#125;  &#125;\n112 è·¯å¾„æ€»å’Œã€113 è·¯å¾„æ€»å’Œ ii\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0112.è·¯å¾„æ€»å’Œ.html)\nç»•æ™•äº†ï¼Œå¦‚æœæŠŠ targetSum -= root.val; è¿™å¥è¯å†™åœ¨å‡½æ•°æœ€å‰é¢ï¼Œå°±ä¸ç”¨å›æº¯ã€‚å¯ä»¥çœ‹ä¸‰è¡Œç®€åŒ–çš„é‚£ä¸ªæ³¨é‡Šã€‚æˆ‘ç†è§£çš„æ˜¯ Java é‡Œ int ä¸èƒ½ä¼ é€’å€¼ï¼Œé€’å½’å†…å±‚å¯¹ targetSum çš„å€¼è¿›è¡Œæ”¹å˜ï¼Œå¤–å±‚ä¸ä¼šå˜åŒ–ï¼Œæ‰€ä»¥å°±ä¸ç”¨å›æº¯äº†ã€‚\n// æ²¡ææ‡‚æ€ä¹ˆå°±ä¸ç”¨å›æº¯äº†ï¼Œå› ä¸ºintä¸èƒ½ä¼ å€¼å—ï¼Ÿ/**   * æ„Ÿè§‰ä¹‹å‰åšè¿‡æ±‚è·¯å¾„çš„é¢˜ï¼ˆé€’å½’+è¿­ä»£ï¼‰è¿™é¢˜åº”è¯¥å˜æ¢ä¸€ä¸‹   * @param root æ ¹èŠ‚ç‚¹   * @param targetSum ç›®æ ‡å’Œ   * @return ç»“æœ   */  public static boolean hasPathSum(TreeNode root, int targetSum) &#123;      if (root == null) &#123;          return false;      &#125;      targetSum -= root.val;      return hasPathSumBFS(root, targetSum);  &#125;    private static boolean hasPathSumBFS(TreeNode root, int targetSum) &#123;      if (root.left == null &amp;&amp; root.right == null) &#123;          // æ±‚listä¸­çš„æ€»å’Œ          return targetSum == 0;      &#125;        if (root.left != null) &#123;          targetSum -= root.left.val;          if (hasPathSumBFS(root.left, targetSum)) &#123;              return true;          &#125;          // è¿™é‡Œçš„å›æº¯å°±æ˜¯æŠŠå½“å‰èŠ‚ç‚¹å‡æ‰ï¼ˆæ•°å€¼åŠ ä¸Šï¼‰ã€‚åŒ…æ‹¬ä¹‹å‰ä¹Ÿæ˜¯ï¼Œä½†æ˜¯ä¹‹å‰æ˜¯listä¸å¤ªå¥½ç§»é™¤ï¼Œæ‰€ä»¥é€‰æ‹©ç§»é™¤æœ€åä¸€ä½        targetSum += root.left.val;      &#125;    \t/*\t// ä¸Šé¢ä¸‰è¡Œå¯ä»¥ç®€åŒ–æˆ  \tif (root.left != null) &#123;  \t    // è¿™é‡ŒtargetSumçš„å€¼æ˜¯æ²¡æœ‰å˜åŒ–çš„ã€‚å‡å®Œçš„å€¼è¿›å…¥å¾ªç¯ï¼Œå°±ä¸ç”¨å›æº¯äº†  \t    hasPathSumBFS(root.left, targetSum - root.left.val);  \t&#125;\t*/\t    if (root.right != null) &#123;          targetSum -= root.right.val;          if (hasPathSumBFS(root.right, targetSum)) &#123;              return true;          &#125;          targetSum += root.right.val;      &#125;        return false;  &#125;/**   * ç®€åŒ–ç‰ˆæœ¬   */  public static boolean hasPathSum(TreeNode root, int targetSum) &#123;      if (root == null) &#123;          return false;      &#125;        if (root.left == null &amp;&amp; root.right == null) &#123;          return targetSum == 0;      &#125;            return hasPathSum(root.left, targetSum - root.val) || hasPathSum(root.right, targetSum - root.val);  &#125;\n106 ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ã€105 ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0106.ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘.html)\næ›´å¿«çš„è§£æ³•æ˜¯æŠŠ inorder æ”¾åˆ° map å†…ï¼Œè¿™æ ·æŸ¥æ‰¾ä¸ç”¨éå†ã€‚\n/**   * 1.ååºæœ€åä¸€ä¸ªèŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹   * 2.æ ¹æ®è¿™ä¸ªèŠ‚ç‚¹åˆ‡å‰²ä¸­åºæ•°ç»„ï¼ˆèŠ‚ç‚¹å‰ä¸ºå·¦å­æ ‘ï¼ŒèŠ‚ç‚¹åä¸ºå³å­æ ‘ï¼‰   * 3.æ ¹æ®ä¸­åºæ•°ç»„çš„åˆ‡å‰²åˆ‡å‰²ååºæ•°ç»„   * 4.é€’å½’   * @param inorder ä¸­åºéå†ç»“æœ   * @param postorder ååºéå†ç»“æœ   * @return æ ‘   */  public static TreeNode buildTree(int[] inorder, int[] postorder) &#123;      if (inorder.length != postorder.length) &#123;          return null;      &#125;        if (postorder.length == 0) &#123;          return null;      &#125;      TreeNode root = new TreeNode(postorder[postorder.length - 1]);      if (postorder.length == 1) &#123;          return root;      &#125;        int indexIn = -1;      for (int i = 0; i &lt; inorder.length; i++) &#123;          if (inorder[i] == postorder[postorder.length - 1]) &#123;              indexIn = i;              break;          &#125;      &#125;      // å·¦å­æ ‘      int[] leftTreeInorder = Arrays.copyOfRange(inorder, 0, indexIn);      // å³å­æ ‘      int[] rightTreeInorder = Arrays.copyOfRange(inorder, indexIn + 1, inorder.length);        root.left = buildTree(leftTreeInorder, Arrays.copyOfRange(postorder, 0, leftTreeInorder.length));      root.right = buildTree(rightTreeInorder, Arrays.copyOfRange(postorder, leftTreeInorder.length, postorder.length - 1));      return root;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["äºŒå‰æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åä¸ƒå¤©-654æœ€å¤§äºŒå‰æ ‘ã€617åˆå¹¶äºŒå‰æ ‘ã€700äºŒå‰æœç´¢æ ‘ä¸­çš„æœç´¢ã€98éªŒè¯äºŒå‰æœç´¢æ ‘","url":"/posts/c463689e/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š654ACã€617AC å¯ä¼˜åŒ–ã€700ACã€98 ä¸ä¼š\n\n\næ›´æ–°\n\n\n24.06.07 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n654 æœ€å¤§äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/maximum-binary-tree/)\npublic static TreeNode constructMaximumBinaryTree(int[] nums) &#123;      if (nums.length == 0) &#123;          return null;      &#125;        int maxIndex = getMaxIndex(nums);      TreeNode root = new TreeNode(nums[maxIndex]);      if (nums.length == 1) &#123;          return root;      &#125;        root.left = constructMaximumBinaryTree(Arrays.copyOfRange(nums, 0, maxIndex));      root.right = constructMaximumBinaryTree(Arrays.copyOfRange(nums, maxIndex + 1, nums.length));      return root;  &#125;    private static int getMaxIndex(int[] nums) &#123;      int max = Integer.MIN_VALUE;      int maxIndex = -1;      for (int i = 0; i &lt; nums.length; i++) &#123;          if (nums[i] &gt; max) &#123;              maxIndex = i;              max = nums[i];          &#125;      &#125;      return maxIndex;  &#125;\n617 åˆå¹¶äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/merge-two-binary-trees/)\npublic TreeNode mergeTrees(TreeNode root1, TreeNode root2) &#123;      if (root1 == null &amp;&amp; root2 == null) &#123;          return null;      &#125;        int value1 = root1 == null ? 0 : root1.val;      int value2 = root2 == null ? 0 : root2.val;        TreeNode node = new TreeNode(value1 + value2);        if (root1 == null) &#123;          node.left = mergeTrees(null, root2.left);          node.right = mergeTrees(null, root2.right);      &#125; else if (root2 == null)&#123;          node.left = mergeTrees(root1.left, null);          node.right = mergeTrees(root1.right, null);      &#125; else &#123;          node.left = mergeTrees(root1.left, root2.left);          node.right = mergeTrees(root1.right, root2.right);      &#125;      return node;  &#125;\n700 äºŒå‰æœç´¢æ ‘ä¸­çš„æœç´¢\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/search-in-a-binary-search-tree)\n/**   * BFS  */public TreeNode searchBST(TreeNode root, int val) &#123;      if (root == null) &#123;          return null;      &#125;      if (val == root.val) &#123;          return root;      &#125; else if (val &lt; root.val) &#123;          return searchBST(root.left, val);      &#125; else &#123;          return searchBST(root.right, val);      &#125;  &#125;    /**   * DFS  */ public TreeNode searchBSTDFS(TreeNode root, int val) &#123;      while (root != null) &#123;          if (val == root.val) &#123;              return root;          &#125; else if (val &lt; root.val)&#123;              root = root.left;          &#125; else &#123;              root = root.right;          &#125;      &#125;      return null;  &#125;\n98 éªŒè¯äºŒå‰æœç´¢æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/validate-binary-search-tree/)\nåªæ¯”è¾ƒäº†å·¦èŠ‚ç‚¹å°äºä¸­é—´èŠ‚ç‚¹ï¼Œå³èŠ‚ç‚¹å¤§äºä¸­é—´èŠ‚ç‚¹ï¼Œå®é™…ä¸Šè¦åŠ ä¸Šå·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹å°äºä¸­é—´èŠ‚ç‚¹ï¼Œå³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹å¤§äºä¸­é—´èŠ‚ç‚¹\n// æ²¡æœ‰é€šè¿‡ï¼Œå°‘ç®—äº†ä¸€ç§æƒ…å†µpublic boolean isValidBST(TreeNode root) &#123;      if (root == null) &#123;          return true;      &#125;        // å·¦å­æ ‘ä¸ä¸ºç©ºå¹¶ä¸”å¤§äº      if (root.left != null &amp;&amp; root.left.val &gt;= root.val) &#123;          return false;          // å³å­æ ‘ä¸ä¸ºç©ºå¹¶ä¸”å°äº      &#125; else if (root.right != null &amp;&amp; root.right.val &lt;= root.val) &#123;          return false;      &#125;        return isValidBST(root.left) &amp;&amp; isValidBST(root.right);  &#125;\nçœ‹è§£æ\n654 æœ€å¤§äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0654.æœ€å¤§äºŒå‰æ ‘.html)\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1MG411G7ox\n617 åˆå¹¶äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0617.åˆå¹¶äºŒå‰æ ‘.html)\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1m14y1Y7JK\n// ä¼˜åŒ–åpublic TreeNode mergeTrees1(TreeNode root1, TreeNode root2) &#123;      if (root1 == null &amp;&amp; root2 != null) &#123;          return root2;      &#125; else if (root1 != null &amp;&amp; root2 == null) &#123;          return root1;      &#125; else if (root1 == null &amp;&amp; root2 == null) &#123;          return null;      &#125; else &#123;          TreeNode node = new TreeNode(root1.val + root2.val);          node.left = mergeTrees(root1.left, root2.left);          node.right = mergeTrees(root1.right, root2.right);          return node;      &#125;  &#125;\n700 äºŒå‰æœç´¢æ ‘ä¸­çš„æœç´¢\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0700.äºŒå‰æœç´¢æ ‘ä¸­çš„æœç´¢.html)\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1wG411g7sF\näºŒå‰æœç´¢æ ‘æ˜¯ä¸€ä¸ªæœ‰åºæ ‘ï¼š\n\n\nè‹¥å®ƒçš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›\n\n\nè‹¥å®ƒçš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›\n\n\nå®ƒçš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æœç´¢æ ‘\n\n\n98 éªŒè¯äºŒå‰æœç´¢æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0098.éªŒè¯äºŒå‰æœç´¢æ ‘.html)\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV18P411n7Q4\nå…³é”®åœ¨äºï¼šä¸­åºéå†ä¸‹ï¼Œè¾“å‡ºçš„äºŒå‰æœç´¢æ ‘èŠ‚ç‚¹çš„æ•°å€¼æ˜¯æœ‰åºåºåˆ—ã€‚\npublic boolean isValidBST(TreeNode root) &#123;      List&lt;Integer&gt; list = new ArrayList&lt;&gt;();      inorder(root, list);        if (list.size() &lt;= 1) &#123;          return true;      &#125;      for (int i = 0; i &lt; list.size() - 1; i++) &#123;          if (list.get(i) &gt;= list.get(i + 1)) &#123;              return false;          &#125;      &#125;      return true;  &#125;    private void inorder(TreeNode root, List&lt;Integer&gt; list) &#123;      if (root == null) &#123;          return;      &#125;      inorder(root.left, list);      list.add(root.val);      inorder(root.right, list);  &#125;    /**   * å•æ¬¡å¾ªç¯æå®š * åŒæŒ‡é’ˆæ³• */  TreeNode max;  public boolean isValidBST1(TreeNode root) &#123;      if (root == null) &#123;          return true;      &#125;      // å·¦      boolean left = isValidBST1(root.left);      if (!left) &#123;          return false;      &#125;      // ä¸­      if (max != null &amp;&amp; root.val &lt;= max.val) &#123;          return false;      &#125;      max = root;      // å³      return isValidBST1(root.right);  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŒæŒ‡é’ˆ","äºŒå‰æ ‘","äºŒå‰æœç´¢æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åå…«å¤©-530äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®ã€501äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°ã€236äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ","url":"/posts/47cc7c82/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š530 æš´åŠ›éå†ã€501 æš´åŠ›ã€236 ä¸ä¼šã€‚çœ‹äº†æ˜¨å¤©çš„é¢˜è§£æŠŠ 530 æ”¹æˆäº†åŒæŒ‡é’ˆã€‚\n\n\næ›´æ–°\n\n\n24.06.08 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n530 äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/minimum-absolute-difference-in-bst)\n// æš´åŠ›éå†public int getMinimumDifference(TreeNode root) &#123;      List&lt;Integer&gt; list = new ArrayList&lt;&gt;();      getMinDiff(root, list);      int min = Math.abs(list.get(0) - list.get(1));        for (int i = 2; i &lt; list.size(); i++) &#123;          min = Math.min(Math.abs(list.get(i) - list.get(i - 1)), min);      &#125;        return min;  &#125;    private void getMinDiff(TreeNode root, List&lt;Integer&gt; list) &#123;      if (root == null) &#123;          return;      &#125;        getMinDiff(root.left, list);      list.add(root.val);      getMinDiff(root.right, list);  &#125;// åé¢çœ‹äº†æ˜¨å¤©æœ€åä¸€é¢˜çš„é¢˜è§£ï¼Œè¿™é‡Œå¯ä»¥ç”¨åŒæŒ‡é’ˆ/**   * åŒæŒ‡é’ˆçš„è§£æ³•   * @param root æ ¹èŠ‚ç‚¹   */  Integer min = Integer.MAX_VALUE;  TreeNode pre;  public int getMinimumDifference1(TreeNode root) &#123;      if (root == null) &#123;          return min;      &#125;        getMinimumDifference1(root.left);        // ä¸­é—´éå†      if (pre != null) &#123;          min = Math.min(Math.abs(root.val - pre.val), min);      &#125;      pre = root;        getMinimumDifference1(root.right);        return min;  &#125;\n501 äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/find-mode-in-binary-search-tree)\npublic static int[] findMode(TreeNode root) &#123;      if (root == null) &#123;          return new int[]&#123;&#125;;      &#125;        Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();      find(root, map);      List&lt;Map.Entry&lt;Integer, Integer&gt;&gt; collect = map.entrySet().stream()              .sorted((o1, o2) -&gt; o2.getValue() - o1.getValue())              .collect(Collectors.toList());      List&lt;Integer&gt; list = new ArrayList&lt;&gt;();      list.add(collect.get(0).getKey());      for (int i = 1; i &lt; collect.size(); i++) &#123;          if (collect.get(i).getValue().equals(collect.get(0).getValue())) &#123;              list.add(collect.get(i).getKey());          &#125;      &#125;      return list.stream().mapToInt(i -&gt; i).toArray();  &#125;    private static void find(TreeNode root, Map&lt;Integer, Integer&gt; map) &#123;      if (root == null)&#123;          return;      &#125;        find(root.left, map);      map.put(root.val, map.getOrDefault(root.val, 0) + 1);      find(root.right, map);  &#125;\n236 äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-tree)\næ²¡æœ‰æ€è·¯ã€‚\nçœ‹è§£æ\n530 äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0530.%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E6%9C%80%E5%B0%8F%E7%BB%9D%E5%AF%B9%E5%B7%AE.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1DD4y11779\n501 äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0501.%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E4%B8%AD%E7%9A%84%E4%BC%97%E6%95%B0.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1fD4y117gp\n// åŒæŒ‡é’ˆçš„å‰ä¸€ä¸ªèŠ‚ç‚¹  TreeNode pre = null;  int count = 0;  int maxCount = 0;    /**   * åŒæŒ‡é’ˆè§£æ³•   * @param root æ ¹èŠ‚ç‚¹   * @return ç»“æœ   */  public int[] findMode(TreeNode root) &#123;      List&lt;Integer&gt; list = new ArrayList&lt;&gt;();        // é€’å½’é€»è¾‘      findModeTravel(root, list);        return list.stream().mapToInt(i -&gt; i).toArray();  &#125;    private void findModeTravel(TreeNode root, List&lt;Integer&gt; list) &#123;      if (root == null) &#123;          return;      &#125;        findModeTravel(root.left, list);        if (pre == null) &#123;          count = 1;      &#125;else if (pre.val == root.val)&#123;          count++;      &#125; else &#123;          count = 1;      &#125;      pre = root;        if (count == maxCount) &#123;          list.add(root.val);      &#125; else if (count &gt; maxCount) &#123;          maxCount = count;          list.clear();          list.add(root.val);      &#125;        findModeTravel(root.right, list);  &#125;\n236 äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0236.%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1jd4y1B7E2\npublic TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) &#123;      // return rootä¹Ÿæ˜¯ç©º å¯ä»¥å’Œä¸‹é¢ä¸€èµ·å†™      if (root == null) &#123;          return null;      &#125;      if (root == p || root == q) &#123;          return root;      &#125;        TreeNode left = lowestCommonAncestor(root.left, p, q);      TreeNode right = lowestCommonAncestor(root.right, p, q);        if (left!= null &amp;&amp; right != null) &#123;          return root;      &#125; else if (left != null &amp;&amp; right == null) &#123;          return left;      &#125; else if (right != null &amp;&amp; left == null) &#123;          return right;      &#125; else &#123;          return null;      &#125;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŒæŒ‡é’ˆ","äºŒå‰æ ‘","äºŒå‰æœç´¢æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåå¤©-669ä¿®å‰ªäºŒå‰æœç´¢æ ‘ã€108å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘ã€538æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘","url":"/posts/d99de55b/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š669 é€šè¿‡ï¼Œä½†æ˜¯æœ‰æ›´ç®€å•çš„æ–¹æ³•ã€‚108ACã€‚538 æ²¡æœ‰æ€è·¯ï¼Œçœ‹äº†è§£é¢˜æ€è·¯å†™å‡ºæ¥äº†ã€‚\n\n\næ›´æ–°\n\n\n24-06-09 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n669 ä¿®å‰ªäºŒå‰æœç´¢æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/trim-a-binary-search-tree)\n\t/**     * æ€è·¯ï¼šæŸ¥æ‰¾èŠ‚ç‚¹ï¼Œåˆ é™¤èŠ‚ç‚¹     *      * @param root æ ¹èŠ‚ç‚¹     * @param low  åŒºé—´å·¦èŒƒå›´     * @param high åŒºé—´å³èŒƒå›´     * @return     */    public static TreeNode trimBST(TreeNode root, int low, int high) &#123;        if (root == null) &#123;            return root;        &#125;        // å…ˆå‰ªæ        cut(root, low, high);        // å†å‡å•ä¸ª        return travel(root, low, high);    &#125;    private static TreeNode travel(TreeNode root, int low, int high) &#123;        if (root == null) &#123;            return root;        &#125;        if (low &lt;= root.val &amp;&amp; root.val &lt;= high) &#123;            root.left = travel(root.left, low, high);            root.right = travel(root.right, low, high);        &#125; else &#123;            if (root.left == null) &#123;                return root.right;            &#125; else if (root.right == null) &#123;                return root.left;            &#125; else &#123;                // åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹                // 1.å³å­æ ‘è¡¥ä½(æ‰¾åˆ°å³å­æ ‘çš„æœ€å·¦ä¾§èŠ‚ç‚¹)                TreeNode cur = root.right;                while (cur.left != null) &#123;                    cur = cur.left;                &#125;                cur.left = root.left;                root = root.right;                return root;            &#125;        &#125;        root.left = travel(root.left, low, high);        root.right = travel(root.right, low, high);        return root;    &#125;    private static void cut(TreeNode root, int low, int high) &#123;        if (root == null) &#123;            return;        &#125;        // æ•´æ¡å‰ªæ‰        if (root.val &gt; high) &#123;            root.right = null;            root.left = trimBST(root.left, low, high);        &#125;        if (root.val &lt; low) &#123;            root.left = null;            root.right = trimBST(root.right, low, high);        &#125;        cut(root.left, low, high);        cut(root.right, low, high);    &#125;// å› ä¸ºæ—¶é—´å¤æ‚åº¦å¤ªé«˜ï¼Œåé¢åˆå†™äº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œä½†æ˜¯è¿™ä¸ªç‰ˆæœ¬ACä¸äº†public static TreeNode trimBST(TreeNode root, int low, int high) &#123;          if (root == null) &#123;              return root;          &#125;            if (root.val &gt; high) &#123;  \t\t\treturn root.left;              // return trimBST(root.left, low, high);          &#125;          if (root.val &lt; low) &#123;              // ç»§ç»­å‘å³éå†  \t\t\treturn root.right;              // return trimBST(root.right, low, high);          &#125;            if (low &lt;= root.val &amp;&amp; root.val &lt;= high) &#123;              root.left = trimBST(root.left, low, high);              root.right = trimBST(root.right, low, high);          &#125;            while (root != null &amp;&amp; (root.val &lt; low || root.val &gt; high)) &#123;              if (root.left == null) &#123;                  root = root.right;              &#125; else if (root.right == null) &#123;                  root = root.left;              &#125; else &#123;                  // åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹                  // 1.å³å­æ ‘è¡¥ä½(æ‰¾åˆ°å³å­æ ‘çš„æœ€å·¦ä¾§èŠ‚ç‚¹)                  TreeNode cur = root.right;                  while (cur.left != null) &#123;                      cur = cur.left;                  &#125;                  cur.left = root.left;                  root = root.right;              &#125;          &#125;          return root;      &#125;\n108 å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/convert-sorted-array-to-binary-search-tree/)\npublic static TreeNode sortedArrayToBST(int[] nums) &#123;      if (nums.length == 0) &#123;          return null;      &#125;      return sortedDFS(nums, 0, nums.length);  &#125;    private static TreeNode sortedDFS(int[] nums, int i, int j) &#123;      if (i &gt;= j) &#123;          return null;      &#125;        int mid = (j - i) / 2 + i;      TreeNode treeNode = new TreeNode(nums[mid]);      treeNode.left = sortedDFS(nums, i, mid);      treeNode.right = sortedDFS(nums , mid + 1, j);      return treeNode;  &#125;\n538 æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/convert-bst-to-greater-tree)\n/**   * çœ‹äº†é¢˜è§£ä¹‹åå†™å‡ºæ¥çš„   * æ€è·¯ï¼š   * 1.äºŒå‰æœç´¢æ ‘ï¼Œä¸­åºéå†ï¼ˆå·¦ä¸­å³ï¼‰æœ‰åº   * 2.è¦æŒ‰å€’åºç›¸åŠ ï¼Œéå†æ–¹å‘ç›¸å   * 3.å–ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å‰èŠ‚ç‚¹ä¸æ–­ç´¯åŠ    */  TreeNode pre = new TreeNode(0);  public TreeNode convertBST(TreeNode root) &#123;      getTreeNodeTravel(root);      return root;  &#125;    private void getTreeNodeTravel(TreeNode root) &#123;      if (root == null) &#123;          return;      &#125;        getTreeNodeTravel(root.right);        root.val = pre.val + root.val;      pre = root;      getTreeNodeTravel(root.left);  &#125;\nçœ‹è§£æ\n669 ä¿®å‰ªäºŒå‰æœç´¢æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š https://programmercarl.com/0669.%E4%BF%AE%E5%89%AA%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91.html\nè§†é¢‘è®²è§£ï¼š [https://www.bilibili.com/video/BV17P41177ud](https://www.bilibili.com/video/BV17P41177ud\nçœ‹äº†é¢˜è§£å‘ç°æ˜¯ä¸‹é¢ä¸¤è¡Œå¯¼è‡´ä¸èƒ½ ACã€‚è¿™é‡Œä¸èƒ½ç›´æ¥å‰ªæ‰ï¼Œå¿½ç•¥äº†æƒ…å†µã€‚\nå¹¶ä¸”ç”¨äº†ä¸‹é¢çš„ç»§ç»­é€’å½’ï¼Œå°±ä¸ç”¨å†åˆ é™¤èŠ‚ç‚¹äº†ã€‚\nif (root.val &gt; high) &#123;  \treturn root.left;      // return trimBST(root.left, low, high);  &#125;  if (root.val &lt; low) &#123;      // ç»§ç»­å‘å³éå†  \treturn root.right;      // return trimBST(root.right, low, high);  &#125;  \næ­£ç¡®æ–¹æ³•ï¼ˆğŸ¥´å¥½éš¾ï¼‰ï¼š\npublic static TreeNode trimBST(TreeNode root, int low, int high) &#123;      if (root == null) &#123;          return root;      &#125;      if (root.val &gt; high) &#123;          return trimBST(root.left, low, high);      &#125;      if (root.val &lt; low) &#123;           return trimBST(root.right, low, high);      &#125;      if (low &lt;= root.val &amp;&amp; root.val &lt;= high) &#123;          root.left = trimBST(root.left, low, high);          root.right = trimBST(root.right, low, high);      &#125;      return root;  &#125;\n108 å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š https://programmercarl.com/0108.%E5%B0%86%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E4%B8%BA%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91.html\nè§†é¢‘è®²è§£ï¼š[https://www.bilibili.com/video/BV1uR4y1X7qL](https://www.bilibili.com/video/BV1uR4y1X7qL\n538 æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š https://programmercarl.com/0538.%E6%8A%8A%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E8%BD%AC%E6%8D%A2%E4%B8%BA%E7%B4%AF%E5%8A%A0%E6%A0%91.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1d44y1f7wP\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["äºŒå‰æ ‘","äºŒå‰æœç´¢æ ‘","ç´¯åŠ æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåä¸€å¤©-ç†è®ºåŸºç¡€ã€77ç»„åˆ","url":"/posts/ff56c28f/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šç†è®ºåŸºç¡€æ€»ç»“åœ¨ [[é¢è¯•-æ•°æ®ç»“æ„å’Œç®—æ³•]] ä¸­ã€‚\n\n\næ›´æ–°\n\n\n24-05-10 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n77 ç»„åˆ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/combinations/)\npublic List&lt;List&lt;Integer&gt;&gt; combine(int n, int k) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; list = new ArrayList&lt;&gt;();      combineDFS(1, n, k, list, result);      return result;  &#125;    /**   * * @param start å½“å‰å¼€å§‹èŠ‚ç‚¹   * @param n n   * @param k k   * @param list æ¯ä¸ªlist   * @param result æœ€åçš„ç»“æœ   */  private void combineDFS(int start, int n, int k, List&lt;Integer&gt; list, List&lt;List&lt;Integer&gt;&gt; result) &#123;      if (list.size() == k) &#123;          List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;(k);          resultOne.addAll(list);          result.add(resultOne);          return;      &#125;        for (int j = start; j &lt;= n; j++) &#123;          list.add(j);          combineDFS(j + 1, n, k, list, result);          list.remove(list.size() - 1);      &#125;  &#125;\nçœ‹è§£æ\n77 ç»„åˆ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0077.%E7%BB%84%E5%90%88.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1ti4y1L7cv\nå‰ªææ“ä½œï¼šhttps://www.bilibili.com/video/BV1wi4y157er\npublic List&lt;List&lt;Integer&gt;&gt; combine(int n, int k) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; list = new ArrayList&lt;&gt;();      combineDFS(1, n, k, list, result);      return result;  &#125;    /**   * * @param start å½“å‰å¼€å§‹èŠ‚ç‚¹   * @param n n   * @param k k   * @param list æ¯ä¸ªlist   * @param result æœ€åçš„ç»“æœ   */  private void combineDFS(int start, int n, int k, List&lt;Integer&gt; list, List&lt;List&lt;Integer&gt;&gt; result) &#123;      if (list.size() == k) &#123;          List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;(k);          resultOne.addAll(list);          result.add(resultOne);          return;      &#125;  \t// é™„å¸¦å‰ªææ“ä½œ    for (int j = start; j &lt;= (n - (k - list.size())) + 1; j++) &#123;          list.add(j);          combineDFS(j + 1, n, k, list, result);          list.remove(list.size() - 1);      &#125;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å›æº¯ç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåäºŒå¤©-216ç»„åˆæ€»å’ŒIIIã€17ç”µè¯å·ç çš„å­—æ¯ç»„åˆ","url":"/posts/82bed832/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š216 å¯ä»¥ ACã€‚17 çœ‹äº†éƒ¨åˆ†è§£æå†™å‡ºæ¥çš„ã€‚\n\n\næ›´æ–°\n\n\n24-06-10 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n216 ç»„åˆæ€»å’Œ III\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/combination-sum-iii)\npublic class LE22 &#123;      public static void main(String[] args) &#123;          List&lt;List&lt;Integer&gt;&gt; combinationSum3 = combinationSum3(9, 45);          for (List&lt;Integer&gt; integerList : combinationSum3) &#123;              System.out.println(Arrays.toString(integerList.stream().mapToInt(n -&gt; n).toArray()));          &#125;      &#125;        public static List&lt;List&lt;Integer&gt;&gt; combinationSum3(int k, int n) &#123;          // ç»“æœé›†          List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();          // å•ä¸ªç»“æœ          List&lt;Integer&gt; list = new ArrayList&lt;&gt;();            combinationSum(1, k, n, 0, list, result);          return result;      &#125;        private static void combinationSum(int start, int k, int n, int sum, List&lt;Integer&gt; list, List&lt;List&lt;Integer&gt;&gt; result) &#123;          // å‰ªææ“ä½œ          if (sum &gt; n) &#123;              return;          &#125;            if (list.size() == k) &#123;              if (sum == n) &#123;                  List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;(list);                  result.add(resultOne);              &#125;              return;          &#125;            for (int j = start; j &lt;= 9 - (k - list.size()) + 1; j++) &#123;              list.add(j);              combinationSum(j + 1, k, n, sum + j, list, result);              list.remove(list.size() - 1);          &#125;      &#125;  &#125;\n17 ç”µè¯å·ç çš„å­—æ¯ç»„åˆ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/letter-combinations-of-a-phone-number)\n/**   * @param digits æŒ‰é”®æ•°ç»„   * @return ç»“æœ   */  public static List&lt;String&gt; letterCombinations(String digits) &#123;      List&lt;String&gt; list = new ArrayList&lt;&gt;();      String[] buttonList = &#123;&quot;&quot;, &quot;&quot;, &quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;, &quot;jkl&quot;, &quot;mno&quot;, &quot;pqrs&quot;, &quot;tuv&quot;, &quot;wxyz&quot;&#125;;        if (digits == null || &quot;&quot;.equals(digits)) &#123;          return list;      &#125;        combinations(0, digits, buttonList, &quot;&quot;, list);      return list;  &#125;    /**   * * @param i éå†çš„å±‚æ•°   */  private static void combinations(int i, String digits, String[] buttonList, String str, List&lt;String&gt; list) &#123;      if (i == digits.length()) &#123;          list.add(str);          return;      &#125;        int digit = Integer.parseInt(digits.charAt(i) + &quot;&quot;);      String letter = buttonList[digit];      for (int j = 0; j &lt; letter.length(); j++) &#123;          str+=letter.charAt(j);          combinations(i + 1, digits, buttonList, str, list);          str = str.substring(0, str.length() - 1);      &#125;  &#125;\nçœ‹è§£æ\n216 ç»„åˆæ€»å’Œ III\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0216.ç»„åˆæ€»å’ŒIII.html)\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1wg411873x\n17 ç”µè¯å·ç çš„å­—æ¯ç»„åˆ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0017.ç”µè¯å·ç çš„å­—æ¯ç»„åˆ.html)\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1yV4y1V7Ug\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å›æº¯ç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬åä¹å¤©-235äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€701äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œã€450åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„èŠ‚ç‚¹","url":"/posts/49e785ab/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š235ã€701ACï¼Œ701 è¿˜æœ‰æ›´ç®€å•çš„å†™æ³•ã€‚450 é€šè¿‡å¤±è´¥ã€‚\n\n\næ›´æ–°\n\n\n24-06-09 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n235 äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-search-tree)\nçœ‹äº†ä¸€éƒ¨åˆ†çš„è§£æã€‚ä¸»è¦åœ¨äºå½“æˆ‘ä»¬ä»ä¸Šå‘ä¸‹å»é€’å½’éå†ï¼Œç¬¬ä¸€æ¬¡é‡åˆ° cur èŠ‚ç‚¹æ˜¯æ•°å€¼åœ¨ [q, p] åŒºé—´ä¸­ï¼Œé‚£ä¹ˆ cur å°±æ˜¯ q å’Œ p çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚\npublic TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) &#123;      if (p.val &lt; q.val) &#123;          return lowestCommonAncestorTravel(root, p, q);      &#125; else &#123;          return lowestCommonAncestorTravel(root, q, p);      &#125;  &#125;    private TreeNode lowestCommonAncestorTravel(TreeNode root, TreeNode p, TreeNode q) &#123;      if (root == null || (p.val &lt;= root.val &amp;&amp; root.val &lt;= q.val)) &#123;          return root;      &#125; else if (root.val &gt; q.val) &#123;          return lowestCommonAncestor(root.left, p, q);      &#125; else &#123;          return lowestCommonAncestor(root.right, p, q);      &#125;  &#125;\n701 äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/insert-into-a-binary-search-tree/description/)\n// ç”¨åŒæŒ‡é’ˆTreeNode pre;  public TreeNode insertIntoBST(TreeNode root, int val) &#123;      if (pre == null) &#123;          if (root == null) &#123;              return new TreeNode(val);          &#125;      &#125; else &#123;          if (root == null) &#123;              if (pre.val &gt; val)&#123;                  pre.left = new TreeNode(val);              &#125; else if (pre.val &lt; val) &#123;  \t                pre.right = new TreeNode(val);              &#125;              return root;          &#125;      &#125;      pre = root;        if (root.val &gt; val) &#123;          insertIntoBST(root.left, val);      &#125; else if (root.val &lt; val) &#123;          insertIntoBST(root.right, val);      &#125;        return root;  &#125;\n450 åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„èŠ‚ç‚¹\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/delete-node-in-a-bst)\næƒ³çš„æ˜¯å·¦å­æ ‘é¡¶ä½å­çš„æƒ…å†µã€‚çœ‹äº†è§£æç”¨äº†å³å­æ ‘é¡¶ä½ï¼Œå¥½åƒç¡®å®å¥½ç†è§£ä¸€ç‚¹ã€‚ï¼ˆåŒ…æ‹¬è®²è§£ä¸­çš„æ™®é€šäºŒå‰æ ‘åˆ é™¤ï¼Œä¹Ÿæ˜¯ç”¨äº†å³å­æ ‘é¡¶ä½ï¼‰\n// è¿™æ ·å­ç”¨ä¾‹85ä¸èƒ½é€šè¿‡public TreeNode deleteNode(TreeNode root, int key) &#123;      // ä¸ºç©ºç›´æ¥è¿”å›      if (root == null) &#123;          return root;      &#125;        if (root.val == key) &#123;          if (root.left == null) &#123;              root = root.right;          &#125; else if (root.right == null) &#123;              root = root.left;          &#125; else &#123;          // åº”è¯¥æ˜¯è¿™é‡Œå†™å¾—ä¸å¯¹            TreeNode right = root.right;              TreeNode leftRight = root.left.right;              root = root.left;              if (leftRight != null) &#123;                  root.right = leftRight;                  root.right.right = right;              &#125; else &#123;                  root.right = right;              &#125;          &#125;          return root;      &#125;        if (root.val &gt; key) &#123;          root.left = deleteNode(root.left, key);      &#125; else &#123;          root.right = deleteNode(root.right, key);      &#125;        return root;  &#125;\nçœ‹è§£æ\n235 äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0235.%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88.html\nè§†é¢‘è®²è§£ï¼š[https://www.bilibili.com/video/BV1Zt4y1F7ww](https://www.bilibili.com/video/BV1Zt4y1F7ww\n701 äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0701.%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E4%B8%AD%E7%9A%84%E6%8F%92%E5%85%A5%E6%93%8D%E4%BD%9C.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1Et4y1c78Y\n// æ–‡ç« ä¸­ç»™çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œç¡®å®è¿™æ ·å­æ€è·¯æ›´æ¸…æ™°äº†    public TreeNode insertIntoBST(TreeNode root, int val) &#123;        if (root == null) // å¦‚æœå½“å‰èŠ‚ç‚¹ä¸ºç©ºï¼Œä¹Ÿå°±æ„å‘³ç€valæ‰¾åˆ°äº†åˆé€‚çš„ä½ç½®ï¼Œæ­¤æ—¶åˆ›å»ºèŠ‚ç‚¹ç›´æ¥è¿”å›ã€‚            return new TreeNode(val);                    if (root.val &lt; val)&#123;            root.right = insertIntoBST(root.right, val); // é€’å½’åˆ›å»ºå³å­æ ‘        &#125;else if (root.val &gt; val)&#123;            root.left = insertIntoBST(root.left, val); // é€’å½’åˆ›å»ºå·¦å­æ ‘        &#125;        return root;    &#125;\n450 åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„èŠ‚ç‚¹\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼šhttps://programmercarl.com/0450.%E5%88%A0%E9%99%A4%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E4%B8%AD%E7%9A%84%E8%8A%82%E7%82%B9.html\nè§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1tP41177us\npublic TreeNode deleteNode(TreeNode root, int key) &#123;  if (root == null) return root;  if (root.val == key) &#123;    if (root.left == null) &#123;      return root.right;    &#125; else if (root.right == null) &#123;      return root.left;    &#125; else &#123;    // åªæœ‰è¿™éƒ¨åˆ†ä¸ä¸€æ ·      TreeNode cur = root.right;      while (cur.left != null) &#123;        cur = cur.left;      &#125;      cur.left = root.left;      root = root.right;      return root;    &#125;  &#125;  if (root.val &gt; key) root.left = deleteNode(root.left, key);  if (root.val &lt; key) root.right = deleteNode(root.right, key);  return root;&#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["äºŒå‰æ ‘","äºŒå‰æœç´¢æ ‘"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåä¸‰å¤©-39ç»„åˆæ€»å’Œã€40ç»„åˆæ€»å’ŒIIã€131åˆ†å‰²å›æ–‡ä¸²","url":"/posts/2f09909f/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š39AC ä½†æ˜¯å¯ä»¥ç»§ç»­ä¼˜åŒ–å‰ªæã€‚40ACã€‚131 åˆ†å‰²æ²¡æœ‰åšè¿‡ï¼Œç›´æ¥çœ‹è§£æäº†ï¼ˆåŠ¨æ€è§„åˆ’æ±‚å›æ–‡è¿™ä¸ªæ²¡æœ‰çœ‹ï¼Œåé¢åˆ·åˆ°åŠ¨æ€è§„åˆ’å†ç ”ç©¶ï¼‰ã€‚\n\n\næ›´æ–°\n\n\n24-06-11 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n39 ç»„åˆæ€»å’Œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/combination-sum)\npublic static List&lt;List&lt;Integer&gt;&gt; combinationSum(int[] candidates, int target) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();        combinationSumDFS(0, 0, target, candidates, resultOne, result);      return result;  &#125;      private static void combinationSumDFS(int startIndex, int sum, int target, int[] candidates, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;      if (sum &gt;= target) &#123;          if (target == sum) &#123;              result.add(new ArrayList&lt;&gt;(resultOne));          &#125;          return;      &#125;        for (int i = startIndex; i &lt; candidates.length; i++) &#123;          resultOne.add(candidates[i]);          combinationSumDFS(i, sum + candidates[i], target, candidates, resultOne, result);          resultOne.remove(resultOne.size() - 1);      &#125;  &#125;\n40 ç»„åˆæ€»å’Œ II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/combination-sum-ii)\npublic static List&lt;List&lt;Integer&gt;&gt; combinationSum2(int[] candidates, int target) &#123;      Arrays.sort(candidates);        List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();        combinationSum2DFS(0, 0, target, candidates, resultOne, result);      return result;  &#125;    /**   * æ€è·¯ï¼š   * 1. å’Œä¸Šé¢˜å·®ä¸å¤šã€‚ä½†æ˜¯æ•°ç»„å˜æˆæœ‰é‡å¤å…ƒç´ çš„äº†ã€‚   * 2. æƒ³æ³•æ˜¯æ¯å±‚éå†çš„æ—¶å€™ï¼Œå»é‡   */  private static void combinationSum2DFS(int startIndex, int sum, int target, int[] candidates, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;      if (sum == target) &#123;          result.add(new ArrayList&lt;&gt;(resultOne));          return;      &#125;        for (int i = startIndex; i &lt; candidates.length &amp;&amp; sum + candidates[i] &lt;= target; i++) &#123;\t\t// åœ¨å•å±‚çš„æ•°ç»„å†…å»é‡        if (i - 1 &gt;= startIndex &amp;&amp; candidates[i] == candidates[i - 1]) &#123;              continue;          &#125;          resultOne.add(candidates[i]);          combinationSum2DFS(i + 1, sum + candidates[i], target, candidates, resultOne, result);          resultOne.remove(resultOne.size() - 1);      &#125;  &#125;\n131 åˆ†å‰²å›æ–‡ä¸²\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/palindrome-partitioning)\nçœ‹è§£æ\n39 ç»„åˆæ€»å’Œ\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0039.ç»„åˆæ€»å’Œ.html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV1KT4y1M7HJ/)\næœ¬æ¥ä»¥ä¸ºåªè¦ return å°±ä¸ç”¨ä¼˜åŒ–äº†ï¼ˆå¥½åƒæ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œè¿˜æ˜¯ä¼šç»§ç»­å¾€ä¸‹èµ°ï¼‰ï¼Œä½†æ˜¯é¢˜è§£ä¸­è¯´å¯ä»¥å‡å°‘ä¸€æ¬¡è¿›å…¥é€’å½’ã€‚\npublic static List&lt;List&lt;Integer&gt;&gt; combinationSum(int[] candidates, int target) &#123;      // è¦å‰ªæå¿…é¡»è¦æ’åº      Arrays.sort(candidates);        List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();        combinationSumDFS(0, 0, target, candidates, resultOne, result);      return result;  &#125;      private static void combinationSumDFS(int startIndex, int sum, int target, int[] candidates, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;      if (target == sum) &#123;          result.add(new ArrayList&lt;&gt;(resultOne));          return;      &#125;        // forå¾ªç¯çš„åˆ¤æ–­åšäº†å‰ªæä¼˜åŒ–å¤„ç†      for (int i = startIndex; i &lt; candidates.length &amp;&amp; sum + candidates[i] &lt;= target; i++) &#123;          resultOne.add(candidates[i]);          combinationSumDFS(i, sum + candidates[i], target, candidates, resultOne, result);          resultOne.remove(resultOne.size() - 1);      &#125;  &#125;\n40 ç»„åˆæ€»å’Œ II\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0040.ç»„åˆæ€»å’ŒII.html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV12V4y1V73A/)\n\nåœ¨ candidates[i] == candidates[i - 1] ç›¸åŒçš„æƒ…å†µä¸‹ï¼š\n\n\nused[i - 1] == trueï¼Œè¯´æ˜åŒä¸€æ ‘æ candidates[i - 1] ä½¿ç”¨è¿‡\n\n\nused[i - 1] == falseï¼Œè¯´æ˜åŒä¸€æ ‘å±‚ candidates[i - 1] ä½¿ç”¨è¿‡\n\n\n131 åˆ†å‰²å›æ–‡ä¸²\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0131.åˆ†å‰²å›æ–‡ä¸².html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV1c54y1e7k6/)\npublic static List&lt;List&lt;String&gt;&gt; partition(String s) &#123;      List&lt;List&lt;String&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;String&gt; string = new ArrayList&lt;&gt;();      partitionDFS(0, s, string, result);      return result;  &#125;    private static void partitionDFS(int startIndex, String s, List&lt;String&gt; string, List&lt;List&lt;String&gt;&gt; result) &#123;      if (startIndex &gt;= s.length()) &#123;          result.add(new ArrayList&lt;&gt;(string));      &#125;        for (int i = startIndex; i &lt; s.length(); i++) &#123;          String substring = s.substring(startIndex, i + 1);          if (!isPartition(substring)) &#123;              continue;          &#125;          string.add(substring);          partitionDFS(i + 1, s, string, result);          string.remove(string.size() - 1);      &#125;  &#125;    /**   * åˆ¤æ–­ä¼ å…¥å­—ç¬¦ä¸²æ˜¯å¦ä¸ºå›æ–‡å­—ç¬¦ä¸²   * @param substring æˆªå–çš„å­—ç¬¦ä¸²   * @return ç»“æœ   */  private static boolean isPartition(String substring) &#123;      for (int i = 0, j= substring.length() - 1; i &lt; j; i++, j--) &#123;          if (substring.charAt(i) != substring.charAt(j)) &#123;              return false;          &#125;      &#125;      return true;  &#125;\n// ä¼˜åŒ–ç‰ˆ åŠ¨æ€è§„åˆ’æ³•class Solution &#123;    List&lt;List&lt;String&gt;&gt; result;    LinkedList&lt;String&gt; path;    boolean[][] dp;    public List&lt;List&lt;String&gt;&gt; partition(String s) &#123;        result = new ArrayList&lt;&gt;();        char[] str = s.toCharArray();        path = new LinkedList&lt;&gt;();        dp = new boolean[str.length + 1][str.length + 1];        isPalindrome(str);        backtracking(s, 0);        return result;    &#125;    public void backtracking(String str, int startIndex) &#123;        if (startIndex &gt;= str.length()) &#123;            //å¦‚æœèµ·å§‹ä½ç½®å¤§äºsçš„å¤§å°ï¼Œè¯´æ˜æ‰¾åˆ°äº†ä¸€ç»„åˆ†å‰²æ–¹æ¡ˆ            result.add(new ArrayList&lt;&gt;(path));        &#125; else &#123;            for (int i = startIndex; i &lt; str.length(); ++i) &#123;                if (dp[startIndex][i]) &#123;                    //æ˜¯å›æ–‡å­ä¸²ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥é€’å½’                    //å…ˆå°†å½“å‰å­ä¸²ä¿å­˜å…¥path                    path.addLast(str.substring(startIndex, i + 1));                    //èµ·å§‹ä½ç½®åç§»ï¼Œä¿è¯ä¸é‡å¤                    backtracking(str, i + 1);                    path.pollLast();                &#125; else &#123;                    //ä¸æ˜¯å›æ–‡å­ä¸²ï¼Œè·³è¿‡                    continue;                &#125;            &#125;        &#125;    &#125;    //é€šè¿‡åŠ¨æ€è§„åˆ’åˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡ä¸²,å‚è€ƒåŠ¨æ€è§„åˆ’ç¯‡ 52 å›æ–‡å­ä¸²    public void isPalindrome(char[] str) &#123;        for (int i = 0; i &lt;= str.length; ++i) &#123;            dp[i][i] = true;        &#125;        for (int i = 1; i &lt; str.length; ++i) &#123;            for (int j = i; j &gt;= 0; --j) &#123;                if (str[j] == str[i]) &#123;                    if (i - j &lt;= 1) &#123;                        dp[j][i] = true;                    &#125; else if (dp[j + 1][i - 1]) &#123;                        dp[j][i] = true;                    &#125;                &#125;            &#125;        &#125;    &#125;&#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å›æº¯ç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåå››å¤©-93å¤åŸIPåœ°å€ã€78å­é›†ã€90å­é›†II","url":"/posts/c27b36b8/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š93 å¯ä»¥ ACã€‚78ã€90ACã€‚\n\n\næ›´æ–°\n\n\n24-06-11 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n93 å¤åŸ IP åœ°å€\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/restore-ip-addresses)\nè§£çš„æ—¶å€™ä¸çŸ¥é“å•å­—ç¬¦ä¸²æ€ä¹ˆæ“ä½œäº†ï¼ŒåŠ äº†ä¸€ä¸ªæ•°ç»„ã€‚æ…¢äº†å¾ˆå¤šã€‚\npublic static List&lt;String&gt; restoreIpAddresses(String s) &#123;      List&lt;String&gt; result = new ArrayList&lt;&gt;();      List&lt;String&gt; temp = new ArrayList&lt;&gt;();          if (s.length() &lt; 4 || s.length() &gt; 12)&#123;          return result;      &#125;        restoreIpAddressesDFS(0, temp, s, result);      return result;  &#125;    /**   * * @param startIndex å¼€å§‹Index   * @param s è¾“å…¥çš„s   * @param result åˆ‡å‰²çš„å­—ç¬¦ä¸²é›†   */  private static void restoreIpAddressesDFS(int startIndex, List&lt;String&gt; temp, String s, List&lt;String&gt; result) &#123;      if (startIndex &gt;= s.length() &amp;&amp; temp.size() == 4) &#123;          String resultOne = String.join(&quot;.&quot;, temp);          result.add(resultOne);      &#125;        for (int i = startIndex; i &lt; s.length() &amp;&amp; Integer.parseInt(s.substring(startIndex, i + 1)) &lt; 256; i++) &#123;          // 8 ä¸º substring çš„å–å€¼å°±åœ¨ 1 - 3ä¹‹é—´          String substring = s.substring(startIndex, i + 1);          if (substring.length() &lt; 1 || substring.length() &gt; 3) &#123;              continue;          &#125;          if (substring.length() &gt; 1 &amp;&amp; substring.startsWith(&quot;0&quot;)) &#123;              continue;          &#125;          temp.add(substring);          restoreIpAddressesDFS(i + 1, temp, s, result);          temp.remove(temp.size() - 1);      &#125;  &#125;\n78 å­é›†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/subsets)\npublic static List&lt;List&lt;Integer&gt;&gt; subsets(int[] nums) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();        // æ’åº      Arrays.sort(nums);          subsetsDFS(0, nums, resultOne, result);      return result;  &#125;    /**   * è¿™ä¸ªå’Œä¹‹å‰çš„åŒºåˆ«åœ¨äºï¼Œå¦‚æœè½¬åŒ–æˆä¸€é¢—æ ‘ã€‚ä¹‹å‰åªè¦æ±‚å¶å­èŠ‚ç‚¹ã€‚è¿™ä¸ªå…¨éƒ¨éƒ½è¦   * è€Œä¸”è¿˜è¦ä¸é‡å¤ï¼ˆğŸ˜—å†™é”™äº†ï¼Œçœ‹æˆ90çš„é¢˜äº†ã€‚è¿™é¢˜è¿˜è¦æ›´ç®€å•ä¸€ç‚¹ã€‚ï¼‰ * @param startIndex èµ·å§‹index   */private static void subsetsDFS(int startIndex, int[] nums, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;        result.add(new ArrayList&lt;&gt;(resultOne));      for (int i = startIndex; i &lt; nums.length; i++) &#123;          resultOne.add(nums[i]);          subsetsDFS(i + 1, nums, resultOne, result);          resultOne.remove(resultOne.size() - 1);      &#125;  &#125;\n90 å­é›† II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/subsets-ii)\npublic static List&lt;List&lt;Integer&gt;&gt; subsetsWithDup(int[] nums) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();        // æ’åº      Arrays.sort(nums);        subsetsDFS(0, nums, resultOne, result);      return result;  &#125;    /**   * @param startIndex èµ·å§‹index   */private static void subsetsDFS(int startIndex, int[] nums, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;      result.add(new ArrayList&lt;&gt;(resultOne));        for (int i = startIndex; i &lt; nums.length; i++) &#123;          if (i - 1 &gt;= startIndex &amp;&amp; nums[i] == nums[i - 1]) &#123;              continue;          &#125;          resultOne.add(nums[i]);          subsetsDFS(i + 1, nums, resultOne, result);          resultOne.remove(resultOne.size() - 1);      &#125;  &#125;\nçœ‹è§£æ\n93 å¤åŸ IP åœ°å€\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0093.å¤åŸIPåœ°å€.html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV1XP4y1U73i/)\nclass Solution &#123;    List&lt;String&gt; result = new ArrayList&lt;String&gt;();\tStringBuilder stringBuilder = new StringBuilder();\tpublic List&lt;String&gt; restoreIpAddresses(String s) &#123;\t\trestoreIpAddressesHandler(s, 0, 0);\t\treturn result;\t&#125;\t// numberè¡¨ç¤ºstringbuilderä¸­ipæ®µçš„æ•°é‡\tpublic void restoreIpAddressesHandler(String s, int start, int number) &#123;\t\t// å¦‚æœstartç­‰äºsçš„é•¿åº¦å¹¶ä¸”ipæ®µçš„æ•°é‡æ˜¯4ï¼Œåˆ™åŠ å…¥ç»“æœé›†ï¼Œå¹¶è¿”å›\t\tif (start == s.length() &amp;&amp; number == 4) &#123;\t\t\tresult.add(stringBuilder.toString());\t\t\treturn;\t\t&#125;\t\t// å¦‚æœstartç­‰äºsçš„é•¿åº¦ä½†æ˜¯ipæ®µçš„æ•°é‡ä¸ä¸º4ï¼Œæˆ–è€…ipæ®µçš„æ•°é‡ä¸º4ä½†æ˜¯startå°äºsçš„é•¿åº¦ï¼Œåˆ™ç›´æ¥è¿”å›\t\tif (start == s.length() || number == 4) &#123;\t\t\treturn;\t\t&#125;\t\t// å‰ªæï¼šipæ®µçš„é•¿åº¦æœ€å¤§æ˜¯3ï¼Œå¹¶ä¸”ipæ®µå¤„äº[0,255]\t\tfor (int i = start; i &lt; s.length() &amp;&amp; i - start &lt; 3 &amp;&amp; Integer.parseInt(s.substring(start, i + 1)) &gt;= 0\t\t\t\t&amp;&amp; Integer.parseInt(s.substring(start, i + 1)) &lt;= 255; i++) &#123;\t\t\t// å¦‚æœipæ®µçš„é•¿åº¦å¤§äº1ï¼Œå¹¶ä¸”ç¬¬ä¸€ä½ä¸º0çš„è¯ï¼Œcontinue\t\t\tif (i + 1 - start &gt; 1 &amp;&amp; s.charAt(start) - &#x27;0&#x27; == 0) &#123;\t\t\t\tcontinue;\t\t\t&#125;\t\t\tstringBuilder.append(s.substring(start, i + 1));\t\t\t// å½“stringBuilderé‡Œçš„ç½‘æ®µæ•°é‡å°äº3æ—¶ï¼Œæ‰ä¼šåŠ ç‚¹ï¼›å¦‚æœç­‰äº3ï¼Œè¯´æ˜å·²ç»æœ‰3æ®µäº†ï¼Œæœ€åä¸€æ®µä¸éœ€è¦å†åŠ ç‚¹\t\t\tif (number &lt; 3) &#123;\t\t\t\tstringBuilder.append(&quot;.&quot;);\t\t\t&#125;\t\t\tnumber++;\t\t\trestoreIpAddressesHandler(s, i + 1, number);\t\t\tnumber--;\t\t\t// åˆ é™¤å½“å‰stringBuilderæœ€åä¸€ä¸ªç½‘æ®µï¼Œæ³¨æ„è€ƒè™‘ç‚¹çš„æ•°é‡çš„é—®é¢˜\t\t\t// ä¸»è¦è¿™é‡Œæ²¡æœ‰å†™å‡ºæ¥â—\t\t\tstringBuilder.delete(start + number, i + number + 2);\t\t&#125;\t&#125;&#125;\n78 å­é›†\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0078.å­é›†.html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV1U84y1q7Ci)\n90 å­é›† II\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0090.å­é›†II.html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV1vm4y1F71J)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å›æº¯ç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåäº”å¤©-491é€’å¢å­åºåˆ— ã€46å…¨æ’åˆ— ã€47å…¨æ’åˆ— II","url":"/posts/f191c36/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š491 è¶…æ—¶ã€‚46ACã€‚47 ä¸æ˜¯å¾ˆå¯¹ï¼Œè¦çœ‹è§£æï¼Œä¸»è¦æ˜¯å»é‡é‚£ä¸€æ­¥ã€‚\n\n\næ›´æ–°\n\n\n24-06-11 åˆå§‹è®°å½•24-06-12 å®Œæˆ\n\nåˆæ­¥é¢˜è§£\n491 é€’å¢å­åºåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/non-decreasing-subsequences)\nè¶…æ—¶äº†ï¼Œä¸»è¦æ˜¯å»é‡é‚£ä¸€æ­¥åº”è¯¥ã€‚\npublic static List&lt;List&lt;Integer&gt;&gt; findSubsequences(int[] nums) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();        findSubsequencesDFS(0 , nums, resultOne, result);      return result;  &#125;    private static void findSubsequencesDFS(int startIndex, int[] nums, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;      // å…ˆè¿™æ ·åˆ¤æ–­æ˜¯å¦é‡å¤      if (resultOne.size() &gt;= 2 &amp;&amp; !result.contains(resultOne)) &#123;          result.add(new ArrayList&lt;&gt;(resultOne));      &#125;        for (int i = startIndex; i &lt; nums.length; i++) &#123;          if (resultOne.size() != 0 &amp;&amp; resultOne.get(resultOne.size() - 1) &gt; nums[i]) &#123;              continue;          &#125;          resultOne.add(nums[i]);           findSubsequencesDFS(i + 1, nums, resultOne, result);          resultOne.remove(resultOne.size() - 1);      &#125;  &#125;\n46 å…¨æ’åˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/permutations/description/)\n// æ’åˆ—æ¯ä¸ªå˜é‡éƒ½è¦ç»Ÿè®¡ï¼Œæ‰€ä»¥ä¸éœ€è¦startIndexpublic static List&lt;List&lt;Integer&gt;&gt; permute(int[] nums) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();        if (nums == null || nums.length == 0) &#123;          return result;      &#125;        permuteDFS(nums, resultOne, result);      return result;  &#125;    private static void permuteDFS(int[] nums, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;      if (resultOne.size() == nums.length) &#123;          result.add(new ArrayList&lt;&gt;(resultOne));          return;      &#125;        for (int i = 0; i &lt; nums.length; i++) &#123;          if (resultOne.contains(nums[i])) &#123;              continue;          &#125;          resultOne.add(nums[i]);          permuteDFS(nums, resultOne, result);          resultOne.remove(resultOne.size() - 1);      &#125;  &#125;\n47 å…¨æ’åˆ— II\né¢˜ç›®é“¾æ¥ï¼š(leetcode.cn/problems/permutations-ii/)\n/**   * å’Œä¸Šä¸€é¢˜å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æ•°ç»„å…ƒç´ é‡å¤ã€‚   * æ‰€ä»¥ä¸èƒ½ç”¨æ•°ç»„ç›´æ¥ç»Ÿè®¡ï¼Œå¾—ç”¨indexè®°å½•è¿™ä¸ªæ˜¯å¦è¢«è®°è¿‡   * è¿˜æœ‰ç‚¹ç¼ºé™·ã€‚é‡å¤å…ƒç´ ä¼šæŒ‰ä¸åŒä¸‹æ ‡è¢«é‡å¤è®¡å…¥.   * å’Œä¹‹å‰ä¸€æ ·ï¼Œå•å±‚å…ƒç´ ä¸èƒ½é‡å¤ã€‚   * @param nums nums   * @return ç»“æœ   */  public static List&lt;List&lt;Integer&gt;&gt; permuteUnique(int[] nums) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();          if (nums == null || nums.length == 0) &#123;          return result;      &#125;        Arrays.sort(nums);      permuteUniqueDFS(nums, new ArrayList&lt;&gt;(), resultOne, result);      return result;  &#125;    private static void permuteUniqueDFS(int[] nums, List&lt;Integer&gt; resultIndex, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;      if (resultOne.size() == nums.length) &#123;          result.add(new ArrayList&lt;&gt;(resultOne));          return;      &#125;        // åˆ¤æ–­è¿™å±‚æœ‰æ²¡æœ‰ä½¿ç”¨è¿‡è¿™ä¸ªæ•°å­—ï¼Œå’ŒLE491ä¸€æ ·      HashSet&lt;Integer&gt; set = new HashSet&lt;&gt;();      // setè®°å½•ä¸‹æ ‡      for (int i = 0; i &lt; nums.length; i++) &#123;          if (resultIndex.contains(i)) &#123;              continue;          &#125;          if (set.contains(nums[i])) &#123;              continue;          &#125;          resultIndex.add(i);          resultOne.add(nums[i]);          set.add(nums[i]);          permuteUniqueDFS(nums, resultIndex, resultOne, result);          resultOne.remove(resultOne.size() - 1);          resultIndex.remove(resultIndex.size() - 1);      &#125;  &#125;\nçœ‹é¢˜è§£\n491 é€’å¢å­åºåˆ—\n(https://programmercarl.com/0491.é€’å¢å­åºåˆ—.html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV1EG4y1h78v)\nåŠ äº†å‰ªææ“ä½œçš„ä¼˜åŒ–ã€‚\npublic static List&lt;List&lt;Integer&gt;&gt; findSubsequences(int[] nums) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();        findSubsequencesDFS(0 , nums, resultOne, result);      return result;  &#125;    private static void findSubsequencesDFS(int startIndex, int[] nums, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;       if (resultOne.size() &gt;= 2) &#123;          result.add(new ArrayList&lt;&gt;(resultOne));      &#125;        HashMap&lt;Integer,Integer&gt; map = new HashMap&lt;&gt;();      for (int i = startIndex; i &lt; nums.length; i++) &#123;          if (resultOne.size() != 0 &amp;&amp; resultOne.get(resultOne.size() - 1) &gt; nums[i]) &#123;              continue;          &#125;          // åˆ¤æ–­è¿™å±‚æ˜¯å¦ä½¿ç”¨          if (map.getOrDefault(nums[i], 0) &gt;= 1) &#123;              continue;          &#125;          map.put(nums[i], map.getOrDefault(nums[i], 0) + 1);          resultOne.add(nums[i]);          findSubsequencesDFS(i + 1, nums, resultOne, result);          resultOne.remove(resultOne.size() - 1);      &#125;  &#125;\n46 å…¨æ’åˆ—\n(https://programmercarl.com/0046.å…¨æ’åˆ—.html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV19v4y1S79W)\n47 å…¨æ’åˆ— II\n(https://programmercarl.com/0047.å…¨æ’åˆ—II.html)\nè§†é¢‘è®²è§£ï¼š(https://www.bilibili.com/video/BV1R84y1i7Tm)\npublic static List&lt;List&lt;Integer&gt;&gt; permuteUnique(int[] nums) &#123;      List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();      List&lt;Integer&gt; resultOne = new ArrayList&lt;&gt;();          if (nums == null || nums.length == 0) &#123;          return result;      &#125;        Arrays.sort(nums);      permuteUniqueDFS(nums, new boolean[]&#123;&#125;, resultOne, result);      return result;  &#125;    /**   * ç”¨æ•°ç»„æ ‡è®°å› ä¸ºè¿™ä¸ªæ ‘æ›´åƒä¸€ä¸ªçŸ©é˜µ   * æ•°ç»„å¯ä»¥æ ‡è®°numsåˆå¯ä»¥æ ‡è®°å±‚æ•°   */  private static void permuteUniqueDFS(int[] nums, boolean[] used, List&lt;Integer&gt; resultOne, List&lt;List&lt;Integer&gt;&gt; result) &#123;      if (resultOne.size() == nums.length) &#123;          result.add(new ArrayList&lt;&gt;(resultOne));          return;      &#125;        // setè®°å½•ä¸‹æ ‡      for (int i = 0; i &lt; nums.length; i++) &#123;          // è®°å½•äº†indexå€¼ï¼Œå³è¿™indexè¢«ä½¿ç”¨äº†ï¼ˆè¿™é‡Œå¯ä»¥ç†è§£ï¼‰          if (used[i]) &#123;              continue;          &#125;            // å¦‚æœè¿™ä¸ªæ•°å€¼å’Œå‰é¢çš„æ•°å€¼ç›¸åŒ          // é¦–å…ˆä¸€å®šè¦æ’åºï¼Œè¿™æ ·numsæ•°ç»„ä¸­çš„å‰é¢ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±ä¸€å®šæ˜¯è¢«ç”¨è¿‡äº†          // ç„¶åç°åœ¨åˆ°è¿™ä¸ªèŠ‚ç‚¹ï¼Œå‰é¢ä¸€ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€æ˜¯false(è¿™é‡Œæ¨ªå‘çœ‹)ï¼Œè¯´æ˜å·²ç»å›æº¯äº†ã€‚èŠ‚ç‚¹å·²ç»è¢«æ·»åŠ ï¼Œè·³è¿‡è¿™å±‚          if (i &gt; 0 &amp;&amp; nums[i] == nums[i - 1] &amp;&amp; !used[i - 1]) &#123;              continue;          &#125;          // è¿™å±‚æ˜¯å¦ä½¿ç”¨è¿‡          used[i] = true;          resultOne.add(nums[i]);          permuteUniqueDFS(nums, used, resultOne, result);          resultOne.remove(resultOne.size() - 1);          used[i] = false;      &#125;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å›æº¯ç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåå…­å¤©-332é‡æ–°å®‰æ’è¡Œç¨‹ã€51Nçš‡åã€ 37è§£æ•°ç‹¬","url":"/posts/cf86d462/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šä»Šå¤©çš„é¢˜ï¼Œçœ‹æ ‡æ³¨è¯´éƒ½å¾ˆéš¾ï¼Œå…ˆå»æ€»ç»“å†åšè¿™ä¸ªã€‚æ—¶é—´ä¸å¤ªå¤Ÿäº†ï¼Œéƒ½æ˜¯ç›´æ¥çœ‹çš„è§£æç„¶ååšé¢˜ã€‚\n\n\næ›´æ–°\n\n\n24-06-12 åˆå§‹è®°å½•24-06-13 å®Œæˆé¢˜è§£\n\nåˆæ­¥é¢˜è§£\n332 é‡æ–°å®‰æ’è¡Œç¨‹\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/reconstruct-itinerary)\n51N çš‡å\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/n-queens)\n37 è§£æ•°ç‹¬\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/sudoku-solver)\nçœ‹è§£æ\n332 é‡æ–°å®‰æ’è¡Œç¨‹\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0332.é‡æ–°å®‰æ’è¡Œç¨‹.html)\nè§£æ³•è¶…æ—¶ï¼ˆç¬¬ 80 ä¸ªç”¨ä¾‹ï¼‰ï¼šåŠ ä¸Šå‰ªæä¸ä¼šè¶…æ—¶ã€‚åˆ«çš„æ€è·¯éƒ½å’Œæ¸…æ™°ï¼Œä½†æ˜¯å‰ªæé‚£ä¸€æ­¥æœ‰ç‚¹éš¾æƒ³åˆ°ã€‚\npublic static List&lt;String&gt; findItinerary(List&lt;List&lt;String&gt;&gt; tickets) &#123;      List&lt;String&gt; resultOne = new ArrayList&lt;&gt;();        // æŒ‰å­—å…¸æ’åºæ’åºï¼ˆç›®çš„åœ°æ’åºï¼‰    tickets.sort(Comparator.comparing(o -&gt; o.get(1)));      // ç”¨äºè®°å½•å½“å‰èŠ‚ç‚¹æ˜¯å¦ä½¿ç”¨      boolean[] flagList = new boolean[tickets.size()];        // è¡Œç¨‹å¿…é¡»ä»JFKå¼€å§‹      resultOne.add(&quot;JFK&quot;);        // è¿™é‡Œå¦‚æœæ‰¾åˆ°ä¸€æ¡å°±ç›´æ¥è¿”å›      findItineraryDFS(flagList, tickets, resultOne);      return resultOne;  &#125;    private static boolean findItineraryDFS(boolean[] flagList, List&lt;List&lt;String&gt;&gt; tickets, List&lt;String&gt; resultOne) &#123;      // ticketsä¸ºçº¿è·¯æ•°ï¼ŒèŠ‚ç‚¹æ•°è¦åŠ 1      if (resultOne.size() == tickets.size() + 1) &#123;          return true;      &#125;        for (int i = 0; i &lt; tickets.size(); i++) &#123;  \t    // ä¸ºäº†é˜²æ­¢è¶…æ—¶åŠ ä¸Šè¿™å¥çš„å‰ªæ\t    // å¦‚æœè¿™å¼ ç¥¨å’Œä¸Šå¼ ç¥¨ç›¸åŒ ä¸”ä¸Šå¼ ç¥¨æ²¡ç”¨è¿‡ è¯´æ˜æ˜¯ä»ä¸Šå¼ ç¥¨å›æº¯è¿‡æ¥çš„ï¼Œå·²ç»éå†è¿‡è¿™ç§æƒ…å†µï¼Œè·³è¿‡\t    if(i &gt; 0 &amp;&amp; tickets.get(i).equals(tickets.get(i - 1)) &amp;&amp; !flagList[i - 1]) continue;\t            if (!flagList[i] &amp;&amp; tickets.get(i).get(0).equals(resultOne.get(resultOne.size() - 1))) &#123;              resultOne.add(tickets.get(i).get(1));              flagList[i] = true;                if (findItineraryDFS(flagList, tickets, resultOne)) &#123;                  return true;              &#125;                resultOne.remove(resultOne.size() - 1);              flagList[i] = false;          &#125;      &#125;      return false;  &#125;\n51N çš‡å\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0051.Nçš‡å.html)\npublic class LE51 &#123;      public static void main(String[] args) &#123;          solveNQueens(4);      &#125;        public static List&lt;List&lt;String&gt;&gt; solveNQueens(int n) &#123;          List&lt;List&lt;String&gt;&gt; result = new ArrayList&lt;&gt;();          char[][] chars = new char[n][n];            for (char[] c : chars) &#123;              Arrays.fill(c, &#x27;.&#x27;);          &#125;            solveNQueensDFS(0, n, chars, result);          return result;      &#125;        /**       * @param row    è¡Œæ•°       * @param n      æ£‹ç›˜å¤§å°       * @param chars  æ£‹ç›˜æ‘†æ³•       * @param result ç»“æœ       */      private static void solveNQueensDFS(int row, int n, char[][] chars, List&lt;List&lt;String&gt;&gt; result) &#123;          if (row == n) &#123;              List&lt;String&gt; list = new ArrayList&lt;&gt;();              for (char[] aChar : chars) &#123;                  list.add(String.copyValueOf(aChar));              &#125;              result.add(list);              return;          &#125;            for (int i = 0; i &lt; n; i++) &#123;              if (isValid(row, i, n, chars)) &#123;                  chars[row][i] = &#x27;Q&#x27;;                  solveNQueensDFS(row + 1, n, chars, result);                  chars[row][i] = &#x27;.&#x27;;              &#125;          &#125;      &#125;        private static boolean isValid(int row, int col, int n, char[][] chars) &#123;          // æ£€æŸ¥åˆ—          for (int i = 0; i &lt; row; ++i) &#123;              if (chars[i][col] == &#x27;Q&#x27;) &#123;                  return false;              &#125;          &#125;            // æ£€æŸ¥45åº¦å¯¹è§’çº¿          for (int i = row - 1, j = col - 1; i &gt;= 0 &amp;&amp; j &gt;= 0; i--, j--) &#123;              if (chars[i][j] == &#x27;Q&#x27;) &#123;                  return false;              &#125;          &#125;            // æ£€æŸ¥135åº¦å¯¹è§’çº¿          for (int i = row - 1, j = col + 1; i &gt;= 0 &amp;&amp; j &lt;= n - 1; i--, j++) &#123;              if (chars[i][j] == &#x27;Q&#x27;) &#123;                  return false;              &#125;          &#125;          return true;      &#125;  &#125;\n37 è§£æ•°ç‹¬\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£ï¼š(https://programmercarl.com/0037.è§£æ•°ç‹¬.html)\npublic class LE37 &#123;      public void solveSudoku(char[][] board) &#123;          solveSudokuDFS(board);      &#125;        private boolean solveSudokuDFS(char[][] board) &#123;          for (int i = 0; i &lt; board.length; i++) &#123;              for (int j = 0; j &lt; board[0].length; j++) &#123;                  if (board[i][j] != &#x27;0&#x27;) &#123;                      continue;                  &#125;                  for (char k = &#x27;1&#x27;; k &lt;= &#x27;9&#x27;; k++) &#123;                      if (isvalid(i, j, k, board)) &#123;                          board[i][j] = k;                            if (solveSudokuDFS(board)) &#123;                              return true;                          &#125;                          board[i][j] = &#x27;.&#x27;;                      &#125;                  &#125;                  // èµ°åˆ°è¿™ä¸€è¡Œï¼Œè¯´æ˜ç›´åˆ°é€’å½’å®Œæ¯•ï¼Œéƒ½æ²¡æœ‰è¿”å›true   return false;              &#125;            &#125;            return true;      &#125;        /**       * åˆ¤æ–­æ£‹ç›˜æ”¾å…¥è¿™ä¸ªæ•°æ˜¯å¦åˆæ³•       *       * @param i     è¡Œ       * @param j     åˆ—       * @param k     å€¼       * @param board æ£‹ç›˜       * @return æ˜¯å¦åˆæ³•       */      private boolean isvalid(int i, int j, char k, char[][] board) &#123;          // è¡Œä¸­æ˜¯å¦å«æœ‰è¿™ä¸ªæ•°          // åˆ—ä¸­æ˜¯å¦å«æœ‰è¿™ä¸ªæ•°          for (int index = 0; index &lt; board.length; index++) &#123;              if (board[i][index] == k) &#123;                  return false;              &#125;              if (board[index][j] == k) &#123;                  return false;              &#125;          &#125;            // 9å®«æ ¼ä¸­æ˜¯å¦å«æœ‰è¿™ä¸ªæ•°          int x = (i / 3) * 3;          int y = (j / 3) * 3;            for (int indexX = x; indexX &lt; x + 3; indexX++) &#123;              for (int indexY = y; indexY &lt; y + 3; indexY++) &#123;                  if (board[indexX][indexY] == k) &#123;                      return false;                  &#125;              &#125;          &#125;            return true;      &#125;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å›æº¯ç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåä¸ƒå¤©-455åˆ†å‘é¥¼å¹²ã€376æ‘†åŠ¨åºåˆ—ã€53æœ€å¤§å­åºå’Œ","url":"/posts/dc3e282a/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š455ACã€376ã€53 éƒ½éœ€è¦çœ‹è§£æï¼Œæ„Ÿè§‰è´ªå¿ƒä¸Šæ¥éƒ½æ˜¯ä¸€ç‚¹æ€è·¯éƒ½æ²¡æœ‰ï¼Œå¯èƒ½é¢˜åšçš„ä¸å¤Ÿå¤šã€‚\n\n\næ›´æ–°\n\n\n24-06-13 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n455 åˆ†å‘é¥¼å¹²\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/assign-cookies)\nå±äºå°é¥¼å¹²ä¼˜å…ˆã€‚\npublic static void main(String[] args) &#123;      int[] g = &#123;10,9,8,7&#125;;      int[] s = &#123;5,6,7,8&#125;;      System.out.println(findContentChildren(g, s));  &#125;      /**   * æ„Ÿè§‰ä¸Šsä»å°æ’åºï¼Œgä»å°æ’åºã€‚æŒ‰åºåˆ†é…å°±è¡Œã€‚   * @param g å­©å­èƒƒå£   * @param s é¥¼å¹²æ•°   * @return ç»“æœ   */  public static int findContentChildren(int[] g, int[] s) &#123;      Arrays.sort(s);      Arrays.sort(g);        int count = 0;      for (int i = 0, j = 0; i &lt; g.length &amp;&amp; j &lt; s.length; j++) &#123;          if (g[i] &lt;= s[j]) &#123;              count++;              i++;          &#125;      &#125;      return count;  &#125;\n376 æ‘†åŠ¨åºåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/wiggle-subsequence)\næ²¡æœ‰æ€è·¯ã€‚çœ‹äº†ä¸€ç‚¹ç‚¹è§£æï¼Œç”»å›¾ã€‚æŠŠå¡åˆ äº†ã€‚ï¼ˆä½†æ˜¯åˆå¿½ç•¥äº†å•è°ƒå¡çš„æƒ…å†µï¼Œå…·ä½“é¢˜è§£åœ¨çœ‹è§£æéƒ¨åˆ†ï¼‰\npublic int wiggleMaxLength(int[] nums) &#123;      if (nums.length &lt;= 1) &#123;          return nums.length;      &#125;      int count = 0;      if (nums[0] != nums[1]) &#123;          if (nums.length == 2) &#123;              return 2;          &#125;          count = 2;      &#125; else &#123;          count = 1;      &#125;      for (int i = 2; i &lt; nums.length; i++) &#123;          int slopePre = nums[i - 1] - nums[i - 2];          int slope = nums[i] - nums[i - 1];            if ((slopePre &gt;= 0  &amp;&amp; slope &lt; 0) || (slopePre &lt;= 0 &amp;&amp; slope &gt; 0)) &#123;              count++;          &#125;      &#125;      return count;  &#125;\n53 æœ€å¤§å­åºå’Œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/maximum-subarray)\næ²¡æœ‰æ€è·¯ã€‚çœ‹äº†éƒ¨åˆ†è§£æï¼Œè¯´æ˜¯è¿ç»­å’Œå¦‚æœå‡ºç°è´Ÿæ•°ï¼Œç›´æ¥æŠ›å¼ƒï¼Œä»ä¸‹ä¸€ä¸ªæ•°å¼€å§‹ã€‚\n// æ€è·¯æ˜¯è¿ç»­å’Œä¸ºè´Ÿï¼Œå°±ç›´æ¥æŠ›å¼ƒè¿ç»­å’Œ  public int maxSubArray(int[] nums) &#123;      int max = Integer.MIN_VALUE;      int sum = 0;        for (int num : nums) &#123;          sum += num;          max = Math.max(sum, max);            if (sum &lt; 0) &#123;              sum = 0;          &#125;      &#125;        return max;  &#125;\nçœ‹è§£æ\n455 åˆ†å‘é¥¼å¹²\nè§£æï¼š(https://programmercarl.com/0455.åˆ†å‘é¥¼å¹².html)\næœ‰ä¸¤ç§æ€è·¯ï¼Œå¤§é¥¼å¹²ä¼˜å…ˆæ»¡è¶³èƒƒå£å¤§çš„ï¼›å°é¥¼å¹²ä¼˜å…ˆæ»¡è¶³èƒƒå£å°çš„ã€‚\n376 æ‘†åŠ¨åºåˆ—\nè§£æï¼š(https://programmercarl.com/0376.æ‘†åŠ¨åºåˆ—.html)\næ€è·¯ï¼š\n\n\næ€æ ·ç®—æœ‰å³°å€¼ (preDiff &gt;= 0  &amp;&amp; curDiff &lt; 0) || (preDiff &lt;= 0 &amp;&amp; curDiff &gt; 0)\n\n\næ•°ç»„é¦–æ€ä¹ˆè®¡æ•°ï¼šé»˜è®¤åŠ ä¸Šä¸€ä¸ªå¹³èŠ‚ç‚¹ï¼Œå³ preDiff ä¸º 0\n\n\nå•è°ƒå¡åº¦æœ‰å¹³å¡ï¼šåªåœ¨å¡åº¦è¿›è¡Œæ›´æ–°çš„æ—¶å€™ï¼Œæ‰æŠŠå‰ä¸€ä¸ªå¡å€¼è¿›è¡Œè®°å½•\n\n\npublic int wiggleMaxLength(int[] nums) &#123;      if (nums.length &lt;= 1) &#123;          return nums.length;      &#125;        // å½“å‰çš„å·®å€¼      int curDiff = 0;      // å‰ä¸€ä¸ªå¡çš„å·®å€¼      int preDiff = 0;      int count = 1;        for (int i = 1; i &lt; nums.length; i++) &#123;          curDiff = nums[i] - nums[i - 1];            if ((preDiff &gt;= 0  &amp;&amp; curDiff &lt; 0) || (preDiff &lt;= 0 &amp;&amp; curDiff &gt; 0)) &#123;              count++;              // åªæœ‰å¡åº¦æ›´æ–°æ‰è®°å½•å¡å€¼              preDiff = curDiff;          &#125;      &#125;        return count;  &#125;\nè¿˜æœ‰ä¸€ä¸ªå·æ‡’ç‰ˆæœ¬æ˜¯å…ˆå»é‡ï¼Œå†æ‰¾å¡ã€‚ä½†æ˜¯è¦å¾ªç¯ä¸¤æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦å˜é«˜ã€‚\n53 æœ€å¤§å­åºå’Œ\nè§£æï¼š(https://programmercarl.com/0053.æœ€å¤§å­åºå’Œ.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["è´ªå¿ƒç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåå…«å¤©-122ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIIã€55 è·³è·ƒæ¸¸æˆã€45è·³è·ƒæ¸¸æˆIIã€1005Kæ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ","url":"/posts/8d31312e/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š122ACï¼Œ55 çœ‹äº†é¢˜è§£ ACï¼Œ45ACï¼Œé¢˜è§£ä»£ç æ›´ç®€å•ä¸€ç‚¹\n\n\næ›´æ–°\n\n\n24-06-14 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n122 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii)\nç”»å›¾å¾ˆç®€å•\n/**   * å°±æ˜¯ç®—æ‰€æœ‰å¢åŒºé—´çš„å€¼   * @param prices åˆ—è¡¨   * @return è‚¡ç¥¨é‡‘é¢   */  public int maxProfit(int[] prices) &#123;      int sum = 0;        for (int i = 1; i &lt; prices.length; i++) &#123;          if (prices[i] &gt;= prices[i - 1]) &#123;              sum +=prices[i] - prices[i - 1];          &#125;      &#125;        return sum;  &#125;\n55 è·³è·ƒæ¸¸æˆ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/jump-game/)\næ²¡æœ‰æ€è·¯ã€‚çœ‹äº†éƒ¨åˆ†é¢˜è§£ï¼Œè¯´æ˜¯æ±‚è¦†ç›–æœ€å¤§çš„èŒƒå›´ã€‚\npublic static boolean canJump(int[] nums) &#123;      int maxIndex = 0;        for (int i = 0; i &lt; nums.length; i++) &#123;          if (i &gt; maxIndex) &#123;              return false;          &#125;  \t\t// è¿™é‡Œçœ‹äº†é¢˜è§£ä¼˜åŒ–äº†ä¸€ä¸‹        maxIndex = Math.max(nums[i] + i, maxIndex);          if (maxIndex &gt;= nums.length - 1)&#123;              return true;          &#125;      &#125;      return false;  &#125;  \n45 è·³è·ƒæ¸¸æˆ II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/jump-game-ii/)\n/**   * å‡è®¾æ¯æ¬¡éƒ½è·³è·ƒåŒºé—´å†…æœ€è¿œçš„è·ç¦»   * @param nums æ•°ç»„   * @return ç»“æœ   */  public static int jump(int[] nums) &#123;      int maxIndex = 0;      int maxJ = 0;      int count = 0;        if (nums.length == 1) &#123;          return count;      &#125;        for (int i = 0; i &lt; nums.length;) &#123;          if (i + nums[i] &gt;= nums.length - 1) &#123;              count++;              return count;          &#125;            for (int j = i + 1; j &lt;= i + nums[i] &amp;&amp; j &lt; nums.length; j++) &#123;                if (j + nums[j] &gt;= maxIndex) &#123;                  maxIndex = j + nums[j];                  maxJ = j;              &#125;          &#125;          count++;          i = maxJ;      &#125;        return count;  &#125;\n1005K æ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/maximize-sum-of-array-after-k-negations)\n/**   * æ€è·¯ï¼šå¯ä»¥å¤šæ¬¡é€‰æ‹©åŒä¸€ä¸ªæ•°å­—ï¼Œè¿”å›æœ€å¤§å’Œï¼Œè¯´æ˜å¯ä»¥å…ˆæ’åº   * 1. ä»å°åˆ°å¤§æ’åˆ—ï¼Œ æŠŠæ‰€æœ‰è´Ÿæ•°å˜æ­£   * 2. è¿˜æœ‰æ¬¡æ•°å‰©ä½™ã€‚å¥‡æ•°æ¬¡å‰©ä½™ï¼Œå°±æŠŠç»å¯¹å€¼æœ€å°çš„ç¿»è½¬ä¸€æ¬¡ã€‚   *   * @param nums æ•°ç»„   * @param k ç¿»è½¬æ¬¡æ•°   * @return ç»“æœ   */  public static int largestSumAfterKNegations(int[] nums, int k) &#123;      Arrays.sort(nums);      int minAbs = Integer.MAX_VALUE;      int index = 0;      int sum = 0;        for (int i = 0; i &lt; nums.length; i++) &#123;            if (Math.abs(nums[i]) &lt; minAbs) &#123;              minAbs = Math.min(minAbs, Math.abs(nums[i]));              index = i;          &#125;            if (k &gt; 0 &amp;&amp; nums[i] &lt; 0) &#123;              nums[i] = -nums[i];              k--;          &#125;          sum += nums[i];      &#125;        if (k % 2 == 1) &#123;          sum -= 2 * nums[index];      &#125;        return sum;  &#125;\nçœ‹è§£æ\n122 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II\nè§£æï¼š(https://programmercarl.com/0122.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII.html)\n55 è·³è·ƒæ¸¸æˆ\nè§£æï¼š(https://programmercarl.com/0055.è·³è·ƒæ¸¸æˆ.html)\n45 è·³è·ƒæ¸¸æˆ II\nè§£æï¼š(https://programmercarl.com/0045.è·³è·ƒæ¸¸æˆII.html)\né¢˜è§£çš„æ€è·¯åœ¨äºå¢åŠ è¦†ç›–èŒƒå›´ã€‚æ¯æ›´æ–°ä¸€æ¬¡è¦†ç›–èŒƒå›´ï¼Œå°±ç»“æœ +1ï¼ˆè¿™é‡Œæ¯”è¾ƒç»•ï¼Œä½†æ˜¯è¿™æ ·å°±ä¸ç”¨åŒå±‚å¾ªç¯äº†ï¼‰ã€‚\nç®€åŒ–ç‰ˆæœ¬ï¼š\npublic int jump(int[] nums) &#123;      int result = 0;      // å½“å‰è¦†ç›–çš„æœ€è¿œè·ç¦»ä¸‹æ ‡      int end = 0;      // ä¸‹ä¸€æ­¥è¦†ç›–çš„æœ€è¿œè·ç¦»ä¸‹æ ‡      int temp = 0;      for (int i = 0; i &lt;= end &amp;&amp; end &lt; nums.length - 1; ++i) &#123;          temp = Math.max(temp, i + nums[i]);          // å¯è¾¾ä½ç½®çš„æ”¹å˜æ¬¡æ•°å°±æ˜¯è·³è·ƒæ¬¡æ•°          if (i == end) &#123;              end = temp;              result++;          &#125;      &#125;      return result;  &#125;\n1005K æ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ\nè§£æï¼š(https://programmercarl.com/1005.Kæ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["è´ªå¿ƒç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬äºŒåä¹å¤©-134åŠ æ²¹ç«™ã€135åˆ†å‘ç³–æœã€860æŸ æª¬æ°´æ‰¾é›¶ã€406æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—","url":"/posts/d65e5e22/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š134AC ä½†æ˜¯æ—¶é—´æ¯”è¾ƒé•¿ã€135 çœ‹äº†éƒ¨åˆ†é¢˜è§£ ACã€860ACï¼ˆä½†æ˜¯ HashMapï¼‰ã€406 ä¸ä¼š\n\n\næ›´æ–°\n\n\n24-06-14 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n134 åŠ æ²¹ç«™\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/gas-station)\n/**   * æ€è·¯ï¼šæœ‰ä¸¤ä¸ª å¼å­ ç›¸-ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ•°ç»„ã€‚   * ç„¶åæ±‚è¿™ä¸ªæ•°ç»„ï¼Œsum &gt; 0 çš„æƒ…å†µã€‚   * ç¯å½¢å¾ªç¯ä¸å¥½å¤„ç†ï¼Œç›´æ¥å°†è·¯çº¿å»¶é•¿ä¸€å€   * @param gas æ±½æ²¹   * @param cost æ¶ˆè€—   * @return ç»“æœ   */  public static int canCompleteCircuit(int[] gas, int[] cost) &#123;      int startIndex = -1;      int sum = 0;        for (int i = 0, j = i; i &lt; gas.length * 2 &amp;&amp; startIndex &lt; gas.length; i++, j++) &#123;          if (startIndex != -1 &amp;&amp; i - startIndex == gas.length) &#123;              break;          &#125;            if (sum == 0 &amp;&amp; i &lt; gas.length) &#123;              startIndex = i;          &#125;            if (j &gt;= gas.length) &#123;              j = i - gas.length;          &#125;            // è·å–æœ¬æ®µè·¯çš„å‰©ä½™æƒ…å†µ          int diff = gas[j] - cost[j];            sum += diff;            if (sum &lt; 0) &#123;              startIndex = -1;              sum = 0;          &#125;      &#125;        return startIndex;  &#125;\n135 åˆ†å‘ç³–æœ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/candy)\næå‰çœ‹äº†ä¸€éƒ¨åˆ†è§£æï¼Œä¸èƒ½åŒæ—¶è€ƒè™‘å·¦å³ï¼ˆæ²¡çœ‹çœŸçš„æƒ³ä¸åˆ°ğŸ¤•ï¼‰ã€‚ä½†æ˜¯å¾ˆæ…¢ã€‚çœ‹äº†è§£æï¼Œå’Œæˆ‘å†™çš„ä¸€æ ·ã€‚\npublic static int candy(int[] ratings) &#123;      if (ratings.length &lt;= 1) &#123;          return ratings.length;      &#125;        int[] result = new int[ratings.length];      result[0] = 1;      for (int i = 1; i &lt; ratings.length; i++) &#123;          if (ratings[i] &gt; ratings[i - 1]) &#123;              result[i] = result[i - 1] + 1;          &#125; else &#123;              result[i] = 1;          &#125;      &#125;      System.out.println(Arrays.toString(result));          for (int i = ratings.length - 2; i &gt;= 0; i--) &#123;          if (ratings[i] &gt; ratings[i + 1] &amp;&amp; result[i] &lt;= result[i + 1]) &#123;              result[i] = result[i + 1] + 1;          &#125;      &#125;      System.out.println(Arrays.toString(result));        return Arrays.stream(result).sum();  &#125;\n860 æŸ æª¬æ°´æ‰¾é›¶\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/lemonade-change)\npublic boolean lemonadeChange(int[] bills) &#123;      Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();      map.put(5, 0);      map.put(10, 0);      map.put(20, 0);        for (int bill : bills) &#123;          // æ”¶é’±          map.put(bill, map.get(bill) + 1);            if (bill == 10) &#123;              if (map.get(5) &lt; 1) &#123;                  return false;              &#125;              map.put(5, map.get(5) - 1);          &#125;          if (bill == 20) &#123;              if (map.get(5) &gt;= 1 &amp;&amp; map.get(10) &gt;= 1) &#123;                  map.put(5, map.get(5) - 1);                  map.put(10, map.get(10) - 1);              &#125; else if (map.get(5) &gt;= 3)&#123;                  map.put(5, map.get(5) - 3);              &#125; else &#123;                  return false;              &#125;          &#125;      &#125;      return true;  &#125;\n406 æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/queue-reconstruction-by-height)\næ²¡æœ‰æ€è·¯ï¼Œè™½ç„¶çœ‹äº†æç¤ºè¦å’Œ 135 ä¸€æ ·åˆ†å¼€å¤„ç†ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰æ€è·¯ã€‚\nçœ‹è§£æ\n134 åŠ æ²¹ç«™\né¢˜è§£ï¼š(https://programmercarl.com/0134.åŠ æ²¹ç«™.html)\nçœ‹äº†è§£æï¼Œæ˜æ˜æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯æ…¢ä¸€ç‚¹ã€‚â—å¿½ç•¥äº†ä¸€ä¸ªç‚¹ï¼Œå¦‚æœæ€»å’Œå¤§äº 0ï¼Œ é‚£ä¹ˆå¿…å®šæœ‰è§£ã€‚æ— è¯­è§£æé‡Œé‚£ä¸ª totalSum çœŸçš„å¤ªå¦™äº†ã€‚\npublic static int canCompleteCircuit(int[] gas, int[] cost) &#123;      int curSum = 0;      int totalSum = 0;      int index = 0;      for (int i = 0; i &lt; gas.length; i++) &#123;          curSum += gas[i] - cost[i];          totalSum += gas[i] - cost[i];          if (curSum &lt; 0) &#123;              index = (i + 1) % gas.length;              curSum = 0;          &#125;      &#125;      if (totalSum &lt; 0) &#123;          return -1;      &#125;      return index;  &#125;\n135 åˆ†å‘ç³–æœ\nè§£æï¼š(https://programmercarl.com/0135.åˆ†å‘ç³–æœ.html)\n860 æŸ æª¬æ°´æ‰¾é›¶\nè§£æï¼š(https://programmercarl.com/0860.æŸ æª¬æ°´æ‰¾é›¶.html)\nä¸ç”¨HashMapï¼Œç›´æ¥ä¸¤ä¸ªintè¿›è¡ŒåŠ å‡ğŸ¤¡public boolean lemonadeChange(int[] bills) &#123;      int five = 0;      int ten = 0;      for (int bill : bills) &#123;          if (bill == 5) &#123;              five++;          &#125; else if (bill == 10) &#123;              ten++;              five--;              if (five &lt; 0) &#123;                  return false;              &#125;          &#125; else if (bill == 20) &#123;              if (five &gt;= 1 &amp;&amp; ten &gt;= 1) &#123;                  five--;                  ten--;              &#125; else if (five &gt;= 3) &#123;                  five -= 3;              &#125; else &#123;                  return false;              &#125;          &#125;      &#125;      return true;  &#125;\n406 æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—\nè§£æï¼š(https://programmercarl.com/0406.æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—.html)\n/**   * æ€è·¯: å…ˆæŒ‰èº«é«˜æ’åº, ç„¶åæ ¹æ®å‰é¢çš„äººæ•°è¿›è¡Œé˜Ÿåˆ—è°ƒæ•´ã€‚   * @param people é˜Ÿä¼éœ€æ±‚   * @return æ’å·çš„é˜Ÿåˆ—   */  public int[][] reconstructQueue(int[][] people) &#123;      Arrays.sort(people, (o1, o2) -&gt; &#123;          if (o1[0] == o2[0]) &#123;              return o1[1] - o2[1];          &#125;          return o2[0] - o1[0];      &#125;);  \t// é˜Ÿåˆ—è°ƒæ•´ç”¨LinkedListã€‚æŒ‰é¡ºåºåœ¨ä¸‹æ ‡ä½ç½®æ’å…¥ï¼Œè¿™æ ·æ¯æ¬¡æ’å…¥çš„å€¼éƒ½åœ¨ç›¸åº”çš„ä¸‹æ ‡ä¸Šã€‚\t// æŠŠæ—§çš„å¤§äºç­‰äºå®ƒçš„å€¼å¾€åè°ƒæ•´ï¼Œä¸å½±å“ä¹‹å‰çš„æ’åºã€‚    LinkedList&lt;int[]&gt; list = new LinkedList&lt;&gt;();        for (int[] person : people) &#123;          list.add(person[1], person);      &#125;        return list.toArray(new int[people.length][]);  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["è´ªå¿ƒç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åå¤©-452ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒã€435æ— é‡å åŒºé—´ã€763åˆ’åˆ†å­—æ¯åŒºé—´","url":"/posts/253a4d3a/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šå¯èƒ½å› ä¸ºç†¬å¤œï¼Œæ€ç»ªéƒ½æ˜¯é£˜çš„ã€‚éƒ½æ˜¯çœ‹äº†è§£æå†™å‡ºæ¥çš„ã€‚\n\n\næ›´æ–°\n\n\n24-06-15 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n452 ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/minimum-number-of-arrows-to-burst-balloons)\næ²¡æœ‰æ€è·¯ã€‚\n435 æ— é‡å åŒºé—´\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/non-overlapping-intervals)\nè¿˜æ˜¯æ²¡æœ‰æ€è·¯ã€‚\n763 åˆ’åˆ†å­—æ¯åŒºé—´\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/partition-labels/description/)\nç›´æ¥çœ‹çš„è§£æã€‚\nçœ‹è§£æ\n452 ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ\nè§£æï¼š(https://programmercarl.com/0452.ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ.html)\n/**   * æ€è·¯ï¼šçœ‹äº†ä¸€ä¸‹é¢˜ç›®å°±æ˜¯è¦æ±‚é‡å çš„åŒºé—´   * å…³é”®åœ¨äºæ›´æ–°æœ€å°å³è¾¹ç•Œ   * @param points åæ ‡ç‚¹   * @return æœ€å°å¼“ç®­æ•°   */  public static int findMinArrowShots(int[][] points) &#123;      Arrays.sort(points, Comparator.comparingInt(o -&gt; o[0]));        if (points.length &lt;= 1) &#123;          return points.length;      &#125;        int count = 1;      for (int i = 1; i &lt; points.length; i++) &#123;          if (points[i][0] &gt; points[i - 1][1]) &#123;              count++;          &#125; else &#123;              points[i][1] = Math.min(points[i][1], points[i - 1][1]);          &#125;      &#125;      return count;  &#125;\n435 æ— é‡å åŒºé—´\nè§£æï¼š(https://programmercarl.com/0435.æ— é‡å åŒºé—´.html)\n/**   * æ€è·¯ï¼šå’Œä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œæ‰¾é‡å çš„ï¼Œç„¶åç§»é™¤äº†   * @param intervals åŒºé—´çš„é›†åˆ   * @return ç»“æœ   */  public static int eraseOverlapIntervals(int[][] intervals) &#123;      Arrays.sort(intervals, Comparator.comparingInt(o -&gt; o[0]));        int count = 0;        if (intervals.length &lt;= 1) &#123;          return count;      &#125;        for (int i = 1; i &lt; intervals.length; i++) &#123;          if (intervals[i][0] &gt;= intervals[i - 1][1])&#123;          &#125; else &#123;              count++;              intervals[i][1] = Math.min(intervals[i][1], intervals[i - 1][1]);          &#125;      &#125;        return count;  &#125;\n763 åˆ’åˆ†å­—æ¯åŒºé—´\nè§£æï¼š(https://programmercarl.com/0763.åˆ’åˆ†å­—æ¯åŒºé—´.html)\n/**   * æ€è·¯ï¼š   * 1. æ‰¾åˆ°æ¯ä¸ªå­—æ¯çš„åŒºé—´   * 2. æ ¹æ®éå†ä¸­æœ€è¿œç»“æŸèŠ‚ç‚¹ï¼Œæ›´æ–°åˆ‡å‰²ä½ç½®   * @param s å­—ç¬¦ä¸²   * @return ç»“æœ   */  public List&lt;Integer&gt; partitionLabels(String s) &#123;      char[] chars = s.toCharArray();        // è®°å½•æ¯ä¸ªå­—æ¯æœ€åå‡ºç°çš„èŠ‚ç‚¹      int[] ints = new int[26];      Arrays.fill(ints, -1);      for (int i = 0; i &lt; chars.length; i++) &#123;          ints[chars[i] - &#x27;a&#x27;] = i;      &#125;        List&lt;Integer&gt; list = new ArrayList&lt;&gt;();        int idx = 0;      // è®°å½•ä¸Šä¸€ä¸ªåˆ‡å‰²çš„ä½ç½®ï¼ˆç”¨äºè®¡ç®—å­˜å…¥listçš„é•¿åº¦ï¼‰      int last = -1;      for (int i = 0; i &lt; chars.length; i++) &#123;          // æŠŠèŠ‚ç‚¹æ›´æ–°ä¸ºè¦ç»“æŸçš„åœ°æ–¹          idx = Math.max(idx, ints[chars[i] - &#x27;a&#x27;]);          // ç›´åˆ°å¯ä»¥ç»“æŸ          if (i == idx) &#123;              list.add(i - last);              last = i;          &#125;      &#125;      return list;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["è´ªå¿ƒç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åä¸€å¤©-56åˆå¹¶åŒºé—´ã€738å•è°ƒé€’å¢çš„æ•°å­—ã€968ç›‘æ§äºŒå‰æ ‘","url":"/posts/28ed1b79/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š56ã€738ACã€‚968 çœ‹æç¤ºè¯´æ¯”è¾ƒéš¾ï¼Œå…ˆå»åšè´ªå¿ƒçš„æ€»ç»“ã€‚968 ä¸ä¼šï¼Œç›´æ¥çœ‹è§£æã€‚\n\n\næ›´æ–°\n\n\n24-06-17 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n56 åˆå¹¶åŒºé—´\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/merge-intervals)\npublic static int[][] merge(int[][] intervals) &#123;      ArrayList&lt;int[]&gt; list = new ArrayList&lt;&gt;();      // æŒ‰å·¦è¾¹ç•Œæ’åº      Arrays.sort(intervals, (o1, o2) -&gt; &#123;          if (o1[0] == o2[0]) &#123;              return o1[1] - o2[1];          &#125;          return o1[0] - o2[0];      &#125;);        if (intervals.length &lt;= 1) &#123;          return intervals;      &#125;        int start = intervals[0][0];      int end = intervals[0][1];      for (int i = 1; i &lt; intervals.length; i++) &#123;          // æ²¡æœ‰é‡åˆåŒºé—´ï¼Œå°†ä¸Šä¸€ä¸ªåˆå¹¶åŒºé—´åŠ å…¥listï¼Œå¹¶æ›´æ–°æœ€æ–°çš„åˆå¹¶åŒºé—´          if (intervals[i][0] &gt; intervals[i - 1][1]) &#123;              list.add(new int[]&#123;start, end&#125;);              start = intervals[i][0];              end = intervals[i][1];          // æ›´æ–°åˆå¹¶çš„å³è¾¹ç•Œ          &#125; else &#123;              end = Math.max(end, intervals[i][1]);              // æ›´æ–°å³è¾¹ç•Œ              intervals[i][1] = end;          &#125;      &#125;      // æœ€åéœ€è¦å°†æœ€åä¸€ä¸ªåˆå¹¶åŒºé—´åŠ å…¥      list.add(new int[]&#123;start, end&#125;);      return list.toArray(new int[list.size()][]);  &#125;\n738 å•è°ƒé€’å¢çš„æ•°å­—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/monotone-increasing-digits)\npublic static int monotoneIncreasingDigits(int n) &#123;      String num = n + &quot;&quot;;      if (num.length() &lt;= 1) &#123;          return n;      &#125;        char[] chars = num.toCharArray();      for (int i = chars.length - 1; i &gt;= 1; i--) &#123;          if (chars[i - 1] &gt; chars[i]) &#123;              chars[i - 1]--;              // ä»iå¼€å§‹éƒ½å˜æˆ9              for (int j = i; j &lt; chars.length; j++) &#123;                  chars[j] = &#x27;9&#x27;;              &#125;          &#125;      &#125;        return Integer.parseInt(String.valueOf(chars));  &#125;// ä¼˜åŒ–äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰å¾ªç¯è¿˜æ˜¯æ”¾å¤–é¢å¥½public static int monotoneIncreasingDigits(int n) &#123;      String num = n + &quot;&quot;;      if (num.length() &lt;= 1) &#123;          return n;      &#125;        int start = -1;      char[] chars = num.toCharArray();      for (int i = chars.length - 1; i &gt;= 1; i--) &#123;          if (chars[i - 1] &gt; chars[i]) &#123;              chars[i - 1]--;              start = i;  //          // ä»iå¼€å§‹éƒ½å˜æˆ9  //          for (int j = i; j &lt; chars.length; j++) &#123;  //              chars[j] = &#x27;9&#x27;;  //          &#125;          &#125;      &#125;      if (start != -1) &#123;          // ä»iå¼€å§‹éƒ½å˜æˆ9          for (int j = start; j &lt; chars.length; j++) &#123;              chars[j] = &#x27;9&#x27;;          &#125;      &#125;        return Integer.parseInt(String.valueOf(chars));  &#125;\n968 ç›‘æ§äºŒå‰æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/binary-tree-cameras)\nçœ‹è§£æ\n56 åˆå¹¶åŒºé—´\nè§£æï¼š(https://programmercarl.com/0056.åˆå¹¶åŒºé—´.html)\n738 å•è°ƒé€’å¢çš„æ•°å­—\nè§£æï¼š(https://programmercarl.com/0738.å•è°ƒé€’å¢çš„æ•°å­—.html)\n968 ç›‘æ§äºŒå‰æ ‘\nè§£æï¼š(https://programmercarl.com/0968.ç›‘æ§äºŒå‰æ ‘.html)\næ€è·¯ï¼šæœ¬é¢˜è¦ä»å¶å­èŠ‚ç‚¹åˆ†æï¼Œè´ªå¿ƒè´ªå¶å­èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ä¸ºæ‘„åƒå¤´ï¼ˆè¿™ç§æƒ…å†µä¸‹æ‘„åƒå¤´æœ€å°‘ï¼‰ã€‚ç„¶åï¼Œæ ¹æ®èŠ‚ç‚¹çŠ¶æ€ï¼Œä¸€å…±åˆ†äº† 3 ç§ï¼š0 æ— è¦†ç›–ï¼›1 æœ‰æ‘„åƒå¤´ï¼›2 æœ‰è¦†ç›–ã€‚æŒ‰ç…§ä¸‹å›¾çš„æ€è·¯åšé¢˜ï¼Œå°±å¯ä»¥è§£å‡ºï¼Œè¿˜æ˜¯æ¯”è¾ƒéš¾æƒ³çš„ã€‚\nå†…é“¾ï¼š[[968ç›‘æ§äºŒå‰æ ‘å›¾ç¤º.excalidraw]]\nå¤–é“¾ï¼š\nint res = 0;  public int minCameraCover(TreeNode root) &#123;      if (minCameraCoverTravel(root) == 0) &#123;          res++;      &#125;      return res;  &#125;    private int minCameraCoverTravel(TreeNode root) &#123;      if (root == null) &#123;          // ç©ºèŠ‚ç‚¹é»˜è®¤ä¸ºæœ‰è¦†ç›–çš„çŠ¶æ€          return 2;      &#125;        // åç»­éå†      int left = minCameraCoverTravel(root.left);      int right = minCameraCoverTravel(root.right);        // å‰ä¸¤ä¸ªifå¯ä»¥äº’æ¢      // æƒ…å†µ1      if (left == 2 &amp;&amp; right == 2) &#123;          return 0;      // æƒ…å†µ2ï¼ŒåŠ ä¸€ä¸ªæ‘„åƒå¤´   &#125; else if (left == 0 || right == 0) &#123;          res++;          return 1;      &#125; else &#123;          return 2;      &#125;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["è´ªå¿ƒç®—æ³•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åäºŒå¤©-509æ–æ³¢é‚£å¥‘æ•°ã€70çˆ¬æ¥¼æ¢¯ã€746ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯","url":"/posts/bae90a3d/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šåŠ¨æ€è§„åˆ’ä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡ï¼ŒåŸºæœ¬éƒ½ä¸ä¼šã€‚çœ‹äº†å‰é¢ä¸¤é¢˜ 746 æŒ‰ç…§è§£é¢˜æ–¹æ³• AC äº†ã€‚\n\n\næ›´æ–°\n\n\n24-06-18 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n509 æ–æ³¢é‚£å¥‘æ•°\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/fibonacci-number)\n// é€’å½’åšæ³•public int fib(int n) &#123;      if (n == 0) &#123;          return 0;      &#125;      if (n == 1) &#123;          return 1;      &#125;        return fib(n - 1) + fib(n - 2);  &#125;\n70 çˆ¬æ¥¼æ¢¯\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/climbing-stairs/)\nä¸ä¼šã€‚\n746 ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/min-cost-climbing-stairs/)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šçˆ¬åˆ° i å°é˜¶éœ€è¦çš„æœ€å°èŠ±è´¹\n\n\né€’æ¨å…¬å¼ï¼šMath.min(dp[i - 1] + cost[i - 1], dp[i - 2] + cost[i - 2])\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ– dp[0] = 0ã€dp[1] = 1\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic static void main(String[] args) &#123;      int[] cost = &#123;1, 100, 1, 1, 1, 100, 1, 1, 100, 1&#125;;      minCostClimbingStairs(cost);  &#125;  public static int minCostClimbingStairs(int[] cost) &#123;      int[] dp = new int[cost.length + 1];      dp[0] = 0;      dp[1] = 0;        for (int i = 2; i &lt; dp.length; i++) &#123;          dp[i] = Math.min(dp[i - 1] + cost[i - 1], dp[i - 2] + cost[i - 2]);      &#125;        System.out.println(Arrays.toString(dp));        return dp[cost.length];  &#125;\nçœ‹è§£æ\n509 æ–æ³¢é‚£å¥‘æ•°\né¢˜è§£ï¼š(https://programmercarl.com/0509.æ–æ³¢é‚£å¥‘æ•°.html)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šç¬¬ i ä¸ªæ–æ³¢é‚£å¥‘æ•°\n\n\né€’æ¨å…¬å¼ï¼šdp[i] = dp[i - 1] + dp[i - 2]\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ– dp[0] = 1ã€dp[1] = 1\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic static int fibBp(int n) &#123;      if (n &lt;= 1) &#123;          return n;      &#125;      int[] dp = new int[n + 1];      dp[0] = 0;      dp[1] = 1;      for (int i = 2; i &lt;= n; i++) &#123;          dp[i] = dp[i - 1] + dp[i - 2];      &#125;        System.out.println(Arrays.toString(dp));        return dp[n];  &#125;// åªç»´æŠ¤ä¸¤ä¸ªæ•°å€¼çš„ç‰ˆæœ¬public int fib(int n) &#123;    if(n == 0) return 0;    if(n == 1) return 1;    int[] dp = new int[2];    dp[0] = 0;    dp[1] = 1;    for(int i = 2 ; i &lt; n+1 ; i++)&#123;        int sum  = dp[0] + dp[1];        dp[0] = dp[1];        dp[1] = sum;    &#125;    return dp[1];&#125;\n70 çˆ¬æ¥¼æ¢¯\nè§£æï¼š(https://programmercarl.com/0070.çˆ¬æ¥¼æ¢¯.html)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šçˆ¬ i é˜¶æœ‰å‡ ç§æ–¹æ³•\n\n\né€’æ¨å…¬å¼ï¼šdp[i] = dp[i - 1] + dp[i - 2]è¿™é‡Œæœ‰ç‚¹éš¾ç†è§£ï¼šå› ä¸ºèµ°åˆ° i é˜¶åªæœ‰ä¸¤ç§æƒ…å†µï¼Œ1ï¸âƒ£ä» i - 2 åˆ° i èµ°ä¸¤æ­¥ï¼›2ï¸âƒ£ä» i - 1 åˆ° i èµ°ä¸¤æ­¥ã€‚æ‰€ä»¥åˆ° i é˜¶çš„æ€»æ–¹æ³•æ•° : dp[i] = dp[i - 1] + dp[i - 2]\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ– dp[1] = 1ã€dp[2] = 2ã€‚æ ¹æ®é¢˜ç›®æè¿°ï¼Œn &gt; 0 æ‰€ä»¥è¿™é‡Œè¿™ä¹ˆè®¾ç½®ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int climbStairs(int n) &#123;      if (n &lt;= 2) &#123;          return n;      &#125;        int[] dp = new int[n + 1];      dp[1] = 1;      dp[2] = 2;      for (int i = 3; i &lt;= n; i++) &#123;          dp[i] = dp[i - 1] + dp[i - 2];      &#125;        return dp[n];  &#125;\n746 ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯\nè§£æï¼š(https://programmercarl.com/0746.ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åå››å¤©-01èƒŒåŒ…é—®é¢˜ äºŒç»´ã€01èƒŒåŒ…é—®é¢˜ ä¸€ç»´ã€416åˆ†å‰²ç­‰å’Œå­é›†","url":"/posts/23390fe6/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šå‰ä¸¤é¢˜ä¸ºèƒŒåŒ…åŸºç¡€é¢˜ï¼Œç›´æ¥çœ‹çš„é¢˜è§£ã€‚416 ä¹Ÿæ˜¯çœ‹çš„è§£æã€‚\n\n\næ›´æ–°\n\n\n24-06-20 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n416 åˆ†å‰²ç­‰å’Œå­é›†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/partition-equal-subset-sum)\nçœ‹è§£æ\n01 èƒŒåŒ…é—®é¢˜ äºŒç»´\né¢˜ç›®é“¾æ¥ + è§£æï¼š(https://programmercarl.com/èƒŒåŒ…ç†è®ºåŸºç¡€01èƒŒåŒ…-1.html)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šä»ä¸‹æ ‡ä¸º [0-i] çš„ç‰©å“é‡Œä»»æ„å–ï¼Œæ”¾è¿›å®¹é‡ä¸º j çš„èƒŒåŒ…ï¼Œä»·å€¼æ€»å’Œæœ€å¤§æ˜¯å¤šå°‘ã€‚\n\n\né€’æ¨å…¬å¼ï¼šdp[i][j] = Math.max(dp[i - 1][j], dp[i - 1][j - weight[i]] + value[i])ï¼ˆå³ï¼Œä¸å­˜æ”¾å½“å‰ç‰©å“/å­˜æ”¾å½“å‰ç‰©å“ï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[i][0] å‡ä¸º 0ï¼Œdp[0][j] éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ¥ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic static void main(String[] args) &#123;      integerBreak(4, new int[][]&#123;&#123;1, 15&#125;, &#123;3, 20&#125;, &#123;4, 30&#125;&#125;);  &#125;    /**   * äºŒç»´æ•°ç»„è§£æ³•   * @param n èƒŒåŒ…å¤§å°   * @param item ç‰©å“åŠé‡é‡åŠä»·å€¼   */public static void integerBreak(int n, int[][] item) &#123;      int[][] dp = new int[item.length][n + 1];        for (int i = 1; i &lt; dp[0].length &amp;&amp; n &gt;= item[0][0]; i++) &#123;          dp[0][i] = item[0][1];      &#125;        for (int i = 1; i &lt; item.length; i++) &#123;          for (int j = 1; j &lt;= n; j++) &#123;              if (j - item[i][0] &lt; 0) &#123;                  dp[i][j] = dp[i - 1][j];              &#125;else &#123;                  dp[i][j] = Math.max(dp[i - 1][j], dp[i - 1][j - item[i][0]] + item[i][1]);              &#125;          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));  &#125;\n01 èƒŒåŒ…é—®é¢˜ ä¸€ç»´\né¢˜ç›®é“¾æ¥ + è§£æï¼š(https://programmercarl.com/èƒŒåŒ…ç†è®ºåŸºç¡€01èƒŒåŒ…-2)\n\n\nç¡®å®š dp[j] çš„å«ä¹‰ï¼šä»ç‰©å“é‡Œä»»æ„å–ï¼Œæ”¾è¿›å®¹é‡ä¸º j çš„èƒŒåŒ…ï¼Œä»·å€¼æ€»å’Œæœ€å¤§æ˜¯å¤šå°‘ã€‚\n\n\né€’æ¨å…¬å¼ï¼šdp[j] = Math.max(dp[j], dp[j - weight[i]] + value[i])ï¼ˆå³ï¼Œè¦ä¹ˆç­‰äºåŸå€¼ï¼Œè¦ä¹ˆç­‰äºæ”¾å…¥ç‰©å“çš„å€¼ï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = 0ã€‚\n\n\néå†é¡ºåºï¼šä»åå‘å‰éå†ã€‚ï¼ˆè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå› ä¸ºé€’æ¨å…¬å¼å†…éœ€è¦ä¸Šä¸€å±‚çš„åŸå€¼ï¼Œåªæœ‰å€’åºéå†ï¼Œå¯ä»¥è·å–ä¸Šä¸€å±‚çš„åŸå€¼ã€‚ï¼‰\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\n/**   * ä¸€ç»´æ•°ç»„è§£æ³•   * @param n èƒŒåŒ…å¤§å°   * @param item ç‰©å“åŠé‡é‡åŠä»·å€¼   */  public void integerBreak1(int n, int[][] item) &#123;      int[] dp = new int[n + 1];        for (int[] ints : item) &#123;          for (int j = dp.length - 1; j &gt;= ints[0]; j--) &#123;                dp[j] = Math.max(dp[j], dp[j - ints[0]] + ints[1]);          &#125;      &#125;        System.out.println(Arrays.toString(dp));  &#125;\n416 åˆ†å‰²ç­‰å’Œå­é›†\nè§£æï¼š(https://programmercarl.com/0416.åˆ†å‰²ç­‰å’Œå­é›†.html)\n\n\nç¡®å®š dp[j] çš„å«ä¹‰ï¼šä»ç‰©å“é‡Œä»»æ„å–ï¼Œæ±‚æ€»é‡çš„æœ€å¤§å€¼ï¼Œåˆ¤æ–­æ˜¯å¦ç­‰äº j å³ sum/2ã€‚è¿™é¢˜è¦æŠ½è±¡ï¼Œè®¾ç½® i ä½ç½®çš„é‡é‡å’Œä»·å€¼éƒ½ä¸º i\n\n\né€’æ¨å…¬å¼ï¼šdp[j] = Math.max(dp[j], dp[j - weight[i]] + value[i])ï¼ˆå¦‚æœ dp[j] == j è¯´æ˜ï¼Œé›†åˆä¸­çš„å­é›†æ€»å’Œæ­£å¥½å¯ä»¥å‡‘æˆæ€»å’Œ jï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šå› ä¸ºæ˜¯æ­£æ•´æ•°æ•°ç»„ï¼Œæ‰€ä»¥å¯ä»¥åˆå§‹åŒ–ä¸º 0ã€‚\n\n\néå†é¡ºåºï¼šä»åå‘å‰éå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic boolean canPartition(int[] nums) &#123;      int sum = Arrays.stream(nums).sum();      if (sum % 2 != 0) &#123;          return false;      &#125;        int[] dp = new int[sum / 2 + 1];        for (int num : nums) &#123;          for (int j = dp.length - 1; j &gt;= num; j--) &#123;                dp[j] = Math.max(dp[j], dp[j - num] + num);          &#125;          if (dp[sum / 2] == sum / 2) &#123;              return true;          &#125;      &#125;      return false;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’","01èƒŒåŒ…"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åäº”å¤©-1049æœ€åä¸€å—çŸ³å¤´çš„é‡é‡ IIã€494ç›®æ ‡å’Œã€474ä¸€å’Œé›¶","url":"/posts/bde30672/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š1049 å’Œæ˜¨å¤©é‚£é¢˜å·®ä¸å¤šã€‚494ã€474ã€‚ã€‚ã€‚â˜ ï¸åŠ¨è§„è¿˜æ˜¯å…ˆäº†è§£è§£æ³•ã€‚åé¢åˆ·åˆ«çš„é¢˜ç»„çš„æ—¶å€™å†è¯´ã€‚\n\n\næ›´æ–°\n\n\n24-06-21 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n1049 æœ€åä¸€å—çŸ³å¤´çš„é‡é‡ II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/last-stone-weight-ii)\næœ¬é¢˜å¯ä»¥æŠ½è±¡æˆè®©çŸ³å¤´åˆ†æˆå°½é‡ç›¸åŒçš„ä¸¤å †ï¼Œç„¶åè¿›è¡Œç›¸æ’ã€‚å³èƒŒåŒ…å¤§å°ä¸ºæ€»å’Œé™¤ä»¥ 2ï¼Œæ±‚èƒ½æ”¾å…¥çš„æœ€å¤§ä»·å€¼ã€‚\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šä»çŸ³å¤´é‡Œä»»å–ï¼ŒèƒŒåŒ…å¤§å°ä¸º iï¼Œèƒ½æ”¾å…¥çš„æœ€å¤§ä»·å€¼ã€‚weight[i] = store[i]ï¼Œvalue[i] = store[i]ã€‚\n\n\né€’æ¨å…¬å¼ï¼šdp[i] = Math.max(dp[i], dp[i - weight[j]] + value[j])ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = 0ã€‚\n\n\néå†é¡ºåºï¼šä»åå‘å‰éå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int lastStoneWeightII(int[] stones) &#123;      int sum = Arrays.stream(stones).sum();        int[] dp = new int[sum / 2 + 1];        for (int stone : stones) &#123;          for (int j = dp.length - 1; j &gt;= 0; j--) &#123;              if (j &gt;= stone) &#123;  \t\t\t    dp[j] = Math.max(dp[j], dp[j - stone] + stone);  \t\t\t&#125;         &#125;      &#125;        return sum - dp[sum / 2] * 2;  &#125;\n494 ç›®æ ‡å’Œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/target-sum)\nå®Œå…¨æ²¡æ€è·¯\n474 ä¸€å’Œé›¶\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/ones-and-zeroes)\nçœ‹ä¸æ‡‚ï¼Œé¢˜ç›®éƒ½çœ‹ä¸æ‡‚â˜ ï¸\nçœ‹è§£æ\n1049 æœ€åä¸€å—çŸ³å¤´çš„é‡é‡ II\nè§£æï¼š(https://programmercarl.com/1049.æœ€åä¸€å—çŸ³å¤´çš„é‡é‡II.html)\n494 ç›®æ ‡å’Œ\nè§£æï¼š(https://programmercarl.com/0494.ç›®æ ‡å’Œ.html)\nå‡è®¾æ­£æ•°é›†åˆæ€»å’Œæ˜¯ leftï¼Œè´Ÿæ•°é›†åˆæ€»å’Œæ˜¯ rightã€‚æ€»å’Œ sum = left + rightã€‚ç›®æ ‡å€¼ target = left - rightã€‚å¯ä»¥å¾—åˆ° left å³æ­£æ•°ä¹‹å’Œ = (sum + target)/2ã€‚\næœ¬é¢˜æ˜¯è£…æ»¡æœ‰å‡ ç§æ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»„åˆé—®é¢˜ï¼Œç”¨çš„è§£æ³•å°±å’Œä¹‹å‰ä¸ä¸€æ ·ã€‚\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šå¡«æ»¡ iï¼ˆåŒ…æ‹¬ iï¼‰è¿™ä¹ˆå¤§å®¹ç§¯çš„åŒ…ï¼Œæœ‰ dp[i] ç§æ–¹æ³•\n\n\né€’æ¨å…¬å¼ï¼šdp[j] += dp[j - nums[i]]ã€‚\n\n\n\n\n\nå·²ç»æœ‰ä¸€ä¸ª 1ï¼ˆnums[i]ï¼‰ çš„è¯ï¼Œæœ‰ dp[4] ç§æ–¹æ³• å‡‘æˆ å®¹é‡ä¸º 5 çš„èƒŒåŒ…ã€‚\n\n\nå·²ç»æœ‰ä¸€ä¸ª 2ï¼ˆnums[i]ï¼‰ çš„è¯ï¼Œæœ‰ dp[3] ç§æ–¹æ³• å‡‘æˆ å®¹é‡ä¸º 5 çš„èƒŒåŒ…ã€‚\n\n\nå·²ç»æœ‰ä¸€ä¸ª 3ï¼ˆnums[i]ï¼‰ çš„è¯ï¼Œæœ‰ dp[2] ç§æ–¹æ³• å‡‘æˆ å®¹é‡ä¸º 5 çš„èƒŒåŒ…\n\n\nå·²ç»æœ‰ä¸€ä¸ª 4ï¼ˆnums[i]ï¼‰ çš„è¯ï¼Œæœ‰ dp[1] ç§æ–¹æ³• å‡‘æˆ å®¹é‡ä¸º 5 çš„èƒŒåŒ…\n\n\nå·²ç»æœ‰ä¸€ä¸ª 5 ï¼ˆnums[i]ï¼‰çš„è¯ï¼Œæœ‰ dp[0] ç§æ–¹æ³• å‡‘æˆ å®¹é‡ä¸º 5 çš„èƒŒåŒ…\n\n\né‚£ä¹ˆå‡‘æ•´ dp[5] æœ‰å¤šå°‘æ–¹æ³•å‘¢ï¼Œä¹Ÿå°±æ˜¯æŠŠ æ‰€æœ‰çš„ dp[j - nums[i]] ç´¯åŠ èµ·æ¥ã€‚\n\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = 1ã€‚å‡è®¾æ•°ç»„ä¸ªæ•°ä¸º 0ï¼Œè·å– dp[0]ï¼Œå°±æ˜¯ 1ã€‚\n\n\néå†é¡ºåºï¼šä»åå‘å‰éå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int findTargetSumWays(int[] nums, int target) &#123;      int sum = Arrays.stream(nums).sum();      if ((sum + target) % 2 == 1) &#123;          return 0;      &#125;        if (sum &lt; Math.abs(target)) &#123;          return 0;      &#125;        int left = (sum + target) / 2;      int[] dp = new int[left + 1];      dp[0] = 1;      for (int num : nums) &#123;          for (int j = dp.length - 1; j &gt;= num; j--) &#123;  \t\t    // è¿™é‡Œæ¯”è¾ƒéš¾ç†è§£            dp[j] += dp[j - num];          &#125;      &#125;        System.out.println(Arrays.toString(dp));        return dp[left];  &#125;\n474 ä¸€å’Œé›¶\nè§£æï¼š(https://programmercarl.com/0474.ä¸€å’Œé›¶.html)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šæœ€å¤šæœ‰ i ä¸ª 0 å’Œ j ä¸ª 1 çš„ strs çš„æœ€å¤§å­é›†çš„å¤§å°ä¸º dp[i][j]ã€‚ç‰©å“çš„é‡é‡æ˜¯ 0 çš„ä¸ªæ•°ï¼Œ1 çš„ä¸ªæ•°ã€‚ä»·å€¼å°±æ˜¯ 1ã€‚ï¼ˆéš¾ç‚¹åœ¨äºŒç»´æ•°ç»„ã€‚ã€‚åæ­£çœ‹äº†è§£æåˆæ„Ÿè§‰æ‡‚äº†ï¼Œè‡ªå·±å†™åˆä¸ä¼šâ˜ ï¸ï¼‰\n\n\né€’æ¨å…¬å¼ï¼šdp[i][j] = Math.max(dp[i][j], dp[i - x][j - y]) + 1ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0][0] = 0ã€‚\n\n\néå†é¡ºåºï¼šä»åå‘å‰éå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int findMaxForm(String[] strs, int m, int n) &#123;      int[][] dp = new int[m + 1][n + 1];        // è¿™é‡Œxè®¡ç®—0çš„æ•°é‡ï¼Œ yè®¡ç®—1çš„æ•°é‡      int x, y;      for (String str : strs) &#123;          x = 0;          y = 0;          char[] chars = str.toCharArray();          for (char c : chars) &#123;              if (c == &#x27;0&#x27;) &#123;                  x++;              &#125; else &#123;                  y++;              &#125;          &#125;            for (int i = m; i &gt;= 0; i--) &#123;              for (int j = n; j &gt;= 0; j--) &#123;                  if (i &gt;= x &amp;&amp; j &gt;= y) &#123;                      dp[i][j] = Math.max(dp[i][j], dp[i - x][j - y] + 1);                  &#125;              &#125;          &#125;      &#125;      return dp[m][n];  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’","01èƒŒåŒ…"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åä¸‰å¤©-62ä¸åŒè·¯å¾„ã€63ä¸åŒè·¯å¾„ IIã€343 æ•´æ•°æ‹†åˆ†ã€96ä¸åŒçš„äºŒå‰æœç´¢æ ‘","url":"/posts/5da9e7f4/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š62ACã€63ACã€343 ä¸ä¼šã€‚96 ä¸€åˆ·å…ˆè·³è¿‡ã€‚\n\n\næ›´æ–°\n\n\n24-06-19 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n62 ä¸åŒè·¯å¾„\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/unique-paths)\n\n\nç¡®å®š dp[m][n] çš„å«ä¹‰ï¼šç½‘æ ¼å¤§å°ä¸º m x n æ—¶çš„è·¯å¾„æ•°\n\n\né€’æ¨å…¬å¼ï¼šdp[m][n] = dp[m][n-1] + dp[m-1][n]\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šæ‰€æœ‰çºµåˆ—æ¨ªåˆ—ä¸º 1 çš„ï¼Œéƒ½æ˜¯ 1ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic static int uniquePaths(int m, int n) &#123;      int[][] dp = new int[m + 1][n + 1];        if (m &lt;= 1 || n &lt;= 1) &#123;          return 1;      &#125;          for (int i = 1; i &lt;= m; i++) &#123;          for (int j = 1; j &lt;= n; j++) &#123;              if (i == 1 || j == 1) &#123;                  dp[i][j] = 1;                  continue;              &#125;                dp[i][j] = dp[i - 1][j] + dp[i][j - 1];          &#125;      &#125;            return dp[m][n];  &#125;\n63 ä¸åŒè·¯å¾„ II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/unique-paths-ii)\nè¿™é¢˜çš„äº”éƒ¨æ›²åˆ†æåº”è¯¥å’Œä¸Šé¢˜ä¸€æ ·ã€‚å¤šäº†éšœç¢æ ¼å­ï¼Œé‡åˆ°éšœç¢æ ¼å­æ—¶ï¼Œæ•°è®¡ 0 ï¼ˆæ³¨æ„ä¸€ä¸‹è¾¹ç•Œé—®é¢˜å°±è¡Œï¼‰ã€‚\npublic int uniquePathsWithObstacles(int[][] obstacleGrid) &#123;      int m = obstacleGrid.length;      int n = obstacleGrid[0].length;      int[][] dp = new int[m][n];        for (int i = 0; i &lt; m; i++) &#123;          for (int j = 0; j &lt; n; j++) &#123;              if (obstacleGrid[i][j] == 1) &#123;                  dp[i][j] = 0;                  continue;              &#125;                if (i == 0 &amp;&amp; j == 0) &#123;                dp[i][j] = 1;              &#125; else if (i == 0) &#123;                  dp[i][j] = dp[i][j - 1];              &#125; else if (j == 0) &#123;                  dp[i][j] = dp[i - 1][j];              &#125; else &#123;                  dp[i][j] = dp[i - 1][j] + dp[i][j - 1];              &#125;          &#125;      &#125;        // System.out.println(&quot;dp = &quot; + Arrays.deepToString(dp));        return dp[m - 1][n - 1];  &#125;\n343 æ•´æ•°æ‹†åˆ†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/integer-break/)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šæ­£æ•´æ•° i çš„æ‹†åˆ†æœ€å¤§åŒ–ä¹˜ç§¯ã€‚\n\n\né€’æ¨å…¬å¼ï¼šæƒ³ä¸å‡ºæ¥ã€‚ğŸ¤•\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[2] = 1ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\n96 ä¸åŒçš„äºŒå‰æœç´¢æ ‘\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/unique-binary-search-trees)\nçœ‹è§£æ\n62 ä¸åŒè·¯å¾„\nè§£æï¼š(https://programmercarl.com/0062.ä¸åŒè·¯å¾„.html)\næœ‰ä¸€ä¸ªçŠ¶æ€å‹ç¼©ç‰ˆæœ¬ï¼š\nclass Solution &#123;    public int uniquePaths(int m, int n) &#123;        // åœ¨äºŒç»´dpæ•°ç»„ä¸­ï¼Œå½“å‰å€¼çš„è®¡ç®—åªä¾èµ–æ­£ä¸Šæ–¹å’Œæ­£å·¦æ–¹ï¼Œå› æ­¤å¯ä»¥å‹ç¼©æˆä¸€ç»´æ•°ç»„ã€‚        int[] dp = new int[n];        // åˆå§‹åŒ–ï¼Œç¬¬ä¸€è¡Œåªèƒ½ä»æ­£å·¦æ–¹è·³è¿‡æ¥ï¼Œæ‰€ä»¥åªæœ‰ä¸€æ¡è·¯å¾„ã€‚        Arrays.fill(dp, 1);        for (int i = 1; i &lt; m; i ++) &#123;            // ç¬¬ä¸€åˆ—ä¹Ÿåªæœ‰ä¸€æ¡è·¯ï¼Œä¸ç”¨è¿­ä»£ï¼Œæ‰€ä»¥ä»ç¬¬äºŒåˆ—å¼€å§‹            for (int j = 1; j &lt; n; j ++) &#123;                dp[j] += dp[j - 1]; // dp[j] = dp[j] (æ­£ä¸Šæ–¹)+ dp[j - 1] (æ­£å·¦æ–¹)            &#125;        &#125;        return dp[n - 1];    &#125;&#125;\n63 ä¸åŒè·¯å¾„ II\nè§£æï¼š(https://programmercarl.com/0063.ä¸åŒè·¯å¾„II.html)\n343 æ•´æ•°æ‹†åˆ†\nè§£æï¼š(https://programmercarl.com/0343.æ•´æ•°æ‹†åˆ†.html)\nä¸æ˜¯å¾ˆæ‡‚ï¼Œä¸€åˆ·å…ˆè·³è¿‡äº†ã€‚\npublic static int integerBreak(int n) &#123;      int[] dp = new int[n + 1];        dp[2] = 1;        for (int i = 3; i &lt;= n; i++) &#123;          for (int j = 1; j &lt;= i - j; j++) &#123;              // è¿™é‡Œçš„ j å…¶å®æœ€å¤§å€¼ä¸º i-j,å†å¤§åªä¸è¿‡æ˜¯é‡å¤è€Œå·²ï¼Œ              // å¹¶ä¸”ï¼Œåœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬åˆ†æ dp[0], dp[1]éƒ½æ˜¯æ— æ„ä¹‰çš„ï¼Œ              // j æœ€å¤§åˆ° i-j,å°±ä¸ä¼šç”¨åˆ° dp[0]ä¸dp[1]              dp[i] = Math.max(dp[i], Math.max(j * (i - j), j * dp[i - j]));              // j * (i - j) æ˜¯å•çº¯çš„æŠŠæ•´æ•° i æ‹†åˆ†ä¸ºä¸¤ä¸ªæ•° ä¹Ÿå°±æ˜¯ i,i-j ï¼Œå†ç›¸ä¹˜              //è€Œj * dp[i - j]æ˜¯å°† i æ‹†åˆ†æˆä¸¤ä¸ªä»¥åŠä¸¤ä¸ªä»¥ä¸Šçš„ä¸ªæ•°,å†ç›¸ä¹˜ã€‚          &#125;      &#125;      return dp[n];  &#125;\næœ¬é¢˜ä¹Ÿå¯ä»¥ç”¨è´ªå¿ƒï¼Œæ¯æ¬¡æ‹†æˆ n ä¸ª 3ï¼Œå¦‚æœå‰©ä¸‹æ˜¯ 4ï¼Œåˆ™ä¿ç•™ 4ï¼Œç„¶åç›¸ä¹˜ï¼Œä½†æ˜¯è¿™ä¸ªç»“è®ºéœ€è¦æ•°å­¦è¯æ˜å…¶åˆç†æ€§ï¼ ğŸ¥´æœ¬æ¥æƒ³è¿™ä¹ˆå†™çš„ï¼Œä½†æ˜¯å¥½åƒæƒ³é”™äº†ã€‚å…·ä½“çš„æ•°å­¦æ¨å¯¼ï¼š(https://leetcode.cn/problems/integer-break/solutions/29098/343-zheng-shu-chai-fen-tan-xin-by-jyd/)\n96 ä¸åŒçš„äºŒå‰æœç´¢æ ‘\nè§£æï¼š(https://programmercarl.com/0096.ä¸åŒçš„äºŒå‰æœç´¢æ ‘.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åå…­å¤©-å®Œå…¨èƒŒåŒ…ã€518é›¶é’±å…‘æ¢ IIã€377ç»„åˆæ€»å’Œ â…£ã€CM70çˆ¬æ¥¼æ¢¯ï¼ˆè¿›é˜¶ï¼‰","url":"/posts/b717497e/","content":"\n\nå‰è¨€çŠ¶æ€ï¼šçœ‹å®Œå®Œå…¨ç»„åˆçš„è§£æä¹‹åï¼Œå®Œæˆ 518 å’Œ 377ã€‚CM70å°±æ˜¯377ã€‚\n\n\næ›´æ–°\n\n\n24-06-22 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n518 é›¶é’±å…‘æ¢ II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/coin-change-ii/)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šå¡«æ»¡ iï¼ˆåŒ…æ‹¬ iï¼‰è¿™ä¹ˆå¤§å®¹ç§¯çš„åŒ…ï¼Œæœ‰ dp[i] ç§æ–¹æ³•\n\n\né€’æ¨å…¬å¼ï¼šdp[i] += dp[i - coin]ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = 1ã€‚å‡è®¾æ•°ç»„ä¸ªæ•°ä¸º 0ï¼Œè·å– dp[0]ï¼Œå°±æ˜¯ 1ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\n/**   * æ€è·¯ï¼š   * 1. è¿™æ˜¯ä¸€ä¸ªå®Œå…¨èƒŒåŒ…çš„é¢˜ç›®ï¼ˆæ­£åºï¼‰   * 2. æ±‚çš„æ˜¯ç»„åˆæ•°é‡ dp[i] += dp[i - coin];   * @param amount æ€»æ•°   * @param coins ç¡¬å¸æ€»å’Œ   * @return æœ‰å‡ ç§ç»„åˆæ–¹æ³•   */  public static int change(int amount, int[] coins) &#123;      // å¡«æ»¡ iï¼ˆåŒ…æ‹¬ iï¼‰è¿™ä¹ˆå¤§å®¹ç§¯çš„åŒ…ï¼Œæœ‰ `dp[i]` ç§æ–¹æ³•      int[] dp = new int[amount + 1];        dp[0] = 1;        for (int coin : coins) &#123;          for (int i = coin; i &lt; dp.length; i++) &#123;              dp[i] += dp[i - coin];          &#125;      &#125;        System.out.println(Arrays.toString(dp));        return dp[amount];  &#125;\n377 ç»„åˆæ€»å’Œ â…£\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/combination-sum-iv)\nå¦‚æœæ±‚ç»„åˆæ•°å°±æ˜¯å¤–å±‚ for å¾ªç¯éå†ç‰©å“ï¼Œå†…å±‚ for éå†èƒŒåŒ…ã€‚\nå¦‚æœæ±‚æ’åˆ—æ•°å°±æ˜¯å¤–å±‚ for éå†èƒŒåŒ…ï¼Œå†…å±‚ for å¾ªç¯éå†ç‰©å“ã€‚\n/**   * å®Œå…¨èƒŒåŒ…+æ’åˆ— *   * @param nums   æ•°ç»„   * @param target æ€»æ•°   * @return æœ‰å‡ ç§æ’åˆ— */  public static int combinationSum4(int[] nums, int target) &#123;      int[] dp = new int[target + 1];        dp[0] = 1;      for (int i = 0; i &lt; dp.length; i++) &#123;          for (int num : nums) &#123;              if (i &gt;= num) &#123;                  dp[i] += dp[i - num];              &#125;          &#125;      &#125;        System.out.println(Arrays.toString(dp));        return dp[target];  &#125;\n70 çˆ¬æ¥¼æ¢¯ ï¼ˆè¿›é˜¶ï¼‰\né¢˜ç›®é“¾æ¥ï¼š(https://kamacoder.com/problempage.php?pid=1067)\nå°±æ˜¯å®Œå…¨èƒŒåŒ… + æ’åˆ—ï¼Œè§£æ³•å’Œä¸Šé¢˜ä¸€æ¨¡ä¸€æ ·ã€‚nums å–å€¼ä¸º 1- æ¯æ¬¡æœ€å¤šçˆ¬çš„é˜¶æ¢¯æ•°é‡\nçœ‹è§£æ\nå®Œå…¨èƒŒåŒ…\næœ‰ N ä»¶ç‰©å“å’Œä¸€ä¸ªæœ€å¤šèƒ½èƒŒé‡é‡ä¸º W çš„èƒŒåŒ…ã€‚ç¬¬ i ä»¶ç‰©å“çš„é‡é‡æ˜¯ weight[i]ï¼Œå¾—åˆ°çš„ä»·å€¼æ˜¯ value[i] ã€‚æ¯ä»¶ç‰©å“éƒ½æœ‰æ— é™ä¸ªï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥æ”¾å…¥èƒŒåŒ…å¤šæ¬¡ï¼‰ï¼Œæ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…é‡Œç‰©å“ä»·å€¼æ€»å’Œæœ€å¤§ã€‚\nå®Œå…¨èƒŒåŒ…å’Œ 01 èƒŒåŒ…é—®é¢˜å”¯ä¸€ä¸åŒçš„åœ°æ–¹å°±æ˜¯ï¼Œæ¯ç§ç‰©å“æœ‰æ— é™ä»¶ã€‚\näºŒç»´æ•°ç»„ï¼š\n\n\né€’æ¨å…¬å¼ï¼šdp[i][j] = Math.max(dp[i - 1][j], dp[i][j - item[i][0]] + item[i][1])ï¼ˆå³ï¼Œä¸é‡å¤å­˜æ”¾å½“å‰ç‰©å“/é‡å¤å­˜æ”¾å½“å‰ç‰©å“ï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[i][0] å‡ä¸º 0ã€‚dp[0][j] ä¸ºç¬¬ä¸€æ ¼æŒ‰èƒŒåŒ…å¤§å°å–é‡å¤å€¼ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\npublic static void main(String[] args) &#123;      integerBreak(4, new int[][]&#123;&#123;1, 15&#125;, &#123;3, 20&#125;, &#123;4, 30&#125;&#125;);  &#125;    public static void integerBreak(int n, int[][] item) &#123;      int[][] dp = new int[item.length][n + 1];        // çºµåˆ—åˆå§‹åŒ–ä¸º0ï¼ˆæ•°ç»„å®šä¹‰ï¼Œä¸ç”¨åˆå§‹åŒ–ï¼‰        // æ¨ªåˆ—åˆå§‹åŒ–ä¸ä¸€æ ·äº†      for (int j = 1; j &lt; dp[0].length &amp;&amp; n &gt;= item[0][0]; j++) &#123;          dp[0][j] = j / item[0][0] * item[0][1];      &#125;        for (int i = 1; i &lt; item.length; i++) &#123;          for (int j = 1; j &lt;= n; j++) &#123;              if (j - item[i][0] &lt; 0) &#123;  \t            // å¦‚æœå½“å‰ç‰©å“ä¸èƒ½æ”¾å…¥ï¼ŒèƒŒåŒ…å€¼ = å½“å‰å€¼çš„å‰ä¸€åˆ—                dp[i][j] = dp[i - 1][j];              &#125; else &#123;  \t            // å¦‚æœå½“å‰ç‰©å“å¯ä»¥æ”¾å…¥\t\t\t\t// æ¯”è¾ƒå‰ä¸€åˆ—å’Œï¼ˆèŒƒå›´å¤§å°è¿˜æ˜¯[0, i]ï¼Œå¦‚æœæ˜¯ i - 1ï¼ŒèŒƒå›´å¤§å°å°±æ˜¯[0, i - 1]ï¼‰\t\t\t\t// ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒ…ä¸åŒ…å«è¿™ä¸ªæ•°æœ¬èº«ï¼ˆå¯ä¸å¯ä»¥é‡å¤è®¡æ•°ï¼‰                dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - item[i][0]] + item[i][1]);              &#125;          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));  &#125;\nä¸€ç»´æ•°ç»„ï¼ˆçŠ¶æ€å‹ç¼©ï¼‰ï¼š\n\n\né€’æ¨å…¬å¼ï¼šdp[i] = Math.max(dp[i], dp[i - item[0]] + item[1]);\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = 0\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚ï¼ˆè€Œå®Œå…¨èƒŒåŒ…çš„ç‰©å“æ˜¯å¯ä»¥æ·»åŠ å¤šæ¬¡çš„ï¼Œæ‰€ä»¥è¦ä»å°åˆ°å¤§å»éå†ã€‚ï¼ˆğŸ˜…è€å®è¯´ï¼Œçœ‹äº†å¥½å‡ å‡ ééƒ½æ²¡æ‡‚ï¼‰ï¼‰\n\n\nè¿™é‡Œå®Œå…¨èƒŒåŒ…ä¸€ç»´ dp æ•°ç»„å¯ä»¥äº¤æ¢éå†é¡ºåºï¼šå› ä¸º dp[j] æ˜¯ç”¨åˆ°å…¶å·¦è¾¹çš„æ•°æ® dp[j - weight[i]] çš„ï¼Œè€Œå…ˆéå†èƒŒåŒ…å†éå†ç‰©å“ä¹Ÿæ˜¯æ»¡è¶³çš„ã€‚\n\n\npublic static void integerBreak1(int n, int[][] items) &#123;      int[] dp = new int[n + 1];      for (int[] item : items) &#123;          for (int i = 0; i &lt; dp.length; i++) &#123;              if (i &gt;= item[0]) &#123;                  dp[i] = Math.max(dp[i], dp[i - item[0]] + item[1]);              &#125;          &#125;      &#125;        System.out.println(Arrays.toString(dp));  &#125;\n518 é›¶é’±å…‘æ¢ II\nè§£æï¼š(https://programmercarl.com/0518.é›¶é’±å…‘æ¢II.html)\n377 ç»„åˆæ€»å’Œ â…£\nè§£æï¼š(https://programmercarl.com/0377.ç»„åˆæ€»å’Œâ…£.html)\n70 çˆ¬æ¥¼æ¢¯ ï¼ˆè¿›é˜¶ï¼‰\nè§£æï¼š(https://programmercarl.com/0070.çˆ¬æ¥¼æ¢¯å®Œå…¨èƒŒåŒ…ç‰ˆæœ¬.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’","å®Œå…¨èƒŒåŒ…"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åä¸ƒå¤©-322é›¶é’±å…‘æ¢ã€279å®Œå…¨å¹³æ–¹æ•°ã€139å•è¯æ‹†åˆ†","url":"/posts/f80db845/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š322 é€’æ¨å…¬å¼çœ‹äº†é¢˜è§£ã€‚279 ä¸ 322 ä¸€æ ·ï¼ŒAC äº†ã€‚139 ç”¨å›æº¯è¶…æ—¶ã€‚\n\n\næ›´æ–°\n\n\n24-06-25 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n322 é›¶é’±å…‘æ¢\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/coin-change)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šå¡«æ»¡ iï¼ˆåŒ…æ‹¬ iï¼‰è¿™ä¹ˆå¤§å®¹ç§¯çš„åŒ…ï¼Œéœ€è¦çš„æœ€å°ä¸ªæ•°ä¸º dp[i]\n\n\né€’æ¨å…¬å¼ï¼šdp[i] = Math.min(dp[i], dp[i - coin] + 1)ã€‚ï¼ˆè¿™é‡Œæ¯”è¾ƒéš¾æƒ³ï¼ŒèƒŒåŒ…æ”¾è¿™ä¸ªç¡¬å¸çš„è®¡ç®—ä¸ºä¸æ”¾çš„ç»“æœåŠ ä¸€ï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = 0ã€‚èƒŒåŒ…å¤§å°ä¸º 0ï¼Œæ–¹æ³•æ•°ä¹Ÿä¸º 0ã€‚ï¼ˆæ ¹æ®é¢˜ä¸­ç»™å‡ºçš„ç¤ºä¾‹ 3ï¼‰\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\n/**   * æ€è·¯ï¼š   * 1. ç¡¬å¸è·å–å¯ä»¥é‡å¤ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰   * @param coins ç¡¬å¸æ•°ç»„   * @param amount æ•°é‡   * @return ç»“æœ   */  public static int coinChange(int[] coins, int amount) &#123;      // dp è¡¨ç¤ºå‡‘æˆé‡‘é¢æ‰€éœ€è¦çš„æœ€å°ä¸ªæ•°      int[] dp = new int[amount + 1];      Arrays.fill(dp, amount + 1);        dp[0] = 0;        for (int coin : coins) &#123;          for (int i = coin; i &lt; dp.length; i++) &#123;              if(dp[i - coin] != amount + 1) &#123;                  dp[i] = Math.min(dp[i], dp[i- coin] + 1);              &#125;           &#125;      &#125;        System.out.println(Arrays.toString(dp));        return dp[amount] == amount + 1 ? -1 : dp[amount];  &#125;\n279 å®Œå…¨å¹³æ–¹æ•°\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/perfect-squares)\nå’Œä¸Šé¢˜å®Œå…¨ä¸€æ ·ï¼ŒåŒºåˆ«åªæœ‰å–å€¼æ•°ç»„çš„å€¼éœ€è¦è‡ªå·±è®¡ç®—ã€‚\n/**   * æ€è·¯ï¼šèƒŒåŒ…å¤§å°ä¸ºnï¼Œä»1-æ ¹å·nä¹‹é—´å–æ•°   * 1. æ•°å¯ä»¥é‡å¤å–å€¼ï¼Œå®Œå…¨èƒŒåŒ…   *   * @param n å’Œä¸ºn   * @return ç»“æœ   */  public int numSquares(int n) &#123;      // dp[i] è¡¨ç¤ºå’Œä¸ºnçš„å®Œå…¨å¹³æ–¹æ•°çš„æœ€å°æ•°é‡      int[] dp = new int[n + 1];      Arrays.fill(dp, n + 1);        dp[0] = 0;      int num = (int) Math.sqrt(n);      for (int i = 1; i &lt;= num; i++) &#123;          for (int j = i * i; j &lt; dp.length; j++) &#123;              if (dp[j - i * i] != n + 1) &#123;                  dp[j] = Math.min(dp[j], dp[j - i * i] + 1);              &#125;          &#125;      &#125;        System.out.println(Arrays.toString(dp));        return dp[n];  &#125;\n139 å•è¯æ‹†åˆ†\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/word-break)\n// å›æº¯æ–¹æ³•ã€‚è¿™æ ·å†™ä¼šè¶…æ—¶ğŸ¤•public boolean wordBreak(String s, List&lt;String&gt; wordDict) &#123;      wordDict.sort(Comparator.comparingInt(String::length));      return wordBreakBFS(s, wordDict, new ArrayList&lt;&gt;());  &#125;    public static boolean wordBreakBFS(String s, List&lt;String&gt; wordDict, List&lt;String&gt; word) &#123;      String join = String.join(&quot;&quot;, word);      if (s.length() &lt;= join.length()) &#123;          return s.equals(String.join(&quot;&quot;, word));      &#125; else if (!s.startsWith(join)) &#123;          return false;      &#125;        for (String string : wordDict) &#123;          word.add(string);          boolean b = wordBreakBFS(s, wordDict, word);          if (b) &#123;              return true;          &#125;          word.remove(word.size() - 1);      &#125;        return false;  &#125;\nçœ‹è§£æ\n322 é›¶é’±å…‘æ¢\nè§£æï¼š(https://programmercarl.com/0322.é›¶é’±å…‘æ¢.html)\n279 å®Œå…¨å¹³æ–¹æ•°\nè§£æï¼š(https://programmercarl.com/0279.å®Œå…¨å¹³æ–¹æ•°.html)\n139 å•è¯æ‹†åˆ†\nè§£æï¼š(https://programmercarl.com/0139.å•è¯æ‹†åˆ†.html)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šå­—ç¬¦ä¸²é•¿åº¦ä¸º iï¼Œdp[i] è¡¨ç¤ºæ˜¯å¦å¯ä»¥æ‹†åˆ†ï¼Œå¯ä»¥è¿”å› trueã€‚\n\n\né€’æ¨å…¬å¼ï¼šå¦‚æœ dp[j] ä¸º trueï¼Œå¹¶ä¸”å­—ç¬¦ä¸²ä¸‹æ ‡ j-i æˆªå–çš„å­—ç¬¦åœ¨å­—å…¸å†…ï¼Œè¯´æ˜å¯ä»¥æ‹†åˆ†ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = trueã€‚åˆå§‹å€¼ä¸ºäº†ä¿è¯åç»­è®¡ç®—ä¸ä¼šä¸€ç›´ä¸º falseã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰ã€‚ç”±äºæ˜¯æ’åˆ—é—®é¢˜ï¼Œæ‰€ä»¥å…ˆéå†èƒŒåŒ…å¤§å°ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\n// åŠ¨æ€è§„åˆ’public static boolean wordBreak(String s, List&lt;String&gt; wordDict) &#123;      boolean[] dp = new boolean[s.length() + 1];      dp[0] = true;        for (int i = 1; i &lt; dp.length; i++) &#123;          for (String word : wordDict) &#123;              int len = word.length();              if (i &gt;= len &amp;&amp; dp[i - len] &amp;&amp; word.equals(s.substring(i - len, i))) &#123;                  dp[i] = true;                  break;              &#125;          &#125;      &#125;        System.out.println(Arrays.toString(dp));        return dp[s.length()];  &#125;\n// å›æº¯è®°å¿†æ³•class Solution &#123;    private Set&lt;String&gt; set;    private int[] memo;    public boolean wordBreak(String s, List&lt;String&gt; wordDict) &#123;        memo = new int[s.length()];        set = new HashSet&lt;&gt;(wordDict);        return backtracking(s, 0);    &#125;    public boolean backtracking(String s, int startIndex) &#123;        // System.out.println(startIndex);        if (startIndex == s.length()) &#123;            return true;        &#125;        if (memo[startIndex] == -1) &#123;            return false;        &#125;        for (int i = startIndex; i &lt; s.length(); i++) &#123;            String sub = s.substring(startIndex, i + 1);\t\t    // æ‹†åˆ†å‡ºæ¥çš„å•è¯æ— æ³•åŒ¹é…            if (!set.contains(sub)) &#123;                continue;                            &#125;            boolean res = backtracking(s, i + 1);            if (res) return true;        &#125;        // è¿™é‡Œæ˜¯å…³é”®ï¼Œæ‰¾éäº†startIndex~s.length()ä¹Ÿæ²¡èƒ½å®Œå…¨åŒ¹é…ï¼Œæ ‡è®°ä»startIndexå¼€å§‹ä¸èƒ½æ‰¾åˆ°        memo[startIndex] = -1;        return false;    &#125;&#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’","å®Œå…¨èƒŒåŒ…"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åå…«å¤©-198æ‰“å®¶åŠ«èˆã€213æ‰“å®¶åŠ«èˆIIã€337æ‰“å®¶åŠ«èˆIII","url":"/posts/f5901d56/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼šéƒ½æ˜¯çœ‹äº†è§£æå†™å‡ºã€‚\n\n\næ›´æ–°\n\n\n24-06-26 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n198 æ‰“å®¶åŠ«èˆ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/house-robber)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šä¸‹æ ‡ i åŠä¹‹å‰çš„æˆ¿é—´èƒ½å·çš„æœ€å¤§é‡‘å¸æ•°ã€‚\n\n\né€’æ¨å…¬å¼ï¼šdp[i] = Math.max(dp[i - 1], dp[i - 2] + nums[i])ã€‚ï¼ˆåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œå·/ä¸å·ï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = num[0], dp[1] = Math.max(num[0], num[1])ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int rob(int[] nums) &#123;      int[] dp = new int[nums.length];        dp[0] = nums[0];      if (nums.length &lt;= 1) &#123;          return dp[0];      &#125;      dp[1] = Math.max(nums[0], nums[1]);        for (int i = 2; i &lt; dp.length; i++) &#123;          dp[i] = Math.max(dp[i - 1], dp[i - 2] + nums[i]);      &#125;        return dp[nums.length - 1];  &#125;\n213 æ‰“å®¶åŠ«èˆ II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/house-robber-ii)\næœ¬é¢˜çš„é€’æ¨ä¸ä¸Šä¸€é¢˜ç›¸åŒã€‚åŒºåˆ«åœ¨äºè¦ä¸è¦ç»Ÿè®¡å¤´å°¾ã€‚æ€è·¯æ˜¯å»é™¤å°¾å’Œå»é™¤å¤´åˆ†åˆ«æ±‚ä¸€æ¬¡æœ€å¤§å€¼ã€‚ç„¶åé€‰è¾ƒå¤§çš„é‚£ä¸ªã€‚\npublic class LE213 &#123;      public static void main(String[] args) &#123;          int rob = rob(new int[]&#123;200, 3, 140, 20, 10&#125;);          System.out.println(rob);      &#125;        public static int rob(int[] nums) &#123;          if (nums.length == 1) &#123;              return nums[0];          &#125;          return Math.max(rob1(nums, 0, nums.length - 1), rob1(nums, 1, nums.length));      &#125;            public static int rob(int[] nums, int start, int end) &#123;          int[] dp = new int[end - start];            dp[0] = nums[start];          if (dp.length == 1) &#123;              return dp[0];          &#125;          dp[1] = Math.max(nums[start], nums[start + 1]);            for (int i = 2; i &lt; dp.length; i++) &#123;              dp[i] = Math.max(dp[i - 1], dp[i - 2] + nums[start + 2]);              start++;          &#125;            System.out.println(Arrays.toString(dp));            return dp[dp.length - 1];      &#125;        /**       * æ–¹æ³•äºŒï¼šç›´æ¥äº¤æ¢       */      public static int rob1(int[] nums, int start, int end) &#123;          // xä¸ºä¸Šä¸Šå±‚çš„æœ€å¤§å€¼ï¼Œyä¸ºä¸Šä¸€å±‚çš„æœ€å¤§å€¼ã€‚          int x = 0, y = 0;          for (int i = start; i &lt; end; i++) &#123;              int temp = Math.max(x + nums[i], y);              x = y;              y = temp;          &#125;            return y;      &#125;  &#125;\n337 æ‰“å®¶åŠ«èˆ III\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/house-robber-iii)\nåŠ¨æ€è§„åˆ’å…¶å®å°±æ˜¯ä½¿ç”¨çŠ¶æ€è½¬ç§»å®¹å™¨æ¥è®°å½•çŠ¶æ€çš„å˜åŒ–ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªé•¿åº¦ä¸º 2 çš„æ•°ç»„ï¼Œè®°å½•å½“å‰èŠ‚ç‚¹å·ä¸ä¸å·æ‰€å¾—åˆ°çš„çš„æœ€å¤§é‡‘é’±ã€‚\nè¿™é“é¢˜ç›®ç®—æ˜¯æ ‘å½¢ dp çš„å…¥é—¨é¢˜ç›®ï¼Œå› ä¸ºæ˜¯åœ¨æ ‘ä¸Šè¿›è¡ŒçŠ¶æ€è½¬ç§»ï¼Œæˆ‘ä»¬åœ¨è®²è§£äºŒå‰æ ‘çš„æ—¶å€™è¯´è¿‡é€’å½’ä¸‰éƒ¨æ›²ï¼Œé‚£ä¹ˆä¸‹é¢æˆ‘ä»¥é€’å½’ä¸‰éƒ¨æ›²ä¸ºæ¡†æ¶ï¼Œå…¶ä¸­èåˆåŠ¨è§„äº”éƒ¨æ›²çš„å†…å®¹æ¥è¿›è¡Œè®²è§£ã€‚\né€’å½’ä¸‰éƒ¨æ›²ï¼š\n\n\nç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ã€‚æ±‚ä¸€ä¸ªèŠ‚ç‚¹ä¸¤ä¸ªçŠ¶æ€çš„é‡‘é’±å€¼ï¼Œè¿”å›å€¼å°±æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 2 çš„æ•°ç»„ã€‚æœ¬é¢˜ dp æ•°ç»„å°±æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 2 çš„æ•°ç»„\n\n\nç¡®å®šç»ˆæ­¢æ¡ä»¶ã€‚é‡åˆ°ç©ºèŠ‚ç‚¹è¿”å›ã€‚\n\n\nç¡®å®šéå†é¡ºåºã€‚ååºéå†ã€‚\n\n\nåŠ¨è§„äº”éƒ¨æ›²ï¼š\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šä¸‹æ ‡ 0 è¡¨ç¤ºä¸å·çš„æœ€å¤§ï¼Œä¸‹æ ‡ 1 è¡¨ç¤ºå·çš„æœ€å¤§ã€‚\n\n\né€’æ¨å…¬å¼å³å•å±‚é€’å½’çš„é€»è¾‘ï¼šdp[0] = cur-&gt;val + left[0] + right[0]ï¼Œdp[1] = max(left[0], left[1]) + max(right[0], right[1])ã€‚ï¼ˆåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œå·/ä¸å·ï¼šå·å½“å‰èŠ‚ç‚¹ dp[1]ï¼Œå€¼ä¸ºå½“å‰èŠ‚ç‚¹å€¼ + ä¸å·å·¦å³çš„èŠ‚ç‚¹çš„å€¼ï¼›ä¸å·å½“å‰èŠ‚ç‚¹ dp[0]ï¼Œå€¼ä¸ºå·¦å­©å­å·/ä¸å·çš„æœ€å¤§å€¼ + å³å­©å­å·/ä¸å·çš„æœ€å¤§å€¼ï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0] = 0, dp[1] = 0ï¼Œè¿™é‡Œçš„åˆå§‹åŒ–ä¸é€’å½’çš„ç»ˆæ­¢æ¡ä»¶ç›¸ã€‚\n\n\néå†é¡ºåºï¼šååºéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int rob(TreeNode root) &#123;      if (root == null) &#123;          return 0;      &#125;      int[] dp = robDFS(root);      return Math.max(dp[0], dp[1]);  &#125;    private int[] robDFS(TreeNode root) &#123;      if (root == null) &#123;          return new int[2];      &#125;        int[] left = robDFS(root.left);      int[] right = robDFS(root.right);        return new int[]&#123;Math.max(left[0], left[1]) + Math.max(right[0], right[1]), root.val + left[0] + right[0]&#125;;  &#125;\nçœ‹è§£æ\n198 æ‰“å®¶åŠ«èˆ\nè§£æï¼š(https://programmercarl.com/0198.æ‰“å®¶åŠ«èˆ.html)\n213 æ‰“å®¶åŠ«èˆ II\nè§£æï¼š(https://programmercarl.com/0213.æ‰“å®¶åŠ«èˆII.html)\n337 æ‰“å®¶åŠ«èˆ III\nè§£æï¼š(https://programmercarl.com/0337.æ‰“å®¶åŠ«èˆIII.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’","æ ‘å½¢dp"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å››åå¤©-188ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIVã€309æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸã€714ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹","url":"/posts/ab0ba29f/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼š188 æ ¹æ® 123AC äº†ã€‚309ç”¨å¦ä¸€ç§æ–¹æ³•ACäº†ã€‚714ACã€‚\n\n\næ›´æ–°\n\n\n24-06-28 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n188 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iv)\npublic int maxProfit(int k, int[] prices) &#123;      int[][] dp = new int[prices.length][2 * k];        // åˆå§‹åŒ–æ•°æ®      for (int i = 0; i &lt; k; i++) &#123;          dp[0][i * 2] = -prices[0];      &#125;        for (int i = 1; i &lt; dp.length; i++) &#123;          dp[i][0] = Math.max(dp[i - 1][0], -prices[i]);          for (int j = 1; j &lt; 2 * k; j++) &#123;              if (j % 2 == 0) &#123;                  // å¶æ•°ä¹°å…¥                  dp[i][j] = Math.max(dp[i - 1][j], dp[i - 1][j - 1] - prices[i]);              &#125; else &#123;                  // å¥‡æ•°å–å‡º                  dp[i][j] = Math.max(dp[i - 1][j], dp[i - 1][j - 1] + prices[i]);              &#125;          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[prices.length - 1][2 * k - 1];  &#125;\n309 æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-with-cooldown)\næ€è·¯ï¼šä¹°å–è‚¡ç¥¨ + æ‰“å®¶åŠ«èˆç»“åˆ\npublic int maxProfit(int[] prices) &#123;      // 0 è¡¨ç¤ºæŒæœ‰è‚¡ç¥¨çš„çŠ¶æ€; 1 è¡¨ç¤ºä¸æŒæœ‰è‚¡ç¥¨çš„çŠ¶æ€      int[][] dp = new int[prices.length][2];        dp[0][0] = -prices[0];        for (int i = 1; i &lt; dp.length; i++) &#123;          if (i == 1) &#123;              dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][1] - prices[i]);          &#125; else &#123;              // æŒæœ‰ï¼šå‰ä¸€å¤©æŒæœ‰ï¼›å‰ä¸€å¤©ä¸æŒæœ‰ï¼ˆä¸å¯èƒ½ï¼‰ï¼šå‰ä¸¤å¤©ä¸æŒæœ‰              dp[i][0] = Math.max(dp[i - 1][0], dp[i - 2][1] - prices[i]);          &#125;          // ä¸æŒæœ‰ï¼šå‰ä¸€å¤©ä¸æŒæœ‰ï¼›å‰ä¸€å¤©æŒæœ‰          dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] + prices[i]);      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[prices.length - 1][1];  &#125;\n714 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-with-transaction-fee)\n// åŠ ä¸Šæ‰‹ç»­è´¹å°±è¡Œpublic int maxProfit(int[] prices, int fee) &#123;      int[][] dp = new int[prices.length][2];        // å‡è®¾ä¹°å…¥çš„æ—¶å€™æ”¯ä»˜æ‰‹ç»­è´¹      dp[0][0] = -prices[0] - fee;        for (int i = 1; i &lt; dp.length; i++) &#123;          dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][1] - prices[i] - fee);          dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] + prices[i]);      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[prices.length - 1][1];  &#125;\nçœ‹è§£æ\n188 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV\nè§£æï¼š(https://programmercarl.com/0188.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIV.html)\n309 æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ\nè§£æï¼š(https://programmercarl.com/0309.æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ.html)\næ³¨æ„è¿™é‡Œçš„æ¯ä¸€ä¸ªçŠ¶æ€ï¼Œä¾‹å¦‚çŠ¶æ€ä¸€ï¼Œæ˜¯æŒæœ‰è‚¡ç¥¨è‚¡ç¥¨çŠ¶æ€å¹¶ä¸æ˜¯è¯´ä»Šå¤©ä¸€å®šå°±ä¹°å…¥è‚¡ç¥¨ï¼Œè€Œæ˜¯è¯´ä¿æŒä¹°å…¥è‚¡ç¥¨çš„çŠ¶æ€å³ï¼šå¯èƒ½æ˜¯å‰å‡ å¤©ä¹°å…¥çš„ï¼Œä¹‹åä¸€ç›´æ²¡æ“ä½œï¼Œæ‰€ä»¥ä¿æŒä¹°å…¥è‚¡ç¥¨çš„çŠ¶æ€ã€‚\nè¾¾åˆ°ä¹°å…¥è‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€ä¸€ï¼‰å³ï¼šdp[i][0]ï¼Œæœ‰ä¸¤ä¸ªå…·ä½“æ“ä½œï¼š\n\n\næ“ä½œä¸€ï¼šå‰ä¸€å¤©å°±æ˜¯æŒæœ‰è‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€ä¸€ï¼‰ï¼Œdp[i][0] = dp[i - 1][0]\n\n\næ“ä½œäºŒï¼šä»Šå¤©ä¹°å…¥äº†ï¼Œæœ‰ä¸¤ç§æƒ…å†µ\n\nå‰ä¸€å¤©æ˜¯å†·å†»æœŸï¼ˆçŠ¶æ€å››ï¼‰ï¼Œdp[i - 1][3] - prices[i]\nå‰ä¸€å¤©æ˜¯ä¿æŒå–å‡ºè‚¡ç¥¨çš„çŠ¶æ€ï¼ˆçŠ¶æ€äºŒï¼‰ï¼Œdp[i - 1][1] - prices[i]\n\n\n\né‚£ä¹ˆ dp[i][0] = max(dp[i - 1][0], dp[i - 1][3] - prices[i], dp[i - 1][1] - prices[i]);\nè¾¾åˆ°ä¿æŒå–å‡ºè‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€äºŒï¼‰å³ï¼šdp[i][1]ï¼Œæœ‰ä¸¤ä¸ªå…·ä½“æ“ä½œï¼š\n\n\næ“ä½œä¸€ï¼šå‰ä¸€å¤©å°±æ˜¯çŠ¶æ€äºŒ\n\n\næ“ä½œäºŒï¼šå‰ä¸€å¤©æ˜¯å†·å†»æœŸï¼ˆçŠ¶æ€å››ï¼‰ï¼Œdp[i][1] = max(dp[i - 1][1], dp[i - 1][3]);\n\n\nè¾¾åˆ°ä»Šå¤©å°±å–å‡ºè‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€ä¸‰ï¼‰ï¼Œå³ï¼šdp[i][2]ï¼Œåªæœ‰ä¸€ä¸ªæ“ä½œï¼š\næ˜¨å¤©ä¸€å®šæ˜¯æŒæœ‰è‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€ä¸€ï¼‰ï¼Œä»Šå¤©å–å‡ºï¼Œå³ï¼šdp[i][2] = dp[i - 1][0] + prices[i];\nè¾¾åˆ°å†·å†»æœŸçŠ¶æ€ï¼ˆçŠ¶æ€å››ï¼‰ï¼Œå³ï¼šdp[i][3]ï¼Œåªæœ‰ä¸€ä¸ªæ“ä½œï¼š\næ˜¨å¤©å–å‡ºäº†è‚¡ç¥¨ï¼ˆçŠ¶æ€ä¸‰ï¼‰ï¼Œ dp[i][3] = dp[i - 1][2];\nclass Solution &#123;    public int maxProfit(int[] prices) &#123;        if (prices == null || prices.length &lt; 2) &#123;            return 0;        &#125;        int[][] dp = new int[prices.length][2];        // bad case        dp[0][0] = 0;        dp[0][1] = -prices[0];        dp[1][0] = Math.max(dp[0][0], dp[0][1] + prices[1]);        dp[1][1] = Math.max(dp[0][1], -prices[1]);        for (int i = 2; i &lt; prices.length; i++) &#123;            // dpå…¬å¼            dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][1] + prices[i]);            dp[i][1] = Math.max(dp[i - 1][1], dp[i - 2][0] - prices[i]);        &#125;        return dp[prices.length - 1][0];    &#125;&#125;\n714 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹\nè§£æï¼š(https://programmercarl.com/0714.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬ä¸‰åä¹å¤©-121ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºã€122ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIIã€123ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIII","url":"/posts/f80b512c/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼š121 ç›´æ¥çœ‹çš„è§£æã€‚122 å¯ä»¥å†™å‡ºã€‚123 çœ‹äº†éƒ¨åˆ†è§£æï¼ˆä¸»è¦æ˜¯ dp çš„å®šä¹‰é‚£å—ï¼‰ã€‚\n\n\næ›´æ–°\n\n\n24-06-27 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n121 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/best-time-to-buy-and-sell-stock/)ï¼šå¯ä»¥è¿›è¡Œä¸€ç¬”äº¤æ˜“\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šdp[i][0] è¡¨ç¤ºç¬¬ i å¤©æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œdp[i][1] è¡¨ç¤ºç¬¬ i å¤©ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ã€‚\n\n\né€’æ¨å…¬å¼ï¼šdp[i][0] = Math.max(dp[i - 1][0], -prices[i]);dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] + prices[i]);ã€‚ï¼ˆåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œå½“å‰æŒæœ‰/ä¸æŒæœ‰ï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0][0] = -prices[0]; dp[0][1] = 0;ã€‚è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼šä¸æŒæœ‰è‚¡ç¥¨çŠ¶æ€æ‰€å¾—é‡‘é’±ä¸€å®šæ¯”æŒæœ‰è‚¡ç¥¨çŠ¶æ€å¾—åˆ°çš„å¤šï¼\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int maxProfit(int[] prices) &#123;      // `dp[i][0]` è¡¨ç¤ºç¬¬ i å¤©æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œ`dp[i][1]` è¡¨ç¤ºç¬¬ i å¤©ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ã€‚      int[][] dp = new int[prices.length][2];        // åˆå§‹åŒ–      dp[0][0] = -prices[0];      dp[0][1] = 0;        for (int i = 1; i &lt; prices.length; i++) &#123;          // 1. æ±‚ dp[i][0]: å‰ä¸€å¤©ä¹ŸæŒæœ‰å°±ä¸º dp[i - 1][0]ï¼Œå‰ä¸€å¤©ä¸æŒæœ‰å°±ä¸º -prices[i]                dp[i][0] = Math.max(dp[i - 1][0], -prices[i]);          // 2. æ±‚ dp[i][1]: å‰ä¸€å¤©ä¹Ÿä¸æŒæœ‰å°±ä¸º dp[i - 1][1]ï¼Œå‰ä¸€å¤©æŒæœ‰å°±ä¸º dp[i - 1][0] + prices[i]                dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] + prices[i]);      &#125;        System.out.println(Arrays.deepToString(dp));  \t// æ‰‹ä¸­ä¸æŒæœ‰è‚¡ç¥¨æ—¶ï¼Œåˆ©æ¶¦æ‰ä¼šæœ€å¤§    return dp[prices.length - 1][1];&#125;\n122 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii)ï¼šå¯ä»¥è¿›è¡Œå¤šç¬”äº¤æ˜“\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šdp[i][0] è¡¨ç¤ºç¬¬ i å¤©æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œdp[i][1] è¡¨ç¤ºç¬¬ i å¤©ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ã€‚\n\n\né€’æ¨å…¬å¼ï¼šdp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][1] - prices[i]); dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] + prices[i]);ã€‚ï¼ˆä¸ä¸Šä¸€é¢˜çš„å”¯ä¸€åŒºåˆ«ä¸º dp[i][0] çš„æ¨å¯¼å…¬å¼ï¼Œç”±äºå¯ä»¥æŒç»­ä¹°å…¥å–å‡ºï¼Œå½“å¤©æŒæœ‰çš„ä»·æ ¼ä¸ºå‰ä¸€å¤©ä¸æŒæœ‰çš„ä»·æ ¼ - å½“å¤©ä»·æ ¼ï¼‰\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0][0] = -prices[0]; dp[0][1] = 0;ã€‚è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼šä¸æŒæœ‰è‚¡ç¥¨çŠ¶æ€æ‰€å¾—é‡‘é’±ä¸€å®šæ¯”æŒæœ‰è‚¡ç¥¨çŠ¶æ€å¾—åˆ°çš„å¤šï¼\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int maxProfit(int[] prices) &#123;      // `dp[i][0]` è¡¨ç¤ºç¬¬ i å¤©æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œ`dp[i][1]` è¡¨ç¤ºç¬¬ i å¤©ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ã€‚      int[][] dp = new int[prices.length][2];        // åˆå§‹åŒ–      dp[0][0] = -prices[0];      dp[0][1] = 0;        for (int i = 1; i &lt; prices.length; i++) &#123;          // 1. æ±‚ dp[i][0]: å‰ä¸€å¤©ä¹ŸæŒæœ‰å°±ä¸º dp[i - 1][0]ï¼Œå‰ä¸€å¤©ä¸æŒæœ‰å°±ä¸º dp[i - 1][1] - prices[i]                dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][1] - prices[i]);          // 2. æ±‚ dp[i][1]: å‰ä¸€å¤©ä¹Ÿä¸æŒæœ‰å°±ä¸º dp[i - 1][1]ï¼Œå‰ä¸€å¤©æŒæœ‰å°±ä¸º dp[i - 1][0] + prices[i]                dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] + prices[i]);      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[prices.length - 1][1];&#125;\n123 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iii/)ï¼šå¯ä»¥è¿›è¡Œä¸¤ç¬”äº¤æ˜“\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šå½“å¤©çš„çŠ¶æ€ä¸€å…±æœ‰ 5 ç§ï¼šæ²¡æœ‰æ“ä½œï¼Œä¸è®¡å…¥ã€‚dp[i][0] è¡¨ç¤ºç¬¬ i å¤©ç¬¬ä¸€æ¬¡æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œdp[i][1] è¡¨ç¤ºç¬¬ i å¤©ç¬¬ä¸€æ¬¡ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œdp[i][2] è¡¨ç¤ºç¬¬ i å¤©ç¬¬äºŒæ¬¡æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œdp[i][2] è¡¨ç¤ºç¬¬ i å¤©ç¬¬äºŒæ¬¡ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ã€‚ï¼ˆè¿™é¢˜é‡ç‚¹æŠŠè¿™ä¸ªå†™å‡ºæ¥ï¼Œåé¢å°±èƒ½åšé¢˜äº†ï¼‰\n\n\né€’æ¨å…¬å¼ï¼šdp[i][0] = Math.max(dp[i - 1][0], -prices[i]); dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] + prices[i]); dp[i][2] = Math.max(dp[i - 1][2], dp[i - 1][1] - prices[i]); dp[i][3] = Math.max(dp[i - 1][3], dp[i - 1][2] + prices[i]);ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[0][0] = -prices[0]; dp[0][2] = -prices[0];ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic static int maxProfit(int[] prices) &#123;      // `dp[i][0]` è¡¨ç¤ºç¬¬ i å¤©ç¬¬ä¸€æ¬¡æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œ`dp[i][1]` è¡¨ç¤ºç¬¬ i å¤©ç¬¬ä¸€æ¬¡ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œ`dp[i][2]` è¡¨ç¤ºç¬¬ i å¤©ç¬¬äºŒæ¬¡æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘ï¼Œ`dp[i][2]` è¡¨ç¤ºç¬¬ i å¤©ç¬¬äºŒæ¬¡ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—æœ€å¤šç°é‡‘     int[][] dp = new int[prices.length][4];        // åˆå§‹åŒ–      dp[0][0] = -prices[0];      dp[0][2] = -prices[0];        for (int i = 1; i &lt; prices.length; i++) &#123;          // 1. æ±‚ dp[i][0]: å‰ä¸€å¤©ä¹ŸæŒæœ‰å°±ä¸º dp[i - 1][0]ï¼Œå‰ä¸€å¤©ä¸æŒæœ‰å°±ä¸º -prices[i]                dp[i][0] = Math.max(dp[i - 1][0], -prices[i]);          // 2. æ±‚ dp[i][1]: å‰ä¸€å¤©ä¹Ÿä¸æŒæœ‰å°±ä¸º dp[i - 1][1]ï¼Œå‰ä¸€å¤©æŒæœ‰å°±ä¸º dp[i - 1][0] + prices[i]                dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] + prices[i]);          // 3. æ±‚ dp[i][2]: å‰ä¸€å¤©ä¹ŸæŒæœ‰ä¸º dp[i - 1][2]ï¼Œå‰ä¸€å¤©ä¸æŒæœ‰å°±ä¸º dp[i - 1][1] - prices[i]                dp[i][2] = Math.max(dp[i - 1][2], dp[i - 1][1] - prices[i]);          // 4. æ±‚ dp[i][3]: å‰ä¸€å¤©ä¹Ÿä¸æŒæœ‰ä¸º dp[i - 1][3]ï¼Œå‰ä¸€å¤©æŒæœ‰å°±ä¸º dp[i - 1][2] + prices[i]                dp[i][3] = Math.max(dp[i - 1][3], dp[i - 1][2] + prices[i]);      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[prices.length - 1][3];  &#125;\nçœ‹è§£æ\n121 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº\nè§£æï¼š(https://programmercarl.com/0121.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº.html)\nè¡¥å……è´ªå¿ƒç®—æ³•çš„æ€è·¯ï¼šå¦‚æœç¬¬ i å¤©å–å‡ºè‚¡ç¥¨ï¼Œåˆ™æœ€å¤§åˆ©æ¶¦ä¸º (è¯¥å¤©çš„è‚¡ä»· - å‰é¢å¤©æ•°ä¸­æœ€å°çš„è‚¡ä»·)ï¼Œç„¶åä¸å·²çŸ¥çš„æœ€å¤§åˆ©æ¶¦æ¯”è¾ƒï¼Œå¦‚æœå¤§äºåˆ™æ›´æ–°å½“å‰æœ€å¤§åˆ©æ¶¦çš„å€¼ã€‚\n/**   * è´ªå¿ƒè§£æ³•   */  public int maxProfit(int[] prices) &#123;      int minPrice = Integer.MAX_VALUE;      int maxProfit = 0;        for (int price : prices) &#123;          minPrice = Math.min(price, minPrice);          maxProfit = Math.max(maxProfit, price - minPrice);      &#125;        return maxProfit;  &#125;\n122 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II\nè§£æï¼š(https://programmercarl.com/0122.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIIï¼ˆåŠ¨æ€è§„åˆ’ï¼‰.html)\n123 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III\nè§£æï¼š(https://programmercarl.com/0123.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIII)\nç‰ˆæœ¬äºŒï¼šï¼ˆä¸åšè¦æ±‚ï¼‰\npublic int maxProfit(int[] prices) &#123;    int[] dp = new int[4];     // å­˜å‚¨ä¸¤æ¬¡äº¤æ˜“çš„çŠ¶æ€å°±è¡Œäº†    // dp[0]ä»£è¡¨ç¬¬ä¸€æ¬¡äº¤æ˜“çš„ä¹°å…¥    dp[0] = -prices[0];    // dp[1]ä»£è¡¨ç¬¬ä¸€æ¬¡äº¤æ˜“çš„å–å‡º    dp[1] = 0;    // dp[2]ä»£è¡¨ç¬¬äºŒæ¬¡äº¤æ˜“çš„ä¹°å…¥    dp[2] = -prices[0];    // dp[3]ä»£è¡¨ç¬¬äºŒæ¬¡äº¤æ˜“çš„å–å‡º    dp[3] = 0;    for(int i = 1; i &lt;= prices.length; i++)&#123;        // è¦ä¹ˆä¿æŒä¸å˜ï¼Œè¦ä¹ˆæ²¡æœ‰å°±ä¹°ï¼Œæœ‰äº†å°±å–        dp[0] = Math.max(dp[0], -prices[i-1]);        dp[1] = Math.max(dp[1], dp[0]+prices[i-1]);        // è¿™å·²ç»æ˜¯ç¬¬äºŒæ¬¡äº¤æ˜“äº†ï¼Œæ‰€ä»¥å¾—åŠ ä¸Šå‰ä¸€æ¬¡äº¤æ˜“å–å‡ºå»çš„æ”¶è·        dp[2] = Math.max(dp[2], dp[1]-prices[i-1]);        dp[3] = Math.max(dp[3], dp[2]+ prices[i-1]);    &#125;    return dp[3];&#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å››åä¸€å¤©-300æœ€é•¿é€’å¢å­åºåˆ—ã€674æœ€é•¿è¿ç»­é€’å¢åºåˆ—ã€718æœ€é•¿é‡å¤å­æ•°ç»„","url":"/posts/825964fb/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼š300 çœ‹è§£æï¼Œ674ACï¼Œ718çœ‹è§£æ\n\n\næ›´æ–°\n\n\n24-07-01 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n300 æœ€é•¿é€’å¢å­åºåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/longest-increasing-subsequence)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šdp[i] è¡¨ç¤ºç¬¬ i ä¸ªä¸‹æ ‡å‰çš„æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦\n\n\né€’æ¨å…¬å¼ï¼šdp[i] = Math.max(dp[i], dp[j] + 1)ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp æ•°ç»„æ‰€æœ‰å…ƒç´ çš„åˆå§‹åŒ–å€¼éƒ½ä¸º 1ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int lengthOfLIS(int[] nums) &#123;      int[] dp = new int[nums.length];        Arrays.fill(dp, 1);        int maxLength = 0;      for (int i = 1; i &lt; dp.length; i++) &#123;          for (int j = 0; j &lt; i; j++) &#123;              if (nums[i] &gt; nums[j]) &#123;                  dp[i] = Math.max(dp[i], dp[j] + 1);              &#125;          &#125;          maxLength = Math.max(maxLength, dp[i]);      &#125;        return maxLength;  &#125;\n674 æœ€é•¿è¿ç»­é€’å¢åºåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/longest-continuous-increasing-subsequence)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šdp[i] è¡¨ç¤ºç¬¬ i ä¸ªä¸‹æ ‡å‰çš„æœ€é•¿è¿ç»­é€’å¢å­åºåˆ—çš„é•¿åº¦\n\n\né€’æ¨å…¬å¼ï¼šdp[i] = Math.max(dp[i], dp[i - 1] + 1)ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp æ•°ç»„æ‰€æœ‰å…ƒç´ çš„åˆå§‹åŒ–å€¼éƒ½ä¸º 1ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int findLengthOfLCIS(int[] nums) &#123;      int[] dp = new int[nums.length];        Arrays.fill(dp, 1);        int maxLength = 1;      for (int i = 1; i &lt; dp.length; i++) &#123;          if (nums[i] &gt; nums[i - 1]) &#123;              dp[i] = Math.max(dp[i], dp[i - 1] + 1);          &#125;          maxLength = Math.max(maxLength, dp[i]);      &#125;        return maxLength;  &#125;\n718 æœ€é•¿é‡å¤å­æ•°ç»„\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šnum1 åˆ° i - 1ï¼›num2 åˆ° j - 1 ä½ç½®çš„æœ€é•¿é‡å¤æ•°ç»„ã€‚\n\n\né€’æ¨å…¬å¼ï¼šdp[i][j] = dp[i - 1][j - 1] + 1; ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp æ•°ç»„æ‰€æœ‰å…ƒç´ çš„åˆå§‹åŒ–å€¼éƒ½ä¸º 0ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰é¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/maximum-length-of-repeated-subarray)\n\n\npublic int findLength(int[] nums1, int[] nums2) &#123;      int[][] dp = new int[nums1.length + 1][nums2.length + 1];        int maxLength = 0;      for (int i = 1; i &lt;= nums1.length; i++) &#123;          for (int j = 1; j &lt;= nums2.length; j++) &#123;              if (nums1[i - 1] == nums2[j - 1]) &#123;                  dp[i][j] = dp[i - 1][j - 1] + 1;              &#125;              maxLength = Math.max(dp[i][j], maxLength);          &#125;      &#125;        return maxLength;  &#125;\nçœ‹è§£æ\n300 æœ€é•¿é€’å¢å­åºåˆ—\nè§£æï¼š(https://programmercarl.com/0300.æœ€é•¿ä¸Šå‡å­åºåˆ—.html)\n674 æœ€é•¿è¿ç»­é€’å¢åºåˆ—\nè§£æï¼š(https://programmercarl.com/0674.æœ€é•¿è¿ç»­é€’å¢åºåˆ—.html)\n718 æœ€é•¿é‡å¤å­æ•°ç»„\nè§£æï¼š(https://programmercarl.com/0718.æœ€é•¿é‡å¤å­æ•°ç»„.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å››åäºŒå¤©-1143æœ€é•¿å…¬å…±å­åºåˆ—ã€1035ä¸ç›¸äº¤çš„çº¿ã€53æœ€å¤§å­åºå’Œã€392åˆ¤æ–­å­åºåˆ—","url":"/posts/2b15070f/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼š1143ACï¼ˆæ–¹æ³•ä¸æ˜¯æœ€ç®€çš„ï¼‰ã€1035ACï¼ˆå’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼‰ã€53ACã€392ACï¼ˆæ ¹æ® 1143ï¼‰\n\n\næ›´æ–°\n\n\n24-07-05 åˆå§‹è®°å½•24-07-06 114324-07-07 1143ä¼˜åŒ–ã€1035ã€53ã€392\n\nåˆæ­¥é¢˜è§£\n1143 æœ€é•¿å…¬å…±å­åºåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/longest-common-subsequence/)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼štext1 åˆ° iï¼›text2 åˆ° j ä½ç½®çš„æœ€é•¿é‡å¤æ•°ç»„ã€‚\n\n\né€’æ¨å…¬å¼ï¼šå¦‚æœå½“å‰ä½ç½®å…ƒç´ ç›¸åŒï¼šdp[i][j] = dp[i - 1][j - 1] + 1; ï¼Œ å¦‚æœå½“å‰ä½ç½®å…ƒç´ ä¸åŒï¼šdp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]); ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šé’ˆå¯¹åˆå§‹å…ƒç´ æ˜¯å¦ç›¸åŒåŠ i = 0 å’Œ j = 0 çš„ä¸¤ç§æƒ…å†µï¼Œéƒ½éœ€è¦åˆ†åˆ«åˆ¤æ–­ã€‚\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic static int longestCommonSubsequence(String text1, String text2) &#123;      int[][] dp = new int[text1.length()][text2.length()];        int maxLength = 0;        for (int i = 0; i &lt; text1.length(); i++) &#123;          for (int j = 0; j &lt; text2.length(); j++) &#123;              // å½“å‰æŒ‡é’ˆä½ç½®ç›¸åŒï¼Œdp[i][j] = dp[i - 1][j - 1] + 1              if (text1.charAt(i) == text2.charAt(j)) &#123;                  if (i == 0 || j == 0) &#123;                      dp[i][j] = 1;                      maxLength = Math.max(dp[i][j], maxLength);                      continue;                  &#125;                  dp[i][j] = dp[i - 1][j - 1] + 1;              &#125; else &#123;                  if (i == 0 &amp;&amp; j == 0) &#123;                      dp[i][j] = 0;                      continue;                  &#125; else if (i == 0) &#123;                      dp[i][j] = dp[0][j - 1];                      maxLength = Math.max(dp[i][j], maxLength);                      continue;                  &#125; else if (j == 0) &#123;                      dp[i][j] = dp[i - 1][0];                      maxLength = Math.max(dp[i][j], maxLength);                      continue;                  &#125;                  dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);              &#125;              maxLength = Math.max(dp[i][j], maxLength);          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));        return maxLength;  &#125;\n1035 ä¸ç›¸äº¤çš„çº¿\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/uncrossed-lines)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼štext1 åˆ° i - 1ï¼›text2 åˆ° j - 1 ä½ç½®çš„æœ€é•¿é‡å¤æ•°ç»„ã€‚\n\n\né€’æ¨å…¬å¼ï¼šå¦‚æœå½“å‰ä½ç½®å…ƒç´ ç›¸åŒï¼šdp[i][j] = dp[i - 1][j - 1] + 1; ï¼Œ å¦‚æœå½“å‰ä½ç½®å…ƒç´ ä¸åŒï¼šdp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]); ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼ši = 0 æˆ– j = 0 æ—¶ï¼Œdp å€¼ä¸º 0\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int maxUncrossedLines(int[] nums1, int[] nums2) &#123;      int[][] dp = new int[nums1.length + 1][nums2.length + 1];        for (int i = 1; i &lt;= nums1.length; i++) &#123;          for (int j = 1; j &lt;= nums2.length; j++) &#123;              // å½“å‰ä½ç½®åŠ å…¥è®¡æ•°              if (nums1[i - 1] == nums2[j - 1]) &#123;                  dp[i][j] = dp[i - 1][j - 1] + 1;              &#125; else &#123;                  dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);              &#125;          &#125;      &#125;        // System.out.println(Arrays.deepToString(dp));        return dp[nums1.length][nums2.length];  &#125;\n53 æœ€å¤§å­åºå’Œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/maximum-subarray/)\n\n\nç¡®å®š dp[i] çš„å«ä¹‰ï¼šæ•°ç»„é•¿åº¦ä¸º i æ—¶çš„æœ€å¤§å­åºå’Œã€‚\n\n\né€’æ¨å…¬å¼ï¼šå¦‚æœå½“å‰ä½ç½®å…ƒç´ ç›¸åŒï¼šdp[i] = Math.max(dp[i - 1] + nums[i], nums[i]); ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼ši = 0 æ—¶ï¼Œå– nums[0] çš„å€¼\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int maxSubArray(int[] nums) &#123;      int[] dp = new int[nums.length];        dp[0] = nums[0];      int max = dp[0];        for (int i = 1; i &lt; dp.length; i++) &#123;          dp[i] = Math.max(dp[i - 1] + nums[i], nums[i]);          max = Math.max(max, dp[i]);      &#125;        System.out.println(Arrays.toString(dp));        return max;  &#125;\n392 åˆ¤æ–­å­åºåˆ—\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šs åˆ° i - 1ï¼›t åˆ° j - 1 ä½ç½®çš„ç›¸åŒå­åºåˆ—é•¿åº¦ã€‚\n\n\né€’æ¨å…¬å¼ï¼šå¦‚æœå½“å‰ä½ç½®å…ƒç´ ç›¸åŒï¼šdp[i][j] = dp[i - 1][j - 1] + 1; ï¼Œ å¦‚æœå½“å‰ä½ç½®å…ƒç´ ä¸åŒï¼šdp[i][j] = dp[i][j - 1]; ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼ši = 0 æˆ– j = 0 æ—¶ï¼Œdp å€¼ä¸º 0\n\n\néå†é¡ºåºï¼šä»å‰å‘åéå†ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/is-subsequence)\npublic boolean isSubsequence(String s, String t) &#123;      int[][] dp = new int[s.length() + 1][t.length() + 1];          for (int i = 1; i &lt;= s.length(); i++) &#123;          for (int j = 1; j &lt;= t.length(); j++) &#123;              // å½“å‰æŒ‡é’ˆä½ç½®ç›¸åŒï¼Œdp[i][j] = dp[i - 1][j - 1] + 1              if (s.charAt(i - 1) == t.charAt(j - 1)) &#123;                  dp[i][j] = dp[i - 1][j - 1] + 1;              &#125; else &#123;                  dp[i][j] = dp[i][j - 1];              &#125;          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[s.length()][t.length()] == s.length();  &#125;\nçœ‹è§£æ\n1143 æœ€é•¿å…¬å…±å­åºåˆ—\nè§£æï¼š(https://programmercarl.com/1143.æœ€é•¿å…¬å…±å­åºåˆ—.html)\n\n\näºŒç»´æ•°ç»„ä¼˜åŒ–\n\ndp æ•°ç»„çš„å®šä¹‰ä¿®æ”¹ä¸º dp[i][j]ï¼šé•¿åº¦ä¸º [0, i - 1] çš„å­—ç¬¦ä¸² text1 ä¸é•¿åº¦ä¸º [0, j - 1] çš„å­—ç¬¦ä¸² text2 çš„æœ€é•¿å…¬å…±å­åºåˆ—ä¸º dp[i][j]ï¼ˆå³å¤šï¼‰\nåˆå§‹åŒ–å³ i ä¸º 0ï¼Œj ä¸º 0 æ—¶ï¼Œdp[i][j] çš„å€¼ä¹Ÿä¸º 0\n\n\n\npublic int longestCommonSubsequence(String text1, String text2) &#123;      int[][] dp = new int[text1.length() + 1][text2.length() + 1];      for (int i = 1; i &lt;= text1.length(); i++) &#123;          for (int j = 1; j &lt;= text2.length(); j++) &#123;              // å½“å‰æŒ‡é’ˆä½ç½®ç›¸åŒï¼Œdp[i][j] = dp[i - 1][j - 1] + 1              if (text1.charAt(i - 1) == text2.charAt(j - 1)) &#123;                  dp[i][j] = dp[i - 1][j - 1] + 1;              &#125; else &#123;                  dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);              &#125;          &#125;      &#125;    \t// System.out.println(Arrays.deepToString(dp));        return dp[text1.length()][text2.length()];  &#125;\n\n\nä¸€ç»´æ•°ç»„ä¼˜åŒ–\n\n\nclass Solution &#123;    public int longestCommonSubsequence(String text1, String text2) &#123;        int n1 = text1.length();        int n2 = text2.length();                // å¤šä»äºŒç»´dpæ•°ç»„è¿‡ç¨‹åˆ†æ          // å…³é”®åœ¨äº  å¦‚æœè®°å½•  dp[i - 1][j - 1]        // å› ä¸º dp[i - 1][j - 1]  &lt;!=&gt;  dp[j - 1]  &lt;=&gt;  dp[i][j - 1]        int [] dp = new int[n2 + 1];        for(int i = 1; i &lt;= n1; i++)&#123;            // è¿™é‡Œpreç›¸å½“äº dp[i - 1][j - 1]            int pre = dp[0];            for(int j = 1; j &lt;= n2; j++)&#123;                //ç”¨äºç»™preèµ‹å€¼                int cur = dp[j];                if(text1.charAt(i - 1) == text2.charAt(j - 1))&#123;                    //è¿™é‡Œpreç›¸å½“äºdp[i - 1][j - 1]   åƒä¸‡ä¸èƒ½ç”¨dp[j - 1] !!                    dp[j] = pre + 1;                &#125; else&#123;                    // dp[j]     ç›¸å½“äº   dp[i - 1][j]                    // dp[j - 1] ç›¸å½“äº   dp[i][j - 1]                    dp[j] = Math.max(dp[j], dp[j - 1]);                &#125;                //æ›´æ–°dp[i - 1][j - 1], ä¸ºä¸‹æ¬¡ä½¿ç”¨åšå‡†å¤‡                pre = cur;            &#125;        &#125;        return dp[n2];    &#125;&#125;\n1035 ä¸ç›¸äº¤çš„çº¿\nè§£æï¼š(https://programmercarl.com/1035.ä¸ç›¸äº¤çš„çº¿.html)\n53 æœ€å¤§å­åºå’Œ\nè§£æï¼š(https://programmercarl.com/0053.æœ€å¤§å­åºå’Œï¼ˆåŠ¨æ€è§„åˆ’ï¼‰.html)\n392 åˆ¤æ–­å­åºåˆ—\nè§£æï¼š(https://programmercarl.com/0392.åˆ¤æ–­å­åºåˆ—.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å››åä¸‰å¤©-115ä¸åŒçš„å­åºåˆ—ã€583ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œã€72ç¼–è¾‘è·ç¦»","url":"/posts/ca280c35/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼š115 ä¸ä¼šã€583 æ ¹æ® 115ACã€72 ä¸ä¼š\n\n\næ›´æ–°\n\n\n24-07-08 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n115 ä¸åŒçš„å­åºåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/distinct-subsequences/)\n583 ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/delete-operation-for-two-strings/)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šs åˆ° i - 1ï¼›t åˆ° j - 1 ä½ç½®çš„åˆ é™¤ç›¸åŒéœ€è¦çš„æœ€å°æ­¥æ•°ã€‚\n\n\né€’æ¨å…¬å¼ï¼šå¦‚æœå½“å‰ä½ç½®å…ƒç´ ç›¸åŒï¼šdp[i][j] = dp[i - 1][j - 1]; ï¼ˆå³ä¸åŠ è¿™ä¸ªå…ƒç´ æ—¶çš„å­åºåˆ—ä¸ªæ•° + åŠ ä¸Šè¿™ä¸ªå…ƒç´ çš„å­åºåˆ—ä¸ªæ•°ï¼‰ï¼Œ å¦‚æœå½“å‰ä½ç½®å…ƒç´ ä¸åŒï¼šdp[i][j] = Math.min(dp[i - 1][j] + 1, dp[i][j - 1] + 1); ï¼ˆç”»å›¾å³å½“å‰ä½ç½®çš„ä¸Šå·¦å†å»é™¤ä¸€ä¸ªå…ƒç´ å¹¶å–è¾ƒå°å€¼ï¼‰ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[i][0] ã€dp[0][j] éƒ½æ˜¯ä¸å…ƒç´ ä¸ªæ•°æœ‰å…³ã€‚\n\n\néå†é¡ºåºï¼šä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int minDistance(String word1, String word2) &#123;      int[][] dp = new int[word1.length() + 1][word2.length() + 1];        for (int i = 0; i &lt; dp.length; i++) &#123;          dp[i][0] = i;      &#125;      for (int i = 0; i &lt; dp[0].length; i++) &#123;          dp[0][i] = i;      &#125;        for (int i = 1; i &lt;= word1.length(); i++) &#123;          for (int j = 1; j &lt;= word2.length(); j++) &#123;              // å½“å‰æŒ‡é’ˆä½ç½®ç›¸åŒï¼Œdp[i][j] = dp[i - 1][j - 1] + 1              if (word1.charAt(i - 1) == word2.charAt(j - 1)) &#123;                  dp[i][j] = dp[i - 1][j - 1];              &#125; else &#123;                  dp[i][j] = Math.min(dp[i - 1][j] + 1, dp[i][j - 1] + 1);              &#125;          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[word1.length()][word2.length()];  &#125;\n72 ç¼–è¾‘è·ç¦»\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/edit-distance)\nçœ‹è§£æ\n115 ä¸åŒçš„å­åºåˆ—\nè§£æï¼š(https://programmercarl.com/0115.ä¸åŒçš„å­åºåˆ—.html)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šs åˆ° i - 1ï¼›t åˆ° j - 1 ä½ç½®çš„å­åºåˆ—ä¸ªæ•°ã€‚\n\n\né€’æ¨å…¬å¼ï¼šå¦‚æœå½“å‰ä½ç½®å…ƒç´ ç›¸åŒï¼šdp[i][j] = dp[i - 1][j - 1] + dp[i - 1][j]; ï¼ˆå³ä¸åŠ è¿™ä¸ªå…ƒç´ æ—¶çš„å­åºåˆ—ä¸ªæ•° + åŠ ä¸Šè¿™ä¸ªå…ƒç´ çš„å­åºåˆ—ä¸ªæ•°ï¼‰ï¼Œ å¦‚æœå½“å‰ä½ç½®å…ƒç´ ä¸åŒï¼šdp[i][j] = dp[i - 1][j];ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[i][0] ä¸€å®šéƒ½æ˜¯ 1ï¼Œå› ä¸ºä¹Ÿå°±æ˜¯æŠŠä»¥ i-1 ä¸ºç»“å°¾çš„ sï¼Œåˆ é™¤æ‰€æœ‰å…ƒç´ ï¼Œå‡ºç°ç©ºå­—ç¬¦ä¸²çš„ä¸ªæ•°å°±æ˜¯ 1ã€‚dp[0][j] ä¸€å®šéƒ½æ˜¯ 0ã€‚dp[0][0] åº”è¯¥æ˜¯ 1ã€‚\n\n\néå†é¡ºåºï¼šä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int numDistinct(String s, String t) &#123;      int[][] dp = new int[s.length() + 1][t.length() + 1];        for (int i = 0; i &lt; dp.length; i++) &#123;          dp[i][0] = 1;      &#125;        for (int i = 1; i &lt;= s.length(); i++) &#123;          for (int j = 1; j &lt;= t.length(); j++) &#123;              // å½“å‰æŒ‡é’ˆä½ç½®ç›¸åŒï¼Œdp[i][j] = dp[i - 1][j - 1] + 1              if (s.charAt(i - 1) == t.charAt(j - 1)) &#123;                  dp[i][j] = dp[i - 1][j - 1] + dp[i - 1][j];              &#125; else &#123;                  dp[i][j] = dp[i - 1][j];              &#125;          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[s.length()][t.length()];  &#125;\n583 ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ\nè§£æï¼š(https://programmercarl.com/0583.ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ.html)\n72 ç¼–è¾‘è·ç¦»\nè§£æï¼š(https://programmercarl.com/0072.ç¼–è¾‘è·ç¦».html)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šword1 åˆ° i - 1ï¼›word2 åˆ° j - 1 ä½ç½®çš„æœ€å°ç¼–è¾‘æ•°ã€‚\n\n\né€’æ¨å…¬å¼ï¼šéœ€è¦ç¡®è®¤å››ç§æƒ…å†µï¼šword1[i - 1] == word2[j - 1] æ—¶ï¼Œä¸æ“ä½œï¼›word1[i - 1] != word2[j - 1]ï¼Œå¢åˆ æ¢ã€‚å…·ä½“å…¬å¼çœ‹ä»£ç ã€‚\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šdp[i][0] ã€dp[0][j] éƒ½æ˜¯ä¸å…ƒç´ ä¸ªæ•°æœ‰å…³ï¼Œå³åˆ é™¤æ‰€æœ‰å…ƒç´ ã€‚\n\n\néå†é¡ºåºï¼šä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³ã€‚\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int minDistance(String word1, String word2) &#123;      int[][] dp = new int[word1.length() + 1][word2.length() + 1];        for (int i = 0; i &lt; dp.length; i++) &#123;          dp[i][0] = i;      &#125;      for (int i = 0; i &lt; dp[0].length; i++) &#123;          dp[0][i] = i;      &#125;        for (int i = 1; i &lt;= word1.length(); i++) &#123;          for (int j = 1; j &lt;= word2.length(); j++) &#123;              if (word1.charAt(i - 1) == word2.charAt(j - 1)) &#123;                  dp[i][j] = dp[i - 1][j - 1];              &#125; else &#123;                  // ä¸‰æ•°æ¯”è¾ƒ                  // word1åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå°±æ˜¯ä»¥ä¸‹æ ‡i - 2ä¸ºç»“å°¾çš„word1 ä¸ j-1ä¸ºç»“å°¾çš„word2çš„æœ€è¿‘ç¼–è¾‘è·ç¦» å†åŠ ä¸Šä¸€ä¸ªæ“ä½œã€‚                  // word2åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå°±æ˜¯ä»¥ä¸‹æ ‡i - 1ä¸ºç»“å°¾çš„word1 ä¸ j-2ä¸ºç»“å°¾çš„word2çš„æœ€è¿‘ç¼–è¾‘è·ç¦» å†åŠ ä¸Šä¸€ä¸ªæ“ä½œã€‚                  // æ›¿æ¢å…ƒç´ ï¼Œword1æ›¿æ¢word1[i - 1]ï¼Œä½¿å…¶ä¸word2[j - 1]ç›¸åŒï¼Œæ­¤æ—¶ä¸ç”¨å¢åˆ åŠ å…ƒç´ ã€‚                  dp[i][j] = Math.min(Math.min(dp[i - 1][j - 1], dp[i - 1][j]), Math.min(dp[i - 1][j], dp[i][j - 1])) + 1;              &#125;          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));        return dp[word1.length()][word2.length()];  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å››åå››å¤©-647å›æ–‡å­ä¸²ã€516æœ€é•¿å›æ–‡å­åºåˆ—","url":"/posts/aa7c5f5/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼š647 çœ‹è§£æï¼Œ516 çœ‹è§£æ\n\n\næ›´æ–°\n\n\n24-07-09 åˆå§‹è®°å½•24-07-10 å®Œæˆ\n\nåˆæ­¥é¢˜è§£\n647 å›æ–‡å­ä¸²\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/palindromic-substrings)\n516 æœ€é•¿å›æ–‡å­åºåˆ—\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/longest-palindromic-subsequence)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šè¡¨ç¤ºåŒºé—´èŒƒå›´ [i,j] ï¼ˆæ³¨æ„æ˜¯å·¦é—­å³é—­ï¼‰çš„å­ä¸²çš„æœ€é•¿å›æ–‡å­ä¸²çš„é•¿åº¦ã€‚\n\n\né€’æ¨å…¬å¼ï¼šs[i] ä¸ s[j] ç›¸ç­‰ï¼Œs[i] ä¸ s[j] ä¸ç›¸ç­‰è¿™ä¸¤ç§æƒ…å†µï¼šä¸ç›¸ç­‰å–å·¦å³æŒ‡é’ˆå‘å†…ç§»åŠ¨çš„æœ€å¤§å€¼ï¼›ç›¸ç­‰ dp[i][j] = dp[i + 1][j - 1] + 2;  \n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šç›¸ç­‰æ—¶ï¼Œå– 1ã€‚\n\n\néå†é¡ºåºï¼šä»ä¸‹åˆ°ä¸Šï¼Œä»å·¦åˆ°å³éå†\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int longestPalindromeSubseq(String s) &#123;      int[][] dp = new int[s.length()][s.length()];        for (int i = 0; i &lt; s.length(); i++) &#123;          dp[i][i] = 1;      &#125;        int max= 0;      for (int i = s.length() - 1; i &gt;= 0; i--) &#123;          for (int j = i + 1; j &lt; s.length(); j++) &#123;              if (s.charAt(i) == s.charAt(j)) &#123;                  dp[i][j] = dp[i + 1][j - 1] + 2;              &#125; else &#123;                  dp[i][j] = Math.max(dp[i + 1][j], dp[i][j - 1]);              &#125;              max = Math.max(dp[i][j], max);          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));        return max;  &#125;\nçœ‹è§£æ\n647 å›æ–‡å­ä¸²\nè§£æï¼š(https://programmercarl.com/0647.å›æ–‡å­ä¸².html)\n\n\nç¡®å®š dp[i][j] çš„å«ä¹‰ï¼šè¡¨ç¤ºåŒºé—´èŒƒå›´ [i,j] ï¼ˆæ³¨æ„æ˜¯å·¦é—­å³é—­ï¼‰çš„å­ä¸²æ˜¯å¦æ˜¯å›æ–‡å­ä¸²ï¼Œå¦‚æœæ˜¯ dp[i][j] ä¸º trueï¼Œå¦åˆ™ä¸º falseã€‚\n\n\né€’æ¨å…¬å¼ï¼šs[i] ä¸ s[j] ç›¸ç­‰ï¼Œs[i] ä¸ s[j] ä¸ç›¸ç­‰è¿™ä¸¤ç§æƒ…å†µï¼šä¸ç›¸ç­‰å³ä¸º falseï¼›ç›¸ç­‰åˆ†ä¸ºä¸‰ç§æƒ…å†µï¼šä¸‹æ ‡ i ä¸ j ç›¸åŒï¼ŒåŒä¸€ä¸ªå­—ç¬¦è¿”å› trueï¼›ä¸‹æ ‡ i ä¸ j ç›¸å·®ä¸º 1ï¼Œè¿”å› trueï¼›i ä¸ j ç›¸å·®å¤§äº 1 çš„æ—¶å€™ï¼Œåˆ¤æ–­ dp[i + 1][j - 1] æ˜¯å¦ä¸º true\n\n\ndp æ•°ç»„çš„åˆå§‹åŒ–ï¼šå…¨ä¸º false\n\n\néå†é¡ºåºï¼šä»ä¸‹åˆ°ä¸Šï¼Œä»å·¦åˆ°å³éå†\n\n\næ‰“å° dp æ•°ç»„ï¼ˆç”¨äº debugï¼‰\n\n\npublic int countSubstrings(String s) &#123;      boolean[][] dp = new boolean[s.length()][s.length()];        int num = 0;        for (int i = s.length() - 1; i &gt;= 0; i--) &#123;          for (int j = i; j &lt; s.length(); j++) &#123;              if (s.charAt(i) != s.charAt(j)) &#123;                  dp[i][j] = false;              &#125; else &#123;                  if (j - i &lt;= 1) &#123;                      dp[i][j] = true;                  &#125; else &#123;                      dp[i][j] = dp[i + 1][j - 1];                  &#125;              &#125;              if (dp[i][j]) &#123;                  num++;              &#125;          &#125;      &#125;        System.out.println(Arrays.deepToString(dp));        return num;  &#125;\n516 æœ€é•¿å›æ–‡å­åºåˆ—\nè§£æï¼š(https://programmercarl.com/0516.æœ€é•¿å›æ–‡å­åºåˆ—.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŠ¨æ€è§„åˆ’"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å››åäº”å¤©-739æ¯æ—¥æ¸©åº¦ã€496ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  Iã€503ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ II","url":"/posts/d0198d2/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼š739 çœ‹è§£æã€‚496 çœ‹è§£æã€‚503 æ ¹æ® 739 å†™å‡ºã€‚\n\n\næ›´æ–°\n\n\n24-07-11 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n739 æ¯æ—¥æ¸©åº¦\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/daily-temperatures)\n496 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/next-greater-element-i)\n503 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/next-greater-element-ii)\npublic static int[] nextGreaterElements(int[] nums) &#123;      int[] result = new int[nums.length];      Arrays.fill(result, -1);        Stack&lt;Integer&gt; stack = new Stack&lt;&gt;();      stack.push(0);        for (int i = 0; i &lt; nums.length * 2; i++) &#123;          while (!stack.isEmpty() &amp;&amp; nums[i % nums.length] &gt; nums[stack.peek()]) &#123;              result[stack.peek()] = nums[i % nums.length];              stack.pop();          &#125;          stack.push(i % nums.length);      &#125;        return result;  &#125;\nçœ‹è§£æ\n739 æ¯æ—¥æ¸©åº¦\nè§£æï¼š(https://programmercarl.com/0739.æ¯æ—¥æ¸©åº¦.html)\n\n\næƒ…å†µä¸€ï¼šå½“å‰éå†çš„å…ƒç´  T[i] å°äºæ ˆé¡¶å…ƒç´  T[st.top()] çš„æƒ…å†µ\n\n\næƒ…å†µäºŒï¼šå½“å‰éå†çš„å…ƒç´  T[i] ç­‰äºæ ˆé¡¶å…ƒç´  T[st.top()] çš„æƒ…å†µ\n\n\næƒ…å†µä¸‰ï¼šå½“å‰éå†çš„å…ƒç´  T[i] å¤§äºæ ˆé¡¶å…ƒç´  T[st.top()] çš„æƒ…å†µ\n\n\npublic static int[] dailyTemperatures(int[] temperatures) &#123;      Deque&lt;Integer&gt; stack = new LinkedList&lt;&gt;();      int[] result = new int[temperatures.length];        stack.push(0);      for (int i = 1; i &lt; temperatures.length; i++) &#123;\t    // å½“å‰å…ƒç´ å°äºç­‰äºæ ˆé¡¶å…ƒç´ ï¼Œç›´æ¥ç»§ç»­æ”¾å…¥          if (temperatures[i] &lt;= temperatures[stack.peek()]) &#123;              stack.push(i);          // å½“å‰å…ƒç´ å¤§äºæ ˆé¡¶å…ƒç´ ï¼Œå¼¹å‡ºå…ƒç´ ï¼Œè®¡ç®—resultï¼Œï¼ˆç›´åˆ°å½“å‰å…ƒç´ ä¸å¤§äºæ ˆé¡¶å…ƒç´ ï¼‰ï¼Œå°†å½“å‰å…ƒç´ åŠ å…¥æ ˆ        &#125; else &#123;              while (!stack.isEmpty() &amp;&amp; temperatures[i] &gt; temperatures[stack.peek()]) &#123;                  result[stack.peek()] = i - stack.peek();                  stack.pop();              &#125;              stack.push(i);          &#125;      &#125;      return result;  &#125;// ç®€åŒ–ç‰ˆæœ¬public int[] dailyTemperatures(int[] temperatures) &#123;      Deque&lt;Integer&gt; stack = new LinkedList&lt;&gt;();      int[] result = new int[temperatures.length];        stack.push(0);      for (int i = 1; i &lt; temperatures.length; i++) &#123;\t    while (!stack.isEmpty() &amp;&amp; temperatures[i] &gt; temperatures[stack.peek()]) &#123;                  result[stack.peek()] = i - stack.peek();                  stack.pop();              &#125;          stack.push(i);        &#125;      return result;  &#125;\n496 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I\nè§£æï¼š(https://programmercarl.com/0496.ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ I.html)\npublic int[] nextGreaterElement(int[] nums1, int[] nums2) &#123;      int[] result = new int[nums1.length];      Stack&lt;Integer&gt; stack = new Stack&lt;&gt;();        Arrays.fill(result, -1);        HashMap&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();      for (int i = 0; i &lt; nums1.length; i++) &#123;          map.put(nums1[i], i);      &#125;        stack.push(0);        for (int i = 1; i &lt; nums2.length; i++) &#123;          if (nums2[i] &lt;= nums2[stack.peek()]) &#123;              stack.push(i);          &#125; else &#123;  \t        // æ ˆä¸­ä¿å­˜äº†ä¸Šä¸ªéœ€è¦æ¯”è¾ƒçš„å¯¹è±¡            while (!stack.isEmpty() &amp;&amp; nums2[i] &gt; nums2[stack.peek()]) &#123;                  // num1ä¸­åŒ…å«æ•´è¿™ä¸ªå…ƒç´                   if (map.containsKey(nums2[stack.peek()])) &#123;                      // resultä¸­çš„å¯¹åº”ä¸‹æ ‡ä¸ºè¿™ä¸ªå…ƒç´ çš„åä¸€ä½                      result[map.get(nums2[stack.peek()])] = nums2[i];                  &#125;                  stack.pop();              &#125;              stack.push(i);          &#125;      &#125;      return result;  &#125;\n503 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II\nè§£æï¼š(https://programmercarl.com/0503.ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ II.html)\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å•è°ƒæ ˆ"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å››åå…­å¤©-42æ¥é›¨æ°´ã€84æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢","url":"/posts/82b551fe/","content":"\n\nå‰è¨€\nçŠ¶æ€ï¼š42 çœ‹è§£æã€‚84 çœ‹è§£æã€‚\n\n\næ›´æ–°\n\n\n24-07-13 åˆå§‹è®°å½•24-07-16 å®Œæˆ\n\nåˆæ­¥é¢˜è§£\n42 æ¥é›¨æ°´\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/trapping-rain-water/)\n84 æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/largest-rectangle-in-histogram)\nçœ‹è§£æ\n42 æ¥é›¨æ°´\nè§£æï¼š(https://programmercarl.com/0042.æ¥é›¨æ°´.html)\n\n\nå½“å‰é«˜åº¦å°äºç­‰äºæ ˆé¡¶é«˜åº¦ï¼Œå…¥æ ˆï¼ŒæŒ‡é’ˆåç§»ã€‚\n\n\nå½“å‰é«˜åº¦å¤§äºæ ˆé¡¶é«˜åº¦ï¼Œå‡ºæ ˆï¼Œè®¡ç®—å‡ºå½“å‰å¢™å’Œæ ˆé¡¶çš„å¢™ä¹‹é—´æ°´çš„å¤šå°‘ï¼Œç„¶åè®¡ç®—å½“å‰çš„é«˜åº¦å’Œæ–°æ ˆçš„é«˜åº¦çš„å…³ç³»ï¼Œé‡å¤ç¬¬ 2 æ­¥ã€‚ç›´åˆ°å½“å‰å¢™çš„é«˜åº¦ä¸å¤§äºæ ˆé¡¶é«˜åº¦æˆ–è€…æ ˆç©ºï¼Œç„¶åæŠŠå½“å‰å¢™å…¥æ ˆï¼ŒæŒ‡é’ˆåç§»ã€‚\n\n\npublic int trap(int[] height) &#123;      Stack&lt;Integer&gt; stack = new Stack&lt;&gt;();        int area = 0;        stack.push(0);      for (int i = 1; i &lt; height.length; i++) &#123;          if (height[i] &lt;= height[stack.peek()]) &#123;              stack.push(i);          &#125; else &#123;              // å½“å‰å…ƒç´ å°äºæ ˆé¡¶å…ƒç´               if (height[stack.peek()] &gt;= height[i]) &#123;                  stack.push(i);              &#125; else &#123;                  while (!stack.isEmpty() &amp;&amp; height[i] &gt; height[stack.peek()]) &#123;                      // å½“å‰çš„æ ˆé¡¶                      Integer mid = stack.pop();                      if (!stack.isEmpty()) &#123;                          int h = Math.min(height[stack.peek()], height[i]) - height[mid];                          int w = i - stack.peek() - 1;                          area += h * w;                      &#125;                  &#125;                  stack.push(i);              &#125;          &#125;      &#125;      return area;  &#125;\n84 æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢\nè§£æï¼š(https://programmercarl.com/0084.æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢.html)\næœ¬é¢˜æ˜¯è¦æ‰¾æ¯ä¸ªæŸ±å­å·¦å³ä¸¤è¾¹ç¬¬ä¸€ä¸ªå°äºè¯¥æŸ±å­çš„æŸ±å­ï¼Œæ‰€ä»¥ä»æ ˆå¤´ï¼ˆå…ƒç´ ä»æ ˆå¤´å¼¹å‡ºï¼‰åˆ°æ ˆåº•çš„é¡ºåºåº”è¯¥æ˜¯ä»å¤§åˆ°å°çš„é¡ºåº\npublic int largestRectangleArea(int[] heights) &#123;      Stack&lt;Integer&gt; stack = new Stack&lt;&gt;();      // é¦–æœ«å°¾åŠ é›¶é˜²æ­¢æ— æ³•è¿›å…¥å¾ªç¯      int[] newHeights = new int[heights.length + 2];      for (int i = 1; i &lt; newHeights.length - 1; i++) &#123;          newHeights[i] = heights[i - 1];      &#125;      newHeights[heights.length + 1] = 0;      newHeights[0] = 0;        int area = 0;      stack.push(0);      for (int i = 0; i &lt; newHeights.length; i++) &#123;          while (!stack.isEmpty() &amp;&amp; newHeights[i] &lt; newHeights[stack.peek()]) &#123;              // å½“å‰å…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´               Integer mid = stack.pop();              // å³ä¾§æ•°æ®ä¸å·¦ä¾§æ•°æ®çš„å·®å€¼              int w = i - stack.peek() - 1;              area = Math.max(area, w * newHeights[mid]);          &#125;          stack.push(i);      &#125;        return area;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["å•è°ƒæ ˆ"]},{"title":"ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥ç¬¬å…«å¤©-28å®ç° strStr() ã€459é‡å¤çš„å­å­—ç¬¦ä¸²","url":"/posts/45e5605f/","content":"\n\nå‰è¨€çŠ¶æ€ï¼š28 æš´åŠ›ï¼ˆåº”ä¸º KMPï¼‰ã€459 æš´åŠ›ï¼ˆKMP ä¸ä¼šï¼‰\n\n\næ›´æ–°\n\n\n24-05-29 åˆå§‹è®°å½•\n\nåˆæ­¥é¢˜è§£\n28 å®ç° strStr()\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/find-the-index-of-the-first-occurrence-in-a-string/description/)\npublic class LE28 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          String haystack = scanner.nextLine();          String needle = scanner.nextLine();          System.out.println(strStr(haystack, needle));      &#125;        /**       * æ€è·¯ï¼šä¸€ä¸ªæŒ‡é’ˆé’ˆå¯¹haystackéå†ï¼Œä¸€ä¸ªæŒ‡é’ˆé’ˆå¯¹needleéå†       * å½“æŒ‡é’ˆæŒ‡è¿‡çš„è·¯å¾„ç›¸ç­‰ï¼Œè¾“å‡ºä¸¤è€…çš„å·®ï¼ˆå³åˆå§‹ç›¸ç­‰çš„æŒ‡é’ˆä½ç½®ï¼‰       * å½“æŒ‡å‘å…ƒç´ ä¸åŒï¼ŒhaystackæŒ‡é’ˆæŒ‡å‘åˆå§‹å¯¹æ¯”çš„ä¸‹ä¸€ä¸ªï¼ŒneedleæŒ‡é’ˆé‡ç½®       */      public static int strStr(String haystack, String needle) &#123;          int j = 0;          for (int i = 0; i &lt; haystack.length(); i++) &#123;              if (haystack.charAt(i) == needle.charAt(j)) &#123;                  if (j == needle.length() - 1) &#123;                      return i - j;                  &#125;                  j++;              &#125; else &#123;                  i = i - j;                  j = 0;              &#125;          &#125;          return  -1;      &#125;  &#125;\n459 é‡å¤çš„å­å­—ç¬¦ä¸²\né¢˜ç›®é“¾æ¥ï¼š(https://leetcode.cn/problems/repeated-substring-pattern/description/)\nï¼ˆè™½ç„¶è®²äº† KMP åº”è¯¥å°±ç”¨ KMPï¼Œä½†æ˜¯ä¸ä¼šï¼‰\n// æš´åŠ›æ±‚è§£public class LE459 &#123;      public static void main(String[] args) &#123;          Scanner scanner = new Scanner(System.in);          String nextLine = scanner.nextLine();          System.out.println(repeatedSubstringPattern(nextLine));      &#125;        public static boolean repeatedSubstringPattern(String s) &#123;          int n = s.length();          for (int i = 1; i * 2 &lt;= n; i++) &#123;              if (n % i == 0) &#123;                  boolean match = true;                  for (int j = i; j &lt; n; j++) &#123;                      if (s.charAt(j) != s.charAt(j - i)) &#123;                          match = false;                          break;                      &#125;                  &#125;                  if (match) &#123;                      return true;                  &#125;              &#125;          &#125;            return false;      &#125;  &#125;\nçœ‹è®²è§£\n28 å®ç° strStr()\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0028.å®ç°strStr.html)\næœ¬é¢˜åº”è¯¥ç”¨ KMP æ€è·¯ï¼Œè¿™ä¸ªç®—æ³•ä¸»è¦ç”¨åœ¨å­—ç¬¦ä¸²åŒ¹é…ä¸Šã€‚KMP çš„ç»å…¸æ€æƒ³å°±æ˜¯:å½“å‡ºç°å­—ç¬¦ä¸²ä¸åŒ¹é…æ—¶ï¼Œå¯ä»¥è®°å½•ä¸€éƒ¨åˆ†ä¹‹å‰å·²ç»åŒ¹é…çš„æ–‡æœ¬å†…å®¹ï¼Œåˆ©ç”¨è¿™äº›ä¿¡æ¯é¿å…ä»å¤´å†å»åšåŒ¹é…ã€‚\n/**   * æ€è·¯ï¼šä½¿ç”¨KMPç®—æ³•ã€‚   * ä¹‹å‰åŒæŒ‡é’ˆç§»åŠ¨ï¼Œä¸ç›¸ç­‰haystackçš„æŒ‡é’ˆè¿”å›åˆ°åˆå§‹åŒ¹é…ä½ç½®çš„ä¸‹ä¸€ä½ï¼ˆæš´åŠ›æ±‚è§£ï¼‰   * ç°åœ¨ä½¿ç”¨KMPç®—æ³•ï¼Œä¸ç›¸ç­‰ç§»åŠ¨åˆ°nextè¡¨ä¸­æ ‡è®°çš„ä½ç½®ã€‚   * æ‰€ä»¥ç°åœ¨çš„å…³é”®å°±åœ¨äºnextè¡¨çš„è®¡ç®—ï¼š   * 1.åˆå§‹åŒ–   * 2.å½“å‰åç¼€ä¸ç›¸ç­‰æ—¶çš„æ€è·¯ï¼ˆå›é€€ï¼‰   * 3.å½“å‰åç¼€ç›¸ç­‰æ—¶çš„æ€è·¯ï¼ˆç»§ç»­åç§»ï¼‰   * å†…éƒ¨ç›¸å½“äºä¹Ÿè¿›è¡Œäº†KMP */  public static int strStr1(String haystack, String needle) &#123;      // è·å–Nextè¡¨      int[] ints = new int[needle.length()];      int[] next = getNext(ints, needle);        int j = 0;      if (needle.length() == 0) &#123;          return -1;      &#125;      for (int i = 0; i &lt; haystack.length(); i++) &#123;          // ä¸ç›¸ç­‰, jå›é€€          while (j != 0 &amp;&amp; haystack.charAt(i) != needle.charAt(j)) &#123;              j = next[j - 1];          &#125;          // ç›¸ç­‰          if (haystack.charAt(i) == needle.charAt(j)) &#123;              // å®Œå…¨åŒ¹é…ï¼Œè¿”å›ä¸‹æ ‡              if (j == needle.length() - 1) &#123;                  return i - j;              &#125;              j++;          &#125;        &#125;      return  -1;  &#125;    /**   * è·å–nextè¡¨ï¼Œä¾‹ï¼š   * a a b a a f   * 0 1 0 1 2 0 * * 1.åˆå§‹åŒ–   * 2.å½“å‰åç¼€ä¸ç›¸ç­‰æ—¶çš„æ€è·¯ï¼ˆå›é€€ï¼‰   * 3.å½“å‰åç¼€ç›¸ç­‰æ—¶çš„æ€è·¯ï¼ˆç»§ç»­åç§»ï¼‰   *   * @param next è¿”å›çš„nextæ•°ç»„   * @param s è¦æ±‚çš„å­—ç¬¦ä¸²   * @return nextæ•°ç»„   */  private static int[] getNext(int[] next, String s) &#123;      // åˆå§‹åŒ– ä¸¤ä¸ªæŒ‡é’ˆiå’Œjï¼ŒjæŒ‡å‘å‰ç¼€æœ«å°¾ä½ç½®(åŒæ—¶ä¹Ÿæ˜¯ä¹‹å‰æœ€é•¿ç›¸ç­‰çš„å‰åç¼€é•¿åº¦)ï¼ŒiæŒ‡å‘åç¼€æœ«å°¾ä½ç½®(éšç€å­—ç¬¦ä¸²é•¿åº¦é€’å¢ï¼Œé€’å¢)ã€‚      // åˆšåˆšåˆå§‹åŒ–æ—¶ï¼Œå­—ç¬¦ä¸²ä¸ºaï¼Œæ‰€ä»¥j = 0      int j = 0;      next[0] = j;        // è¿™é‡Œiä»1å¼€å§‹ï¼Œæ²¡æœ‰ææ‡‚(å› ä¸ºåˆå§‹ä½ç½®ä¸€å®šä¸º0å—)      for (int i = 1; i &lt; s.length(); i++) &#123;          while (j != 0 &amp;&amp; s.charAt(i) != s.charAt(j)) &#123;              j = next[j - 1];          &#125;          if (s.charAt(i) == s.charAt(j)) &#123;              j++;          &#125;          next[i] = j;      &#125;      return next;  &#125;\n459 é‡å¤çš„å­å­—ç¬¦ä¸²\né¢˜ç›®é“¾æ¥/æ–‡ç« è®²è§£/è§†é¢‘è®²è§£ï¼š(https://programmercarl.com/0459.é‡å¤çš„å­å­—ç¬¦ä¸².html)\n/**   * KMPæ€è·¯   * å¦‚æœè¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ç”±é‡å¤å­ä¸²ç»„æˆçš„ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²é•¿åº¦-æœ€é•¿ç›¸ç­‰å‰åç¼€å°±ä¸ºé‡å¤å­ä¸²çš„é•¿åº¦   * åè¿‡æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿ç›¸ç­‰å‰åç¼€ä¸é•¿åº¦çš„å·®å€¼ï¼ˆå³å¯èƒ½æ˜¯é‡å¤å­ä¸²é•¿åº¦çš„è¿™ä¸ªå€¼ï¼‰èƒ½è¢«å­—ç¬¦ä¸²é•¿åº¦æ•´é™¤ï¼Œé‚£ä¹ˆå°±è¯´æ˜è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ç”±é‡å¤å­ä¸²ç»„æˆçš„   * ä½†æ˜¯è¿™ä¸ªåè¿‡æ¥è¯´ã€‚éœ€è¦è¯æ˜ã€‚ï¼ˆè™½ç„¶ç”»äº†å‡ ç§æƒ…å†µéƒ½æ˜¯è¿™æ ·ï¼‰   *   * KMPå¤ä¹ ï¼š   * 1.åˆå§‹åŒ–   * 2.ä¸ç›¸ç­‰çš„æƒ…å†µ   * 3.ç›¸ç­‰çš„æƒ…å†µ   */  public static boolean repeatedSubstringPattern1(String s) &#123;      int[] next = getNext(s);      // è¿™é‡Œé™¤äº†ä¸Šé¢è¯´çš„æ¡ä»¶ä¹‹å¤–ï¼Œè¿˜éœ€è¦åŠ ä¸Šnext[len - 1] != -1, è¿™è¯´æ˜å­—ç¬¦ä¸²æœ‰æœ€é•¿ç›¸åŒçš„å‰åç¼€ï¼ˆå°±æ˜¯å­—ç¬¦ä¸²é‡Œçš„å‰ç¼€å­ä¸²å’Œåç¼€å­ä¸²ç›¸åŒçš„æœ€é•¿é•¿åº¦ï¼‰      return next[s.length() - 1] != 0 &amp;&amp; s.length() % (s.length() - next[s.length() - 1]) == 0;  &#125;    private static int[] getNext(String s) &#123;      int j = 0;      int[] next = new int[s.length()];      next[j] = 0;        for (int i = 1; i &lt; s.length(); i++) &#123;          while (j != 0 &amp;&amp; s.charAt(i) != s.charAt(j)) &#123;              j = next[j - 1];          &#125;          if (s.charAt(i) == s.charAt(j)) &#123;              j++;          &#125;          next[i] = j;      &#125;        return next;  &#125;\n","categories":["é¢è¯•","ä»£ç éšæƒ³å½•"],"tags":["åŒæŒ‡é’ˆ","å­—ç¬¦ä¸²","KMP"]},{"title":"Obsidian + Git + Hexo + å›¾åºŠ = Blog + ä¸ªäººç¬”è®°ä½“ç³»","url":"/posts/121fccfa/","content":"\n\nå‰è¨€ä¹‹å‰æœ‰è¿‡åŸºäº Hexo çš„åšå®¢æ­å»ºç»å†ï¼Œä½†æ˜¯ç”±äºæ—¶é—´ç¹å¿™ï¼ŒåŠ ä¸Šåç»­å­¦ä¹ äº†è§£åˆ°çš„ç¬”è®°è½¯ä»¶ï¼Œæ‹¥æœ‰æˆ‘æƒ³è¦çš„å…¨å±€æœç´¢åŠŸèƒ½ï¼Œè€Œä¸”æ¯”åšå®¢çš„æ ¼å¼ã€æ’ç‰ˆæ›´åŠ å¸å¼•äººï¼Œå°±æ”¾å¼ƒäº†ä¹‹å‰æ­å»ºçš„åšå®¢ã€‚ä½†æ˜¯å‡ºæ¥æ‰¾å·¥ä½œæ„Ÿè§‰æ‹¥æœ‰ä¸€ä¸ªè‡ªå·±çš„æŠ€æœ¯åšå®¢ä¼šæ¯”è¾ƒå ä¼˜åŠ¿ï¼Œå› æ­¤æ‰“ç®—åœ¨ç¬”è®°çš„åŸºç¡€ä¸Šï¼ŒåŠ ä¸ŠåŸæ¥çš„ Hexo å¿«é€Ÿç”Ÿæˆï¼Œè½¬æˆæŠ€æœ¯åšå®¢è¾“å‡ºã€‚\n\n\nå‚è€ƒæ–‡ç« \n\n\n\nã€ä¿å§†çº§ã€‘åˆ©ç”¨Githubæ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢ï¼Œçœ‹å®Œå°±ä¼š\nHexo + Obsidian + Git å®Œç¾çš„åšå®¢éƒ¨ç½²ä¸ç¼–è¾‘æ–¹æ¡ˆ\n\n\n\næ›´æ–°\n\n\n22.12.11 åˆå§‹è®°å½•(ä¿®æ”¹é¢„è®¡å¼€å§‹æ—¥æœŸä¸ºå…ƒæ—¦)23.02.24 ç¯å¢ƒéƒ¨ç½²ï¼Œä¸ªäººåšå®¢ç»‘å®šåˆ° Gitee Pages23.02.27 Obsidian æ•´åˆ ç­‰å¾…Gitee Pageså®¡æ ¸ing24.03.28 æ›´æ–°åŸŸåç»‘å®šç­‰ç›¸å…³é—®é¢˜24.06.17 æ·»åŠ æ›´å¤šåŠŸèƒ½\n\nç¯å¢ƒéƒ¨ç½²\nå®‰è£…git\n\n\nè®¿é—® git å®˜æ–¹åœ°å€ï¼Œä¸‹è½½å¯¹åº”çš„å®‰è£…åŒ…ï¼Œè¿›è¡Œå®‰è£…ï¼ˆç®€å•çš„ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼‰ã€‚\n\n\nå®‰è£…å¥½ä¹‹åï¼Œé¼ æ ‡å³é”®å¯ä»¥çœ‹åˆ°ï¼šGit Bash Hereï¼Œç‚¹å‡»åæ‰“å¼€äº†ã€‚\n\n\nè¾“å…¥ï¼šgit --version\nå‡ºç°ç‰ˆæœ¬å·è¯´æ˜å®‰è£…æˆåŠŸã€‚\n\n\nå®‰è£…node.js\n\n\nè®¿é—® node.js å®˜æ–¹åœ°å€ï¼Œä¸‹è½½å¯¹åº”çš„å®‰è£…åŒ…ï¼Œè¿›è¡Œå®‰è£…ï¼ˆç®€å•çš„ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼‰ã€‚\n\n\nå®‰è£…å¥½ä¹‹åï¼Œé…ç½®ç¯å¢ƒå˜é‡ï¼Œå¹¶åœ¨ç»ˆç«¯é‡Œé¢è¾“å…¥ï¼šnode -v\nå‡ºç°ç‰ˆæœ¬å·è¯´æ˜å®‰è£…æˆåŠŸã€‚\n\n\nå®‰è£… Hexo\n\n\nå®‰è£…å‘½ä»¤ï¼š\n\n\nnpm install hexo -g\næµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå‘½ä»¤ï¼šhexo -v\n\nå‡ºç°ç‰ˆæœ¬å·è¯´æ˜å®‰è£…æˆåŠŸã€‚\n\n\nå®‰è£… hexo æ¨é€ git æ‹“å±•ä¾èµ–ï¼Œå®‰è£…å‘½ä»¤ï¼š\n\n\nnpm installÂ hexo-deployer-git --save\ngit é…ç½® SSH key\n\n\nå…ˆçœ‹æœ¬åœ°æ˜¯å¦é…ç½®å¥½ SSH keyï¼ˆå‘½ä»¤ï¼šcd ~/.sshï¼‰\nSSH key çš„ä¿å­˜ä½ç½®åœ¨æœ¬åœ°çš„ C:\\Users\\&#123;ä½ çš„ç”¨æˆ·å&#125;\\.ssh æ–‡ä»¶ä¸‹ï¼Œå¦‚æœæœ¬åœ°å·²å­˜åœ¨ SSHï¼Œæ­¤æ­¥ä¸ä¼šæœ‰æç¤ºï¼Œå¦åˆ™å‡ºç° No such file or directoryã€‚\nå¦‚æœä¿å­˜æ–‡ä»¶ä¸‹æ²¡æœ‰æ–‡ä»¶ id_rsa.pubÂ æˆ–Â id_dsa.pub åˆ™ä¹Ÿéœ€è¦é‡æ–°ç”Ÿæˆ\n\n\nç”Ÿæˆ SSH key\nå¦‚æœæ²¡æœ‰é…ç½®è¾“å…¥ç”Ÿæˆå‘½ä»¤ï¼Œç„¶åè¿ç»­å›è½¦ä¸‰æ¬¡å³å¯ï¼š\n\n\nssh-keygen -t rsa -C &quot;é‚®ä»¶åœ°å€&quot; #è¯¥é‚®ç®±åœ°å€æ˜¯ç»‘å®šgithubè´¦å·çš„åœ°å€\ngithub\n\n\næ‰“å¼€ SSH key çš„ä¿å­˜ä½ç½®ï¼Œå¤åˆ¶ id_rsa.pub æ–‡ä»¶é‡Œå…¨éƒ¨å†…å®¹ï¼Œæ¥ç€æ‰“å¼€ github ä¸»é¡µï¼Œç‚¹å‡»ä¸ªäººè®¾ç½®ï¼Œç‚¹å‡»å·¦ä¾§çš„ SSH and GPG keysï¼Œç‚¹å‡» New SSH key\n\n\n\nå°† id_rsa.pub å¤åˆ¶çš„å†…å®¹ç²˜è´´åˆ° key ä¸­ï¼Œtitle éšä¾¿èµ·ä¸€ä¸ªå°±è¡Œã€‚\n\n\n\næµ‹è¯•æ˜¯å¦æˆåŠŸï¼Œè¾“å…¥å‘½ä»¤ï¼š\n\n\nssh -T git@github.com\nå‡ºç°  You've successfully authenticated, but GitHub does not provide shell access. è¯´æ˜æˆåŠŸ\n\n\né…ç½®è´¦å·å’Œå¯†ç \n\n\n$ git config --global user.name &quot;liyunchen&quot; #ä½ çš„githubç”¨æˆ·å $ git config --global user.email &quot;xxx@163.com&quot; #å¡«å†™ä½ çš„githubæ³¨å†Œé‚®ç®±\ngitee\n\né™¤äº† Github Pagesï¼Œä¹Ÿå¯ä»¥æŠŠåšå®¢æ­å»ºåœ¨ Gitee Pages ä¸Šï¼Œä¸ç¿»å¢™çš„æƒ…å†µä¸‹ï¼Œè¿æ¥ github ç»å¸¸ä¼šå‡ºç°è¿æ¥ä¸ä¸Šçš„æƒ…å†µï¼Œæ‰€ä»¥è¿™æ¬¡å°±ç›´æ¥æ”¹åˆ° Gitee ä¸Šäº†ã€‚åˆæ¢å›æ¥äº†ï¼Œgitee å®åœ¨å¤ªçƒ¦äº†ï¼Œéƒ¨ç½²å®Œäº†è¿˜è¦ç‚¹ç¡®å®šï¼ˆ24.02.02ï¼‰\n\n\n\nåŒæ ·çš„é…ç½® SSH keyï¼Œåœ¨ Gitee çš„ä¸ªäººè®¾ç½®ç•Œé¢æ·»åŠ å…¬é’¥\n\n\n\næµ‹è¯•æ˜¯å¦æˆåŠŸï¼Œè¾“å…¥å‘½ä»¤ï¼š\n\n\nssh -T git@gitee.com\nå‡ºç°  You've successfully authenticated, but GITEE.COM does not provide shell access. è¯´æ˜æˆåŠŸ\næ­å»ºä¸ªäººåšå®¢\n\n\næ–°å»ºä¸€ä¸ªä¿å­˜åšå®¢çš„å­˜æ”¾ç›®å½•ï¼Œè¿›å…¥åˆ°æœ¬åœ°åšå®¢å­˜æ”¾ç›®å½•ï¼Œåˆå§‹åŒ–ä¸ªäººåšå®¢ï¼Œå‘½ä»¤ï¼š\n\n\nhexo init\nå‡ºç°ä¸å¯è·å–é”™è¯¯è¯´æ˜ github è¿æ¥å¤±è´¥ï¼Œå†é‡æ–°æ‰§è¡Œä¸€éå‘½ä»¤å°±å¯ä»¥äº†\n\n\n\nç”Ÿæˆé™æ€ç½‘é¡µï¼Œå‘½ä»¤ï¼š\n\n\nhexo g\n\n\næœ¬åœ°é¢„è§ˆï¼Œå‘½ä»¤ï¼š\n\n\nhexo s\nè®¿é—® localhost:4000\ngithub\n\n\næ–°å»ºä¸€ä¸ª github ä»“åº“ï¼Œç»™ä»“åº“èµ·ä¸ªåç§°ï¼Œå¯ä»¥ä¸º ç”¨æˆ·å.github.ioï¼Œè¿™æ ·è¿™ä¸ªåç§°å°±å¯ä»¥ä½œä¸ºä½  github åšå®¢çš„è®¿é—®åœ°å€\n\n\nç¼–è¾‘ _config.ymlï¼Œæ­¤æ–‡ä»¶åœ¨ä½ åšå®¢å­˜æ”¾ç›®å½•ä¸‹ï¼Œéœ€è¦ç¼–è¾‘çš„ github åœ°å€å¡«å†™åœ¨æœ€å deploy å¤„\n\n\ndeploy: \ttype: git \trepository: #ä»“åº“åœ°å€\tbranch: main #æŸ¥çœ‹è‡ªå·±ä»“åº“æ˜¯masterè¿˜æ˜¯main\n\n\nå‘å¸ƒåˆ° githubï¼Œå‘½ä»¤ï¼š\n\n\nhexo d\nè¿™æ ·å°±å·²ç»æŠŠç”Ÿæˆçš„é™æ€æ–‡ä»¶æ¨é€åˆ° github ä»“åº“å»äº†ã€‚\ngitee\n\n\næ–°å»ºä¸€ä¸ª gitee ä»“åº“ï¼Œç»™ä»“åº“èµ·ä¸ªåç§°ï¼Œè¿™é‡Œæˆ‘ç›´æ¥ç”¨ blog ä½œä¸ºåç§°ï¼Œè¿™æ ·åšå®¢çš„è®¿é—®åœ°å€å°±æ˜¯ ç”¨æˆ·å.gitee.io/blog\n\n\nç¼–è¾‘ _config.ymlï¼Œæ­¤æ–‡ä»¶åœ¨ä½ åšå®¢å­˜æ”¾ç›®å½•ä¸‹ï¼Œæ–‡ä»¶éœ€è¦\n\n\ndeploy: \ttype: git \trepository: #ä»“åº“åœ°å€\tbranch: master #æŸ¥çœ‹è‡ªå·±ä»“åº“æ˜¯masterè¿˜æ˜¯main\n\n\nå‘å¸ƒåˆ° giteeï¼Œå‘½ä»¤ï¼š\n\n\nhexo d\n\n\nåœ¨ä¸ªäººä»“åº“ç•Œé¢ï¼Œå¼€å¯ Gitee Pages æœåŠ¡ï¼ˆç¬¬ä¸€æ¬¡ä½¿ç”¨è¿˜è¦æ‰‹æŒèº«ä»½è¯æ‹ç…§çš„å®åè®¤è¯ï¼Œè›®æ— è¯­çš„ï¼Œç»ˆäºçŸ¥é“ä¸ºä»€ä¹ˆç”¨çš„äººå°‘äº†ã€‚ã€‚ã€‚ï¼‰\n\n\n\nåšå®¢ä¸»é¢˜ï¼ˆKeepï¼‰\n\nåœ¨é…ç½®æ–‡ä»¶é‡Œå¯ä»¥çœ‹è§ Hexo ä¸»é¢˜å•†åº— çš„åœ°å€ï¼Œé…ç½®æ–‡ä»¶ä¸­é»˜è®¤çš„ä¸»é¢˜ä¸º landscapeï¼Œä¸å¤ªå–œæ¬¢æ‰“ç®—æ¢æ‰ã€‚åŸå…ˆåšå®¢ä½¿ç”¨çš„æ˜¯ Next ä¸»é¢˜ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ Hexo æ­å»ºåšå®¢ç”¨åˆ°æœ€å¤šçš„ä¸»é¢˜ï¼Œä½†æ˜¯ä¹Ÿç”¨è…»äº†ã€‚ç°åœ¨å‘ç°ä¸€ä¸ªæ–°çš„ä¸»é¢˜ Keepï¼Œæ„Ÿè§‰è›®ç®€æ´èˆ’é€‚çš„ï¼Œæ‰€ä»¥è¿™æ¬¡é‡æ–°æ­å»ºä¹Ÿæ‰“ç®—ç›´æ¥æ¢ä¸Šã€‚\n\nKeep ä¸»é¢˜çš„å®˜æ–¹é…ç½®æ–‡æ¡£å¾ˆè¯¦ç»†ï¼Œåœ¨æ¼”ç¤ºåšå®¢ä¸­æœ‰ä¸€ä¸ª ä½¿ç”¨æŒ‡å—ï¼Œç›´æ¥ç…§ç€é…ç½®å°±è¡Œã€‚\nObsidian æ•´åˆ\nObsidian çŸ¥è¯†åº“åˆ›å»º\n\n\næ–°å»ºä¸€ä¸ªä»“åº“æˆ–å°†ä¹‹å‰çš„åšå®¢æ–‡ä»¶ä½œä¸ºä»“åº“æ‰“å¼€\n\n\n\nå¿½ç•¥å¤šä½™çš„æ–‡ä»¶ã€‚æˆ‘ä»¬ä¸»è¦æ˜¯ç¼–è¾‘å’Œç®¡ç† Markdown æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸€äº›å¤šä½™çš„æ–‡ä»¶è¦å¿½ç•¥æ‰ï¼Œè¿™æ ·åœ¨çŸ¥è¯†åº“é‡Œæœç´¢æ–‡ä»¶ã€å…³é”®å­—æ—¶æ‰ä¸ä¼šæœç´¢åˆ°å¤šä½™çš„ï¼Œä¹Ÿèƒ½æœ‰æ•ˆæé«˜æ£€ç´¢æ•ˆç‡ã€‚æ‰“å¼€ï¼šè®¾ç½®&gt;æ–‡ä»¶ä¸é“¾æ¥&gt;Exclude Files\n\n\n\nè®¾ç½®æ–°å»ºç¬”è®°çš„å­˜æ”¾ä½ç½®ï¼Œå†…éƒ¨é“¾æ¥ç±»å‹~~ï¼ˆå…³é—­ Wiki é“¾æ¥çš„ä½¿ç”¨ï¼Œå› ä¸º hexo çš„è§£æè¦æ±‚ä¸º markdown æ ¼å¼çš„æ–‡ä»¶ï¼‰~~ä»¥åŠé™„ä»¶é»˜è®¤çš„å­˜æ”¾è·¯å¾„\n\n\n\nåœ¨ hexo é¡¹ç›®çš„ .gitignore æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹å†…å®¹ï¼š\n\n\n.obsidian/workspace\nåšå®¢æ–‡ç« çš„ç®¡ç†\n\næ–°å»ºæ–‡ä»¶åœ¨ hexo çš„é»˜è®¤é…ç½®ä¸­æ”¾åœ¨Â source/_postÂ ç›®å½•ä¸‹ï¼Œéšç€æ–‡ç« æ•°é‡çš„å¢å¤šï¼Œæ–‡ç« ä¹Ÿä¼šå˜å¾—éš¾ä»¥å¯»æ‰¾ã€‚å› æ­¤é‡‡ç”¨ä»¥æ–‡ä»¶å¤¹æ¥åˆ†ç›®å½•çš„æ–¹å¼ï¼Œå­˜æ”¾å†™å¥½çš„æ–‡ä»¶ã€‚ä½†æ˜¯è¿™æ ·åˆ†ç±»åï¼Œè¿˜éœ€è¦æ‰‹åŠ¨ç»´æŠ¤æ–‡ç« å¼€å§‹å‰çš„å®šä¹‰æ–‡å­—ï¼Œå»ä¿®æ”¹æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œè¾ƒä¸ºéº»çƒ¦ã€‚\n\nä¸ºäº†çœå»æ‰‹åŠ¨ç»´æŠ¤Â categorysÂ å­—æ®µçš„è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Â hexo-auto-categoryÂ è¿™ä¸ªæ’ä»¶ã€‚è¿™ä¸ªæ’ä»¶åœ¨ Hexo è¿›è¡Œ build çš„æ—¶å€™ä¼šå»è‡ªåŠ¨æ ¹æ®æ–‡ç« ç›®å½•æƒ…å†µæ¥è‡ªåŠ¨ä¿®æ”¹æ–‡ç« çš„Â categoriesÂ ä¿¡æ¯ï¼Œæ›´è¯¦ç»†çš„éƒ¨åˆ†å¯ä»¥çœ‹ ä½œè€…çš„æ–‡ç« ã€‚\né™¤æ­¤ä¹‹å¤–æœ€å¥½ä¿®æ”¹ä¸€ä¸‹Â _config.ymlÂ ä¸­çš„é»˜è®¤é…ç½®ï¼š\npermalink: :year/:month/:hash.html\nä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åªæœ‰ hexo åœ¨æ‰§è¡ŒÂ hexo generateÂ æˆ–è€…Â hexo serverÂ æ—¶å€™æ‰ä¼šå»è§¦å‘Â categoriesÂ çš„ç”Ÿæˆï¼Œé‚£ä¹ˆæ¯æ¬¡æˆ‘ä»¬åˆ›å»ºæ–‡ç« éƒ½è¦é‡æ–°Â hexo generateÂ ä»¥è§¦å‘æ’ä»¶çš„è‡ªåŠ¨æ ¡æ­£åŠŸèƒ½ï¼Œå¹¶å†æ¬¡æŠŠæ›´æ–°åçš„å˜æ›´æäº¤æ¨é€ gitã€‚\nå‚è€ƒ åšå®¢ ä½¿ç”¨ Husky å®Œæˆ git hook çš„æ“ä½œï¼š\n\n\nå®‰è£… huksyï¼šnpm install husky --save-dev\n\n\næ‰§è¡Œ huksy åˆå§‹åŒ–æŒ‡ä»¤ï¼šnpx husky install\n\n\nåœ¨Â package.jsonÂ ä¸­çš„Â scriptsÂ ä¸­å†™å…¥ï¼š&quot;prepare&quot;: &quot;husky install&quot;\n\n\nåœ¨ç”Ÿæˆçš„Â .huskyÂ ç›®å½•åˆ›å»ºÂ pre-commitÂ æ–‡ä»¶ï¼ˆæœ‰çš„è¯å°±ä¸ç”¨åˆ›å»ºï¼‰ï¼Œå¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š\n\n\n#!/usr/bin/env sh. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;npx hexo generate &amp;&amp; git add .\nå¦‚æœæäº¤ä»£ç çš„æ—¶å€™ï¼Œç»ˆç«¯å‡ºç°ç±»ä¼¼çš„æ„å»ºè¿‡ç¨‹ï¼Œå°±è¯´æ˜ç”± husky åˆ›å»ºçš„ git hook ç”Ÿæ•ˆäº†ã€‚\n\nhexo åšå®¢é»˜è®¤æºå¸¦çš„ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸º categories å’Œ tags ï¼Œè¿™ä¸¤ä¸ªæ ‡ç­¾å¯ä»¥åœ¨æ–‡ç« å¼€å§‹å‰å®šä¹‰ï¼Œç„¶å hexo ä¼šè‡ªåŠ¨è§£æè¯¥æ–‡ç« æ‰€å±çš„ç›®å½•å’Œæ ‡ç­¾ã€‚\n\nä¸Šé¢å·²ç»é€šè¿‡æ’ä»¶è§£å†³äº†ç›®å½•çš„é—®é¢˜ï¼Œè¿˜å‰©ä¸‹æ–‡ç« çš„æ ‡é¢˜å’Œ tagsã€‚Obsidian æ˜¯æ”¯æŒåˆ›å»ºæ–°æ–‡ä»¶æ—¶æ’å…¥æ¨¡æ¿çš„ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¸ç”¨é‡å¤å†™ Hexo åšå®¢æ–‡çš„Â Front-matterÂ éƒ¨åˆ†ã€‚\n\n\nåœ¨Â sourceÂ ç›®å½•ä¸‹åˆ›å»ºÂ _obsidianÂ æ–‡ä»¶å¤¹ï¼Œå¹¶åˆ›å»ºä¸€ç¯‡Â Post TemplateÂ çš„æ–‡ç« ï¼ˆmd æ–‡ä»¶ï¼‰ï¼Œå†…å®¹ä¸ºï¼š\n\n\n---title: &#123;&#123;title&#125;&#125;date: &#123;&#123;date&#125;&#125;tags: []---\n\n\nç„¶åè¿›å…¥åˆ° Obsidian çš„è®¾ç½®é¢æ¿ï¼Œé€‰æ‹©æ ¸å¿ƒæ’ä»¶ï¼Œå¹¶å¯ç”¨æ¨¡æ¿åŠŸèƒ½ã€‚åŒæ—¶ç‚¹å‡»æ—è¾¹çš„é…ç½®æŒ‰é’®ï¼Œè¿›å…¥åˆ°æ¨¡æ¿é…ç½®çš„è®¾ç½®ä¸­ï¼Œè®¾ç½®é…ç½®ä¿¡æ¯\n\n\n\nä¹‹åï¼Œæˆ‘ä»¬å†åˆ›å»ºæ–°æ–‡ç« çš„æ—¶å€™ï¼Œåªéœ€è¦ç‚¹å‡»ä¾§è¾¹æ çš„æ’å…¥æ¨¡æ¿æŒ‰é’®å°±å¯ä»¥å¿«é€Ÿç”Ÿæˆ Front-matter ä¿¡æ¯ï¼š\n\n\n\nåšå®¢å›¾ç‰‡çš„ç®¡ç†\n\nåœ¨ Obsidian ä¸­ï¼Œå¯ä»¥ç›´æ¥ç²˜è´´æˆªå›¾ï¼Œå¹¶è®¾ç½®é»˜è®¤ä¿å­˜ä½ç½®ã€‚ç›¸å¯¹è·¯å¾„ä¿å­˜çš„æ ¼å¼å¦‚ä¸‹ï¼š![](attachments/xxx.png)ï¼Œä½†æ˜¯è¿™æ ·éƒ¨ç½²åˆ° hexo ä¸­çš„å›¾ç‰‡ä¼šæ˜¾ç¤º 404 åŠ è½½ä¸æˆåŠŸçš„é”™è¯¯ã€‚\n\nåŸå…ˆçš„åŠæ³•æ˜¯å°†Â _config.ymlÂ é…ç½®æ–‡ä»¶ä¸­çš„Â post_asset_folderÂ é€‰é¡¹è®¾ç½®ä¸ºÂ trueÂ æ¥æ‰“å¼€ã€‚è¯¥åŠŸèƒ½æ‰“å¼€åï¼ŒHexo å°†ä¼šåœ¨ä½ æ¯ä¸€æ¬¡é€šè¿‡Â hexo new [layout] &lt;title&gt;Â å‘½ä»¤åˆ›å»ºæ–°æ–‡ç« æ—¶è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚è¿™ä¸ªèµ„æºæ–‡ä»¶å¤¹åä¸æ–‡ç« æ–‡ä»¶åç›¸åŒã€‚å°†æ‰€æœ‰ä¸ä½ çš„æ–‡ç« æœ‰å…³çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ï¼‰æ”¾åœ¨è¿™ä¸ªå…³è”æ–‡ä»¶å¤¹ä¸­ä¹‹åï¼Œé€šè¿‡ç›¸å¯¹è·¯å¾„æ¥å¼•ç”¨å®ƒä»¬ã€‚\nä½†æ˜¯ç”±äºæœ¬æ¬¡éœ€è¦å°† Obsidian ä¸ Hexo ç»“åˆï¼Œå¸Œæœ›ç”Ÿæˆæ–°æ–‡ç« ä¸ä¾é äºå‘½ä»¤è¡Œã€‚å› æ­¤æœ¬æ¬¡ç›´æ¥åŠ å…¥å›¾åºŠä¿å­˜å›¾ç‰‡ã€‚\nä½¿ç”¨çš„å›¾åºŠä¸º Keep ä¸»é¢˜æ¨èçš„å›¾åºŠ PicXã€‚  å›¾ç‰‡é“¾æ¥è§„åˆ™å¯èƒ½ä¼šæŒ‚ï¼Œæœ€åè¿˜æ˜¯æ¢å›äº†é˜¿é‡Œäº‘ã€‚å»ºè®®æœ¬åœ°ä¾æ—§å¤‡ä»½ä¸€ä»½å›¾ç‰‡ï¼Œä»¥é˜²ä¸‡ä¸€ã€‚\nFile Tree å®šä½\n\nç”¨ Obsidian æ§åˆ¶æ–‡ä»¶æœ‰ä¸€ä¸ªå¼Šç«¯åœ¨äºå·¦ä¾§ç›®å½•ä¸ºå…¨éƒ¨æ–‡ä»¶ï¼Œè€Œæˆ‘ä»¬ç¼–å†™ hexo åšå®¢ï¼Œä¸€èˆ¬åªä¼šåœ¨ _posts æ–‡ä»¶ä¸‹æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ Obsidian æ’ä»¶Â File Tree Alternative Plugin\n\nå®‰è£…æ’ä»¶åå¯ä»¥çœ‹åˆ°æ–‡ä»¶åˆ—å˜ä¸ºäº†ä»¥ä¸‹æ ¼å¼\n\næ‰“å¼€é€‰ä¸­ _postï¼Œå³é”® Focus on Folderï¼Œåˆ™èœå•æ åªæ˜¾ç¤º _post æ–‡ä»¶å¤¹\n\nå…¶ä»–æ‹“å±•\næ›´é«˜çº§çš„ Markdown æ¸²æŸ“å™¨\n\nHexo é»˜è®¤çš„ Markdown æ¸²æŸ“å™¨æ˜¯ hexo-renderer-markedï¼Œä½†å…¶æ”¯æŒçš„æ¸²æŸ“æ ¼å¼æœ‰é™ï¼Œæ¯”å¦‚é‡ç‚¹ç¬¦å·çš„æ¸²æŸ“å°±æ˜¯ä¸æˆåŠŸçš„ï¼Œå› æ­¤æ›´æ¢æ›´å¥½ç”¨çš„æ¸²æŸ“å™¨ hexo-renderer-markdown-it\n\n\n\nå¸è½½ hexo-renderer-marked\n\n\nnpm un hexo-renderer-marked --save\n\n\nå®‰è£…Â hexo-renderer-markdown-it\n\n\nnpm i hexo-renderer-markdown-it --save\n\n\nå°†å¦‚ä¸‹æ–‡æœ¬å¤åˆ¶ç²˜è´´åˆ°Â HexoÂ çš„é…ç½®æ–‡ä»¶Â _config.ymlÂ çš„å°¾éƒ¨\n\n\nmarkdown:  preset: &quot;default&quot;  render:    html: true    xhtmlOut: false    langPrefix: &quot;language-&quot;    breaks: true    linkify: true    typographer: true    quotes: &quot;â€œâ€â€˜â€™&quot;  enable_rules:  disable_rules:  plugins:    - markdown-it-abbr    - markdown-it-cjk-breaks    - markdown-it-deflist    - markdown-it-emoji    - markdown-it-footnote    - markdown-it-ins    - markdown-it-mark    - markdown-it-sub    - markdown-it-sup    - markdown-it-checkbox    - markdown-it-imsize    - markdown-it-expandable    - name: markdown-it-container      options: success    - name: markdown-it-container      options: tips    - name: markdown-it-container      options: warning    - name: markdown-it-container      options: danger  anchors:    level: 2    collisionSuffix: &quot;&quot;    permalink: false    permalinkClass: &quot;header-anchor&quot;    permalinkSide: &quot;left&quot;    permalinkSymbol: &quot;Â¶&quot;    case: 0    separator: &quot;-&quot;\n\n\nåˆ†åˆ«ä½¿ç”¨Â npmÂ å‘½ä»¤å®‰è£…ä»¥ä¸‹ä¸‰ä¸ªæ’ä»¶ï¼Œå…¶å®ƒæ’ä»¶Â hexo-renderer-markdown-itÂ æ¸²æŸ“å™¨å·²æœ‰\n\n\nnpm i markdown-it-checkboxnpm i markdown-it-imsizenpm i markdown-it-expandable\nåŸŸåç»‘å®š\n\n\nåŸŸåçš„è´­ä¹°\n\n\nåœ¨ä»“åº“é‡Œæ·»åŠ  CNAME æ–‡ä»¶å¹¶åœ¨æ–‡ä»¶ä¸­å¡«å†™ç»‘å®šçš„åŸŸå\n\n\n\nping ä½ çš„ github åŸŸåå¾—åˆ° IP åœ°å€\n\n\n\nè§£æåŸŸååˆ°å¯¹åº”çš„åœ°å€\n\n\n\nèµ„æºæ–‡ä»¶å‹ç¼©æ··æ·†\n\nhexo-all-minifierÂ é›†æˆäº†Â html-minifierã€clean-cssã€uglifyÂ å’ŒÂ imageminÂ ç­‰æ’ä»¶ï¼Œå¯ä»¥å¯¹ Hexo ä¸»é¢˜èµ„æºè¿›è¡Œæœ‰æ•ˆå‹ç¼©ï¼Œåªéœ€å®‰è£…å’Œç®€å•é…ç½®å³å¯ä½¿ç”¨ã€‚\n\n\n\nå®‰è£…æ’ä»¶\n\n\ncd your-hexonpm install hexo-all-minifier\n\n\nåœ¨ Hexo é…ç½®æ–‡ä»¶Â _config.ymlÂ æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®é¡¹\n\n\n# èµ„æºæ–‡ä»¶å‹ç¼©æ··æ·†all_minifier: true\nè®¾ç½®æ–‡ç« è®¿é—®å¯†ç \n\nå€ŸåŠ©Â hexo-blog-encryptÂ æ’ä»¶ï¼Œå¯ä»¥åœ¨ Front-Matter ä¸­ï¼Œå•ç‹¬ä¸ºæŸç¯‡æ–‡ç« è®¾ç½®å¯†ç ã€‚\n\n\n\nå®‰è£…æ’ä»¶\n\n\ncd your-hexonpm install hexo-blog-encrypt\n\n\né…ç½® password å±æ€§\n\n\n---...password: xxx---\nObsidian çš„æ’ä»¶ä½¿ç”¨\næ•´ç†äº†å‡ ä¸ªå¸¸ç”¨çš„ Obsidian æ’ä»¶ã€‚\n\nå†…é“¾ï¼š[[Obsidian çš„æ’ä»¶ä½¿ç”¨]]\nå¤–é“¾ï¼šObsidian çš„æ’ä»¶ä½¿ç”¨\n\nåšå®¢è¯„è®º\nç›®å‰ä½¿ç”¨çš„è¯„è®ºç³»ç»Ÿæ˜¯ Walineï¼Œæ ¹æ®æ•™ç¨‹æ“ä½œå°±è¡Œã€‚\n\nKeep è¯„è®ºæ•™ç¨‹ï¼šhttps://keep-docs.xpoet.cn/basis/configuration-guide/comment.html\nWaline å®˜æ–¹æ•™ç¨‹ï¼šhttps://waline.js.org/guide/get-started\n\né—®é¢˜\nHexo åœ¨éƒ¨ç½²åˆ° Github å CNAME æ–‡ä»¶ä¼šæ¶ˆå¤±æˆ–æ”¹å˜\né—®é¢˜è¯¦è¿°ï¼šä¹‹å‰å·²ç»åœ¨ github ä¸Šå¯¹åŸŸåè¿›è¡Œäº†ç»‘å®šï¼Œä½†æ˜¯ hexo -d ä¹‹åç»‘å®šç”Ÿæˆçš„ CNAME æ–‡ä»¶è¢«åˆ é™¤ã€‚\nè§£å†³æ–¹å¼ï¼šå‚è€ƒç½‘ä¸Šåšå®¢çš„è¯´æ³•ï¼ŒæŠŠå¯¹åº”çš„ CNAME æ–‡ä»¶æ”¾å…¥ source æ–‡ä»¶å¤¹ä¸‹ï¼Œè¿™æ · hexo -g é‡æ–°ç”Ÿæˆ public æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹æ—¶ï¼ŒCNAME æ–‡ä»¶ä¹Ÿä¼šåŒæ­¥ç”Ÿæˆã€‚å†æ‰§è¡Œ hexo -d æ“ä½œåï¼ŒCNAME æ–‡ä»¶è¢«åŒæ­¥å‘å¸ƒï¼Œé¡µé¢åˆ·æ–°åŸŸåæ­£å¸¸ä¸ä¼šå‡ºç° 404 é—®é¢˜ã€‚\nHexo é“¾æ¥åœ°å€æ”¹å˜\nå¤„ç†å¦‚ä¸‹ï¼š\n\nå†…é“¾ï¼š[[ä¼˜åŒ– Hexo ç½‘ç«™çš„æ°¸ä¹…é“¾æ¥æ ¼å¼]]\nå¤–é“¾ï¼šä¼˜åŒ– Hexo ç½‘ç«™çš„æ°¸ä¹…é“¾æ¥æ ¼å¼\n\nKeep ä¸»é¢˜æ›´æ–° tools åŠŸèƒ½æŠ¥é”™ btoa is not defined\nå¤„ç†å¦‚ä¸‹ï¼š\n\nå†…é“¾ï¼š[[Keep ä¸»é¢˜æ›´æ–° tools åŠŸèƒ½æŠ¥é”™ btoa is not defined]]\nå¤–é“¾ï¼šKeep ä¸»é¢˜æ›´æ–° tools åŠŸèƒ½æŠ¥é”™ btoa is not defined\n\n","categories":["åšå®¢"]},{"title":"Spring Data Redis","url":"/posts/feec57d/","content":"\n\nå‰è¨€\nSpring Data Redis æ˜¯ Spring æ¡†æ¶æä¾›çš„ç”¨äºæ“ä½œ Redis çš„æ–¹å¼ã€‚æ¶µç›– Redis çš„å®‰è£…ã€Spring Cache ç»“åˆ Redis çš„ä½¿ç”¨ã€Redis è¿æ¥æ± çš„ä½¿ç”¨å’Œ RedisTemplate çš„ä½¿ç”¨ç­‰å†…å®¹ã€‚\n\n\nå‚è€ƒæ–‡ç« \nSpring Data Redis æœ€ä½³å®è·µï¼\ns\n\n\næ›´æ–°\n\n\n23.08.29 åˆå§‹è®°å½•\n\nRedis å®‰è£…\nLinux\n\n\nä¸‹è½½ Redis5.0 çš„ Docker é•œåƒ\n\n\ndocker pull redis:5.0\n\n\nä½¿ç”¨ Docker å‘½ä»¤å¯åŠ¨ Redis å®¹å™¨\n\n\ndocker run -p 6379:6379 --name redis \\-v /mydata/redis/data:/data \\-d redis:5.0 redis-server --appendonly yes\nWindows\n\n\nä¸‹è½½ Windows ç‰ˆæœ¬çš„ Redis\n\n\n\nä¸‹è½½åç›´æ¥è§£å‹\n\n\nåœ¨å½“å‰åœ°å€æ è¾“å…¥ cmd å‘½ä»¤ï¼Œæ‰§è¡Œå¯¹åº”çš„ redis å¯åŠ¨å‘½ä»¤\n\n\n# æ³¨å†ŒæœåŠ¡redis-server --service-install redis.windows.conf# å¯åŠ¨æœåŠ¡redis-server --service-start# åœæ­¢æœåŠ¡redis-server --service-stop# åˆ é™¤æœåŠ¡redis-server --service-uninstall\nSpring Cache æ“ä½œ Redis\nSpring Cache ç®€ä»‹\n\nå½“ Spring Boot ç»“åˆ Redis æ¥ä½œä¸ºç¼“å­˜ä½¿ç”¨æ—¶ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨ Spring Cache äº†ï¼Œä½¿ç”¨å®ƒæˆ‘ä»¬æ— éœ€çŸ¥é“ Spring ä¸­å¯¹ Redis çš„å„ç§æ“ä½œï¼Œä»…ä»…é€šè¿‡å®ƒæä¾›çš„@Cacheable ã€@CachePut ã€@CacheEvict ã€@EnableCaching ç­‰æ³¨è§£å°±å¯ä»¥å®ç°ç¼“å­˜åŠŸèƒ½ã€‚\n\nå¸¸ç”¨æ³¨è§£\n@EnableCaching\nå¼€å¯ç¼“å­˜åŠŸèƒ½ï¼Œä¸€èˆ¬æ”¾åœ¨å¯åŠ¨ç±»ä¸Šã€‚\n@Cacheable\nä½¿ç”¨è¯¥æ³¨è§£çš„æ–¹æ³•å½“ç¼“å­˜å­˜åœ¨æ—¶ï¼Œä¼šä»ç¼“å­˜ä¸­è·å–æ•°æ®è€Œä¸æ‰§è¡Œæ–¹æ³•ï¼Œå½“ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œä¼šæ‰§è¡Œæ–¹æ³•å¹¶æŠŠè¿”å›ç»“æœå­˜å…¥ç¼“å­˜ä¸­ã€‚ä¸€èˆ¬ä½¿ç”¨åœ¨æŸ¥è¯¢æ–¹æ³•ä¸Šï¼Œå¯ä»¥è®¾ç½®å¦‚ä¸‹å±æ€§ï¼š\n\n\nvalueï¼šç¼“å­˜åç§°ï¼ˆå¿…å¡«ï¼‰ï¼ŒæŒ‡å®šç¼“å­˜çš„å‘½åç©ºé—´ï¼›\n\n\nkeyï¼šç”¨äºè®¾ç½®åœ¨å‘½åç©ºé—´ä¸­çš„ç¼“å­˜ key å€¼ï¼Œå¯ä»¥ä½¿ç”¨ SpEL è¡¨è¾¾å¼å®šä¹‰ï¼›\n\n\nunlessï¼šæ¡ä»¶ç¬¦åˆåˆ™ä¸ç¼“å­˜ï¼›\n\n\nconditionï¼šæ¡ä»¶ç¬¦åˆåˆ™ç¼“å­˜ã€‚\n\n\n@CachePut\nä½¿ç”¨è¯¥æ³¨è§£çš„æ–¹æ³•æ¯æ¬¡æ‰§è¡Œæ—¶éƒ½ä¼šæŠŠè¿”å›ç»“æœå­˜å…¥ç¼“å­˜ä¸­ã€‚ä¸€èˆ¬ä½¿ç”¨åœ¨æ–°å¢æ–¹æ³•ä¸Šï¼Œå¯ä»¥è®¾ç½®å¦‚ä¸‹å±æ€§ï¼š\n\n\nvalueï¼šç¼“å­˜åç§°ï¼ˆå¿…å¡«ï¼‰ï¼ŒæŒ‡å®šç¼“å­˜çš„å‘½åç©ºé—´ï¼›\n\n\nkeyï¼šç”¨äºè®¾ç½®åœ¨å‘½åç©ºé—´ä¸­çš„ç¼“å­˜ key å€¼ï¼Œå¯ä»¥ä½¿ç”¨ SpEL è¡¨è¾¾å¼å®šä¹‰ï¼›\n\n\nunlessï¼šæ¡ä»¶ç¬¦åˆåˆ™ä¸ç¼“å­˜ï¼›\n\n\nconditionï¼šæ¡ä»¶ç¬¦åˆåˆ™ç¼“å­˜ã€‚\n\n\n@CacheEvict\nä½¿ç”¨è¯¥æ³¨è§£çš„æ–¹æ³•æ‰§è¡Œæ—¶ä¼šæ¸…ç©ºæŒ‡å®šçš„ç¼“å­˜ã€‚ä¸€èˆ¬ä½¿ç”¨åœ¨æ›´æ–°æˆ–åˆ é™¤æ–¹æ³•ä¸Šï¼Œå¯ä»¥è®¾ç½®å¦‚ä¸‹å±æ€§ï¼š\n\n\nvalueï¼šç¼“å­˜åç§°ï¼ˆå¿…å¡«ï¼‰ï¼ŒæŒ‡å®šç¼“å­˜çš„å‘½åç©ºé—´ï¼›\n\n\nkeyï¼šç”¨äºè®¾ç½®åœ¨å‘½åç©ºé—´ä¸­çš„ç¼“å­˜ key å€¼ï¼Œå¯ä»¥ä½¿ç”¨ SpEL è¡¨è¾¾å¼å®šä¹‰ï¼›\n\n\nconditionï¼šæ¡ä»¶ç¬¦åˆåˆ™ç¼“å­˜ã€‚\n\n\nä½¿ç”¨æ­¥éª¤\nåŸºç¡€æ­¥éª¤\n\n\nåœ¨ pom.xml ä¸­æ·»åŠ é¡¹ç›®ä¾èµ–ï¼š\n\n\n&lt;!--redisä¾èµ–é…ç½®--&gt;&lt;dependency&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;\n\n\nä¿®æ”¹é…ç½®æ–‡ä»¶ application.ymlï¼Œæ·»åŠ  Redis çš„è¿æ¥é…ç½®\n\n\nspring:  redis:    host: 192.168.6.139 # RedisæœåŠ¡å™¨åœ°å€    database: 0 # Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰    port: 6379 # RedisæœåŠ¡å™¨è¿æ¥ç«¯å£    password: # RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰    timeout: 1000ms # è¿æ¥è¶…æ—¶æ—¶é—´\n\n\nåœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableCaching æ³¨è§£å¯åŠ¨ç¼“å­˜åŠŸèƒ½\n\n\n@EnableCaching@SpringBootApplicationpublic class Application &#123;    public static void main(String[] args) &#123;        SpringApplication.run(Application.class, args);    &#125;&#125;\n\n\nç±»ä¸­å®ç°ç¼“å­˜åŠŸèƒ½\n\n\n/** * PmsBrandServiceå®ç°ç±» * Created by macro on 2019/4/19. */@Servicepublic class PmsBrandServiceImpl implements PmsBrandService &#123;    @Autowired    private PmsBrandMapper brandMapper;    @CacheEvict(value = RedisConfig.REDIS_KEY_DATABASE, key = &quot;&#x27;pms:brand:&#x27;+#id&quot;)    @Override    public int update(Long id, PmsBrand brand) &#123;        brand.setId(id);        return brandMapper.updateByPrimaryKeySelective(brand);    &#125;    @CacheEvict(value = RedisConfig.REDIS_KEY_DATABASE, key = &quot;&#x27;pms:brand:&#x27;+#id&quot;)    @Override    public int delete(Long id) &#123;        return brandMapper.deleteByPrimaryKey(id);    &#125;    @Cacheable(value = RedisConfig.REDIS_KEY_DATABASE, key = &quot;&#x27;pms:brand:&#x27;+#id&quot;, unless = &quot;#result==null&quot;)    @Override    public PmsBrand getItem(Long id) &#123;        return brandMapper.selectByPrimaryKey(id);    &#125;&#125;\nå­˜å‚¨ JSON æ ¼å¼æ•°æ®\n\nç»™ RedisTemplate è®¾ç½® JSON æ ¼å¼çš„åºåˆ—åŒ–å™¨ï¼Œå¹¶é€šè¿‡é…ç½® RedisCacheConfiguration è®¾ç½®è¶…æ—¶æ—¶é—´æ¥å®ç°ä»¥ä¸Šéœ€æ±‚ï¼Œæ­¤æ—¶è¿˜éœ€è¦å»é™¤å¯åŠ¨ç±»ä¸Šçš„@EnableCaching æ³¨è§£ï¼Œå…·ä½“é…ç½®ç±» RedisConfig ä»£ç å¦‚ä¸‹\n\n/** * Redisé…ç½®ç±» * Created by macro on 2020/3/2. */@EnableCaching@Configurationpublic class RedisConfig extends CachingConfigurerSupport &#123;    /**     * redisæ•°æ®åº“è‡ªå®šä¹‰key     */    public  static final String REDIS_KEY_DATABASE=&quot;mall&quot;;    @Bean    public RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory redisConnectionFactory) &#123;        RedisSerializer&lt;Object&gt; serializer = redisSerializer();        RedisTemplate&lt;String, Object&gt; redisTemplate = new RedisTemplate&lt;&gt;();        redisTemplate.setConnectionFactory(redisConnectionFactory);        redisTemplate.setKeySerializer(new StringRedisSerializer());        redisTemplate.setValueSerializer(serializer);        redisTemplate.setHashKeySerializer(new StringRedisSerializer());        redisTemplate.setHashValueSerializer(serializer);        redisTemplate.afterPropertiesSet();        return redisTemplate;    &#125;    @Bean    public RedisSerializer&lt;Object&gt; redisSerializer() &#123;        //åˆ›å»ºJSONåºåˆ—åŒ–å™¨        Jackson2JsonRedisSerializer&lt;Object&gt; serializer = new Jackson2JsonRedisSerializer&lt;&gt;(Object.class);        ObjectMapper objectMapper = new ObjectMapper();        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);        objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);        serializer.setObjectMapper(objectMapper);        return serializer;    &#125;    @Bean    public RedisCacheManager redisCacheManager(RedisConnectionFactory redisConnectionFactory) &#123;        RedisCacheWriter redisCacheWriter = RedisCacheWriter.nonLockingRedisCacheWriter(redisConnectionFactory);        //è®¾ç½®Redisç¼“å­˜æœ‰æ•ˆæœŸä¸º1å¤©        RedisCacheConfiguration redisCacheConfiguration = RedisCacheConfiguration.defaultCacheConfig()                .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(redisSerializer())).entryTtl(Duration.ofDays(1));        return new RedisCacheManager(redisCacheWriter, redisCacheConfiguration);    &#125;&#125;\nä½¿ç”¨ Redis è¿æ¥æ± \n\nSpringBoot 1.5.x ç‰ˆæœ¬ Redis å®¢æˆ·ç«¯é»˜è®¤æ˜¯ Jedis å®ç°çš„ï¼ŒSpringBoot 2.x ç‰ˆæœ¬ä¸­é»˜è®¤å®¢æˆ·ç«¯æ˜¯ç”¨ Lettuce å®ç°çš„ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ Jedis å’Œ Lettuce å®¢æˆ·ç«¯ã€‚\n\nJedis vs Lettuce\nJedis åœ¨å®ç°ä¸Šæ˜¯ç›´è¿ Redis æœåŠ¡ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹éçº¿ç¨‹å®‰å…¨ï¼Œé™¤éä½¿ç”¨è¿æ¥æ± ï¼Œä¸ºæ¯ä¸ª RedisConnection å®ä¾‹å¢åŠ ç‰©ç†è¿æ¥ã€‚\nLettuce æ˜¯ä¸€ç§å¯ä¼¸ç¼©ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå®Œå…¨éé˜»å¡çš„ Redis å®¢æˆ·ç«¯ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«ä¸€ä¸ª RedisConnectionï¼Œå®ƒåˆ©ç”¨ Netty NIO æ¡†æ¶æ¥é«˜æ•ˆåœ°ç®¡ç†å¤šä¸ªè¿æ¥ï¼Œä»è€Œæä¾›äº†å¼‚æ­¥å’ŒåŒæ­¥æ•°æ®è®¿é—®æ–¹å¼ï¼Œç”¨äºæ„å»ºéé˜»å¡çš„ååº”æ€§åº”ç”¨ç¨‹åºã€‚\nä½¿ç”¨æ­¥éª¤\n\n\nä¿®æ”¹ application.yml æ·»åŠ  Lettuce è¿æ¥æ± é…ç½®ï¼Œç”¨äºé…ç½®çº¿ç¨‹æ•°é‡å’Œé˜»å¡ç­‰å¾…æ—¶é—´\n\n\nspring:  redis:    lettuce:      pool:        max-active: 8 # è¿æ¥æ± æœ€å¤§è¿æ¥æ•°        max-idle: 8 # è¿æ¥æ± æœ€å¤§ç©ºé—²è¿æ¥æ•°        min-idle: 0 # è¿æ¥æ± æœ€å°ç©ºé—²è¿æ¥æ•°        max-wait: -1ms # è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼Œè´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶\n\n\nç”±äº SpringBoot 2.x ä¸­é»˜è®¤å¹¶æ²¡æœ‰ä½¿ç”¨ Redis è¿æ¥æ± ï¼Œæ‰€ä»¥éœ€è¦åœ¨ pom.xml ä¸­æ·»åŠ  commons-pool2 çš„ä¾èµ–\n\n\n&lt;dependency&gt;    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;    &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;&lt;/dependency&gt;\n\n\nä¸æ·»åŠ ä¾èµ–åˆ™æŠ¥é”™\n\n\nCaused by: java.lang.NoClassDefFoundError: org/apache/commons/pool2/impl/GenericObjectPoolConfig\tat org.springframework.data.redis.connection.lettuce.LettucePoolingClientConfiguration$LettucePoolingClientConfiguYrRUIQWOPrationBuilder.&lt;init&gt;(LettucePoolingClientConfiguration.java:84) ~[spring-data-redis-2.1.5.RELEASE.jar:2.1.5.RELEASE]\tat org.springframework.data.redis.connection.lettuce.LettucePoolingClientConfiguration.builder(LettucePoolingClientConfiguration.java:48) ~[spring-data-redis-2.1.5.RELEASE.jar:2.1.5.RELEASE]\tat org.springframework.boot.autoconfigure.data.redis.LettuceConnectionConfiguration$PoolBuilderFactory.createBuilder(LettuceConnectionConfiguration.java:149) ~[spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]\tat org.springframework.boot.autoconfigure.data.redis.LettuceConnectionConfiguration.createBuilder(LettuceConnectionConfiguration.java:107) ~[spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]\tat org.springframework.boot.autoconfigure.data.redis.LettuceConnectionConfiguration.getLettuceClientConfiguration(LettuceConnectionConfiguration.java:93) ~[spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]\tat org.springframework.boot.autoconfigure.data.redis.LettuceConnectionConfiguration.redisConnectionFactory(LettuceConnectionConfiguration.java:74) ~[spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]\tat org.springframework.boot.autoconfigure.data.redis.LettuceConnectionConfiguration$$EnhancerBySpringCGLIB$$5caa7e47.CGLIB$redisConnectionFactory$0(&lt;generated&gt;) ~[spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]\tat org.springframework.boot.autoconfigure.data.redis.LettuceConnectionConfiguration$$EnhancerBySpringCGLIB$$5caa7e47$$FastClassBySpringCGLIB$$b8ae2813.invoke(&lt;generated&gt;) ~[spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]\tat org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244) ~[spring-core-5.1.5.RELEASE.jar:5.1.5.RELEASE]\tat org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:363) ~[spring-context-5.1.5.RELEASE.jar:5.1.5.RELEASE]\tat org.springframework.boot.autoconfigure.data.redis.LettuceConnectionConfiguration$$EnhancerBySpringCGLIB$$5caa7e47.redisConnectionFactory(&lt;generated&gt;) ~[spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_91]\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_91]\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_91]\tat java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_91]\tat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]\t... 111 common frames omitted\nè‡ªç”±æ“ä½œ Redis\n\nä½¿ç”¨ RedisTemplate è‡ªç”±ç¼“å­˜æ–¹æ³•ä¸­äº§ç”Ÿçš„ä¸­é—´å€¼\n\nRedisService\n/** * redisæ“ä½œService * Created by macro on 2020/3/3. */public interface RedisService &#123;    /**     * ä¿å­˜å±æ€§     */    void set(String key, Object value, long time);    /**     * ä¿å­˜å±æ€§     */    void set(String key, Object value);    /**     * è·å–å±æ€§     */    Object get(String key);    /**     * åˆ é™¤å±æ€§     */    Boolean del(String key);    /**     * æ‰¹é‡åˆ é™¤å±æ€§     */    Long del(List&lt;String&gt; keys);    /**     * è®¾ç½®è¿‡æœŸæ—¶é—´     */    Boolean expire(String key, long time);    /**     * è·å–è¿‡æœŸæ—¶é—´     */    Long getExpire(String key);    /**     * åˆ¤æ–­æ˜¯å¦æœ‰è¯¥å±æ€§     */    Boolean hasKey(String key);    /**     * æŒ‰deltaé€’å¢     */    Long incr(String key, long delta);    /**     * æŒ‰deltaé€’å‡     */    Long decr(String key, long delta);    /**     * è·å–Hashç»“æ„ä¸­çš„å±æ€§     */    Object hGet(String key, String hashKey);    /**     * å‘Hashç»“æ„ä¸­æ”¾å…¥ä¸€ä¸ªå±æ€§     */    Boolean hSet(String key, String hashKey, Object value, long time);    /**     * å‘Hashç»“æ„ä¸­æ”¾å…¥ä¸€ä¸ªå±æ€§     */    void hSet(String key, String hashKey, Object value);    /**     * ç›´æ¥è·å–æ•´ä¸ªHashç»“æ„     */    Map&lt;Object, Object&gt; hGetAll(String key);    /**     * ç›´æ¥è®¾ç½®æ•´ä¸ªHashç»“æ„     */    Boolean hSetAll(String key, Map&lt;String, Object&gt; map, long time);    /**     * ç›´æ¥è®¾ç½®æ•´ä¸ªHashç»“æ„     */    void hSetAll(String key, Map&lt;String, Object&gt; map);    /**     * åˆ é™¤Hashç»“æ„ä¸­çš„å±æ€§     */    void hDel(String key, Object... hashKey);    /**     * åˆ¤æ–­Hashç»“æ„ä¸­æ˜¯å¦æœ‰è¯¥å±æ€§     */    Boolean hHasKey(String key, String hashKey);    /**     * Hashç»“æ„ä¸­å±æ€§é€’å¢     */    Long hIncr(String key, String hashKey, Long delta);    /**     * Hashç»“æ„ä¸­å±æ€§é€’å‡     */    Long hDecr(String key, String hashKey, Long delta);    /**     * è·å–Setç»“æ„     */    Set&lt;Object&gt; sMembers(String key);    /**     * å‘Setç»“æ„ä¸­æ·»åŠ å±æ€§     */    Long sAdd(String key, Object... values);    /**     * å‘Setç»“æ„ä¸­æ·»åŠ å±æ€§     */    Long sAdd(String key, long time, Object... values);    /**     * æ˜¯å¦ä¸ºSetä¸­çš„å±æ€§     */    Boolean sIsMember(String key, Object value);    /**     * è·å–Setç»“æ„çš„é•¿åº¦     */    Long sSize(String key);    /**     * åˆ é™¤Setç»“æ„ä¸­çš„å±æ€§     */    Long sRemove(String key, Object... values);    /**     * è·å–Listç»“æ„ä¸­çš„å±æ€§     */    List&lt;Object&gt; lRange(String key, long start, long end);    /**     * è·å–Listç»“æ„çš„é•¿åº¦     */    Long lSize(String key);    /**     * æ ¹æ®ç´¢å¼•è·å–Listä¸­çš„å±æ€§     */    Object lIndex(String key, long index);    /**     * å‘Listç»“æ„ä¸­æ·»åŠ å±æ€§     */    Long lPush(String key, Object value);    /**     * å‘Listç»“æ„ä¸­æ·»åŠ å±æ€§     */    Long lPush(String key, Object value, long time);    /**     * å‘Listç»“æ„ä¸­æ‰¹é‡æ·»åŠ å±æ€§     */    Long lPushAll(String key, Object... values);    /**     * å‘Listç»“æ„ä¸­æ‰¹é‡æ·»åŠ å±æ€§     */    Long lPushAll(String key, Long time, Object... values);    /**     * ä»Listç»“æ„ä¸­ç§»é™¤å±æ€§     */    Long lRemove(String key, long count, Object value);&#125;\nRedisServiceImpl\n/** * redisæ“ä½œå®ç°ç±» * Created by macro on 2020/3/3. */@Servicepublic class RedisServiceImpl implements RedisService &#123;    @Autowired    private RedisTemplate&lt;String, Object&gt; redisTemplate;    @Override    public void set(String key, Object value, long time) &#123;        redisTemplate.opsForValue().set(key, value, time, TimeUnit.SECONDS);    &#125;    @Override    public void set(String key, Object value) &#123;        redisTemplate.opsForValue().set(key, value);    &#125;    @Override    public Object get(String key) &#123;        return redisTemplate.opsForValue().get(key);    &#125;    @Override    public Boolean del(String key) &#123;        return redisTemplate.delete(key);    &#125;    @Override    public Long del(List&lt;String&gt; keys) &#123;        return redisTemplate.delete(keys);    &#125;    @Override    public Boolean expire(String key, long time) &#123;        return redisTemplate.expire(key, time, TimeUnit.SECONDS);    &#125;    @Override    public Long getExpire(String key) &#123;        return redisTemplate.getExpire(key, TimeUnit.SECONDS);    &#125;    @Override    public Boolean hasKey(String key) &#123;        return redisTemplate.hasKey(key);    &#125;    @Override    public Long incr(String key, long delta) &#123;        return redisTemplate.opsForValue().increment(key, delta);    &#125;    @Override    public Long decr(String key, long delta) &#123;        return redisTemplate.opsForValue().increment(key, -delta);    &#125;    @Override    public Object hGet(String key, String hashKey) &#123;        return redisTemplate.opsForHash().get(key, hashKey);    &#125;    @Override    public Boolean hSet(String key, String hashKey, Object value, long time) &#123;        redisTemplate.opsForHash().put(key, hashKey, value);        return expire(key, time);    &#125;    @Override    public void hSet(String key, String hashKey, Object value) &#123;        redisTemplate.opsForHash().put(key, hashKey, value);    &#125;    @Override    public Map&lt;Object, Object&gt; hGetAll(String key) &#123;        return redisTemplate.opsForHash().entries(key);    &#125;    @Override    public Boolean hSetAll(String key, Map&lt;String, Object&gt; map, long time) &#123;        redisTemplate.opsForHash().putAll(key, map);        return expire(key, time);    &#125;    @Override    public void hSetAll(String key, Map&lt;String, Object&gt; map) &#123;        redisTemplate.opsForHash().putAll(key, map);    &#125;    @Override    public void hDel(String key, Object... hashKey) &#123;        redisTemplate.opsForHash().delete(key, hashKey);    &#125;    @Override    public Boolean hHasKey(String key, String hashKey) &#123;        return redisTemplate.opsForHash().hasKey(key, hashKey);    &#125;    @Override    public Long hIncr(String key, String hashKey, Long delta) &#123;        return redisTemplate.opsForHash().increment(key, hashKey, delta);    &#125;    @Override    public Long hDecr(String key, String hashKey, Long delta) &#123;        return redisTemplate.opsForHash().increment(key, hashKey, -delta);    &#125;    @Override    public Set&lt;Object&gt; sMembers(String key) &#123;        return redisTemplate.opsForSet().members(key);    &#125;    @Override    public Long sAdd(String key, Object... values) &#123;        return redisTemplate.opsForSet().add(key, values);    &#125;    @Override    public Long sAdd(String key, long time, Object... values) &#123;        Long count = redisTemplate.opsForSet().add(key, values);        expire(key, time);        return count;    &#125;    @Override    public Boolean sIsMember(String key, Object value) &#123;        return redisTemplate.opsForSet().isMember(key, value);    &#125;    @Override    public Long sSize(String key) &#123;        return redisTemplate.opsForSet().size(key);    &#125;    @Override    public Long sRemove(String key, Object... values) &#123;        return redisTemplate.opsForSet().remove(key, values);    &#125;    @Override    public List&lt;Object&gt; lRange(String key, long start, long end) &#123;        return redisTemplate.opsForList().range(key, start, end);    &#125;    @Override    public Long lSize(String key) &#123;        return redisTemplate.opsForList().size(key);    &#125;    @Override    public Object lIndex(String key, long index) &#123;        return redisTemplate.opsForList().index(key, index);    &#125;    @Override    public Long lPush(String key, Object value) &#123;        return redisTemplate.opsForList().rightPush(key, value);    &#125;    @Override    public Long lPush(String key, Object value, long time) &#123;        Long index = redisTemplate.opsForList().rightPush(key, value);        expire(key, time);        return index;    &#125;    @Override    public Long lPushAll(String key, Object... values) &#123;        return redisTemplate.opsForList().rightPushAll(key, values);    &#125;    @Override    public Long lPushAll(String key, Long time, Object... values) &#123;        Long count = redisTemplate.opsForList().rightPushAll(key, values);        expire(key, time);        return count;    &#125;    @Override    public Long lRemove(String key, long count, Object value) &#123;        return redisTemplate.opsForList().remove(key, count, value);    &#125;&#125;\nRedisController\n\nç®€å•æµ‹è¯•åœ¨ Controller ä¸­è¿›è¡Œæ“ä½œ\n\n/** * Redisæµ‹è¯•Controller * Created by macro on 2020/3/3. */@Api(tags = &quot;RedisController&quot;, description = &quot;Redisæµ‹è¯•&quot;)@Controller@RequestMapping(&quot;/redis&quot;)public class RedisController &#123;    @Autowired    private RedisService redisService;    @Autowired    private PmsBrandService brandService;    @ApiOperation(&quot;æµ‹è¯•ç®€å•ç¼“å­˜&quot;)    @RequestMapping(value = &quot;/simpleTest&quot;, method = RequestMethod.GET)    @ResponseBody    public CommonResult&lt;PmsBrand&gt; simpleTest() &#123;        List&lt;PmsBrand&gt; brandList = brandService.list(1, 5);        PmsBrand brand = brandList.get(0);        String key = &quot;redis:simple:&quot; + brand.getId();        redisService.set(key, brand);        PmsBrand cacheBrand = (PmsBrand) redisService.get(key);        return CommonResult.success(cacheBrand);    &#125;    @ApiOperation(&quot;æµ‹è¯•Hashç»“æ„çš„ç¼“å­˜&quot;)    @RequestMapping(value = &quot;/hashTest&quot;, method = RequestMethod.GET)    @ResponseBody    public CommonResult&lt;PmsBrand&gt; hashTest() &#123;        List&lt;PmsBrand&gt; brandList = brandService.list(1, 5);        PmsBrand brand = brandList.get(0);        String key = &quot;redis:hash:&quot; + brand.getId();        Map&lt;String, Object&gt; value = BeanUtil.beanToMap(brand);        redisService.hSetAll(key, value);        Map&lt;Object, Object&gt; cacheValue = redisService.hGetAll(key);        PmsBrand cacheBrand = BeanUtil.mapToBean(cacheValue, PmsBrand.class, true);        return CommonResult.success(cacheBrand);    &#125;    @ApiOperation(&quot;æµ‹è¯•Setç»“æ„çš„ç¼“å­˜&quot;)    @RequestMapping(value = &quot;/setTest&quot;, method = RequestMethod.GET)    @ResponseBody    public CommonResult&lt;Set&lt;Object&gt;&gt; setTest() &#123;        List&lt;PmsBrand&gt; brandList = brandService.list(1, 5);        String key = &quot;redis:set:all&quot;;        redisService.sAdd(key, (Object[]) ArrayUtil.toArray(brandList, PmsBrand.class));        redisService.sRemove(key, brandList.get(0));        Set&lt;Object&gt; cachedBrandList = redisService.sMembers(key);        return CommonResult.success(cachedBrandList);    &#125;    @ApiOperation(&quot;æµ‹è¯•Listç»“æ„çš„ç¼“å­˜&quot;)    @RequestMapping(value = &quot;/listTest&quot;, method = RequestMethod.GET)    @ResponseBody    public CommonResult&lt;List&lt;Object&gt;&gt; listTest() &#123;        List&lt;PmsBrand&gt; brandList = brandService.list(1, 5);        String key = &quot;redis:list:all&quot;;        redisService.lPushAll(key, (Object[]) ArrayUtil.toArray(brandList, PmsBrand.class));        redisService.lRemove(key, 1, brandList.get(0));        List&lt;Object&gt; cachedBrandList = redisService.lRange(key, 0, 3);        return CommonResult.success(cachedBrandList);    &#125;&#125;\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["Redis","Spring"]},{"title":"ã€ä»£ç æ¨¡æ¿ã€‘æ–‡ä»¶å­˜å‚¨","url":"/posts/159a80d0/","content":"\n\nå‰è¨€é¡¹ç›®ä¸­å¸¸ç”¨åˆ°æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ã€‚\n\n\næ›´æ–°\n\n\n24.05.30 åˆå§‹è®°å½•ï¼ˆMinioï¼Œé˜¿é‡Œäº‘OSSï¼‰\n\næ–‡ä»¶ä¸Šä¼ \n\n\næ ¡éªŒ\n\næ–‡ä»¶æ˜¯å¦ä¸ºç©º\næ–‡ä»¶çš„æ ¼å¼\næ–‡ä»¶çš„å¤§å°\n\n\n\næ–‡ä»¶é‡å‘½å\n\n\næ–‡ä»¶ç›®å½•åˆ†ç¦»\n\nä½¿ç”¨ç›®å½•åˆ†ç¦»ç®—æ³• (Hash æŠŠ hash å€¼ä½œä¸ºç›®å½•åç§°)\næŒ‰ç…§æ—¥æœŸåˆ†ç›®å½• (æ¯å¤©åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•)\næŒ‰ç…§ç”¨æˆ·ååˆ†ç›®å½•\n\n\n\nå›¾ç‰‡ä¿å­˜åœ°ç‚¹\n\nweb æœåŠ¡å™¨ï¼ˆé¡¹ç›®æ‰€è¿è¡Œåœ¨çš„ç”µè„‘ï¼‰\näº‘å­˜å‚¨æœåŠ¡å•†\nè‡ªå·±æ­å»ºæ–‡ä»¶æœåŠ¡å™¨ï¼ˆFastDFS Minioï¼‰\n\n\n\né€šç”¨éƒ¨åˆ†ä»£ç \n/**   * æ–‡ä»¶ä¸Šä¼    *   * @param file æ–‡ä»¶   * @return Boolean   */@RestController@RequestMapping(&quot;common&quot;)public class CommonController &#123;    @PostMapping(&quot;upload&quot;)    public R uploadPic(MultipartFile file) throws IOException &#123;        // æ ¡éªŒ        // æ ¡éªŒæ–‡ä»¶æ˜¯å¦ä¸ºç©º        if (ObjectUtil.isNull(file)) return R.error(&quot;ä¸Šä¼ æ–‡ä»¶ä¸èƒ½ä¸ºç©º&quot;);        // æ ¡éªŒæ–‡ä»¶çš„æ ¼å¼        if (!StrUtil.containsAnyIgnoreCase(FileUtil.getSuffix(file.getOriginalFilename()), &quot;jpg&quot;, &quot;png&quot;)) &#123;            return R.error(&quot;ä¸Šä¼ æ–‡ä»¶æ ¼å¼é”™è¯¯&quot;);        &#125;        // æ ¡éªŒæ–‡ä»¶çš„å¤§å°        if (file.getSize() / 1024 / 1024 &gt; 2) return R.error(&quot;æ–‡ä»¶è¿‡å¤§ï¼Œé™åˆ¶åœ¨2MBä»¥å†…&quot;);                // ç»™æ–‡ä»¶è¿›è¡Œé‡å‘½å        String fileName = UUID.fastUUID().toString() + &quot;.&quot; + FileUtil.getSuffix(file.getOriginalFilename());        // ç»™æ–‡ä»¶ç›®å½•åˆ†ç¦»                // å›¾ç‰‡ä¿å­˜åœ°ç‚¹ï¼ˆä¸åŒä¿å­˜åœ°ç‚¹å®ç°æ–¹å¼ä¸åŒï¼‰        .....        return R.success(fileName);    &#125;&#125;\nä¸åŒçš„ä¿å­˜åœ°ç‚¹\nweb æœåŠ¡å™¨ï¼ˆé¡¹ç›®æ‰€è¿è¡Œåœ¨çš„ç”µè„‘ï¼‰\n\n\næ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†ä»£ç \n\n\n// è¿™ç§æƒ…å†µä¸‹ï¼Œæ–‡ä»¶å­˜å‚¨è·¯å¾„ä¸ºæœåŠ¡å™¨ä¸Šçš„è·¯å¾„åç§°file.transferTo(new File(&quot;D:\\\\images\\\\&quot; + fileName));\n\n\nä¸‹è½½\n\n\n\n\nå‰ç«¯ç›´æ¥è®¿é—®æœåŠ¡å™¨åŸŸå + å­˜å‚¨åœ°å€\n\n\n// è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç ä¸­éœ€è¦æ·»åŠ è®¿é—®èµ„æºæ˜ å°„åœ°å€// åœ¨æ‹¦æˆªå™¨ä¸­é…ç½®@Configuration  public class WebMvcConfig implements WebMvcConfigurer &#123;      @Autowired      private AuthInterceptor authInterceptor;          private static final String DWG = &quot;file:&quot; + &quot;D:/images/&quot;;      @Override      public void addResourceHandlers(ResourceHandlerRegistry registry) &#123;    // æ·»åŠ è®¿é—®èµ„æºçš„åœ°å€        registry.addResourceHandler(&quot;/virtual/**&quot;).addResourceLocations(DWG);      &#125;        @Override      public void addInterceptors(InterceptorRegistry registry) &#123;          registry.addInterceptor(authInterceptor)                  .addPathPatterns(&quot;/**&quot;)                  .excludePathPatterns(&quot;/**/login/**&quot;, &quot;/**/*.html&quot;, &quot;/**/*.js&quot;, &quot;/**/*.css&quot;, &quot;/doc.*&quot;,                          &quot;/swagger-ui.*&quot;,                          &quot;/swagger-resources&quot;,                          &quot;/webjars/**&quot;,                          &quot;/v2/api-docs/**&quot;,                          &quot;/virtual/**&quot;                  );      &#125;  &#125;\n\n\nå‰ç«¯é€šè¿‡æ¥å£ä¸‹è½½æ–‡ä»¶\n\n\n@GetMapping(&quot;download&quot;)public void downloadPic(String name, HttpServletResponse response) throws IOException &#123;    FileInputStream fileInputStream = new FileInputStream(&quot;D:\\\\images\\\\&quot; + name);    ServletOutputStream outputStream = response.getOutputStream();    byte[] bytes = new byte[1024];    int len = 0;    while ((len = fileInputStream.read(bytes)) != -1) &#123;        outputStream.write(bytes, 0, len);    &#125;    fileInputStream.close();    outputStream.close();&#125;\näº‘å­˜å‚¨æœåŠ¡å•†\né€šè¿‡å¼€é€šäº‘å­˜å‚¨æœåŠ¡å•†çš„ OSS æœåŠ¡ï¼Œè°ƒç”¨æä¾›çš„ APIï¼Œå®ç°æ–‡ä»¶å­˜å‚¨ã€‚ä¸€èˆ¬åé¢ä¸¤ç§æƒ…å†µä¼šç›´æ¥ç¼–å†™ Util ç±»æ–¹ä¾¿å¤šå¤„è°ƒç”¨ã€‚\né˜¿é‡Œäº‘\nMaven ä¾èµ–\n&lt;dependency&gt;      &lt;groupId&gt;com.aliyun.oss&lt;/groupId&gt;      &lt;artifactId&gt;aliyun-sdk-oss&lt;/artifactId&gt;      &lt;version&gt;3.4.2&lt;/version&gt;  &lt;/dependency&gt;\né…ç½®æ–‡ä»¶\naliyun:    oss:      endpoint: oss-cn-hangzhou.aliyuncs.com      accessKeyId: xxxxxxxxxxxxxxxx      accessKeySecret: xxxxxxxxxxxxxxxx      bucket:  xxxxxxxxxxxxxxxx    userFolder: user/      managerFolder: manager/\nä»£ç \n\n\nOssAutoConfiguration.java\n\n\n@Configuration  @ConditionalOnClass(&#123;OSSClient.class&#125;)  @EnableConfigurationProperties(OssProperties.class)  public class OssAutoConfiguration &#123;        private final OssProperties ossProperties;        public OssAutoConfiguration(final OssProperties ossProperties) &#123;          this.ossProperties = ossProperties;      &#125;        @Bean      public OssClientFactoryBean ossClientFactoryBean() &#123;          final OssClientFactoryBean factoryBean = new OssClientFactoryBean();          factoryBean.setEndpoint(this.ossProperties.getEndpoint());          factoryBean.setAccessKeyId(this.ossProperties.getAccessKeyId());          factoryBean.setAccessKeySecret(this.ossProperties.getAccessKeySecret());          return factoryBean;      &#125;  &#125;\n\n\nOssClientFactoryBean.class\n\n\npublic class OssClientFactoryBean implements FactoryBean&lt;OSSClient&gt;, InitializingBean, DisposableBean &#123;        private OSSClient ossClient;      private String endpoint;      private String accessKeyId;      private String accessKeySecret;        @Override      public OSSClient getObject() throws Exception &#123;          return this.ossClient;      &#125;        @Override      public Class&lt;?&gt; getObjectType() &#123;          return OSSClient.class;      &#125;        @Override      public boolean isSingleton() &#123;          return true;      &#125;        @Override      public void destroy() throws Exception &#123;          if (this.ossClient != null) &#123;              this.ossClient.shutdown();          &#125;      &#125;        @Override      public void afterPropertiesSet() throws Exception &#123;          Assert.notNull(this.endpoint, &quot;&#x27;aliyun.oss.endpoint&#x27; must be not null&quot;);          Assert.notNull(this.accessKeyId, &quot;&#x27;aliyun.oss.accessKeyId&#x27; must be not null&quot;);          Assert.notNull(this.accessKeySecret, &quot;&#x27;aliyun.oss.accessKeySecret&#x27; must be not null&quot;);          this.ossClient = new OSSClient(this.endpoint, this.accessKeyId, this.accessKeySecret);      &#125;        public void setEndpoint(final String endpoint) &#123;          this.endpoint = endpoint;      &#125;        public void setAccessKeyId(final String accessKeyId) &#123;          this.accessKeyId = accessKeyId;      &#125;        public void setAccessKeySecret(final String accessKeySecret) &#123;          this.accessKeySecret = accessKeySecret;      &#125;  &#125;\n\n\nOssProperties.java\n\n\n@Getter  @Setter  @ConfigurationProperties(prefix = &quot;aliyun.oss&quot;)  public class OssProperties &#123;      private String endpoint;      private String accessKeyId;      private String accessKeySecret;      private String bucket;      private String userFolder;      private String managerFolder;  &#125;\n\n\nOssUtil.class\n\n\n@Slf4j  @Component  public class OssUtil &#123;      @Autowired      private OSSClient ossClient;        @Autowired      private OssProperties ossProperties;        /**       * ä¸Šä¼ æ–‡ä»¶       * @param folder &quot;éœ€è¦åŠ / å¦‚&quot;xxx/&quot;&quot;       * @return æ–‡ä»¶åœ°å€       */      public String upload(MultipartFile file, String folder) &#123;          String bucketName = ossProperties.getBucket();            // åˆ¤æ–­Bucketçš„å­˜åœ¨          if (!ossClient.doesBucketExist(bucketName)) &#123;              // åˆ›å»ºå­˜å‚¨ç©ºé—´              Bucket bucket = ossClient.createBucket(bucketName);              bucketName = bucket.getName();          &#125;            String objectName = &quot;&quot;;          try &#123;              // ä»¥è¾“å…¥æµçš„å½¢å¼ä¸Šä¼ æ–‡ä»¶              InputStream is = file.getInputStream();              // æ–‡ä»¶å              String originalFilename = file.getOriginalFilename();              if (ObjectUtil.isNull(originalFilename)) &#123;                  throw new LogicException(&quot;æ–‡ä»¶åç§°è·å–å¤±è´¥&quot;);              &#125;              val suffix = originalFilename.substring(originalFilename.lastIndexOf(&quot;.&quot;));              String fileName = UUID.fastUUID().toString() + suffix.toLowerCase();              objectName = folder + DateUtil.format(new Date(), &quot;yy-MM/dd&quot;) + &quot;/&quot; + fileName;                // æ–‡ä»¶å¤§å°              long fileSize = file.getSize();                // åˆ›å»ºä¸Šä¼ Objectçš„Metadata              ObjectMetadata metadata = new ObjectMetadata();              // ä¸Šä¼ çš„æ–‡ä»¶çš„é•¿åº¦              metadata.setContentLength(is.available());              // æŒ‡å®šè¯¥Objectè¢«ä¸‹è½½æ—¶çš„ç½‘é¡µçš„ç¼“å­˜è¡Œä¸º              metadata.setCacheControl(&quot;no-cache&quot;);              // æŒ‡å®šè¯¥Objectä¸‹è®¾ç½®Header              metadata.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;);              // æŒ‡å®šè¯¥Objectè¢«ä¸‹è½½æ—¶çš„å†…å®¹ç¼–ç æ ¼å¼              metadata.setContentEncoding(&quot;utf-8&quot;);              // æ–‡ä»¶çš„MIMEï¼Œå®šä¹‰æ–‡ä»¶çš„ç±»å‹åŠç½‘é¡µç¼–ç ï¼Œå†³å®šæµè§ˆå™¨å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–æ–‡ä»¶ã€‚å¦‚æœç”¨æˆ·æ²¡æœ‰æŒ‡å®šåˆ™æ ¹æ®Keyæˆ–æ–‡ä»¶åçš„æ‰©å±•åç”Ÿæˆï¼Œ              // å¦‚æœæ²¡æœ‰æ‰©å±•ååˆ™å¡«é»˜è®¤å€¼application/octet-stream              metadata.setContentType(AliyunOssFileTypeEnum.getText(suffix.toLowerCase()));              // æŒ‡å®šè¯¥Objectè¢«ä¸‹è½½æ—¶çš„åç§°ï¼ˆæŒ‡ç¤ºMINMEç”¨æˆ·ä»£ç†å¦‚ä½•æ˜¾ç¤ºé™„åŠ çš„æ–‡ä»¶ï¼Œæ‰“å¼€æˆ–ä¸‹è½½ï¼ŒåŠæ–‡ä»¶åç§°ï¼‰              metadata.setContentDisposition(&quot;filename/filesize=&quot; + originalFilename + &quot;/&quot; + fileSize + &quot;Byte.&quot;);              // ä¸Šä¼ æ–‡ä»¶ (ä¸Šä¼ æ–‡ä»¶æµçš„å½¢å¼)              PutObjectResult putResult = ossClient.putObject(bucketName, objectName, is, metadata);              // è§£æç»“æœ              String resultStr = putResult.getETag();              log.info(&quot;å”¯ä¸€MD5æ•°å­—ç­¾å:&quot; + resultStr);          &#125; catch (OSSException oe) &#123;              // oe.printStackTrace();              log.error(&quot;ä¸Šä¼ é˜¿é‡Œäº‘OSSæœåŠ¡å™¨å¼‚å¸¸.&quot; + oe.getMessage(), oe);          &#125; catch (ClientException ce) &#123;              // ce.printStackTrace();              log.error(&quot;é˜¿é‡Œäº‘OSSæœåŠ¡è¿æ¥å¼‚å¸¸.&quot; + ce.getMessage(), ce);          &#125; catch (IOException e) &#123;              // e.printStackTrace();              log.error(&quot;æ–‡ä»¶æµå¼‚å¸¸.&quot; + e.getMessage(), e);          &#125;          return &quot;https://&quot; + ossProperties.getBucket() + &quot;.&quot; + ossProperties.getEndpoint() + &quot;/&quot; + objectName;      &#125;        /**       * ä¸Šä¼ æ–‡ä»¶ byte ()       * @param folder &quot;éœ€è¦åŠ / å¦‚&quot;xxx/&quot;&quot;       * @return æ–‡ä»¶åœ°å€       */      public String imgUploadByByte(byte[] bytes, String folder) &#123;          String bucketName = ossProperties.getBucket();            // åˆ¤æ–­Bucketçš„å­˜åœ¨          if (!ossClient.doesBucketExist(bucketName)) &#123;              // åˆ›å»ºå­˜å‚¨ç©ºé—´              Bucket bucket = ossClient.createBucket(bucketName);              bucketName = bucket.getName();          &#125;            String objectName = &quot;&quot;;          try &#123;              InputStream inputStream = new ByteArrayInputStream(bytes);                val suffix = &quot;jpg&quot;;              String fileName = UUID.fastUUID().toString() +suffix;              objectName = folder + DateUtil.format(new Date(), &quot;yy-MM/dd&quot;) + &quot;/&quot; + fileName;                // åˆ›å»ºä¸Šä¼ Objectçš„Metadata              ObjectMetadata metadata = new ObjectMetadata();              // ä¸Šä¼ çš„æ–‡ä»¶çš„é•¿åº¦              metadata.setContentLength(inputStream.available());              // æŒ‡å®šè¯¥Objectè¢«ä¸‹è½½æ—¶çš„ç½‘é¡µçš„ç¼“å­˜è¡Œä¸º              metadata.setCacheControl(&quot;no-cache&quot;);              // æŒ‡å®šè¯¥Objectä¸‹è®¾ç½®Header              metadata.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;);              // æŒ‡å®šè¯¥Objectè¢«ä¸‹è½½æ—¶çš„å†…å®¹ç¼–ç æ ¼å¼              metadata.setContentEncoding(&quot;utf-8&quot;);              // æ–‡ä»¶çš„MIMEï¼Œå®šä¹‰æ–‡ä»¶çš„ç±»å‹åŠç½‘é¡µç¼–ç ï¼Œå†³å®šæµè§ˆå™¨å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–æ–‡ä»¶ã€‚å¦‚æœç”¨æˆ·æ²¡æœ‰æŒ‡å®šåˆ™æ ¹æ®Keyæˆ–æ–‡ä»¶åçš„æ‰©å±•åç”Ÿæˆï¼Œ              // å¦‚æœæ²¡æœ‰æ‰©å±•ååˆ™å¡«é»˜è®¤å€¼application/octet-stream              metadata.setContentType(AliyunOssFileTypeEnum.getText(suffix));              // ä¸Šä¼ æ–‡ä»¶ (ä¸Šä¼ æ–‡ä»¶æµçš„å½¢å¼)              PutObjectResult putResult = ossClient.putObject(bucketName, objectName, inputStream, metadata);              // è§£æç»“æœ              String resultStr = putResult.getETag();              log.info(&quot;å”¯ä¸€MD5æ•°å­—ç­¾å:&quot; + resultStr);          &#125; catch (OSSException oe) &#123;              // oe.printStackTrace();              log.error(&quot;ä¸Šä¼ é˜¿é‡Œäº‘OSSæœåŠ¡å™¨å¼‚å¸¸.&quot; + oe.getMessage(), oe);          &#125; catch (ClientException ce) &#123;              // ce.printStackTrace();              log.error(&quot;é˜¿é‡Œäº‘OSSæœåŠ¡è¿æ¥å¼‚å¸¸.&quot; + ce.getMessage(), ce);          &#125; catch (IOException e) &#123;              // e.printStackTrace();              log.error(&quot;æ–‡ä»¶æµå¼‚å¸¸.&quot; + e.getMessage(), e);          &#125;          return &quot;https://&quot; + ossProperties.getBucket() + &quot;.&quot; + ossProperties.getEndpoint() + &quot;/&quot; + objectName;      &#125;        /**       * æ ¹æ®objectNameåˆ é™¤OSSæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶       *       * @param objectName     æ¨¡æ‹Ÿæ–‡ä»¶å¤¹å å¦‚&quot;qj_nanjing/&quot; + Bucketä¸‹çš„æ–‡ä»¶çš„è·¯å¾„å+æ–‡ä»¶å å¦‚ï¼š&quot;upload/cake.jpg&quot;       */       public Boolean deleteFile(String objectName) &#123;          String bucketName = ossProperties.getBucket();          ossClient.deleteObject(bucketName, objectName);          log.info(&quot;åˆ é™¤&quot; + bucketName + &quot;ä¸‹çš„æ–‡ä»¶&quot; + objectName + &quot;æˆåŠŸ&quot;);          return true;      &#125;        /**       * æ ¹æ®urlè·å–objectName       *     * @param url url       */    public String getObjectNameByUrl(String url) &#123;  //        url = url.replace(&quot;https://&quot; + ossProperties.getBucket() + &quot;.&quot; + ossProperties.getEndpoint() + &quot;/&quot;, &quot;&quot;);          int firstIndex = url.indexOf(&quot;/&quot;);          int secondIndex = url.indexOf(&quot;/&quot;, firstIndex + 1);          int thirdIndex = url.indexOf(&quot;/&quot;, secondIndex + 1);          int suffix = url.lastIndexOf(&quot;?&quot;) &gt; 0 ? url.lastIndexOf(&quot;?&quot;) : url.length();          url = url.substring(thirdIndex + 1, suffix);          return url;      &#125;        /**       * è·å–ä¸Šä¼ æ–‡ä»¶url (éå…¬å…±è¯»å†™æ—¶)       *     * @param objectName æ¨¡æ‹Ÿæ–‡ä»¶å¤¹å å¦‚&quot;qj_nanjing/&quot; + Bucketä¸‹çš„æ–‡ä»¶çš„è·¯å¾„å+æ–‡ä»¶å å¦‚ï¼š&quot;upload/cake.jpg&quot;       * @return url       */    public String getUrl(String objectName) &#123;          //è®¾ç½®URlè¿‡æœŸæ—¶é—´ä¸º99å¹´ï¼š3600L*1000*24*365*99          Date expiration = new Date(new Date().getTime() + 3600L * 1000 * 24 * 365 * 99);          GeneratePresignedUrlRequest generatePresignedUrlRequest = new GeneratePresignedUrlRequest(ossProperties.getBucket(), objectName);          generatePresignedUrlRequest.setExpiration(expiration);          URL url = ossClient.generatePresignedUrl(generatePresignedUrlRequest);          return url.toString();      &#125;&#125;\nMinio\næœåŠ¡å¯åŠ¨\n\n\nwindows å¯åŠ¨\n\n\nC:\\Develop\\minio\\bin&gt;minio.exe server C:\\Develop\\minio\\data --address 127.0.0.1:9005\nMaven ä¾èµ–\n&lt;dependencies&gt;      &lt;dependency&gt;          &lt;groupId&gt;io.minio&lt;/groupId&gt;          &lt;artifactId&gt;minio&lt;/artifactId&gt;          &lt;version&gt;7.1.0&lt;/version&gt;      &lt;/dependency&gt;\t&lt;!--SPI--&gt;    &lt;dependency&gt;          &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;          &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;          &lt;optional&gt;true&lt;/optional&gt;      &lt;/dependency&gt;      &lt;dependency&gt;          &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;          &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;      &lt;/dependency&gt;  &lt;/dependencies&gt;\né…ç½®æ–‡ä»¶\nminio:    endpoint: xxxxxxxxxxxxxxxxxxxxxx #MinIOæœåŠ¡æ‰€åœ¨åœ°å€    bucketName: xxxxxxxxxxx #å­˜å‚¨æ¡¶åç§°    accessKey: xxxxxxxxxxxxxxxx #è®¿é—®çš„key    secretKey: xxxxxxxxxxxxxxxxxxx #è®¿é—®çš„ç§˜é’¥\nä»£ç \n\n\nMinioProp.java\n\n\n@ConfigurationProperties(prefix = &quot;minio&quot;)  public class MinioProp &#123;      private String endpoint;      private String accessKey;      private String secretKey;      private String bucketName;        public String getEndpoint() &#123;          return endpoint;      &#125;        public void setEndpoint(String endpoint) &#123;          this.endpoint = endpoint;      &#125;        public String getAccessKey() &#123;          return accessKey;      &#125;        public void setAccessKey(String accessKey) &#123;          this.accessKey = accessKey;      &#125;        public String getSecretKey() &#123;          return secretKey;      &#125;        public void setSecretKey(String secretKey) &#123;          this.secretKey = secretKey;      &#125;        public String getBucketName() &#123;          return bucketName;      &#125;        public void setBucketName(String bucket) &#123;          this.bucketName = bucket;      &#125;  &#125;\n\n\nOSSFile.java\n\n\n@Data  public class OSSFile &#123;      /**       * æ–‡ä»¶å       */      private String fileName;      /**       * æ–‡ä»¶å­˜å‚¨åœ°å€       */      private String url;      /**       * æ–‡ä»¶ObjectName       */        private String objectName;  &#125;\n\n\nMinioUtil.java\n\n\n@Component  @Slf4j  @EnableConfigurationProperties(MinioProp.class)  public class MinioUtil &#123;      @Resource      private MinioProp prop;        private MinioClient minioClient;        /**       * åˆ›å»ºminioClient       */    @PostConstruct      public void createMinioClient() &#123;          try &#123;              if (null == minioClient) &#123;                  log.info(&quot;minioClient create start&quot;);                  minioClient = MinioClient.builder().endpoint(prop.getEndpoint())                          .credentials(prop.getAccessKey(), prop.getSecretKey())                          .build();                  createBucket();                  log.info(&quot;minioClient create end&quot;);              &#125;          &#125; catch (Exception e) &#123;              log.error(&quot;è¿æ¥MinIOæœåŠ¡å™¨å¼‚å¸¸ï¼š&quot; + e);          &#125;      &#125;        /**       * åˆå§‹åŒ–Bucket       *     * @throws Exception å¼‚å¸¸       */      private void createBucket()              throws IOException, InvalidKeyException, InvalidResponseException, InsufficientDataException, NoSuchAlgorithmException, ServerException, InternalException, XmlParserException, InvalidBucketNameException, ErrorResponseException, RegionConflictException &#123;          if (!minioClient.bucketExists(BucketExistsArgs.builder().bucket(prop.getBucketName()).build())) &#123;              minioClient.makeBucket(MakeBucketArgs.builder().bucket(prop.getBucketName()).build());          &#125;      &#125;        /**       * æŸ¥çœ‹å­˜å‚¨bucketæ˜¯å¦å­˜åœ¨       * @return boolean       */    public Boolean bucketExists(String bucketName) &#123;          Boolean found;          try &#123;              found = minioClient.bucketExists(BucketExistsArgs.builder().bucket(bucketName).build());          &#125; catch (Exception e) &#123;              e.printStackTrace();              return false;          &#125;          return found;      &#125;        /**       * åˆ›å»ºå­˜å‚¨bucket       * @return Boolean       */        public Boolean makeBucket(String bucketName) &#123;          try &#123;              if (!bucketExists(bucketName)) &#123;                  minioClient.makeBucket(MakeBucketArgs.builder()                          .bucket(bucketName)                          .build());                  String policyJson = &quot;&#123;\\n&quot; +                          &quot;\\t\\&quot;Version\\&quot;: \\&quot;&quot;+new SimpleDateFormat(&quot;yyyy-mm-dd&quot;).format(System.currentTimeMillis())+&quot;\\&quot;,\\n&quot; +                          &quot;\\t\\&quot;Statement\\&quot;: [&#123;\\n&quot; +                          &quot;\\t\\t\\&quot;Effect\\&quot;: \\&quot;Allow\\&quot;,\\n&quot; +                          &quot;\\t\\t\\&quot;Principal\\&quot;: &#123;\\n&quot; +                          &quot;\\t\\t\\t\\&quot;AWS\\&quot;: [\\&quot;*\\&quot;]\\n&quot; +                          &quot;\\t\\t&#125;,\\n&quot; +                          &quot;\\t\\t\\&quot;Action\\&quot;: [\\&quot;s3:GetBucketLocation\\&quot;, \\&quot;s3:ListBucket\\&quot;, \\&quot;s3:ListBucketMultipartUploads\\&quot;],\\n&quot; +                          &quot;\\t\\t\\&quot;Resource\\&quot;: [\\&quot;arn:aws:s3:::&quot; + bucketName + &quot;\\&quot;]\\n&quot; +                          &quot;\\t&#125;, &#123;\\n&quot; +                          &quot;\\t\\t\\&quot;Effect\\&quot;: \\&quot;Allow\\&quot;,\\n&quot; +                          &quot;\\t\\t\\&quot;Principal\\&quot;: &#123;\\n&quot; +                          &quot;\\t\\t\\t\\&quot;AWS\\&quot;: [\\&quot;*\\&quot;]\\n&quot; +                          &quot;\\t\\t&#125;,\\n&quot; +                          &quot;\\t\\t\\&quot;Action\\&quot;: [\\&quot;s3:AbortMultipartUpload\\&quot;, \\&quot;s3:DeleteObject\\&quot;, \\&quot;s3:GetObject\\&quot;, \\&quot;s3:ListMultipartUploadParts\\&quot;, \\&quot;s3:PutObject\\&quot;],\\n&quot; +                          &quot;\\t\\t\\&quot;Resource\\&quot;: [\\&quot;arn:aws:s3:::&quot; + bucketName + &quot;/*\\&quot;]\\n&quot; +                          &quot;\\t&#125;]\\n&quot; +                          &quot;&#125;\\n&quot;;                  minioClient.setBucketPolicy(SetBucketPolicyArgs.builder().bucket(bucketName).config(policyJson).build());                  log.info(&quot;bucketsï¼šã€&#123;&#125;ã€‘,åˆ›å»º[readwrite]ç­–ç•¥æˆåŠŸï¼&quot;, bucketName);              &#125; else &#123;                  log.info(&quot;minio bucket-&gt;&gt;&gt;ã€&#123;&#125;ã€‘already exists&quot;, bucketName);              &#125;          &#125; catch (Exception e) &#123;              e.printStackTrace();              return false;          &#125;          return true;      &#125;      /**       * åˆ é™¤å­˜å‚¨bucket       * @return Boolean       */        public Boolean removeBucket(String bucketName) &#123;          try &#123;              minioClient.removeBucket(RemoveBucketArgs.builder()                      .bucket(bucketName)                      .build());          &#125; catch (Exception e) &#123;              e.printStackTrace();              return false;          &#125;          return true;      &#125;      /**       * è·å–å…¨éƒ¨bucket       */        public List&lt;Bucket&gt; getAllBuckets() &#123;          try &#123;              List&lt;Bucket&gt; buckets = minioClient.listBuckets();              return buckets;          &#125; catch (Exception e) &#123;              e.printStackTrace();          &#125;          return null;      &#125;      /**       * æ–‡ä»¶ä¸Šä¼        *       * @param file æ–‡ä»¶       * @return Boolean       */        public OSSFile upload(MultipartFile file) &#123;          String originalFilename = file.getOriginalFilename();          if (StrUtil.isBlank(originalFilename))&#123;              throw new RuntimeException();          &#125;          // é‡å‘½å          String fileName = UUID.fastUUID() + originalFilename.substring(originalFilename.lastIndexOf(&quot;.&quot;));          String objectName = DateUtil.format(new Date(), &quot;yy-MM/dd&quot;) + &quot;/&quot; + fileName;          try &#123;              PutObjectArgs objectArgs = PutObjectArgs.builder().bucket(prop.getBucketName()).object(objectName)                      .stream(file.getInputStream(), file.getSize(), -1).contentType(file.getContentType()).build();              //æ–‡ä»¶åç§°ç›¸åŒä¼šè¦†ç›–              minioClient.putObject(objectArgs);          &#125; catch (Exception e) &#123;              e.printStackTrace();              return null;          &#125;            OSSFile ossFile = new OSSFile();          ossFile.setFileName(originalFilename);          ossFile.setObjectName(objectName);          ossFile.setUrl(prop.getEndpoint() + &quot;/&quot; + prop.getBucketName() + &quot;/&quot; + objectName);          return ossFile;      &#125;        /**       * é¢„è§ˆå›¾ç‰‡       * @param fileName       * @return       */      public String preview(String fileName)&#123;          // æŸ¥çœ‹æ–‡ä»¶åœ°å€          GetPresignedObjectUrlArgs build = new GetPresignedObjectUrlArgs().builder().bucket(prop.getBucketName()).object(fileName).method(Method.GET).build();          try &#123;              String url = minioClient.getPresignedObjectUrl(build);              return url;          &#125; catch (Exception e) &#123;              e.printStackTrace();          &#125;          return null;      &#125;        /**       * æ–‡ä»¶ä¸‹è½½       * @param fileName æ–‡ä»¶åç§°       * @param res response       * @return Boolean       */        public void download(String fileName, HttpServletResponse res) &#123;          GetObjectArgs objectArgs = GetObjectArgs.builder().bucket(prop.getBucketName())                  .object(fileName).build();          try (InputStream response = minioClient.getObject(objectArgs))&#123;              byte[] buf = new byte[1024];              int len;              try (FastByteArrayOutputStream os = new FastByteArrayOutputStream())&#123;                  while ((len=response.read(buf))!=-1)&#123;                      os.write(buf,0,len);                  &#125;                  os.flush();                  byte[] bytes = os.toByteArray();                  res.setCharacterEncoding(&quot;utf-8&quot;);                  // è®¾ç½®å¼ºåˆ¶ä¸‹è½½ä¸æ‰“å¼€                  // res.setContentType(&quot;application/force-download&quot;);                  res.addHeader(&quot;Content-Disposition&quot;, &quot;attachment;fileName=&quot; + fileName);                  try (ServletOutputStream stream = res.getOutputStream())&#123;                      stream.write(bytes);                      stream.flush();                  &#125;              &#125;          &#125; catch (Exception e) &#123;              e.printStackTrace();          &#125;      &#125;        /**       * æŸ¥çœ‹æ–‡ä»¶å¯¹è±¡       * @return å­˜å‚¨bucketå†…æ–‡ä»¶å¯¹è±¡ä¿¡æ¯       */      public List&lt;Item&gt; listObjects() &#123;          Iterable&lt;Result&lt;Item&gt;&gt; results = minioClient.listObjects(                  ListObjectsArgs.builder().bucket(prop.getBucketName()).build());          List&lt;Item&gt; items = new ArrayList&lt;&gt;();          try &#123;              for (Result&lt;Item&gt; result : results) &#123;                  items.add(result.get());              &#125;          &#125; catch (Exception e) &#123;              e.printStackTrace();              return null;          &#125;          return items;      &#125;        /**       * åˆ é™¤       * @param fileName       * @return       * @throws Exception       */      public boolean remove(String fileName)&#123;          try &#123;              minioClient.removeObject( RemoveObjectArgs.builder().bucket(prop.getBucketName()).object(fileName).build());          &#125;catch (Exception e)&#123;              return false;          &#125;          return true;      &#125;  &#125;\næ‹“å±•\nMinio è¿™ä¸ªè¢«å†™æˆäº† SPI åŠ è½½åˆ°åˆ«çš„æœåŠ¡ä¸­ï¼Œè¿™è¾¹å†åŠ ä¸€ä¸‹å…³äº SPI çš„çŸ¥è¯†ã€‚\n\nå¦‚å›¾ resources æ–‡ä»¶å¤¹ä¸‹çš„ META-INF æ–‡ä»¶å¤¹ä¸‹çš„ spring.factories æ–‡ä»¶ã€‚\nå¦‚æœè¦æŠŠ MinioUtil è¿™ä¸ªæ–¹æ³•åŠ è½½åˆ°åˆ«çš„é¡¹ç›®ä¸­ï¼Œå¯ä»¥è¿™ä¹ˆå†™ã€‚\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=com.hzjzxx.minio.utils.MinioUtil\nå…³äº SPI çš„çŸ¥è¯†ï¼š\n\nå†…é“¾ï¼š[[é¢è¯•-SPI]]\nå¤–é“¾ï¼šSPIç›¸å…³\n\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["Minio","Oss"]},{"title":"é¢è¯•-Springã€Spring MVCã€Spring Boot","url":"/posts/dcaead99/","content":"\n\nå‰è¨€\nâ—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24-06-10 åˆå§‹è®°å½•24-06-12 ç»§ç»­24-06-13 ç»§ç»­24-06-14 è¡¥å……å‰©ä¸‹çš„çŸ¥è¯†ç‚¹ã€‚Springè¿™å—çš„çŸ¥è¯†åç»­éœ€è¦çœ‹ä¹¦ã€çœ‹æºç ã€‚\n\nSpring\nè¯´è¯´ Spring å¸¸ç”¨çš„å‡ ä¸ªæ³¨è§£ï¼Ÿ\n\n\n\næ³¨è§£\nä½¿ç”¨\n\n\n\n\n@Component\nå–ä»£.xml ä¸­çš„ï¼›ç”¨äºä¸‰å±‚æ¶æ„ç±»ä¹‹å¤–ã€‚\n\n\n@Controller\nè¡ç”Ÿæ³¨è§£ï¼›ç”¨äº Controller å±‚\n\n\n@Service\nè¡ç”Ÿæ³¨è§£ï¼›ç”¨äº Service å±‚\n\n\n@Repository\nè¡ç”Ÿæ³¨è§£ï¼›ç”¨äº Dao å±‚\n\n\n@Bean\nå–ä»£.xml ä¸­å·¥å‚åˆ›å»º bean å¯¹è±¡,æ–¹æ³•çš„è¿”å›å€¼æˆä¸º bean å¯¹è±¡ã€‚\n\n\n@Autowired\nå–ä»£.xml ä¸­ä¸­çš„ ref æ³¨å…¥ï¼Œåº•å±‚æ˜¯ CGLIB åŠ¨æ€ä»£ç†ã€‚è¿™ä¸ªæ˜¯æœ¬åœ°æ³¨å…¥ã€‚\n\n\n@Aspect\nå®šä¹‰åœ¨ç±»ä¸Šï¼›è®¾ç½®å½“å‰ç±»ä¸ºåˆ‡é¢ç±»\n\n\n@Before\nå®šä¹‰åœ¨æ–¹æ³•ä¸Šï¼›æ ‡æ³¨å½“å‰æ–¹æ³•ä½œä¸ºå‰ç½®é€šçŸ¥\n\n\n\nè°ˆè°ˆä½ å¯¹ Spring çš„ç†è§£ï¼Ÿ\nSpring æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç”Ÿæ€ï¼Œä¸å•å•æ˜¯ä¸€ä¸ªæŠ€æœ¯æ¡†æ¶ã€‚\nâ—Spring æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\nå·¥å‚æ¨¡å¼ï¼šBeanFactory å°±æ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„ä½“ç°ï¼Œç”¨æ¥åˆ›å»ºå¯¹è±¡çš„å®ä¾‹ï¼›\nå•ä¾‹æ¨¡å¼ï¼šBean é»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼ã€‚\nä»£ç†æ¨¡å¼ï¼šSpring çš„ AOP åŠŸèƒ½ç”¨åˆ°äº† JDK çš„åŠ¨æ€ä»£ç†å’Œ CGLIB å­—èŠ‚ç ç”ŸæˆæŠ€æœ¯ï¼›\næ¨¡æ¿æ–¹æ³•ï¼šç”¨æ¥è§£å†³ä»£ç é‡å¤çš„é—®é¢˜ã€‚æ¯”å¦‚ï¼šRestTemplateï¼ŒJmsTemplateï¼ŒJpaTemplateã€‚\nè§‚å¯Ÿè€…æ¨¡å¼ï¼šå®šä¹‰å¯¹è±¡é”®ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥è¢«åˆ¶åŠ¨æ›´æ–°ï¼Œå¦‚ Spring ä¸­ listener çš„å®ç°â€“ApplicationListenerã€‚\nSpring ä¸¤å¤§æ ¸å¿ƒæ€æƒ³æ˜¯ä»€ä¹ˆï¼Ÿ\nIOCï¼šè§£è€¦ï¼Œä½¿ä»£ç å¤ç”¨ï¼Œå¯ç»´æŠ¤æ€§å¤§å¹…æå‡ã€‚\nAOPï¼šæä¾›åˆ‡é¢ç¼–ç¨‹ï¼ŒåŒæ ·å¢å¼ºç”Ÿäº§åŠ›ã€‚\nâ—è¯´ä¸€è¯´ä½ å¯¹ IOC çš„ç†è§£ï¼Ÿ\nâ—å¤§ç™½è¯ï¼šæœ€åŸå§‹çš„ tomcat+servlet çš„ç¼–ç åŸç†ã€‚ä½¿ç”¨çš„æ—¶å€™ Myservice myservie = new MyserviceImpl()ã€‚è€¦åˆåº¦å¾ˆé«˜ï¼Œä¿®æ”¹ä¸€ä¸ªç±»è¦ä¿®æ”¹å¾ˆå¤šæ–‡ä»¶ã€‚ç„¶åæˆ‘ä»¬å¼•å…¥ Spring è¿™ä¸ªæ¡†æ¶ã€‚ä¼šå»ç”±æ¡†æ¶ Spring å®¹å™¨åˆ›å»ºå®ä¾‹ Beanï¼Œå¯¹è±¡é—´å°±ä¼šç›´æ¥å¼•ç”¨ï¼ˆä¾èµ–æ³¨å…¥ï¼‰ã€‚ç„¶å Spring MVC(æ ¸å¿ƒ Servlet Filter å»å¤„ç†è¯·æ±‚)ã€‚IOC åº•å±‚å°±æ˜¯åå°„ï¼ˆ+ å·¥å‚æ¨¡å¼ï¼‰ã€é€šè¿‡ç±»å»åˆ›å»ºå¯¹è±¡ã€‚\nIoCï¼ˆInversion Of Controlï¼‰æ§åˆ¶åè½¬ï¼Œå…¶å®æ˜¯ä¸€ç§æ€æƒ³ï¼Œç”¨äºè§£å†³ç¨‹åºé—´çš„è€¦åˆé—®é¢˜ã€‚ã€è§£è€¦ã€‘\nåŸæœ¬æˆ‘ä»¬åˆ›å»ºå¯¹è±¡æ˜¯ç›´æ¥åœ¨ç±»ä¸­ï¼Œé€šè¿‡ new çš„æ–¹å¼åˆ›å»ºï¼Œæ§åˆ¶æƒåœ¨äºç¨‹åºå‘˜è‡ªå·±ï¼Œç°åœ¨æˆ‘ä»¬æŠŠ new å¯¹è±¡çš„å·¥ä½œäº¤ç»™ spring å®Œæˆï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®å³å¯ã€‚åè½¬çš„æ˜¯å¯¹è±¡çš„åˆ›å»ºæƒåŠ›ã€‚ã€ä¾¿æ·ã€‘\nioc å®¹å™¨ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ä¸ªå·¥å‚ï¼Œä½†æ˜¯ä»–çš„åŠŸèƒ½æ¯”æ™®é€šå·¥å‚è¦å¼ºå¤§å¾ˆå¤šï¼Œå†…éƒ¨å¸®åŠ©æˆ‘ä»¬å®Œæˆäº†å¯¹è±¡çš„åˆ›å»ºå’Œæ•´ä¸ªè¿‡ç¨‹ç®¡ç†ï¼ŒåŒæ—¶æä¾›äº†å¾ˆå¤šæ‰©å±•æœºä¼šã€‚ã€å¯æ‰©å±•ã€‘\nâ—è¯´ä¸€è¯´ä½ å¯¹ AOP çš„ç†è§£ï¼Ÿ\nä»–æœ‰å‡ ä¸ªæ¦‚å¿µï¼Œå¯ä»¥åšä¸€ä¸ªåˆ‡é¢ã€‚åœ¨ä¸€äº›ç±»çš„æ–¹æ³•ä¸­ï¼Œéƒ½å…ˆç»‡å…¥ä¸€äº›ä»£ç å¤„ç†ç±»ä¼¼çš„é€»è¾‘ï¼ˆæ—¥å¿—ã€æƒé™è®¤è¯ã€äº‹åŠ¡ï¼‰ã€‚Spring åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªåŠ¨æ€ä»£ç†çš„æŠ€æœ¯ã€‚ä»–ä¼šåŠ¨æ€ç”Ÿæˆä¸€ä¸ªç±»ï¼ŒæŠŠæˆ‘ä»¬çš„ç±»æ³¨å…¥ï¼Œå®ç°ç»‡å…¥çš„é‚£äº›ä»£ç ã€‚\nSpring AOP é‡Œé¢çš„å‡ ä¸ªåè¯\nï¼ˆ1ï¼‰åˆ‡é¢ï¼ˆAspectï¼‰ï¼šåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚é€šçŸ¥å’Œåˆ‡ç‚¹å…±åŒå®šä¹‰äº†åˆ‡é¢çš„å…¨éƒ¨å†…å®¹ã€‚ åœ¨ Spring AOP ä¸­ï¼Œåˆ‡é¢å¯ä»¥ä½¿ç”¨é€šç”¨ç±»ï¼ˆåŸºäºæ¨¡å¼çš„é£æ ¼ï¼‰ æˆ–è€…åœ¨æ™®é€šç±»ä¸­ä»¥ @AspectJ æ³¨è§£æ¥å®ç°ã€‚\nï¼ˆ2ï¼‰è¿æ¥ç‚¹ï¼ˆJoin pointï¼‰ï¼šæŒ‡æ–¹æ³•ï¼Œåœ¨ Spring AOP ä¸­ï¼Œä¸€ä¸ªè¿æ¥ç‚¹æ€»æ˜¯ä»£è¡¨ä¸€ä¸ªæ–¹æ³•çš„æ‰§è¡Œã€‚ åº”ç”¨å¯èƒ½æœ‰æ•°ä»¥åƒè®¡çš„æ—¶æœºåº”ç”¨é€šçŸ¥ã€‚è¿™äº›æ—¶æœºè¢«ç§°ä¸ºè¿æ¥ç‚¹ã€‚è¿æ¥ç‚¹æ˜¯åœ¨åº”ç”¨æ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ’å…¥åˆ‡é¢çš„ä¸€ä¸ªç‚¹ã€‚è¿™ä¸ªç‚¹å¯ä»¥æ˜¯è°ƒç”¨æ–¹æ³•æ—¶ã€æŠ›å‡ºå¼‚å¸¸æ—¶ã€ç”šè‡³ä¿®æ”¹ä¸€ä¸ªå­—æ®µæ—¶ã€‚åˆ‡é¢ä»£ç å¯ä»¥åˆ©ç”¨è¿™äº›ç‚¹æ’å…¥åˆ°åº”ç”¨çš„æ­£å¸¸æµç¨‹ä¹‹ä¸­ï¼Œå¹¶æ·»åŠ æ–°çš„è¡Œä¸ºã€‚\nï¼ˆ3ï¼‰é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåœ¨ AOP æœ¯è¯­ä¸­ï¼Œåˆ‡é¢çš„å·¥ä½œè¢«ç§°ä¸ºé€šçŸ¥ã€‚\nï¼ˆ4ï¼‰åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šåˆ‡ç‚¹çš„å®šä¹‰ä¼šåŒ¹é…é€šçŸ¥æ‰€è¦ç»‡å…¥çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¿æ¥ç‚¹ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ˜ç¡®çš„ç±»å’Œæ–¹æ³•åç§°ï¼Œæˆ–æ˜¯åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰æ‰€åŒ¹é…çš„ç±»å’Œæ–¹æ³•åç§°æ¥æŒ‡å®šè¿™äº›åˆ‡ç‚¹ã€‚\nï¼ˆ5ï¼‰å¼•å…¥ï¼ˆIntroductionï¼‰ï¼šå¼•å…¥å…è®¸æˆ‘ä»¬å‘ç°æœ‰ç±»æ·»åŠ æ–°æ–¹æ³•æˆ–å±æ€§ã€‚\nï¼ˆ6ï¼‰ç›®æ ‡å¯¹è±¡ï¼ˆTarget Objectï¼‰ï¼š è¢«ä¸€ä¸ªæˆ–è€…å¤šä¸ªåˆ‡é¢ï¼ˆaspectï¼‰æ‰€é€šçŸ¥ï¼ˆadviseï¼‰çš„å¯¹è±¡ã€‚å®ƒé€šå¸¸æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚ä¹Ÿæœ‰äººæŠŠå®ƒå«åšè¢«é€šçŸ¥ï¼ˆadvicedï¼‰ å¯¹è±¡ã€‚ æ—¢ç„¶ Spring AOP æ˜¯é€šè¿‡è¿è¡Œæ—¶ä»£ç†å®ç°çš„ï¼Œè¿™ä¸ªå¯¹è±¡æ°¸è¿œæ˜¯ä¸€ä¸ª è¢«ä»£ç†ï¼ˆproxiedï¼‰ å¯¹è±¡ã€‚\nï¼ˆ7ï¼‰ç»‡å…¥ï¼ˆWeavingï¼‰ï¼šç»‡å…¥æ˜¯æŠŠåˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡å¹¶åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚\nSpring é€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\nåœ¨ AOP æœ¯è¯­ä¸­ï¼Œåˆ‡é¢çš„å·¥ä½œè¢«ç§°ä¸ºé€šçŸ¥ï¼Œå®é™…ä¸Šæ˜¯ç¨‹åºæ‰§è¡Œæ—¶è¦é€šè¿‡ SpringAOP æ¡†æ¶è§¦å‘çš„ä»£ç æ®µã€‚\nSpring åˆ‡é¢å¯ä»¥åº”ç”¨ 5 ç§ç±»å‹çš„é€šçŸ¥ï¼š\n\n\nå‰ç½®é€šçŸ¥ï¼ˆBeforeï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥åŠŸèƒ½ï¼›\n\n\nåç½®é€šçŸ¥ï¼ˆAfterï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥ï¼Œæ­¤æ—¶ä¸ä¼šå…³å¿ƒæ–¹æ³•çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼›\n\n\nè¿”å›é€šçŸ¥ï¼ˆAfter-returning ï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥ï¼›\n\n\nå¼‚å¸¸é€šçŸ¥ï¼ˆAfter-throwingï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åè°ƒç”¨é€šçŸ¥ï¼›\n\n\nç¯ç»•é€šçŸ¥ï¼ˆAroundï¼‰ï¼šé€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºã€‚\n\n\nâ—cglib åŠ¨æ€ä»£ç†å’Œ jdk åŠ¨æ€ä»£ç†çš„åŒºåˆ«\nåŠ¨æ€ä»£ç†ï¼Œå…¶å®å°±æ˜¯åŠ¨æ€çš„åˆ›å»ºä¸€ä¸ªç±»å‡ºæ¥ï¼Œåˆ›å»ºè¿™ä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªé‡Œé¢å¼•ç”¨ä½ çœŸæ­£è‡ªå·±å†™çš„ç±»ï¼Œæ‰€æœ‰æ–¹æ³•çš„è°ƒç”¨ï¼Œéƒ½å…ˆèµ°ä»£ç†ç±»å¯¹è±¡ï¼Œåšä¸€äº›ä»£ç ä¸Šçš„å¢å¼ºã€‚\nå¦‚æœç±»å®ç°äº†æŸä¸ªæ¥å£ï¼ŒSpring AOP ä¼šä½¿ç”¨ jdk åŠ¨æ€ä»£ç†ã€‚å¦‚æœæŸä¸ªç±»æ²¡æœ‰å®ç°æ¥å£ï¼ŒSpring AOP ä¼šä½¿ç”¨ cglib åŠ¨æ€ä»£ç†ã€‚cglib æ˜¯ç”Ÿæˆç±»çš„ä¸€ä¸ªå­ç±»ï¼Œå¯ä»¥åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç ï¼Œè¦†ç›–ä¸€äº›æ–¹æ³•ï¼Œè¿›è¡Œæ–¹æ³•å¢å¼ºã€‚\nBean å¯¹è±¡çš„åˆ›å»ºæ–¹å¼æœ‰å“ªå‡ ç§ï¼Ÿ\n\n\né€šè¿‡ IoC ç›´æ¥åˆ›å»º bean å¯¹è±¡\n\n\né€šè¿‡ IoC åˆ›å»º bean å·¥å‚ï¼Œå†é€šè¿‡ bean å·¥å‚çš„æ–¹æ³•åˆ›å»º bean å¯¹è±¡\n\n\né€šè¿‡ IoC åˆ›å»º bean å·¥å‚ï¼Œå†é€šè¿‡ bean å·¥å‚çš„é™æ€æ–¹æ³•åˆ›å»º bean å¯¹è±¡\n\n\nâ—Spring ä¸­çš„ Bean æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\nâ”bean çš„ä½œç”¨åŸŸå¯ä»¥åˆ†ä¸º 5 ä¸ªèŒƒå›´ï¼š\n\n\nsingletonï¼ˆå•ä¾‹ï¼‰ï¼šé»˜è®¤æ¯ä¸ªå®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡\n\n\nprototypeï¼šæ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°çš„\n\n\nrequest\n\n\nsession\n\n\nglobal-session\n\n\nä¸æ˜¯ï¼ŒSpring æ¡†æ¶ä¸­çš„å•ä¾‹ bean ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\nSpring ä¸­çš„ bean é»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼ï¼ŒSpring æ¡†æ¶å¹¶æ²¡æœ‰å¯¹å•ä¾‹ bean è¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†ã€‚\nå®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™ Spring Bean æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚ dao ç±»ï¼‰ï¼Œæ‰€ä»¥æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ bean ä¹Ÿæ˜¯å®‰å…¨çš„ï¼Œä½†å¦‚æœ bean æœ‰çŠ¶æ€çš„è¯ï¼ˆæ¯”å¦‚ view model å¯¹è±¡ï¼‰ï¼Œé‚£å°±è¦å¼€å‘è€…è‡ªå·±å»ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ”¹å˜ bean çš„ä½œç”¨åŸŸï¼ŒæŠŠâ€œsingletonâ€ï¼ˆå•ä¾‹ï¼‰å˜æ›´ä¸ºâ€œprototypeâ€ï¼ˆå¤šä¾‹ï¼‰ï¼Œè¿™æ ·è¯·æ±‚ bean ç›¸å½“äº new Bean() äº†ï¼Œæ‰€ä»¥å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚\næœ‰çŠ¶æ€ï¼šå°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½ã€‚\næ— çŠ¶æ€ï¼šå°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ®ã€‚\nâ—Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ\n\n\né¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“ bean å¯¹è±¡çš„åˆ›å»ºä¸æ˜¯ç”±æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„ï¼Œè€Œæ˜¯ç”± Spring æ¥ç»™æˆ‘ä»¬åˆ›å»ºçš„ï¼Œè€Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯å‘Šè¯‰ Spring æˆ‘ä»¬éœ€è¦åˆ›å»ºå“ªäº› Bean å¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ xmlã€æ³¨è§£ç­‰æ–¹å¼æ¥æä¾›åˆ›å»º Bean å¯¹è±¡æ‰€ä»¥éœ€è¦çš„ä¿¡æ¯ï¼Œè€Œ Spring è¦åˆ›å»º bean å¯¹è±¡ï¼Œå°±é¦–å…ˆå¾—æœ‰ä¸€ä¸ª BeanFactory å·¥å‚æ¥åˆ›å»º Bean å¯¹è±¡ï¼Œå¦‚æœè¿™ä¸ª Bean å¯¹è±¡å·²ç»å­˜åœ¨ï¼Œåˆ™é”€æ¯æ¸…ç©º Bean å·¥å‚çš„å†…å®¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šé€šè¿‡ DefaultListableBeanFactory æ–¹æ³•å…ˆåˆ›å»ºä¸€ä¸ª Bean å¯¹è±¡å·¥å‚ï¼ˆå³ BeanFactoryï¼‰ã€‚\n\n\nBeanFactory è¦åˆ›å»º Bean å¯¹è±¡ï¼Œå°±éœ€è¦ Bean å¯¹è±¡çš„ç›¸å…³ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å°±æ˜¯é€šè¿‡ xml æˆ–æ³¨è§£æ–¹å¼è·å¾—ï¼Œæ‰€ä»¥ç¬¬äºŒæ­¥æ˜¯éœ€è¦è¯»å–è¿™äº› bean çš„ç›¸å…³ä¿¡æ¯ï¼Œé€šè¿‡ LoadBeanDefinition æ¥åŠ è½½é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†ç›¸å…³ä¿¡æ¯åŠ è½½æˆä¸€ä¸ªä¸ª BeanDefinition å¯¹è±¡ï¼ˆBean ä¸ BeanDefinition çš„å…³ç³»å°±åƒç±»ä¸å­—èŠ‚ç æ–‡ä»¶ä¹‹é—´çš„å…³ç³»ï¼‰ã€‚\n\n\nBeanDefinitions ç”Ÿæˆåï¼Œä¼šé€šè¿‡ invokeBeanFactoryPostProcessors æ–¹æ³•å¯¹æ‰€æœ‰çš„ BeanDefinitions ä»¥åŠ BeanFactory è¿›è¡Œåç½®å¤„ç†æ‰§è¡Œï¼š\n\næ‹¿åˆ°å½“å‰åº”ç”¨ä¸Šä¸‹æ–‡ beanFactoryPostProcessors å˜é‡ä¸­çš„å€¼ï¼Œé»˜è®¤æƒ…å†µè¿”å›ä¸ºç©ºã€‚\nå®ä¾‹åŒ–å¹¶è°ƒç”¨æ‰€æœ‰å·²æ³¨å†Œçš„ BeanFactoryPostProcessor ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ Bean çš„ç›¸å…³å®šä¹‰ã€‚\n\n\n\nBeanFactory å·¥å‚çš„ç›¸å…³å¢å¼ºå¤„ç†ç»“æŸåï¼ŒBanFactory å°±ä¼šæ­£å¼å¼€å§‹å® Bean å¯¹è±¡çš„å®ä¾‹åŒ–ï¼Œç”± InstantiateSingletons æ–¹æ³•é€šè¿‡åå°„åˆ›å»º Bean å¯¹è±¡ï¼Œå…¶ä¸­ä¼šåˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦æ˜¯å•ä¾‹æˆ–è€…æ‡’åŠ è½½ï¼šå¦‚æœä¸æ˜¯å•ä¾‹æˆ–è€…ä¸æ˜¯æ‡’åŠ è½½ï¼Œå°±é‡‡ç”¨ FactoryBean å•ç‹¬æ„åˆ›å»ºå¯¹è±¡ï¼›å¦‚æœæ˜¯å•ä¾‹å¯¹è±¡æˆ–æ‡’åŠ è½½ï¼Œå°±ç”± BeanFactory å·¥å‚ç›´æ¥åå°„åˆ›å»ºå¯¹è±¡ã€‚\n\n\nBeanFactory å°†å¯¹è±¡å®ä¾‹åŒ–ä¹‹åï¼ŒSpring ä¼šé€šè¿‡ BeanPostProcessorï¼ˆbean å¯¹è±¡åç½®å¤„ç†å™¨ï¼‰å¯¹ Bean å¯¹è±¡çš„åˆå§‹åŒ–çš„å‰åè¿›è¡Œåç½®å¤„ç†ï¼Œå¡«å…… Bean å¯¹è±¡çš„å±æ€§ï¼Œå®Œæˆåˆå§‹åŒ–ã€‚\n\n\né€šè¿‡ Map æ•°æ®ç±»å‹æ”¾è¿™äº› Bean å¯¹è±¡å­˜æ”¾åœ¨ IOC å®¹å™¨ä¸­ã€‚\n\n\nbean é”€æ¯ï¼šæ³¨å†Œé”€æ¯çš„å›è°ƒæ–¹æ³•ï¼Œå½“å¯¹è±¡é”€æ¯æ—¶ï¼Œä¼šæ‰§è¡Œ destory-method æ–¹æ³•ã€‚\n\n\nä¸‹é¢å¯ä»¥ä¸çœ‹ï¼Œæ„Ÿè§‰è¿™å—è§†é¢‘è®²çš„ä¹±ä¸ƒå…«ç³Ÿçš„ã€‚\nå¤§ç™½è¯ï¼šå†æ³¨è§£é‡Œå®šä¹‰ beanï¼ŒSpring å®¹å™¨æ ¹æ®é…ç½®åˆ›å»ºã€ç®¡ç† bean ä¹‹é—´çš„ä¾èµ–å…³ç³»ç­‰ã€‚ç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»º -&gt;ä½¿ç”¨ -&gt;é”€æ¯ã€‚ä» (1) å®ä¾‹åŒ– beanï¼Œ(2) è®¾ç½®ä¾èµ–å±æ€§ï¼ˆä¾èµ–æ³¨å…¥ï¼‰ï¼Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¿›è¡ŒåŠ¨æ€ä»£ç†çš„å¤„ç†ã€‚(3) å¤„ç† Aware æ¥å£ï¼Œå¦‚æœ Bean å®ç°äº† ApplicationContextAware æ¥å£ï¼ŒSpring å®¹å™¨ä¼šè°ƒç”¨ setApplicationContext(ApplicationContext) æ–¹æ³•ï¼Œä¼ å…¥ Spring ä¸Šä¸‹æ–‡ã€‚æŠŠå®¹å™¨æ³¨å…¥ç»™ Beanã€‚(4) å¦‚æœè¦å¯¹ Bean è¿›è¡Œä¸€äº›è‡ªå®šä¹‰çš„å¤„ç†ï¼Œå¯ä»¥è®© Bean å®ç° BeanPostProcessors æ¥å£ã€‚(5) å¦‚æœ Bean é…ç½®äº† init-methodï¼Œä¼šæ ¹æ®é…ç½®è¿›è¡Œåˆå§‹åŒ–ã€‚(6) æ¸…ç†é˜¶æ®µï¼Œå¦‚æœ Bean å®ç°äº† DisposableBean è¿™ä¸ªæ¥å£ï¼Œä¼šè°ƒç”¨å…¶å®ç°çš„ destroy() æ–¹æ³•ã€‚(7) å¦‚æœ Bean çš„ Spring é…ç½®ä¸­é…ç½®äº† destory-method å±æ€§ï¼Œä¼šåœ¨é”€æ¯æ—¶ï¼Œè¿›è¡Œè°ƒç”¨ã€‚\nSpring ä¸ºä»€ä¹ˆå¯åŠ¨æ—¶è¦å®ä¾‹åŒ–å‡ ä¹æ‰€æœ‰çš„ Beanï¼Œè¿™æ ·å¯åŠ¨ä¸æ˜¯å¾ˆæ¶ˆè€—èµ„æºå—?\nä¸»è¦çš„å¥½å¤„æœ‰ä¸¤ä¸ªï¼šæ€§èƒ½ã€æå‰æš´éœ²é—®é¢˜ã€‚\nå¯åŠ¨æ—¶èŠ±è´¹å‡ åç§’åˆå§‹åŒ–å¥½æ‰€æœ‰çš„ beanï¼Œå¤„ç†å¥½æ‰€æœ‰çš„ä¾èµ–æ³¨å…¥ï¼Œåœ¨è¿è¡Œæ—¶å°±å¯ä»¥å…å»åˆå§‹åŒ–è¿™æ­¥äº†ï¼Œé¦–æ¬¡è®¿é—®å“åº”é€Ÿåº¦è‡ªç„¶æ›´å¥½ã€‚\næå‰æš´éœ²é—®é¢˜å°±æ˜¯åœ¨å¯åŠ¨æ—¶åˆå§‹åŒ– beanï¼Œå¯ä»¥æ£€æŸ¥å¾ªç¯ä¾èµ–ã€bean é‡å¤ã€bean ä¸å­˜åœ¨ç­‰ç­‰ä¸€ç³»åˆ—çš„é—®é¢˜ï¼Œæœ‰é—®é¢˜ç›´æ¥æŠ¥é”™å¯åŠ¨å¤±è´¥ï¼Œé‚£ä½ åœ¨éƒ¨ç½²çš„æ—¶å€™å°±èƒ½ç›´æ¥å‘ç°é—®é¢˜ï¼Œè€Œä¸æ˜¯ç­‰çº¿ä¸Šè¿è¡Œä¸€æ®µæ—¶é—´åçªç„¶åé¦ˆæœ‰é—®é¢˜åˆå¾—è·‘åˆ°æœåŠ¡å™¨ä¸Šçœ‹æ—¥å¿—ã€‚\nSpring é‡Œé¢çš„ bean ä¸ºä»€ä¹ˆè¦æ³¨å†Œï¼Œä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\næ³¨å†Œå°±æ˜¯æŠŠä¿¡æ¯å­˜èµ·æ¥ï¼Œå†…éƒ¨æ˜¯åŸºäºé›†åˆå®ç°çš„ï¼Œæ³¨å†Œæ–¹ä¾¿ä¹‹åå¯¹äºä¿¡æ¯çš„è°ƒå–ã€‚\nBeanFactory å’Œ FactoryBean çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\nBeanFactoryï¼šç”± Bean å·¥å‚ç»Ÿä¸€ç”Ÿæˆå¯¹è±¡ï¼Œç›¸å½“äºä¸€ä¸ªæ¨¡å­å…‹éš†å‡ºæ¥ã€‚\nFactoryBeanï¼šå•ç‹¬æ„é€ å¤æ‚å¯¹è±¡ï¼Œåœ¨ Spring ä¸­ BeanFactory è¿›è¡Œå®ä¾‹åŒ–æ—¶ï¼Œåˆ¤æ–­è¯¥å¯¹è±¡ä¸æ˜¯å•ä¾‹æˆ–è€…ä¸æ˜¯æ‡’åŠ è½½å½¢å¼ï¼Œå°±æ”¹ç”± FactoryBean æ¥å•ç‹¬åˆ›å»ºå¯¹è±¡ã€‚\nSpring æœ‰å“ªäº›ä¾èµ–æ³¨å…¥æ³•ï¼Ÿ\n\n\nSet æ–¹æ³•æ³¨å…¥ï¼šæ³¨å…¥æœ€ç®€å•ï¼Œæœ€å¸¸ç”¨çš„æ³¨å…¥æ–¹å¼ï¼Œæ”¯æŒæ³¨è§£ +xmlã€‚\n\n\næ„é€ å™¨æ³¨å…¥ï¼šæ˜¯æŒ‡å¸¦æœ‰å‚æ•°çš„æ„é€ å‡½æ•°æ³¨å…¥ï¼Œæ”¯æŒæ³¨è§£ +xml\n\n\né™æ€å·¥å‚çš„æ–¹å¼æ³¨å…¥ï¼šé€šè¿‡è°ƒç”¨é™æ€å·¥å‚çš„æ–¹æ³•æ¥è·å–è‡ªå·±éœ€è¦çš„å¯¹è±¡ï¼Œåªæ”¯æŒ xmlã€‚\n\n\nå®ä¾‹å·¥å‚çš„æ–¹å¼æ³¨å…¥ï¼šè·å–å¯¹è±¡å®ä¾‹çš„æ–¹æ³•ä¸æ˜¯é™æ€çš„ï¼Œæ‰€ä»¥éœ€è¦ new ä¸€ä¸ªå·¥å‚ç±»ï¼Œå†è°ƒç”¨æ™®é€šçš„å®ä¾‹æ–¹æ³•ï¼Œåªæ”¯æŒ xmlã€‚æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š(1) æ³¨è§£ï¼ˆ@Autowired,@Resource,@Requiredï¼‰(2) é…ç½®æ–‡ä»¶ï¼ˆxmlï¼‰\n\n\nâ—Spring çš„å¾ªç¯ä¾èµ–æ˜¯ä»€ä¹ˆï¼Ÿ\n\n\nä½¿ç”¨ context.getBean(A.class)ï¼Œæ—¨åœ¨è·å–å®¹å™¨å†…çš„å•ä¾‹ A(è‹¥ A ä¸å­˜åœ¨ï¼Œå°±ä¼šèµ° A è¿™ä¸ª Bean çš„åˆ›å»ºæµç¨‹)ï¼Œæ˜¾ç„¶åˆæ¬¡è·å– A æ˜¯ä¸å­˜åœ¨çš„ï¼Œå› æ­¤èµ° A çš„åˆ›å»ºä¹‹è·¯~\n\n\nå®ä¾‹åŒ– Aï¼ˆæ³¨æ„æ­¤å¤„ä»…ä»…æ˜¯å®ä¾‹åŒ–ï¼‰ï¼Œå¹¶å°†å®ƒæ”¾è¿›ç¼“å­˜ï¼ˆæ­¤æ—¶ A å·²ç»å®ä¾‹åŒ–å®Œæˆï¼Œå·²ç»å¯ä»¥è¢«å¼•ç”¨äº†ï¼‰\n\n\nåˆå§‹åŒ– Aï¼š@Autowired ä¾èµ–æ³¨å…¥ Bï¼ˆæ­¤æ—¶éœ€è¦å»å®¹å™¨å†…è·å– Bï¼‰\n\n\nä¸ºäº†å®Œæˆä¾èµ–æ³¨å…¥ Bï¼Œä¼šé€šè¿‡ getBean(B) å»å®¹å™¨å†…æ‰¾ Bã€‚ä½†æ­¤æ—¶ B åœ¨å®¹å™¨å†…ä¸å­˜åœ¨ï¼Œå°±èµ°å‘ B çš„åˆ›å»ºä¹‹è·¯~\n\n\nå®ä¾‹åŒ– Bï¼Œå¹¶å°†å…¶æ”¾å…¥ç¼“å­˜ã€‚ï¼ˆæ­¤æ—¶ B ä¹Ÿèƒ½å¤Ÿè¢«å¼•ç”¨äº†ï¼‰\n\n\nåˆå§‹åŒ– Bï¼Œ@Autowired ä¾èµ–æ³¨å…¥ Aï¼ˆæ­¤æ—¶éœ€è¦å»å®¹å™¨å†…è·å– Aï¼‰\n\n\næ­¤å¤„é‡è¦ï¼šåˆå§‹åŒ– B æ—¶ä¼šè°ƒç”¨ getBean(A) å»å®¹å™¨å†…æ‰¾åˆ° Aï¼Œä¸Šé¢æˆ‘ä»¬å·²ç»è¯´è¿‡äº†æ­¤æ—¶å€™å› ä¸º A å·²ç»å®ä¾‹åŒ–å®Œæˆäº†å¹¶ä¸”æ”¾è¿›äº†ç¼“å­˜é‡Œï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å»çœ‹ç¼“å­˜é‡Œæ˜¯å·²ç»å­˜åœ¨ A çš„å¼•ç”¨äº†çš„ï¼Œæ‰€ä»¥ getBean(A) èƒ½å¤Ÿæ­£å¸¸è¿”å›\n\n\nB åˆå§‹åŒ–æˆåŠŸï¼ˆæ­¤æ—¶å·²ç»æ³¨å…¥ A æˆåŠŸäº†ï¼Œå·²æˆåŠŸæŒæœ‰ A çš„å¼•ç”¨äº†ï¼‰ï¼Œreturnï¼ˆæ³¨æ„æ­¤å¤„ return ç›¸å½“äºæ˜¯è¿”å›æœ€ä¸Šé¢çš„ getBean(B) è¿™å¥ä»£ç ï¼Œå›åˆ°äº†åˆå§‹åŒ– A çš„æµç¨‹ä¸­~ï¼‰ã€‚\n\n\nå› ä¸º B å®ä¾‹å·²ç»æˆåŠŸè¿”å›äº†ï¼Œå› æ­¤æœ€ç»ˆ A ä¹Ÿåˆå§‹åŒ–æˆåŠŸ\n\n\nåˆ°æ­¤ï¼ŒB æŒæœ‰çš„å·²ç»æ˜¯åˆå§‹åŒ–å®Œæˆçš„ Aï¼ŒA æŒæœ‰çš„ä¹Ÿæ˜¯åˆå§‹åŒ–å®Œæˆçš„ Bï¼Œå®Œç¾~\n\n\nä½¿ç”¨@Autowired æ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\nä½¿ç”¨@Autowired æ³¨è§£æ¥è‡ªåŠ¨è£…é…æŒ‡å®šçš„ beanã€‚åœ¨ä½¿ç”¨@Autowired æ³¨è§£ä¹‹å‰éœ€è¦åœ¨ Spring é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œ&lt;context:annotation-config /&gt;ã€‚\nåœ¨å¯åŠ¨ Spring IoC æ—¶ï¼Œå®¹å™¨è‡ªåŠ¨è£…è½½äº†ä¸€ä¸ª AutowiredAnnotationBeanPostProcessor åç½®å¤„ç†å™¨ï¼Œå½“å®¹å™¨æ‰«æåˆ°@Autowiedã€@Resource æˆ–@Inject æ—¶ï¼Œå°±ä¼šåœ¨ IoC å®¹å™¨è‡ªåŠ¨æŸ¥æ‰¾éœ€è¦çš„ beanï¼Œå¹¶è£…é…ç»™è¯¥å¯¹è±¡çš„å±æ€§ã€‚åœ¨ä½¿ç”¨@Autowired æ—¶ï¼Œé¦–å…ˆåœ¨å®¹å™¨ä¸­æŸ¥è¯¢å¯¹åº”ç±»å‹çš„ beanï¼š\n\n\nå¦‚æœæŸ¥è¯¢ç»“æœåˆšå¥½ä¸ºä¸€ä¸ªï¼Œå°±å°†è¯¥ bean è£…é…ç»™@Autowired æŒ‡å®šçš„æ•°æ®ï¼›\n\n\nå¦‚æœæŸ¥è¯¢çš„ç»“æœä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆ@Autowired ä¼šæ ¹æ®åç§°æ¥æŸ¥æ‰¾ï¼›\n\n\nå¦‚æœä¸Šè¿°æŸ¥æ‰¾çš„ç»“æœä¸ºç©ºï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è§£å†³æ–¹æ³•æ—¶ï¼Œä½¿ç”¨ required=falseã€‚\n\n\nâ—Spring çš„äº‹åŠ¡å®ç°åŸç†ï¼Œå¯¹äºäº‹ç‰©ä¼ æ’­æœºåˆ¶çš„ç†è§£\nåŸç†ï¼š@Transactional + AOP\n\n\nã€å¸¸ç”¨ã€‘ã€é»˜è®¤ã€‘PROPAGATION_REQUIREDï¼šå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œé‚£å°±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œé‚£å°±åŠ å…¥è¯¥äº‹åŠ¡ã€‚\n\n\nã€å¸¸ç”¨ã€‘PROPAGATION_SUPPORTSï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œé‚£å°±ä»¥éäº‹åŠ¡æ‰§è¡Œã€‚\n\n\nPROPAGATION_MANDATORYï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠ›å¼‚å¸¸ã€‚\n\n\nã€åœºæ™¯ã€‘PROPAGATION_REQUIRES_NEWï¼šåˆ›å»ºæ–°äº‹åŠ¡ï¼Œæ— è®ºå½“å‰å­˜ä¸å­˜åœ¨äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡ã€‚\n\n\nPROPAGATION_NOT_SUPPORTEDï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚\n\n\nPROPAGATION_NEVERï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠ›å¼‚å¸¸ã€‚\n\n\nã€åœºæ™¯ã€‘PROPAGATION_NESTEDï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰äº‹åŠ¡ï¼Œå°±æŒ‰ REQUIRED å±æ€§æ‰§è¡Œã€‚å¤–å±‚ä»£ç å›æ»šï¼Œå†…å±‚ä»£ç ä¸€èµ·å›æ»šï¼›å†…å±‚ä»£ç å›æ»šï¼Œå¤–å±‚ä»£ç ä¸ä¸€èµ·å›æ»šã€‚\n\n\nè¯´ä¸€ä¸‹ Spring çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\nSpring æœ‰äº”å¤§éš”ç¦»çº§åˆ«ï¼Œé»˜è®¤å€¼ä¸º ISOLATION_DEFAULTï¼ˆä½¿ç”¨æ•°æ®åº“çš„è®¾ç½®ï¼‰ï¼Œå…¶ä»–å››ä¸ªéš”ç¦»çº§åˆ«å’Œæ•°æ®åº“çš„éš”ç¦»çº§åˆ«ä¸€è‡´ï¼š\n\n\nISOLATION_DEFAULTï¼šç”¨åº•å±‚æ•°æ®åº“çš„è®¾ç½®éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“è®¾ç½®çš„æ˜¯ä»€ä¹ˆæˆ‘å°±ç”¨ä»€ä¹ˆï¼›\n\n\nISOLATION_READ_UNCOMMITTEDï¼šæœªæäº¤è¯»ï¼Œæœ€ä½éš”ç¦»çº§åˆ«ã€äº‹åŠ¡æœªæäº¤å‰ï¼Œå°±å¯è¢«å…¶ä»–äº‹åŠ¡è¯»å–ï¼ˆä¼šå‡ºç°å¹»è¯»ã€è„è¯»ã€ä¸å¯é‡å¤è¯»ï¼‰ï¼›\n\n\nISOLATION_READ_COMMITTEDï¼šæäº¤è¯»ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤åæ‰èƒ½è¢«å…¶ä»–äº‹åŠ¡è¯»å–åˆ°ï¼ˆä¼šé€ æˆå¹»è¯»ã€ä¸å¯é‡å¤è¯»ï¼‰ï¼ŒSQL server çš„é»˜è®¤çº§åˆ«ï¼›\n\n\nISOLATION_REPEATABLE_READï¼šå¯é‡å¤è¯»ï¼Œä¿è¯å¤šæ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå…¶å€¼éƒ½å’Œäº‹åŠ¡å¼€å§‹æ—¶å€™çš„å†…å®¹æ˜¯ä¸€è‡´ï¼Œç¦æ­¢è¯»å–åˆ°åˆ«çš„äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼ˆä¼šé€ æˆå¹»è¯»ï¼‰ï¼ŒMySQL çš„é»˜è®¤çº§åˆ«ï¼›\n\n\nISOLATION_SERIALIZABLEï¼šåºåˆ—åŒ–ï¼Œä»£ä»·æœ€é«˜æœ€å¯é çš„éš”ç¦»çº§åˆ«ï¼Œè¯¥éš”ç¦»çº§åˆ«èƒ½é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ã€‚\n\n\n\n\nè„è¯» ï¼šè¡¨ç¤ºä¸€ä¸ªäº‹åŠ¡èƒ½å¤Ÿè¯»å–å¦ä¸€ä¸ªäº‹åŠ¡ä¸­è¿˜æœªæäº¤çš„æ•°æ®ã€‚æ¯”å¦‚ï¼ŒæŸä¸ªäº‹åŠ¡å°è¯•æ’å…¥è®°å½• Aï¼Œæ­¤æ—¶è¯¥äº‹åŠ¡è¿˜æœªæäº¤ï¼Œç„¶åå¦ä¸€ä¸ªäº‹åŠ¡å°è¯•è¯»å–åˆ°äº†è®°å½• Aã€‚\n\n\nä¸å¯é‡å¤è¯» ï¼šæ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå¤šæ¬¡è¯»åŒä¸€æ•°æ®ã€‚\n\n\nå¹»è¯» ï¼šæŒ‡åŒä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡æŸ¥è¯¢è¿”å›çš„ç»“æœé›†ä¸ä¸€æ ·ã€‚æ¯”å¦‚åŒä¸€ä¸ªäº‹åŠ¡ A ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶å€™æœ‰ n æ¡è®°å½•ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡åŒç­‰æ¡ä»¶ä¸‹æŸ¥è¯¢å´æœ‰ n+1 æ¡è®°å½•ï¼Œè¿™å°±å¥½åƒäº§ç”Ÿäº†å¹»è§‰ã€‚å‘ç”Ÿå¹»è¯»çš„åŸå› ä¹Ÿæ˜¯å¦å¤–ä¸€ä¸ªäº‹åŠ¡æ–°å¢æˆ–è€…åˆ é™¤æˆ–è€…ä¿®æ”¹äº†ç¬¬ä¸€ä¸ªäº‹åŠ¡ç»“æœé›†é‡Œé¢çš„æ•°æ®ï¼ŒåŒä¸€ä¸ªè®°å½•çš„æ•°æ®å†…å®¹è¢«ä¿®æ”¹äº†ï¼Œæ‰€ä»¥æ•°æ®è¡Œçš„è®°å½•å°±å˜å¤šæˆ–è€…å˜å°‘äº†ã€‚\n\n\nç”»ä¸€å¼ å›¾è¯´ Spring çš„æ ¸å¿ƒæ¶æ„\n// todo\næ²¡æœ‰ä»æºç å±‚é¢è®²è§£ï¼Œè¿™å—éœ€è¦åé¢è¡¥å……ã€‚\nSpring MVC\nçœ‹äº†ä¸€ä¸‹åˆ«çš„é—®é¢˜éƒ½æ˜¯æ¯”è¾ƒå¤è€çš„é—®é¢˜ã€‚åº”è¯¥ä¸ä¼šé—®åˆ°ï¼Œæš‚æ—¶ä¸è®°å½•ã€‚\nâ—è¯·æè¿° Spring MVC çš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹ï¼Ÿ\n\n\nç”¨æˆ·å‘é€è¯·æ±‚è‡³å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼›\n\n\nDispatcherServlet æ”¶åˆ°è¯·æ±‚åï¼Œè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ï¼Œè¯·æ±‚è·å– Handleï¼›\n\n\nå¤„ç†å™¨æ˜ å°„å™¨æ ¹æ®è¯·æ±‚ url æ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨ï¼Œç”Ÿæˆå¤„ç†å™¨å¯¹è±¡åŠå¤„ç†å™¨æ‹¦æˆªå™¨ (å¦‚æœæœ‰åˆ™ç”Ÿæˆ) ä¸€å¹¶è¿”å›ç»™ DispatcherServletï¼›\n\n\nDispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨ï¼›\n\n\nHandlerAdapter ç»è¿‡é€‚é…è°ƒç”¨å…·ä½“å¤„ç†å™¨ (Handlerï¼Œä¹Ÿå«åç«¯æ§åˆ¶å™¨)ï¼›\n\n\nHandler æ‰§è¡Œå®Œæˆè¿”å› ModelAndViewï¼›\n\n\nHandlerAdapter å°† Handler æ‰§è¡Œç»“æœ ModelAndView è¿”å›ç»™ DispatcherServletï¼›\n\n\nDispatcherServlet å°† ModelAndView ä¼ ç»™ ViewResolver è§†å›¾è§£æå™¨è¿›è¡Œè§£æï¼›\n\n\nViewResolver è§£æåè¿”å›å…·ä½“ Viewï¼›\n\n\nDispatcherServlet å¯¹ View è¿›è¡Œæ¸²æŸ“è§†å›¾ï¼ˆå³å°†æ¨¡å‹æ•°æ®å¡«å……è‡³è§†å›¾ä¸­ï¼‰\n\n\nDispatcherServlet å“åº”ç”¨æˆ·ã€‚\n\n\nSpring Boot\nâ—SringBoot çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆï¼Ÿ\nå¯åŠ¨ç±»ä¸Šé¢çš„æ³¨è§£æ˜¯@SpringBootApplicationï¼Œå®ƒä¹Ÿæ˜¯ Spring Boot çš„æ ¸å¿ƒæ³¨è§£ï¼Œä¸»è¦ç»„åˆåŒ…å«äº†ä»¥ä¸‹ 3 ä¸ªæ³¨è§£ï¼š\n\n\n@SpringBootConfigurationï¼šç»„åˆäº† @Configuration æ³¨è§£ï¼Œå®ç°é…ç½®æ–‡ä»¶çš„åŠŸèƒ½ã€‚\n\n\n@EnableAutoConfigurationï¼šæ‰“å¼€è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥å…³é—­æŸä¸ªè‡ªåŠ¨é…ç½®çš„é€‰é¡¹ï¼Œå¦‚å…³é—­æ•°æ®æºè‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼š @SpringBootApplication(exclude = { DataSourceAutoConfiguration.class })ã€‚\n\n\n@ComponentScanï¼šSpring ç»„ä»¶æ‰«æã€‚\n\n\nâ—SpringBoot çš„å·¥ä½œåŸç†/è‡ªåŠ¨é…ç½®/SPI æœºåˆ¶æ˜¯æ€ä¹ˆæ ·å­çš„ï¼Ÿ\nSpringBoot ä½¿ç”¨çš„@SpringApplication æ³¨è§£ï¼Œç„¶åä½¿ç”¨@EnableAutoConfiguration ä»¥åŠ@ComponentScan è‡ªåŠ¨è£…é…ï¼Œæ³¨è§£@EnableAutoConfiguration ä½¿ç”¨äº†@Import åŠ è½½ï¼Œä½¿ç”¨@Import å¯¼å…¥çš„ç±»ä¼šè¢« Spring åŠ è½½åˆ° IOC å®¹å™¨ä¸­ï¼Œæœ€åä½¿ç”¨äº† SpringFactoriesLoader åå°„å‡º maven ä¸­ META-INF ä¸‹ spring.factoriesï¼Œå°†åå°„çš„ bean å¯¹è±¡åŠ è½½åˆ° Spring å®¹å™¨ä¸­ï¼ˆä¹Ÿå°±æ˜¯ SpringBoot çš„ SPI æœºåˆ¶ï¼‰ã€‚\nSpring Boot æ˜¯å¦å¯ä»¥ä½¿ç”¨ XML é…ç½® ?\nSpring Boot æ¨èä½¿ç”¨ Java é…ç½®è€Œé XML é…ç½®ï¼Œä½†æ˜¯ Spring Boot ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ XML é…ç½®ï¼Œé€šè¿‡ @ImportResource æ³¨è§£å¯ä»¥å¼•å…¥ä¸€ä¸ª XML é…ç½®ã€‚\nSpring boot æ ¸å¿ƒé…ç½®æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿbootstrap.properties å’Œ application.properties æœ‰ä½•åŒºåˆ« ?\nå•çº¯åš Spring Boot å¼€å‘ï¼Œå¯èƒ½ä¸å¤ªå®¹æ˜“é‡åˆ° bootstrap.properties é…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯åœ¨ç»“åˆ Spring Cloud æ—¶ï¼Œè¿™ä¸ªé…ç½®å°±ä¼šç»å¸¸é‡åˆ°äº†ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦åŠ è½½ä¸€äº›è¿œç¨‹é…ç½®æ–‡ä»¶çš„æ—¶ä¾¯ã€‚\nSpring boot æ ¸å¿ƒçš„ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼š\n\n\nbootstrap (. yml æˆ–è€… . properties)ï¼šboostrap ç”±çˆ¶ ApplicationContext åŠ è½½çš„ï¼Œæ¯” applicaton ä¼˜å…ˆåŠ è½½ï¼Œé…ç½®åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„å¼•å¯¼é˜¶æ®µç”Ÿæ•ˆã€‚ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬åœ¨ Spring Cloud Config æˆ–è€… Nacos ä¸­ä¼šç”¨åˆ°å®ƒã€‚ä¸” bootstrap é‡Œé¢çš„å±æ€§ä¸èƒ½è¢«è¦†ç›–ï¼›\n\n\napplication (. yml æˆ–è€… . properties)ï¼š ç”± ApplicatonContext åŠ è½½ï¼Œç”¨äº spring boot é¡¹ç›®çš„è‡ªåŠ¨åŒ–é…ç½®ã€‚\n\n\nSpring Boot çš„é…ç½®æ–‡ä»¶åˆ†ç±»æœ‰å“ªå‡ ç§ï¼Ÿå®ƒä»¬çš„ä¼˜å…ˆçº§å¦‚ä½•ï¼Ÿ\nSpringBoot æ˜¯åŸºäºçº¦å®šçš„ï¼Œæ‰€ä»¥å¾ˆå¤šé…ç½®éƒ½æœ‰é»˜è®¤å€¼ï¼Œä½†å¦‚æœæƒ³ä½¿ç”¨è‡ªå·±çš„é…ç½®æ›¿æ¢é»˜è®¤é…ç½®çš„è¯ï¼Œå°±å¯ä»¥ä½¿ç”¨ application.properties æˆ–è€… application.ymlï¼ˆapplication.yamlï¼‰è¿›è¡Œé…ç½®ã€‚\né»˜è®¤é…ç½®æ–‡ä»¶åç§°ï¼šapplication\nåœ¨åŒä¸€çº§ç›®å½•ä¸‹ä¼˜å…ˆçº§ä¸ºï¼šproperties&gt;yml &gt; yaml\nSpring Boot æ‰“æˆçš„ jar å’Œæ™®é€šçš„ jar æœ‰ä»€ä¹ˆåŒºåˆ« ?\nSpring Boot é¡¹ç›®æœ€ç»ˆæ‰“åŒ…æˆçš„ jar æ˜¯å¯æ‰§è¡Œ jar ï¼Œè¿™ç§ jar å¯ä»¥ç›´æ¥é€šè¿‡ java -jar xxx.jar å‘½ä»¤æ¥è¿è¡Œï¼Œè¿™ç§ jar ä¸å¯ä»¥ä½œä¸ºæ™®é€šçš„ jar è¢«å…¶ä»–é¡¹ç›®ä¾èµ–ï¼Œå³ä½¿ä¾èµ–äº†ä¹Ÿæ— æ³•ä½¿ç”¨å…¶ä¸­çš„ç±»ã€‚\nSpring Boot çš„ jar æ— æ³•è¢«å…¶ä»–é¡¹ç›®ä¾èµ–ï¼Œä¸»è¦è¿˜æ˜¯ä»–å’Œæ™®é€š jar çš„ç»“æ„ä¸åŒã€‚æ™®é€šçš„ jar åŒ…ï¼Œè§£å‹åç›´æ¥å°±æ˜¯åŒ…åï¼ŒåŒ…é‡Œå°±æ˜¯æˆ‘ä»¬çš„ä»£ç ï¼Œè€Œ Spring Boot æ‰“åŒ…æˆçš„å¯æ‰§è¡Œ jar è§£å‹åï¼Œåœ¨ \\BOOT-INF\\classes ç›®å½•ä¸‹æ‰æ˜¯æˆ‘ä»¬çš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¢«ç›´æ¥å¼•ç”¨ã€‚å¦‚æœéè¦å¼•ç”¨ï¼Œå¯ä»¥åœ¨ pom.xml æ–‡ä»¶ä¸­å¢åŠ é…ç½®ï¼Œå°† Spring Boot é¡¹ç›®æ‰“åŒ…æˆä¸¤ä¸ª jar ï¼Œä¸€ä¸ªå¯æ‰§è¡Œï¼Œä¸€ä¸ªå¯å¼•ç”¨ã€‚\nSpring Boot ä¸­å¦‚ä½•å®ç°å®šæ—¶ä»»åŠ¡ ?\nå®šæ—¶ä»»åŠ¡ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ï¼ŒSpring Boot ä¸­å¯¹äºå®šæ—¶ä»»åŠ¡çš„æ”¯æŒä¸»è¦è¿˜æ˜¯æ¥è‡ª Spring æ¡†æ¶ã€‚\nåœ¨ Spring Boot ä¸­ä½¿ç”¨å®šæ—¶ä»»åŠ¡ä¸»è¦æœ‰ä¸¤ç§ä¸åŒçš„æ–¹å¼ï¼Œä¸€ä¸ªå°±æ˜¯ä½¿ç”¨ Spring ä¸­çš„ @Scheduled æ³¨è§£ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¡†æ¶ Quartzï¼ˆ/kwÉ”Ëts/ï¼‰ã€‚\nä½¿ç”¨ Spring ä¸­çš„ @Scheduled  ï¼ˆ/'ÊƒedjuËld/ï¼‰çš„æ–¹å¼ä¸»è¦é€šè¿‡ @Scheduled æ³¨è§£æ¥å®ç°ã€‚\nä½¿ç”¨ Quartz ï¼Œåˆ™æŒ‰ç…§ Quartz çš„æ–¹å¼ï¼Œå®šä¹‰ Job å’Œ Trigger å³å¯ã€‚\nå¦‚æœæ˜¯åˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡ï¼Œå¯ä»¥é‡‡ç”¨ XXL-Jobã€‚\nâ—ç”»ä¸€å¼ å›¾è¯´ Spring Boot çš„æ ¸å¿ƒæ¶æ„\nSpring Boot æœ¬èº«æ˜¯ Spring é¡¹ç›®å‘å±•åˆ°ä¸€å®šé˜¶æ®µåçš„äº§ç‰©ã€‚ä¸€å¼€å§‹æ˜¯ Spring æ¡†æ¶ï¼ŒMyBatisï¼ŒSpring MVCï¼ˆSSMï¼‰åšä¸€äº›å¼€å‘ï¼Œæ‰“åŒ…éƒ¨ç½²åˆ°çº¿ä¸Šçš„ tomcatã€‚tomcat å¯åŠ¨ï¼Œæ¥æ”¶ http è¯·æ±‚ï¼Œè½¬å‘ç»™ Spring MVC æ¡†æ¶ã€‚\nå¼€å‘çš„æ—¶å€™è¿˜ä¼šå»æ•´åˆå…¶ä»–çš„ä¸€äº›æ¡†æ¶ï¼ˆRedisã€Elasticsearchã€RabbitMQâ€¦ï¼‰ç­‰ä¸œè¥¿ã€‚ä½¿ç”¨ Spring Boot å¯ä»¥ç®€åŒ–ä¹‹å‰çš„å¼€å‘æµç¨‹ï¼Œä¹‹å‰æ¡†æ¶çš„æ•´åˆæµç¨‹æ¯”è¾ƒç¹çã€‚\nSpring Boot å†…åµŒçš„ web æœåŠ¡å™¨ï¼ˆæ¯”å¦‚ tomcatï¼‰å¯ä»¥ç›´æ¥æŠŠå†™å¥½çš„ä»£ç è¿è¡Œï¼ˆå‡å°‘éƒ¨ç½² tomcatï¼‰ã€‚\nSpring Boot æ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªæ˜¯è‡ªåŠ¨è£…é…ï¼Œå¼•å…¥ stater çš„ä¾èµ–ï¼Œä¼šä¸€å®šç¨‹åº¦ä¸Šè‡ªåŠ¨å®Œæˆç›¸åº”çš„é…ç½®å’Œå®šä¹‰ï¼ˆåŸå…ˆéœ€è¦æ‰‹å·¥é…ç½® xml é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰ä¸€äº› beanï¼Œå†™ sql æ–‡ä»¶â€¦ï¼‰ã€‚\nå†…é“¾ï¼š[[SpringBootå¯åŠ¨æµç¨‹.excalidraw]]\nå¤–é“¾ï¼š\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡","Spring"]},{"title":"é¢è¯•-åå°„ã€GCã€JVMä¼˜åŒ–","url":"/posts/6f2f510a/","content":"\n\nå‰è¨€\nâ—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24-06-14 åˆå§‹è®°å½• è¿™JVMçš„å›¾å±…ç„¶æ˜¯æˆ‘ä»¥å‰ç”»çš„ï¼Œä¸€ç‚¹éƒ½ä¸è®°å¾—äº†ã€‚24-06-16 è¡¥å……JVMï¼Œéƒ¨åˆ†é—®é¢˜æ²¡æœ‰æ·±å…¥ï¼Œéœ€è¦çœ‹æ–°çš„è§†é¢‘ã€‚24-06-18 è¡¥å……å‰©ä¸‹çš„å†…å®¹\n\nç±»åŠ è½½å™¨ä¸åå°„\nç®€è¿° java ç±»åŠ è½½æœºåˆ¶ï¼Ÿ\nè™šæ‹ŸæœºæŠŠæè¿°ç±»çš„æ•°æ®ä» Class æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒï¼Œè§£æå’Œåˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„ java ç±»å‹ã€‚\næè¿°ä¸€ä¸‹ JVM åŠ è½½ Class æ–‡ä»¶çš„åŸç†æœºåˆ¶ï¼Ÿ\nJava ä¸­çš„æ‰€æœ‰ç±»ï¼Œéƒ½éœ€è¦ç”±ç±»åŠ è½½å™¨è£…è½½åˆ° JVM ä¸­æ‰èƒ½è¿è¡Œã€‚ç±»åŠ è½½å™¨æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œè€Œå®ƒçš„å·¥ä½œå°±æ˜¯æŠŠ class æ–‡ä»¶ä»ç¡¬ç›˜è¯»å–åˆ°å†…å­˜ä¸­ã€‚åœ¨å†™ç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å‡ ä¹ä¸éœ€è¦å…³å¿ƒç±»çš„åŠ è½½ï¼Œå› ä¸ºè¿™äº›éƒ½æ˜¯éšå¼è£…è½½çš„ï¼Œé™¤éæˆ‘ä»¬æœ‰ç‰¹æ®Šçš„ç”¨æ³•ï¼Œåƒæ˜¯åå°„ï¼Œå°±éœ€è¦æ˜¾å¼çš„åŠ è½½æ‰€éœ€è¦çš„ç±»ã€‚\nç±»è£…è½½æ–¹å¼ï¼Œæœ‰ä¸¤ç§ ï¼š\n\n\néšå¼è£…è½½ï¼Œ ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å½“ç¢°åˆ°é€šè¿‡ new ç­‰æ–¹å¼ç”Ÿæˆå¯¹è±¡æ—¶ï¼Œéšå¼è°ƒç”¨ç±»è£…è½½å™¨åŠ è½½å¯¹åº”çš„ç±»åˆ° jvm ä¸­\n\n\næ˜¾å¼è£…è½½ï¼Œ é€šè¿‡ class.forname() ç­‰æ–¹æ³•ï¼Œæ˜¾å¼åŠ è½½éœ€è¦çš„ç±»\n\n\nJava ç±»çš„åŠ è½½æ˜¯åŠ¨æ€çš„ï¼Œå®ƒå¹¶ä¸ä¼šä¸€æ¬¡æ€§å°†æ‰€æœ‰ç±»å…¨éƒ¨åŠ è½½åå†è¿è¡Œï¼Œè€Œæ˜¯ä¿è¯ç¨‹åºè¿è¡Œçš„åŸºç¡€ç±» (åƒæ˜¯åŸºç±») å®Œå…¨åŠ è½½åˆ° jvm ä¸­ï¼Œè‡³äºå…¶ä»–ç±»ï¼Œåˆ™åœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ è½½ã€‚è¿™å½“ç„¶å°±æ˜¯ä¸ºäº†èŠ‚çœå†…å­˜å¼€é”€ã€‚\nè¯´ä¸€ä¸‹ç±»è£…è½½çš„æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\nç±»è£…è½½åˆ†ä¸ºä»¥ä¸‹ 5 ä¸ªæ­¥éª¤ï¼š\n\n\nåŠ è½½ï¼šæ ¹æ®æŸ¥æ‰¾è·¯å¾„æ‰¾åˆ°ç›¸åº”çš„ class æ–‡ä»¶ç„¶åå¯¼å…¥ï¼›\n\n\néªŒè¯ï¼šæ£€æŸ¥åŠ è½½çš„ class æ–‡ä»¶çš„æ­£ç¡®æ€§ï¼›\n\n\nå‡†å¤‡ï¼šç»™ç±»ä¸­çš„é™æ€å˜é‡åˆ†é…å†…å­˜ç©ºé—´ï¼›\n\n\nè§£æï¼šè™šæ‹Ÿæœºå°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨æ›¿æ¢æˆç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ç¬¦å·å¼•ç”¨å°±ç†è§£ä¸ºä¸€ä¸ªæ ‡ç¤ºï¼Œè€Œåœ¨ç›´æ¥å¼•ç”¨ç›´æ¥æŒ‡å‘å†…å­˜ä¸­çš„åœ°å€ï¼›\n\n\nåˆå§‹åŒ–ï¼šå¯¹é™æ€å˜é‡å’Œé™æ€ä»£ç å—æ‰§è¡Œåˆå§‹åŒ–å·¥ä½œã€‚\n\n\nä»€ä¹ˆæ˜¯ç±»åŠ è½½å™¨ï¼Œç±»åŠ è½½å™¨æœ‰å“ªäº›?\nå®è§‚æ¥çœ‹åªæœ‰ä¸¤ç§ç±»åŠ è½½å™¨ï¼šå¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆc++ å®ç°ï¼‰å’Œå…¶ä»–æ‰€æœ‰çš„ç±»åŠ è½½å™¨ï¼ˆjava è¯­è¨€ï¼‰ã€‚\nä¸»è¦æœ‰ä¸€ä¸‹å››ç§ç±»åŠ è½½å™¨:\n\n\nå¯åŠ¨ç±»åŠ è½½å™¨ (Bootstrap ClassLoader)ï¼šç”¨æ¥åŠ è½½ java æ ¸å¿ƒç±»åº“ï¼Œæ— æ³•è¢« java ç¨‹åºç›´æ¥å¼•ç”¨ã€‚\n\n\nå¹³å°/æ‰©å±•ç±»åŠ è½½å™¨ (extensions class loader)ï¼šå®ƒç”¨æ¥åŠ è½½ Java çš„æ‰©å±•åº“ã€‚Java è™šæ‹Ÿæœºçš„å®ç°ä¼šæä¾›ä¸€ä¸ªæ‰©å±•åº“ç›®å½•ã€‚è¯¥ç±»åŠ è½½å™¨åœ¨æ­¤ç›®å½•é‡Œé¢æŸ¥æ‰¾å¹¶åŠ è½½ Java ç±»ã€‚ï¼ˆJDK9 ä¹‹åï¼Œæ‰©å±•ç±»åŠ è½½å™¨è¢«é‡å‘½åä¸ºå¹³å°ç±»åŠ è½½å™¨ï¼‰ã€‚\n\n\nç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆsystem class loaderï¼‰ï¼šå®ƒæ ¹æ® Java åº”ç”¨çš„ç±»è·¯å¾„ï¼ˆCLASSPATHï¼‰æ¥åŠ è½½ Java ç±»ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒJava åº”ç”¨çš„ç±»éƒ½æ˜¯ç”±å®ƒæ¥å®ŒæˆåŠ è½½çš„ã€‚å¯ä»¥é€šè¿‡ ClassLoader.getSystemClassLoader() æ¥è·å–å®ƒã€‚\n\n\nç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œé€šè¿‡ç»§æ‰¿ java.lang.ClassLoader ç±»çš„æ–¹å¼å®ç°ã€‚\n\n\nä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\nJAVA åå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸º java è¯­è¨€çš„åå°„æœºåˆ¶ã€‚\nä»€ä¹ˆæ˜¯é™æ€ç¼–è¯‘ï¼Œä»€ä¹ˆæ˜¯åŠ¨æ€ç¼–è¯‘ï¼Ÿ\né™æ€ç¼–è¯‘ï¼šåœ¨ç¼–è¯‘æ—¶ç¡®å®šç±»å‹ï¼Œç»‘å®šå¯¹è±¡\nåŠ¨æ€ç¼–è¯‘ï¼šè¿è¡Œæ—¶ç¡®å®šç±»å‹ï¼Œç»‘å®šå¯¹è±¡\nåå°„æœºåˆ¶çš„ä¼˜ç¼ºç‚¹æœ‰å“ªäº›ï¼Ÿ\nä¼˜ç‚¹ï¼š è¿è¡ŒæœŸç±»å‹çš„åˆ¤æ–­ï¼ŒåŠ¨æ€åŠ è½½ç±»ï¼Œæé«˜ä»£ç çµæ´»åº¦ã€‚\nç¼ºç‚¹ï¼š æ€§èƒ½ç“¶é¢ˆï¼šåå°„ç›¸å½“äºä¸€ç³»åˆ—è§£é‡Šæ“ä½œï¼Œé€šçŸ¥ JVM è¦åšçš„äº‹æƒ…ï¼Œè¿‡ç¨‹æ¯”ç›´æ¥çš„ java ä»£ç è¦å¤šäº†ä¸€æ­¥å§”æ‰˜çš„è¿‡ç¨‹ï¼Œåå°„éœ€è¦ç±»åŠ è½½å™¨é€šè¿‡åŒäº²å§”æ´¾æ¨¡å‹å®ç°åŠ¨æ€ç¼–è¯‘ï¼Œæ•ˆç‡è¾ƒä½ã€‚\nä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æœºåˆ¶ï¼Ÿ\né¦–å…ˆï¼ŒJVM ä¸­æœ‰ä¸‰å¤§ç±»åŠ è½½å™¨ï¼šå¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆæœ€é¡¶å±‚ï¼‰ï¼Œå¹³å°ç±»åŠ è½½å™¨ï¼ˆä¸­å±‚ï¼‰ï¼Œç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆä¸‹å±‚ï¼‰ã€‚\nåŒäº²å§”æ´¾æ¨¡å‹å°±æ˜¯æŒ‡ä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒä¸ä¼šç›´æ¥è‡ªå·±å…ˆåŠ è½½ï¼Œè€ŒæŠŠè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨å»æ‰§è¡Œï¼Œå¦‚æœçˆ¶ç±»åŠ è½½å™¨è¿˜å­˜åœ¨å…¶çˆ¶ç±»åŠ è½½å™¨ï¼Œå°±å†å¾€ä¸Šå§”æ‰˜ï¼Œèµ´åˆ°æœ€é¡¶å±‚çš„ç±»åŠ è½½å™¨ï¼Œå¦‚æœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥å®Œæˆç±»åŠ è½½ä»»åŠ¡ï¼Œå°±æˆåŠŸè¿”å›ï¼Œè‹¥ä¸èƒ½ï¼Œå°±å‘ä¸‹ä¼ é€’ï¼Œè®©å­åŠ è½½å™¨å»åŠ è½½ï¼Œè¿™å°±æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ã€‚\nåŒäº²å§”æ´¾æ¨¡å‹ä¸»è¦æ˜¯ç”¨æ¥ä¿è¯åŒä¸€ä¸ªç±»åªèƒ½è¢«ä¸€ä¸ªç±»åŠ è½½å™¨åŠ è½½ã€‚\næ€ä¹ˆç ´ååŒäº²å§”æ´¾æœºåˆ¶ï¼Ÿ\nä¸€èˆ¬åœ¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¸­ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›é€šè¿‡åŒäº²å§”æ´¾æœºåˆ¶ä¸€å±‚å±‚å‘ä¸Šå†ä¸‹æ¥ï¼Œè€Œæ˜¯å¸Œæœ›ç›´æ¥é€šè¿‡è‡ªå·±å®šä¹‰çš„ç±»åŠ è½½å™¨ç›´æ¥å®ç°ç±»åŠ è½½ï¼Œæ¥æå‡åŠ è½½æ€§èƒ½ï¼Œæ¯”å¦‚ Tomcat ä¸­çš„ web å®¹å™¨ç±»åŠ è½½å™¨å°±æ˜¯ç ´åäº†åŒäº²å§”æ‰˜æ¨¡å¼çš„ï¼Œé‡Œé¢çš„ WebApplicationClassLoader é™¤äº†æ ¸å¿ƒç±»åº“å¤–ï¼Œéƒ½æ˜¯ä¼˜å…ˆåŠ è½½è‡ªå·±è·¯å¾„ä¸‹çš„ Classã€‚\nè¦æ‰“ç ´åŒäº²å§”æ´¾æœºåˆ¶ï¼Œåªè¦åœ¨é‡å†™ loadclass çš„è¿‡ç¨‹ä¸­ï¼Œä¸éµä» JVM è§„èŒƒå°±è¡Œäº†ï¼Œä¹Ÿå°±æ˜¯ä¸ç›²ç›®ä¼˜å…ˆå‘ Parednt çš„ ClassLoader æŸ¥æ‰¾å³å¯ã€‚\nä½ åœ¨å“ªäº›åœºæ™¯ä¸‹ç”¨è¿‡åå°„ï¼Ÿ\nåå°„åœ¨æ¡†æ¶ä¸­æœ‰é¢‘ç¹çš„è¢«ä½¿ç”¨ï¼Œæ¯”å¦‚ JDK åŠ¨æ€ä»£ç†ï¼ŒSpring ä¸­çš„æ³¨å…¥å±æ€§ï¼Œè°ƒç”¨æ–¹æ³•ç­‰ã€‚\nåå°„æ›´å¤šæ˜¯ä¸ºäº†çµæ´»èˆå¼ƒä¸€éƒ¨åˆ†æ€§èƒ½ï¼Œè‡ªå·±ä½¿ç”¨ä¸€èˆ¬ç”¨åœ¨å·¥å…·ç±»ä¸­ï¼Œæ¯”å¦‚é¢‘ç¹é€šè¿‡å‚æ•°åæ¥è°ƒç”¨æŒ‡å®šçš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥ç”¨é€šè¿‡åå°„å»åŒ¹é…æŒ‡å®šçš„æ–¹æ³•åï¼Œç„¶åå®ç°åŠŸèƒ½ã€‚\nJava ä¸­è·å–åå°„çš„ä¸‰ç§æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\n\n\nç±»å.class å±æ€§\n\n\nå¯¹è±¡å.getClass() æ–¹æ³•\n\n\nClass.forName(å…¨ç±»å) æ–¹æ³•\n\n\nåå°„å¯ä»¥è·å–ç§æœ‰æ–¹æ³•æˆ–æ„é€ å‡½æ•°å—æˆ–ç§æœ‰æˆå‘˜å˜é‡å—ï¼Ÿ\nå¯ä»¥ã€‚æœ‰ä¸“é—¨åå°„ç§æœ‰æ„é€ å‡½æ•°çš„æ–¹æ³• clazz.getDeclaredConstructor(int.class); æ¥è¯»å–ç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œç§æœ‰æˆå‘˜å˜é‡å’Œç§æœ‰æ–¹æ³•ä¹Ÿä¸€æ ·ï¼Œä½†ç”¨è¿™ä¸ªæ–¹æ³•è¯»å–å®Œè¿˜éœ€è¦è®¾ç½®ä¸€ä¸‹æš´åŠ›åå°„æ‰è¡Œï¼šc.setAccessible(true)ã€‚\nJVM\nå†…é“¾ï¼š[[JVM.excalidraw]]\nå¤–é“¾ï¼š\nJVM åŒ…å«ä¸¤ä¸ªå­ç³»ç»Ÿå’Œä¸¤ä¸ªç»„ä»¶ï¼Œä¸¤ä¸ªå­ç³»ç»Ÿä¸º Class loader(ç±»è£…è½½)ã€Execution engine(æ‰§è¡Œå¼•æ“)ï¼›ä¸¤ä¸ªç»„ä»¶ä¸º Runtime data area(è¿è¡Œæ—¶æ•°æ®åŒº)ã€Native Interface(æœ¬åœ°æ¥å£)ã€‚\nClass loader(ç±»è£…è½½)ï¼šæ ¹æ®ç»™å®šçš„å…¨é™å®šåç±»å (å¦‚ï¼šjava.lang.Object) æ¥è£…è½½ class æ–‡ä»¶åˆ° Runtime data area ä¸­çš„ method areaã€‚\nExecution engine(æ‰§è¡Œå¼•æ“)ï¼šæ‰§è¡Œ classes ä¸­çš„æŒ‡ä»¤ã€‚\nNative Interface(æœ¬åœ°æ¥å£)ï¼šä¸ native libraries äº¤äº’ï¼Œæ˜¯å…¶å®ƒç¼–ç¨‹è¯­è¨€äº¤äº’çš„æ¥å£ã€‚\nRuntime data area(è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ)ï¼šè¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ JVM çš„å†…å­˜ã€‚\né¡ºåº ï¼š\n\n\né¦–å…ˆé€šè¿‡ç¼–è¯‘å™¨æŠŠ Java ä»£ç è½¬æ¢æˆå­—èŠ‚ç ï¼Œç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰å†æŠŠå­—èŠ‚ç åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå°†å…¶æ”¾åœ¨è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆRuntime data areaï¼‰çš„æ–¹æ³•åŒºå†…ã€‚\n\n\nè€Œå­—èŠ‚ç æ–‡ä»¶åªæ˜¯ JVM çš„ä¸€å¥—æŒ‡ä»¤é›†è§„èŒƒï¼Œå¹¶ä¸èƒ½ç›´æ¥äº¤ç»™åº•å±‚æ“ä½œç³»ç»Ÿå»æ‰§è¡Œï¼Œå› æ­¤éœ€è¦ç‰¹å®šçš„å‘½ä»¤è§£æå™¨æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰ï¼Œå°†å­—èŠ‚ç ç¿»è¯‘æˆåº•å±‚ç³»ç»ŸæŒ‡ä»¤ã€‚\n\n\nå†äº¤ç”± CPU å»æ‰§è¡Œï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦è°ƒç”¨å…¶ä»–è¯­è¨€çš„æœ¬åœ°åº“æ¥å£ï¼ˆNative Interfaceï¼‰æ¥å®ç°æ•´ä¸ªç¨‹åºçš„åŠŸèƒ½ã€‚\n\n\nâ—JVM ä¸­æœ‰å“ªå‡ å—å†…å­˜åŒºåŸŸï¼ŸJava 8 ä¹‹åå¯¹å†…å­˜åˆ†ä»£åšäº†ä»€ä¹ˆæ”¹è¿›ï¼Ÿ\n\né¦–å…ˆï¼šä¸€èˆ¬æ¥è¯´ï¼šSpring boot ä¼šå†…ç½®ä¸€ä¸ª tomcatï¼Œtomcat è‡ªå·±æ˜¯åŸºäº java æ¥å¼€å‘çš„ã€‚æˆ‘ä»¬å¯åŠ¨çš„å…¶å®æ˜¯ tomcatï¼ˆä¸€ä¸ª JVM è¿›ç¨‹ï¼‰ï¼Œæˆ‘ä»¬å†™çš„ä»£ç ï¼Œä¼šè¢« tomcat åŠ è½½åˆ° JVM ä¸­ã€‚\ntomcat å»è´Ÿè´£æ¥æ”¶è¯·æ±‚ï¼Œæ‰§è¡Œæˆ‘ä»¬å†™å¥½çš„ä»£ç ï¼ˆåŸºäº Spring æ¡†æ¶çš„ä¸€å †ä»£ç ï¼‰\n\n\n\nç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ï¼šå½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œä¸ªäººæ„Ÿè§‰çš„ä»–å°±æ˜¯ä¸ºå¤šçº¿ç¨‹å‡†å¤‡çš„ï¼Œç¨‹åºè®¡æ•°å™¨æ˜¯æ¯ä¸ªçº¿ç¨‹ç‹¬æœ‰çš„ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å®ƒä¸»è¦ç”¨äºè®°å½•æ¯ä¸ªçº¿ç¨‹çš„æ‰§è¡Œæƒ…å†µã€‚\n\n\nJava è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰ï¼šçº¿ç¨‹ç§æœ‰ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚\n\n\næœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰ï¼šçº¿ç¨‹ç§æœ‰ï¼Œä¸è™šæ‹Ÿæœºæ ˆçš„ä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡è™šæ‹Ÿæœºæ ˆæ˜¯æœåŠ¡ Java æ–¹æ³•çš„ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆæ˜¯ä¸ºè™šæ‹Ÿæœºè°ƒç”¨ Native æ–¹æ³•æœåŠ¡çš„ï¼ˆNative æ–¹æ³•æ˜¯ JVM åº•å±‚çš„ C è¯­è¨€å¯¹å…¶å®ƒç³»ç»Ÿæˆ–ç¡¬ä»¶è¿›è¡Œäº¤äº’ï¼‰ã€‚\n\n\nJava å †ï¼ˆJava Heapï¼‰ï¼šJava è™šæ‹Ÿæœºä¸­å†…å­˜æœ€å¤§çš„ä¸€å—ï¼Œæ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ï¼›Java å †ä¹Ÿå« GC å †ï¼Œæ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå †ä¸­å¯ä»¥ç»†åˆ†ä¸ºï¼šæ–°ç”Ÿä»£ã€è€å¹´ä»£ï¼›å†ç»†è‡´ä¸€ç‚¹ï¼Œæ–°ç”Ÿä»£ä¸­åˆåˆ†ä¸ºï¼šEden Space(ä¼Šç”¸å›­)ã€Survivor ç©ºé—´ï¼ŒSurvivor ç©ºé—´åˆåˆ†ä¸º From åŒºå’Œ to åŒºã€‚\n\n\næ–¹æ³•åŒºï¼ˆMethed Areaï¼‰ï¼š1.8 ä¹‹åæ–¹æ³•åŒºç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚\n\n\n\n\næ–¹æ³•åŒºè¡¥å……ç‚¹ï¼š\n\nåœ¨ JDK1.7 ä»¥å‰ HotSpot è™šæ‹Ÿæœºä½¿ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºï¼Œæ°¸ä¹…ä»£çš„å¤§å°åœ¨å¯åŠ¨ JVM æ—¶å¯ä»¥è®¾ç½®ä¸€ä¸ªå›ºå®šå€¼ï¼ˆ-XX:MaxPermSizeï¼‰ï¼Œä¸å¯å˜ã€‚\nåœ¨ JDK1.7 ä¸­Â å­˜å‚¨åœ¨æ°¸ä¹…ä»£çš„éƒ¨åˆ†æ•°æ®å°±å·²ç»è½¬ç§»åˆ° Java Heapï¼ˆå †ï¼‰æˆ–è€… Native memoryã€‚è­¬å¦‚ç¬¦å·å¼•ç”¨ (Symbols) è½¬ç§»åˆ°äº† native memoryï¼ŒåŸæœ¬å­˜æ”¾åœ¨æ°¸ä¹…ä»£çš„å­—ç¬¦å¸¸é‡æ± ç§»å‡ºã€‚ä½†æ°¸ä¹…ä»£ä»å­˜åœ¨äº JDK 1.7 ä¸­ï¼Œå¹¶æ²¡æœ‰å®Œå…¨ç§»é™¤ã€‚\nJDK1.8 ä¸­è¿›è¡Œäº†è¾ƒå¤§æ”¹åŠ¨ï¼š\n\nç§»é™¤äº†æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰ï¼Œæ›¿æ¢ä¸ºå…ƒç©ºé—´ï¼ˆMetaspaceï¼‰ï¼›\næ°¸ä¹…ä»£ä¸­çš„ class metadata è½¬ç§»åˆ°äº† native memoryï¼ˆæœ¬åœ°å†…å­˜ï¼Œè€Œä¸æ˜¯è™šæ‹Ÿæœºï¼‰ï¼›\næ°¸ä¹…ä»£ä¸­çš„ interned Strings å’Œ class static variables è½¬ç§»åˆ°äº† Java heapï¼ˆå †ï¼‰ï¼›\næ°¸ä¹…ä»£å‚æ•° ï¼ˆPermSize MaxPermSizeï¼‰ -&gt; å…ƒç©ºé—´å‚æ•°ï¼ˆMetaspaceSize MaxMetaspaceSizeï¼‰\n\n\n\n\n\næ°¸ä¹…ä»£ï¼ˆå…ƒç©ºé—´ï¼‰\n\nåœ¨ Java8 ä¸­ï¼Œæ°¸ä¹…ä»£å·²ç»è¢«ç§»é™¤ï¼Œè¢«ä¸€ä¸ªç§°ä¸ºâ€œå…ƒæ•°æ®åŒºâ€ï¼ˆå…ƒç©ºé—´ï¼ŒMetaspaceï¼‰çš„åŒºåŸŸæ‰€å–ä»£ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼ˆä¹‹å‰ï¼Œæ°¸ä¹…ä»£æ˜¯åœ¨ jvm ä¸­ï¼‰ã€‚\nè¿™æ ·ï¼Œè§£å†³äº†ä»¥å‰æ°¸ä¹…ä»£çš„ OOM é—®é¢˜ï¼Œå…ƒæ•°æ®å’Œ class å¯¹è±¡å­˜åœ¨æ°¸ä¹…ä»£ä¸­ï¼Œå®¹æ˜“å‡ºç°æ€§èƒ½é—®é¢˜å’Œå†…å­˜æº¢å‡ºï¼Œæ¯•ç«Ÿæ˜¯å’Œè€å¹´ä»£å…±äº«å †ç©ºé—´ã€‚java8 åï¼Œæ°¸ä¹…ä»£å‡çº§ä¸ºå…ƒç©ºé—´ç‹¬ç«‹åï¼Œä¹Ÿé™ä½äº†è€å¹´ä»£ GC çš„å¤æ‚åº¦ã€‚\n\n\n\nâ”ä½ çŸ¥é“ JVM æ˜¯å¦‚ä½•è¿è¡Œèµ·æ¥çš„å—ï¼Ÿæˆ‘ä»¬çš„å¯¹è±¡æ˜¯å¦‚ä½•åˆ†é…çš„\n\nå¤§ç™½è¯ï¼šæ¯”å¦‚è¯´æˆ‘ä»¬æœ‰ä¸€ä¸ªç±»é‡Œé¢åŒ…å«äº† main æ–¹æ³•ï¼Œä½ å»æ‰§è¡Œè¿™ä¸ª main æ–¹æ³•ï¼Œæ­¤æ—¶ä¼šå¯åŠ¨ä¸€ä¸ª JVM çš„è¿›ç¨‹ã€‚é»˜è®¤ä¼šæœ‰ä¸€ä¸ª main çº¿ç¨‹ï¼Œè¿™ä¸ª main çº¿ç¨‹å°±è´Ÿè´£æ‰§è¡Œè¿™ä¸ª main æ–¹æ³•çš„ä»£ç ï¼Œè¿›è€Œåˆ›å»ºå„ç§å¯¹è±¡ã€‚\ntomcat ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œç±»åŠ è½½åˆ° JVM é‡Œé¢ï¼ŒSpring å°†æˆ‘ä»¬çš„ç±»å®ä¾‹åŒ–æˆå„ç§ Bean å®¹å™¨ã€‚ä¼šæœ‰å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œæˆ‘ä»¬ bean å®ä¾‹å¯¹è±¡é‡Œçš„æ–¹æ³•å’Œä»£ç ï¼Œè¿›è€Œä¹Ÿä¼šåˆ›å»ºå…¶ä»–çš„å„ç§å¯¹è±¡ï¼Œå®ç°ä¸šåŠ¡é€»è¾‘ã€‚\n\nä¾‹å­ï¼šSpring å®¹å™¨ä¸­çš„ JVMã€‚\n\n\nç±»åŠ è½½å™¨æŠŠæˆ‘ä»¬å†™çš„ç±»åŠ è½½åˆ°å…ƒç©ºé—´\n\n\nSpring å®¹å™¨é€šè¿‡åå°„æŠ€æœ¯ï¼Œè·å–å…ƒç©ºé—´ä¸­çš„ç±»ï¼Œåˆ›å»º bean å®ä¾‹å¯¹è±¡å¯¹è±¡å­˜å…¥å †å†…å­˜ã€‚\n\n\ntomcat çº¿ç¨‹æ‰§è¡Œè¯·æ±‚ä¼šåœ¨æ ˆå†…å­˜é€šè¿‡æ ˆå¸§å­˜æ”¾å±€éƒ¨å˜é‡ï¼Œå¼•ç”¨å †å†…å­˜ä¸­çš„å®ä¾‹å˜é‡\n\n\nâ—JVM åœ¨å“ªäº›æƒ…å†µä¸‹ä¼šè§¦å‘åƒåœ¾å›æ”¶\n\nåœ¨ JVM å†…å­˜é‡Œå¿…ç„¶æœ‰ä¸€ä¸ªå†…å­˜çš„åˆ†ä»£æ¨¡å‹ã€‚æ¯”å¦‚è¯´ä¸€ä¸ª 4 æ ¸ 8G çš„æœºå™¨ï¼Œå †å†…å­˜å¯èƒ½ä¹Ÿå°± 4G å·¦å³ï¼ˆå…¶ä»–ä¾‹å¦‚æ ˆå†…å­˜ã€å…ƒç©ºé—´åŒºåŸŸå­˜æ”¾ç±»ä¿¡æ¯ä¹Ÿéœ€è¦ç©ºé—´ï¼‰ã€‚\nå †å†…å­˜å†…éƒ¨å†åˆ†ï¼Œæ¯”å¦‚ç»™å¹´è½»ä»£ 2GBã€ç»™è€å¹´ä»£ 2GBï¼Œé»˜è®¤æƒ…å†µä¸‹ Eden å’Œ s1ã€s2 çš„æ¯”ä¾‹æ˜¯ï¼š8:1:1ã€‚\n\nå¦‚æœ Eden æ»¡äº†ï¼Œå¿…ç„¶ä¼šè§¦å‘åƒåœ¾å›æ”¶ï¼ˆyoung GCï¼‰ã€‚å›æ”¶çš„å¯¹è±¡å°±æ˜¯æ²¡æœ‰äººå¼•ç”¨çš„å¯¹è±¡ï¼šæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å±€éƒ¨å˜é‡å¼•ç”¨å¯¹è±¡ã€ç±»ä¸­çš„é™æ€å˜é‡å¼•ç”¨çš„å¯¹è±¡è¿™ä¸¤ç±»å¯¹è±¡ä¸ä¼šè¢«å›æ”¶ï¼Œå…¶ä»–å¯¹è±¡åŸºæœ¬ä¸Šéƒ½å¯ä»¥è¢«å›æ”¶ã€‚\nä»€ä¹ˆæ˜¯ Full GCï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹ä¼šè§¦å‘ï¼Ÿ\nFull GC æ˜¯æŒ‡æ¸…ç†æ•´ä¸ªå †ç©ºé—´â€”â€”åŒ…æ‹¬å¹´è½»ä»£å’Œè€å¹´ä»£ã€‚\nä»€ä¹ˆæ—¶å€™è§¦å‘ï¼š\n\n\nè°ƒç”¨ System.gc\n\n\næ–¹æ³•åŒºç©ºé—´ä¸è¶³\n\n\nè€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ŒåŒ…æ‹¬ï¼š\n\næ–°åˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šè¢«åˆ†é…åˆ° Eden åŒºï¼Œå¦‚æœè¯¥å¯¹è±¡å ç”¨å†…å­˜éå¸¸å¤§ï¼Œåˆ™ç›´æ¥åˆ†é…åˆ°è€å¹´ä»£åŒºï¼Œæ­¤æ—¶è€å¹´ä»£ç©ºé—´ä¸è¶³ã€‚\nåš minor gc æ“ä½œå‰ï¼Œå‘ç°è¦ç§»åŠ¨çš„ç©ºé—´ï¼ˆEden åŒºã€From åŒºå‘ To åŒºå¤åˆ¶æ—¶ï¼ŒTo åŒºçš„å†…å­˜ç©ºé—´ä¸è¶³ï¼‰æ¯”è€å¹´ä»£å‰©ä½™ç©ºé—´è¦å¤§ï¼Œåˆ™è§¦å‘ full gcï¼Œè€Œä¸æ˜¯ minor gcã€‚\n\n\n\nâ—JVM å¹´è½»ä»£çš„å›æ”¶ç®—æ³•\n\nåƒåœ¾å›æ”¶çš„æ—¶å€™æœ‰ä¸€ä¸ªæ¦‚å¿µï¼šstop the worldã€‚åœæ­¢ jvm å†…çš„å·¥ä½œçº¿ç¨‹çš„è¿è¡Œï¼Œç„¶åæ‰«ææ‰€æœ‰çš„å¯¹è±¡ï¼Œåˆ¤æ–­å“ªäº›å¯ä»¥å›æ”¶ï¼Œå“ªäº›ä¸å¯ä»¥å›æ”¶ã€‚\nå¹´è½»ä»£å†…å¤§éƒ¨åˆ†éƒ½æ˜¯åƒåœ¾å¯¹è±¡ã€‚\n\nåƒåœ¾å›æ”¶ï¼šå¤åˆ¶ç®—æ³•ã€‚\n\n\næŠŠå¹´è½»ä»£å†…çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ° s1ï¼Œè§¦å‘ young GC æŠŠ Eden æ¸…ç©ºã€‚\n\n\nç¬¬äºŒæ¬¡æ»¡ï¼ŒæŠŠå¹´è½»ä»£å†…çš„å­˜æ´»å¯¹è±¡å’Œ s1 å†…å­˜æ´»çš„å¯¹è±¡ï¼Œå¤åˆ¶åˆ° s2ã€‚ç„¶åæŠŠ Eden å’Œ s1 æ¸…ç©º\n\n\nEden åˆæ»¡ï¼ŒæŠŠå¹´è½»ä»£å†…çš„å­˜æ´»å¯¹è±¡å’Œ s2 å†…å­˜æ´»çš„å¯¹è±¡ï¼Œå¤åˆ¶åˆ° s1ã€‚ç„¶åæŠŠ Eden å’Œ s2 æ¸…ç©º\n\n\nâ—å¯¹è±¡ä»€ä¹ˆæ—¶å€™ä¼šè½¬ç§»åˆ°è€å¹´ä»£ä¸­\n\n\næœ‰çš„å¯¹è±¡åœ¨å¹´è½»ä»£é‡Œç†¬è¿‡äº†å¾ˆå¤šæ¬¡åƒåœ¾å›æ”¶ï¼ˆé»˜è®¤æ˜¯ 15 æ¬¡ï¼Œå¯ä»¥è®¾ç½®ï¼‰ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯é•¿æœŸå­˜æ´»çš„å¯¹è±¡ï¼Œä¼šä»å¹´è½»ä»£è½¬ç§»åˆ°è€å¹´ä»£ã€‚ï¼ˆä¾‹å¦‚ï¼šSpring å®¹å™¨å†…çš„ä¸€äº› Bean å¯¹è±¡ï¼‰\n\n\nEden åƒåœ¾å›æ”¶æ—¶ï¼Œå‘ç°å­˜æ´»å¯¹è±¡çš„å¤§å°ï¼Œæ¯” Suivivor åŒºè¿˜è¦å¤§ï¼Œå°±ä¼šç›´æ¥æ”¾å…¥è€å¹´ä»£ã€‚\n\n\nå¾ˆå¤§çš„å¯¹è±¡ï¼Œä¼šç›´æ¥å­˜å…¥è€å¹´ä»£ã€‚\n\n\nâ—JVM è€å¹´ä»£çš„å›æ”¶ç®—æ³•\n\nè€å¹´ä»£å†…çš„å¯¹è±¡ï¼Œå¾ˆå¤šéƒ½æ˜¯é•¿æœŸè¢«å¼•ç”¨çš„ï¼Œä¸èƒ½ç”¨å¤åˆ¶ç®—æ³•ï¼Œæ•ˆç‡æ¯”è¾ƒä½ã€‚\n\nè€å¹´ä»£ä½¿ç”¨çš„ç®—æ³•æ˜¯æ ‡è®°æ¸…é™¤ï¼ˆå›æ”¶ï¼‰ç®—æ³•æˆ–è€…æ ‡è®°å‹ç¼©ç®—æ³•ã€‚\næ ‡è®°æ¸…é™¤ï¼ˆå›æ”¶ï¼‰ï¼š\n\n\né¦–å…ˆä¼šä» GC root è¿›è¡Œéå†ï¼ŒæŠŠå¯è¾¾å¯¹è±¡ï¼ˆå­˜è¿‡çš„å¯¹è±¡ï¼‰æ‰“æ ‡è®°\n\n\nå†ä» GC root äºŒæ¬¡éå†ï¼Œå°†æ²¡æœ‰è¢«æ‰“ä¸Šæ ‡è®°çš„å¯¹è±¡æ¸…é™¤æ‰ã€‚ä¼˜ç‚¹ï¼šè€å¹´ä»£å¯¹è±¡ä¸€èˆ¬æ˜¯æ¯”è¾ƒç¨³å®šçš„ï¼Œç›¸æ¯”å¤åˆ¶ç®—æ³•ï¼Œä¸éœ€è¦å¤åˆ¶å¤§é‡å¯¹è±¡ã€‚ä¹‹æ‰€ä»¥å°†æ‰€æœ‰å¯¹è±¡æ‰«æ 2 æ¬¡ï¼Œçœ‹ä¼¼æ¯”è¾ƒæ¶ˆè€—æ—¶é—´ï¼Œå…¶å®ä¸ç„¶ï¼Œæ˜¯èŠ‚çœäº†æ—¶é—´ã€‚ä¸¾ä¸ªæ —å­ï¼Œæ•°ç»„ 1,2,3,4,5,6ã€‚åˆ é™¤ 2,3,4ï¼Œå¦‚æœæ¯æ¬¡åˆ é™¤ä¸€ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆ 5,6 è¦ç§»åŠ¨ 3 æ¬¡ï¼Œå¦‚æœåˆ é™¤ 1 æ¬¡ï¼Œé‚£ä¹ˆ 5,6 åªéœ€ç§»åŠ¨ 1 æ¬¡ã€‚\n\n\nç¼ºç‚¹ï¼šè¿™ç§æ–¹å¼éœ€è¦ä¸­æ–­å…¶ä»–çº¿ç¨‹ï¼ˆSTWï¼‰ï¼Œç›¸æ¯”å¤åˆ¶ç®—æ³•ï¼Œå¯èƒ½äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚\næ ‡è®°å‹ç¼©ï¼šå’Œæ ‡è®°æ¸…é™¤ç®—æ³•åŸºæœ¬ç›¸åŒï¼Œä¸åŒçš„å°±æ˜¯ï¼Œåœ¨æ¸…é™¤å®Œæˆä¹‹åï¼Œä¼šæŠŠå­˜æ´»çš„å¯¹è±¡å‘å†…å­˜çš„ä¸€è¾¹è¿›è¡Œå‹ç¼©ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³å†…å­˜ç¢ç‰‡é—®é¢˜ã€‚\nå½“è€å¹´ä»£ä¹Ÿæ»¡äº†è£…ä¸ä¸‹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º OOMï¼ˆOut of Memoryï¼‰å¼‚å¸¸ã€‚\næ€ä¹ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯ä»¥è¢«å›æ”¶ï¼Ÿ\nåƒåœ¾æ”¶é›†å™¨åœ¨åšåƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œé¦–å…ˆéœ€è¦åˆ¤å®šçš„å°±æ˜¯å“ªäº›å†…å­˜æ˜¯éœ€è¦è¢«å›æ”¶çš„ï¼Œå“ªäº›å¯¹è±¡æ˜¯ã€Œå­˜æ´»ã€çš„ï¼Œæ˜¯ä¸å¯ä»¥è¢«å›æ”¶çš„ï¼›å“ªäº›å¯¹è±¡å·²ç»ã€Œæ­»æ‰ã€äº†ï¼Œéœ€è¦è¢«å›æ”¶ã€‚\nä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•æ¥åˆ¤æ–­ï¼š\n\n\nå¼•ç”¨è®¡æ•°å™¨æ³•ï¼šä¸ºæ¯ä¸ªå¯¹è±¡åˆ›å»ºä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œæœ‰å¯¹è±¡å¼•ç”¨æ—¶è®¡æ•°å™¨ +1ï¼Œå¼•ç”¨è¢«é‡Šæ”¾æ—¶è®¡æ•° -1ï¼Œå½“è®¡æ•°å™¨ä¸º 0 æ—¶å°±å¯ä»¥è¢«å›æ”¶ã€‚å®ƒæœ‰ä¸€ä¸ªç¼ºç‚¹ä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼›\n\n\nå¯è¾¾æ€§åˆ†æç®—æ³•ï¼šä» GC Roots å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ã€‚å½“ä¸€ä¸ªå¯¹è±¡åˆ° GC Roots æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯å¯ä»¥è¢«å›æ”¶çš„ã€‚\n\n\nâ—å¸¸ç”¨çš„åƒåœ¾å›æ”¶å™¨\n\n\nparnew+cms çš„ç»„åˆï¼ˆjdk8 ä»¥åŠ 8 ä»¥å‰ï¼‰\nparnew æ˜¯æ–°ç”Ÿä»£å›æ”¶å™¨ï¼Œå¤šçº¿ç¨‹ã€‚cms æ˜¯è€å¹´ä»£åƒåœ¾å›æ”¶ï¼ˆæ¯”è¾ƒæ…¢ï¼Œä¸€èˆ¬æ¯”å¹´è½»ä»£æ…¢ 10 å€ä»¥ä¸Šï¼‰ï¼Œcms çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Œåˆšå¼€å§‹ç”¨æ ‡è®°æ¸…ç†ï¼Œç„¶åæ•´ç†ã€‚ä¼šäº§ç”Ÿå‡ ä¸ªé˜¶æ®µï¼Œå°½å¯èƒ½å¹¶å‘è¿›è¡Œ\n\n\nG1(Garbage First)ï¼ˆä» jdk9 å¾€åä¸»æ¨ï¼‰å›æ”¶æ•´ä¸ªå †ã€‚\n\n\nâ—ç”Ÿäº§ç¯å¢ƒä¸­çš„ Tomcat å¦‚ä½•è®¾ç½® JVM å‚æ•°ã€‚å¦‚ä½•æ£€æŸ¥ JVM è¿è¡Œæƒ…å†µ\n\nJava Web ç³»ç»Ÿï¼Œåœ¨ tomcat çš„ä¸€ä¸ªé…ç½®è„šæœ¬ï¼Œcatalina è„šæœ¬é‡Œæ‰¾ä¸€ä¸‹ã€‚\n\næ ¸å¿ƒäº†è§£ç‚¹ï¼š\n\n\nå†…å­˜åŒºåŸŸå¤§å°çš„åˆ†é…ï¼Œæ¯ä¸ªçº¿ç¨‹çš„æ ˆå¤§å°ï¼Œmetaspace å¤§å°ï¼Œå †å†…å­˜çš„å¤§å°ï¼Œå¹´è½»ä»£å’Œè€å¹´ä»£åˆ†åˆ«çš„å¤§å°ï¼Œeden å’Œ survivor åŒºåŸŸçš„å¤§å°ã€‚ï¼ˆæ²¡æœ‰è®¾ç½®ï¼Œä¼šæœ‰é»˜è®¤å€¼ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡ŒæŸ¥çœ‹ï¼‰\n\n\nåƒåœ¾å›æ”¶å™¨ç”¨äº†ä»€ä¹ˆï¼Œæ¯ç§åƒåœ¾å›æ”¶å™¨æ˜¯å¦æœ‰å¯¹åº”çš„ä¸€äº›ç‰¹æ®Šçš„å‚æ•°è®¾ç½®ï¼Œé‚£äº›ç‰¹æ®Šçš„å‚æ•°åˆ†åˆ«ç”¨æ¥å¹²ä»€ä¹ˆçš„ã€‚\n\n\nâ—ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾ç½®ï¼Ÿå½“å‰ç³»ç»Ÿè¿è¡Œçš„æ—¶å€™ï¼Œjvm çš„è¡¨ç°å¦‚ä½•ï¼Ÿ\n// todo é¢ï¼Œè¿™éƒ¨åˆ†éƒ½åœ¨æ‰“å¹¿å‘Šï¼Œæ‰“ç®—çœ‹äº†å¦ä¸€ä¸ªè§†é¢‘å†è¡¥å……ã€‚\nâ—å®é™…é¡¹ç›®ä¸­æ˜¯å¦åšè¿‡ JVM GC ä¼˜åŒ–ï¼Œæ€ä¹ˆåšçš„ï¼Ÿ\n\næ²¡åšè¿‡ï¼Œç›´æ¥å•æœºå‹æµ‹ï¼Œç„¶åè°ƒä¼˜ã€‚\n\n// todo\nâ—å‘ç”Ÿ OOM ä¹‹åï¼Œåº”è¯¥å¦‚ä½•æ’æŸ¥å’Œå¤„ç†çº¿ä¸Šç³»ç»Ÿçš„ OOM é—®é¢˜ï¼Ÿ\nè§£å†³çš„ä¸€ä¸ªæ€è·¯ï¼šåœ¨ JVM é‡Œå¯ä»¥è®¾ç½®å‡ ä¸ªå‚æ•°ï¼Œå¦‚æœä¸€æ—¦ JVM å‘ç”Ÿäº† OOM ä¹‹åï¼Œå°±ä¼šå¯¼å‡ºä¸€ä»½å†…å­˜çš„å¿«ç…§ã€‚å¯ä»¥ç”¨ç±»ä¼¼ MAT è¿™æ ·çš„å·¥å…·å»åˆ†æï¼ˆæ‰¾å‡ºå½“æ—¶çš„å†…å­˜å ç”¨æœ€å¤§çš„å¯¹è±¡æ˜¯è°ï¼Œæ‰¾å‡ºé‚£äº›å¯¹è±¡æ˜¯åœ¨å“ªäº›åœ°æ–¹åˆ›å»ºå‡ºæ¥çš„ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯å¯¹å†…å­˜å»åšä¸€ä¸ªè°ƒä¼˜ï¼‰ã€‚\n// todo è¿™é‡Œè¦ç»“åˆä¸šåŠ¡å»æ€è€ƒï¼Œç»“åˆé¡¹ç›®ï¼ˆæ¨¡æ‹Ÿï¼‰\nJava ä¼šå­˜åœ¨å†…å­˜æ³„æ¼å—ï¼Ÿè¯·ç®€å•æè¿°\nå†…å­˜æ³„æ¼æ˜¯æŒ‡ä¸å†è¢«ä½¿ç”¨çš„å¯¹è±¡æˆ–è€…å˜é‡ä¸€ç›´è¢«å æ®åœ¨å†…å­˜ä¸­ã€‚ç†è®ºä¸Šæ¥è¯´ï¼ŒJava æ˜¯æœ‰ GC åƒåœ¾å›æ”¶æœºåˆ¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å†è¢«ä½¿ç”¨çš„å¯¹è±¡ï¼Œä¼šè¢« GC è‡ªåŠ¨å›æ”¶æ‰ï¼Œè‡ªåŠ¨ä»å†…å­˜ä¸­æ¸…é™¤ã€‚\nä½†æ˜¯ï¼Œå³ä½¿è¿™æ ·ï¼ŒJava ä¹Ÿè¿˜æ˜¯å­˜åœ¨ç€å†…å­˜æ³„æ¼çš„æƒ…å†µï¼Œjava å¯¼è‡´å†…å­˜æ³„éœ²çš„åŸå› å¾ˆæ˜ç¡®ï¼šé•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æŒæœ‰çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡çš„å¼•ç”¨å°±å¾ˆå¯èƒ½å‘ç”Ÿå†…å­˜æ³„éœ²ï¼Œå°½ç®¡çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡å·²ç»ä¸å†éœ€è¦ï¼Œä½†æ˜¯å› ä¸ºé•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡æŒæœ‰å®ƒçš„å¼•ç”¨è€Œå¯¼è‡´ä¸èƒ½è¢«å›æ”¶ï¼Œè¿™å°±æ˜¯ java ä¸­å†…å­˜æ³„éœ²çš„å‘ç”Ÿåœºæ™¯ã€‚\næœ‰é‡åˆ°è¿‡æ ˆæº¢å‡ºå—ï¼Ÿä¸€èˆ¬æ˜¯ä»€ä¹ˆé—®é¢˜å¯¼è‡´ï¼Ÿ\næ ˆæº¢å‡ºï¼ˆStackOverflowErrorï¼‰æ˜¯æŒ‡æ ˆå†…å®¹å…¨éƒ¨è¢«å ç”¨ï¼Œè€Œæ•°æ®è¿˜è¦å¾€é‡Œæ”¾ã€‚ä¸€èˆ¬æ˜¯é€’å½’é”™è¯¯æˆ–è€…å‡ºç°æ­»å¾ªç¯å¯¼è‡´ã€‚\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡"]},{"title":"é¢è¯• MySQL","url":"/posts/1f8a8b53/","content":"\n\nå‰è¨€\nâ—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24-06-19 åˆå§‹è®°å½•\n\nå¼•æ“\nâ—MySQL æœ‰å“ªäº›å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆé€‰æ‹©ï¼Ÿ\nå¸¸è§çš„å­˜å‚¨å¼•æ“æœ‰ï¼šInnoDBï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼ŒMyISAMï¼ˆæ¬¡å¸¸ç”¨ï¼‰ï¼ŒMEMORYï¼ˆæœ€æ¬¡ï¼‰ã€‚\nInnoDBï¼šæ˜¯æœ€å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ï¼Œé‡‡ç”¨ B+Tree ç´¢å¼•ï¼Œæœ€é€‚ç”¨äºéœ€è¦å¢åˆ æ”¹çš„è¡¨ï¼Œæ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒå¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰ï¼ŒInnoDB æ˜¯ç°åœ¨ MySQL é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚åˆ†åº“åˆ†è¡¨ã€è¯»å†™åˆ†ç¦»ã€ä¸»å¤‡åˆ‡æ¢ï¼ˆæŠ€æœ¯æ–¹æ¡ˆå¾ˆæˆç†Ÿï¼‰\nMyISAMï¼šæ˜¯ 5.5 ç‰ˆæœ¬ä¹‹å‰é»˜è®¤çš„å­˜å‚¨å¼•æ“ï¼Œé‡‡ç”¨ B-Tree ç´¢å¼•ï¼Œè®¿é—®é€Ÿåº¦å¿«ï¼Œä½†ä¸æ”¯æŒäº‹åŠ¡å’Œå¤–é”®ï¼Œæ‰€ä»¥åªé€‚ç”¨äºæŸ¥è¯¢éœ€æ±‚çš„è¡¨ã€‚\n\n\nåŸºäº MyISAM çš„æŠ¥è¡¨ç³»ç»Ÿï¼Œhadoop å‰ä¸€å¤©æŠŠæŠ¥è¡¨æ•°æ®æŸ¥è¯¢ç„¶åä¿å­˜åˆ° MySQLï¼Œåé¢åªè¦æŸ¥è¯¢ã€‚MySQL çš„å•è¡¨å»ºè®®æ§åˆ¶æ•°æ®é‡åœ¨å‡ ç™¾ä¸‡ï¼Œä¸€èˆ¬æ˜¯ 500wã€‚åé¢è¿™ç§æŠ¥è¡¨æ•°æ®é‡ä¼šå¾ˆå¤§ï¼Œsql ä¹Ÿå¾ˆå¤æ‚ï¼Œä¸é€‚åˆç”¨ MySQLã€‚\nMEMORYï¼šåŸºäºå†…å­˜å­˜å‚¨ï¼Œé‡‡ç”¨çš„æ˜¯å“ˆå¸Œç´¢å¼•ï¼Œé€Ÿåº¦å¿«ï¼Œä½†å­˜å‚¨é‡å—å†…å­˜å¤§å°é™åˆ¶ï¼Œè€Œä¸”å®‰å…¨æ€§ä½ï¼Œä¸€ä½†æ–­ç”µï¼Œå†…å­˜å°±ä¼šæ¸…ç©ºï¼Œä¸€èˆ¬ä¸ä½¿ç”¨è¿™ç§å­˜å‚¨å¼•æ“ã€‚\n\n\nä¸ºä»€ä¹ˆ MyISAM è®¿é—®æŸ¥è¯¢é€Ÿåº¦å¿«ï¼Ÿ\nMyISAM ç›¸æ¯”äº InnoDBï¼Œä¸éœ€è¦æ·»åŠ éšè—å€¼æ¥å®ç° MVCC ä¿è¯é«˜å¹¶å‘ï¼Œä¹Ÿä¸éœ€è¦äº‹åŠ¡é”ï¼ŒMyISAM é€šè¿‡èˆå¼ƒå¹¶å‘æ§åˆ¶å’Œäº‹åŠ¡ä¿è¯æ¥æå‡æŸ¥è¯¢é€Ÿåº¦ã€‚\næ­¤å¤– MyISAM æ˜¯éèšé›†ç´¢å¼•ï¼Œä¸”å¶èŠ‚ç‚¹å§‹ç»ˆæ˜¯åœ°å€ç›´æ¥æŒ‡å‘æ•°æ®æ–‡ä»¶ï¼Œè€Œ InnoDB å¯èƒ½å‡ºç°å›è¡¨çš„æƒ…å†µï¼Œæ‰€ä»¥ç›¸å¯¹æ¥è¯´ï¼ŒMyISAM çš„è®¿é—®é€Ÿåº¦æ¯” InnoDB å¿«ã€‚\nâ—MyISAM çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ\nMyIsam åˆ™æ˜¯éèšé›†å‹ç´¢å¼•ï¼Œåº•å±‚æ˜¯ BTree æ•°æ®ç»“æ„ï¼Œmyisam å­˜å‚¨ä¼šæœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯è¡¨æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ç´¢å¼•æ–‡ä»¶ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯æ•°æ®æ–‡ä»¶ ï¼Œæ— è®ºæ˜¯å¦æ˜¯ä¸»é”®ç´¢å¼•ï¼Œç´¢å¼•æ–‡ä»¶æœ€ç»ˆéƒ½æ˜¯ä»¥åœ°å€æŒ‡å‘æ•°æ®æ–‡ä»¶ä¸­çš„è¡¨æ•°æ®ã€‚\nâ—InnoDB çš„æ•°æ®ç»“æ„åˆæ˜¯ä»€ä¹ˆï¼Ÿ\nè¦æ±‚å¿…é¡»è¦æœ‰ä¸»é”®ï¼Œé»˜è®¤å†…ç½®æ ¹æ®ä¸»é”®å»ºç«‹ä¸€ä¸ªç´¢å¼•ï¼Œå«èšç°‡ç´¢å¼•ã€‚å¦‚æœå¯¹äºæŸä¸ªéä¸»é”®çš„å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œæœ€åé‚£ä¸ªå¶å­èŠ‚ç‚¹çš„å€¼å°±æ˜¯ä¸»é”®çš„å€¼ã€‚å¯ä»¥ç”¨ä¸»é”®çš„å€¼åˆ°èšç°‡ç´¢å¼•é‡Œæ ¹æ®ä¸»é”®å€¼å†æ¬¡æ‰¾åˆ°æ•°æ®ã€‚\nInnoDB çš„æ•°æ®â€œç±»å‹â€æ˜¯ BTreeï¼Œåº•å±‚æ•°æ®â€œç»“æ„â€æ˜¯ B+Treeï¼ŒB+Tree æ˜¯ BTree æ•°æ®ç»“æ„çš„å˜ç§ï¼Œæ˜¯ç»å¯¹å¹³è¡¡æ ‘ï¼Œæ‰€æœ‰å¶èŠ‚ç‚¹åœ¨åŒä¸€é«˜åº¦ã€‚\nB+Tree æ˜¯ä¸€ä¸ªå¤šè·¯å¹³è¡¡äºŒå‰æ ‘ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸åªæœ‰å·¦å³ä¸¤ä¸ªåˆ†æ”¯ï¼Œè€Œæ˜¯å¯ä»¥ä¸€ä¸ªèŠ‚ç‚¹ä¸‹æœ‰å¾ˆå¤šåˆ†æ”¯ã€‚\nB+Tree é™¤å¶å­èŠ‚ç‚¹å¤–ï¼Œéƒ½åªå­˜å‚¨ key å€¼ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œä¸”æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹é—´éƒ½è¿æœ‰æŒ‡é’ˆï¼Œä½¿æ‰€æœ‰æ•°æ®æˆä¸ºæœ‰åºåºåˆ—ï¼Œå¯ä»¥ç”¨æ¥åšå…¨è¡¨é¡ºåºææ‰«æˆ–èŒƒå›´æŸ¥è¯¢ã€‚\nB+Tree çš„æ•°æ®æ£€ç´¢è§„åˆ™ä¸ºå·¦é—­åˆåŒºé—´ï¼Œè¿™æ ·å¯ä»¥å®ç°å‘å³æ·»åŠ ã€‚\nä¸ºä»€ä¹ˆä½¿ç”¨ B+Tree è€Œä¸ä½¿ç”¨æ™®é€šçš„ Treeï¼Ÿ\næ™®é€šçš„ tree æœ€å¤šåªèƒ½æœ‰ 2 è·¯ï¼Œè€Œ B+Tree åˆ™æ˜¯å¤šè·¯æ•°æ®ç»“æ„ï¼Œè€Œä¸”åœ¨æ•°æ®é‡åºå¤§çš„æƒ…å†µä¸‹ï¼ŒTree å¯èƒ½é«˜åº¦ä¼šå¾ˆé«˜ï¼Œå¢åŠ  IO æ¬¡æ•°ï¼Œé™ä½äº†æ€§èƒ½ï¼Œè€Œ B+Treeï¼Œä¸€é¡µå¤§å°ä¸º 16KBï¼Œå•çº¯ç”¨æ¥å­˜ç´¢å¼•çš„è¯ï¼Œå‡è®¾ç´¢å¼•ä¸º int ç±»å‹ï¼Œå³ 4 ä¸ªå­—èŠ‚ï¼Œä¸è€ƒè™‘å­èŠ‚ç‚¹å¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜ 2000 ä¸ªå…³é”®å­—ï¼Œå³ 2000 è·¯ï¼Œèƒ½å¤Ÿæœç´¢çš„å…³é”®å­—ä¸ªæ•°è¿œè¿œçš„å¤§äºæ™®é€šçš„äºŒå‰æ ‘ï¼ˆæœ‰åªä¸¤è·¯ï¼‰ã€‚\nä¸ºä»€ä¹ˆä½¿ç”¨ B+Tree è€Œä¸ä½¿ç”¨ B-Treeï¼Ÿ\næ•°æ®åº“åœ¨æŸ¥è¯¢æ•°æ®æ—¶ï¼Œä»¥é¡µçš„æ–¹å¼å°†ç£ç›˜æ•°æ®åŠ è½½åˆ°æ•°æ®å»ºåº“å†…å­˜ï¼Œé»˜è®¤æ¯é¡µæ•°æ®å¤§å°æ˜¯ 16kbï¼Œä¸ºäº†æå‡æŸ¥è¯¢æ•ˆç‡ï¼Œéœ€è¦å‡å°‘ç£ç›˜çš„ IO æ¬¡æ•°ã€‚\nB-Tree æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸­ç›´æ¥ä¿å­˜æ•°æ®ï¼Œè¿™æ ·çš„è¯ 16kb çš„é¡µåŒ…å«çš„èŠ‚ç‚¹æ•°é‡å°±ä¼šæ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥åœ¨æŸ¥è¯¢æ—¶ï¼Œéœ€è¦åŠ è½½æ›´å¤šçš„é¡µã€‚\nB+Tree æ•°æ®ç»“æ„ï¼Œåªæœ‰å¶å­èŠ‚ç‚¹åŒ…å«æ•°æ®ï¼Œå…¶ä»–éå¶å­èŠ‚ç‚¹åªåŒ…å«ç´¢å¼•åˆ—çš„å€¼ï¼Œ16kb çš„é¡µèƒ½åŒ…å«çš„èŠ‚ç‚¹æ•°é‡å°±å¤§å¢ï¼Œç›¸å¯¹äº B-Tree è€Œè¨€ï¼Œèƒ½å¤Ÿæ›´å°‘çš„åŠ è½½é¡µã€‚\nä¸ºä»€ä¹ˆä¸ç”¨ Hash æˆ–è€…çº¢é»‘æ•°ï¼Ÿ\nä¸šåŠ¡æŸ¥è¯¢ä¸€èˆ¬å¯èƒ½ä¸æ˜¯æŸ¥è¯¢ä¸€æ¡ï¼Œè€Œæ˜¯æŸ¥è¯¢å¤šæ¡ã€‚\nhash ç´¢å¼•æŸ¥è¯¢å•æ¡ç¡®å®æ¯”è¾ƒå¿«ï¼Œä½†æ˜¯ä»–æ˜¯æ— åºçš„ï¼ŒæŸ¥è¯¢å¤šæ¡æˆ–è€…æ’åºçš„è¯æ€§èƒ½å°±æ¯”è¾ƒä½äº†ï¼Œå¹¶ä¸”åœ¨å†…å­˜èµ„æºç´§å¼ çš„æƒ…å†µä¸‹ï¼Œæ ‘ç´¢å¼•å¯ä»¥åˆ†æ‰¹è£…å…¥å†…å­˜è¿›è¡Œè®¡ç®—ã€‚\nçº¢é»‘æ ‘å› ä¸ºå¤§æ•°æ®å­˜å‚¨ä¸‹ï¼Œæ ‘çš„é«˜åº¦å¾ˆé«˜ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰æ•°ï¼Œè¿™æ ·å¯èƒ½ä¼šå¯¼è‡´å¤šæ¬¡ IOï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒä½ï¼Œçº¢é»‘æ ‘å¹¶ä¸é€‚åˆåºå¤§æ•°æ®æœç´¢ã€‚\nè€Œ B+ æ ‘å¯ä»¥ä¸€æ¬¡æ€§è£…å…¥æ›´å¤šçš„å¶å­èŠ‚ç‚¹åˆ°å†…å­˜ï¼Œå¹¶ä¸”æ ‘çš„é«˜åº¦å¯ä»¥æ§åˆ¶åˆ°å¾ˆä½ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨æ•°æ®å¹¶ä¸”å½¢æˆé“¾è¡¨å¯ä»¥é¿å…è·¨å±‚æŸ¥è¯¢ï¼Œè¿™ç§â€œçŸ®èƒ–â€çš„æ•°æ®ç»“æ„æ›´é€‚åˆäºåºå¤§æ•°æ®æœç´¢ã€‚\nB+Tree å¶å­èŠ‚ç‚¹ä¸­çš„æ•°æ®æ€ä¹ˆæœ‰åºï¼Ÿ\nç´¢å¼•æ˜¯è¡¨æ•°æ®ä¹‹å¤–çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ•°æ®ç»“æ„å³æ˜¯å­˜å‚¨æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åœ¨è¡¨æ•°æ®ä¹‹å¤–è¿˜ä¼šç”Ÿæˆä¸€å¼ ä¸“é—¨æœç´¢è€Œç”¨çš„è¡¨ï¼Œæ–°åŠ å…¥çš„æ•°æ®ä¼šæ‰¾åˆ°å¯¹åº”å­èŠ‚ç‚¹æ‰€åœ¨çš„èŒƒå›´ï¼ŒæŒ‰ç…§å‡åºä»å°åˆ°å¤§æ’åˆ—ã€‚\næ‰€ä»¥ InnoDB çš„æ‰¹é‡æ’å…¥æ•ˆç‡æ˜¯è¾ƒä½çš„ï¼Œå¦‚æœéœ€è¦æ‰¹é‡æ’å…¥ï¼Œå°±éœ€è¦è¿›è¡Œä¸€å®šçš„æ•°æ®åº“ä¼˜åŒ–ã€‚\næ€ä¹ˆä¼˜åŒ–æ•°æ®åº“æ¥æå‡æ•°æ®æ‰¹é‡æ’å…¥çš„æ•ˆç‡å‘¢ï¼Ÿ\n\n\nå°½é‡ä¿æŒæ•°æ®æœ‰åºã€‚å‡å°‘æ•°æ®æ’å…¥æ—¶å¯¹ç´¢å¼•çš„ç»´æŠ¤æˆæœ¬ã€‚\n\n\nä¸€æ¬¡æ’å…¥å¤šæ¡æ•°æ® (ä¸å®œè¿‡å¤š)ã€‚å‡å°‘æ—¥å¿—ï¼Œé™ä½æ—¥å¿—åˆ·æ–°ç£ç›˜çš„é¢‘ç‡ã€‚å‡å°‘ sql è§£ææ¬¡æ•°ã€‚\n\n\nå°½é‡ä¿è¯ä¸»é”®è¶³å¤Ÿå°ï¼Œä¸”è¡¨ä¸Šæ²¡æœ‰å¤šä½™çš„ç´¢å¼•ã€‚\n\n\nå¦‚æœå…è®¸ï¼Œè€ƒè™‘ä¸´æ—¶å…³é—­äºŒè¿›åˆ¶æ—¥å¿—ã€‚\n\n\nç¡®ä¿ innodb_buffer_pool_sizeï¼Œinnodb_log_buffer_sizeï¼Œmax_allowed_packet è¶³å¤Ÿå¤§ã€‚æ³¨ï¼š\n\n\n\n\ninnodb_buffer_pool_sizeï¼šInnoDB æœ€é‡è¦çš„å‚æ•°ï¼Œç¼“å­˜ innodb è¡¨çš„ç´ å¼•ã€æ•°æ®å’Œæ’å…¥æ•°æ®çš„ç¼“å†²ã€‚\n\n\ninnodb_log_buffer_sizeï¼šæ—¥å¿—ç¼“å†²åŒºï¼Œå¤§é‡äº‹åŠ¡æ—¶å¯ä»¥å°†é»˜è®¤ 3M è®¾ä¸º 16Mã€‚\n\n\nmax_allowed_packetï¼šç½‘ç»œåŒ…å¤§å°ï¼Œé¿å…å‡ºç°è¾ƒå¤§çš„ç½‘ç»œåŒ…é”™è¯¯ã€‚\n\n\nä¸ºä»€ä¹ˆ InnoDB èƒ½æ”¯æŒäº‹åŠ¡ç‰¹æ€§ï¼Ÿ\nredo log é‡åšæ—¥å¿—ç”¨æ¥ä¿è¯äº‹åŠ¡çš„æŒä¹…æ€§ï¼šå½“ commit æ—¶ï¼Œå¿…é¡»å…ˆå°†äº‹åŠ¡çš„æ‰€æœ‰æ—¥å¿—å†™åˆ°é‡åšæ—¥å¿—æ–‡ä»¶è¿›è¡ŒæŒä¹…åŒ–ï¼Œç›´åˆ° commit ç»“æŸæ—¥å¿—æ‰ç®—å®Œæˆã€‚\nundo log å›æ»šæ—¥å¿—ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼šäº‹åŠ¡å®Œæˆå‰ï¼Œæ“ä½œå¹¶æ²¡æœ‰çœŸæ­£æ‰§è¡Œï¼Œè€Œè®°å½•åœ¨æ—¥å¿—ä¸­ï¼Œundo log ä¼šè®°å½•ä¹‹å‰äº‹åŠ¡å¯¹åº”çš„è¡Œæ•°æ®ï¼Œå›æ»šæ—¶ï¼Œä¼šæ ¹æ®æ—¥å¿—è¿›è¡Œåå‘æ“ä½œï¼Œå¯¹ä¸­é—´è®°å½•çš„æ¯ä¸€æ­¥æ“ä½œè¿›è¡Œé€»è¾‘åˆ é™¤ï¼Œä»è€Œä¿è¯åŸå­æ€§ã€‚\nundo log + redo log ä¿è¯äº‹åŠ¡çš„ä¸€è‡´æ€§ï¼šæ“ä½œè¿‡ç¨‹ä¸­ç”± redo log ä¿è¯æŒä¹…åŒ–ï¼Œä¸€ä½†è¿‡ç¨‹ä¸­å‡ºé”™ï¼Œå°±ç”± undo log å›æ»šã€‚\né”ï¼ˆå…±äº«ã€æ’ä»–ï¼‰ç”¨æ¥ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§ï¼šäº‹åŠ¡çš„éš”ç¦»æ€§çš„å®ç°åŸç†å°±æ˜¯é”ï¼ŒInnoDB ä¸»è¦æœ‰ 2 ç§é”ï¼Œè¡Œçº§é”è·Ÿæ„å‘é”ã€‚ï¼ˆå…·ä½“è§ MySQL é”å›ç­”ï¼‰\nä»€ä¹ˆæ˜¯ InnoDB å›è¡¨ï¼Ÿ\nå³ç¬¬ä¸€æ¬¡ B+tree çš„å¶èŠ‚ç‚¹ä¸Šæ²¡èƒ½ç›´æ¥è·å–æ•°æ®ï¼Œè¿˜éœ€è¦é€šè¿‡å¶èŠ‚ç‚¹ä¸Šçš„æ•°æ®åšä¸ºæ–°çš„ç´¢å¼•åœ¨å¦ä¸€å¼ è¡¨ä¸Šè¿›è¡Œç¬¬äºŒæ¬¡ B+tree çš„æ‰«æï¼Œç›´åˆ°è·å–æœ€ç»ˆæƒ³è¦çš„æ•°æ®ã€‚\né‚£æœ‰æ²¡æœ‰å¥½çš„è§£å†³åŠæ³•ï¼Ÿ\nè¦†ç›–ç´¢å¼•ï¼ˆå°±æ˜¯è”åˆç´¢å¼•ï¼‰ã€‚è§£å†³å›è¡¨é—®é¢˜ï¼Œåªéœ€è¦åœ¨ä¸€æ£µç´¢å¼•æ ‘ä¸Šå°±èƒ½è·å– SQL æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ï¼Œæ— éœ€å›è¡¨ï¼Œé€Ÿåº¦æ›´å¿«ã€‚\nè¦†ç›–ç´¢å¼•çš„å®ç°æ–¹æ³•æ˜¯ï¼Œå°†éœ€è¦æŸ¥è¯¢çš„æ•°æ®ä¸ä¸»é”®å…±åŒè®¾ä¸ºç´¢å¼•ï¼Œå³è”åˆç´¢å¼•ï¼Œç´¢å¼•æ‰«æéµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œé€šè¿‡ä¸€æ¬¡æ‰«æ B+tree å³å¯æŸ¥è¯¢åˆ°ç›¸åº”çš„ç»“æœï¼Œå®ç°è¦†ç›–ç´¢å¼•ã€‚\næ‰€ä»¥åˆ›å»ºç´¢å¼•çš„æ—¶å€™ï¼Œå°½å¯èƒ½åˆ›å»ºâ€œè¦†ç›–ç´¢å¼•â€ï¼Œå‡å°‘å›è¡¨æ“ä½œï¼Œæå‡æœç´¢æ€§èƒ½ã€‚\nâ—ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿ\nè”åˆç´¢å¼•è¿›æ‰« B+tree æ‰«ææ—¶ï¼Œä¼šä»¥æœ€å·¦è¾¹çš„ç´¢å¼•æ¡ä»¶èµ·ç‚¹ä¼˜å…ˆï¼Œä»»ä½•è¿ç»­çš„ç´¢å¼•éƒ½èƒ½åŒ¹é…çš„ä¸Šã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªè”åˆç´¢å¼•ä¸ºï¼ˆname, price, addressï¼‰ï¼Œé‚£ä¹ˆå®ƒçš„åŒ¹é…ç´¢å¼•æœ‰ä¸‰ä¸ªï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§åˆ†åˆ«æ˜¯ï¼šnameã€name+priceã€name+price+addressï¼ˆæ³¨ï¼šå¿…é¡»æ˜¯ä»æœ€å·¦å¼€å§‹ï¼Œä¸”è¿ç»­ï¼‰\n\n\nå…¨åˆ—åŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨\n\n\næœ€å·¦å‰ç¼€åŒ¹é…ã€‚æœ€å·¦è¾¹ï¼Œä¸€åˆ—ã€ä¸¤åˆ—ã€ä¸‰åˆ—åŒ¹é…éƒ½è¡Œ\n\n\næœ€å·¦åŒ¹é…åŸåˆ™ï¼Œä½†æ˜¯ä¸­é—´æŸä¸ªå€¼æ²¡åŒ¹é…ã€‚ä¼šåŒ¹é…çš„éƒ¨åˆ†èµ°ç´¢å¼•ï¼Œç„¶ååé¢çš„å€¼æ ¹æ®è¿‡æ»¤å‡ºæ¥çš„å€¼ï¼Œå†åŒ¹é…ã€‚ï¼ˆçº¿ä¸Šå¸¸ç”¨ï¼Œæ•ˆæœè¿˜å¥½ï¼‰\n\n\næ²¡æœ‰æœ€å·¦å‰ç¼€åŒ¹é…ã€‚æ¯”å¦‚ç›´æ¥ä» price å¼€å§‹åŒ¹é…ï¼Œå°±ä¸ä¼šèµ°ç´¢å¼•\n\n\nå‰ç¼€åŒ¹é…ã€‚like æ“ä½œåªæœ‰ XX% æ‰ä¼šè¿›è¡ŒåŒ¹é…\n\n\nèŒƒå›´åˆ—è¡¨æŸ¥è¯¢ã€‚åªæœ‰èŒƒå›´å­—æ®µå¯ä»¥æŸ¥è¯¢ã€‚\n\n\nåŒ…å«å‡½æ•°ã€‚ä½¿ç”¨å‡½æ•°çš„å­—æ®µä¸ä¼šç”¨ä¸Šç´¢å¼•ã€‚\n\n\né‚£æ˜¯ä¸æ˜¯è¦†ç›–ç´¢å¼•è¶Šå¤šè¶Šå¥½ï¼Ÿ\nä¸æ˜¯ã€‚åœ¨ B+Tree æ•°æ®ç±»å‹åœ¨ä¿è¯æ ‘çš„å¹³è¡¡çš„è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡å…³é”®å­—çš„å˜åŒ–ï¼Œéƒ½ä¼šå¯¼è‡´ç»“æ„å‘ç”Ÿå¾ˆå¤§çš„å˜åŒ–ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ç‰¹åˆ«æµªè´¹æ—¶é—´çš„ï¼Œæ‰€ä»¥åˆ›å»ºç´¢å¼•ä¸€å®šè¦åˆ›å»ºåˆé€‚çš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯æŠŠæ‰€æœ‰çš„å­—æ®µéƒ½åˆ›å»ºç´¢å¼•ï¼Œåˆ›å»ºå†—ä½™ç´¢å¼•åªä¼šåœ¨å¯¹æ•°æ®è¿›è¡Œæ–°å¢ï¼Œåˆ é™¤ï¼Œä¿®æ”¹æ—¶å¢åŠ æ€§èƒ½æ¶ˆè€—ã€‚\nç™¾ä¸‡çº§åˆ«æˆ–ä»¥ä¸Šçš„æ•°æ®å¦‚ä½•åˆ é™¤ï¼Ÿ\nç´¢å¼•æ–‡ä»¶æ˜¯å•ç‹¬å­˜åœ¨çš„æ–‡ä»¶ï¼Œå¯¹å­˜å‚¨è¡¨çš„æ“ä½œéƒ½ä¼šè¿å¸¦åˆ°ç´¢å¼•æ–‡ä»¶ä¸Šï¼Œä¸ºäº†æé«˜åˆ é™¤é€Ÿåº¦ï¼Œå¯ä»¥ä¼˜å…ˆåˆ é™¤ç´¢å¼•ï¼ˆç™¾ä¸‡çº§çº¦ 3 åˆ†é’Ÿï¼‰ï¼Œç„¶åä¼˜å…ˆåˆ é™¤æ— ç”¨æ•°æ®ï¼Œæœ€åå¯¹éœ€è¦ä¿ç•™çš„æ•°æ®é‡æ–°åˆ›å»ºç´¢å¼•ã€‚è¿™æ ·å°±ç®—éœ€è¦å›æ»šï¼Œä¹Ÿæ¯”å…¨éƒ¨å›æ»šé€Ÿåº¦æ›´å¿«ã€‚\näº‹åŠ¡\nâ—ä½ èƒ½è¯´è¯´äº‹åŠ¡çš„å‡ ä¸ªç‰¹æ€§æ˜¯å•¥ï¼Ÿæœ‰å“ªå‡ ç§éš”ç¦»çº§åˆ«ï¼Ÿ\nâ€”â€”ACIDï¼ˆåªæœ‰ InnoDB æ‰æ”¯æŒäº‹åŠ¡ï¼‰ã€‚\n\n\nåŸå­æ€§ï¼ˆundo log å›æ»šä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼‰ï¼šæŒ‡åŒä¸€å¯¹çš„äº‹åŠ¡æ“ä½œï¼Œè¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥ï¼Œæ“ä½œå¤±è´¥ä¸èƒ½å¯¹æ•°æ®åº“æœ‰å½±å“ã€‚\n\n\nä¸€è‡´æ€§ï¼ˆundo log+redo log ä¿è¯äº‹åŠ¡ä¸€è‡´æ€§ï¼‰ï¼šäº‹åŠ¡æ“ä½œä¹‹åï¼Œæ•°æ®åº“å†…çš„æ•°æ®æ€»é‡ä¿æŒä¸€è‡´ã€‚ï¼ˆèƒ½é‡å®ˆæ’ï¼‰\n\n\néš”ç¦»æ€§ï¼ˆé”ä¿è¯äº‹åŠ¡éš”ç¦»æ€§ï¼‰ï¼šç›¸åŒçš„è¡¨ï¼Œä¸åŒäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚\n\n\næŒä¹…æ€§ï¼ˆredo log é‡åšæ—¥å¿—ç”¨æ¥ä¿è¯äº‹åŠ¡æŒä¹…æ€§ï¼‰ï¼šäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå°±éœ€è¦åœ¨æ•°æ®æ°¸ä¹…åŒ–å­˜å‚¨ï¼Œå³ä¾¿æ•…éšœä¹Ÿä¸ä¼šä¸¢å¤±æäº¤äº‹åŠ¡çš„æ“ä½œã€‚\n\n\n4 ç§ã€‚\n\n\nè¯»æœªæäº¤ï¼ˆRUï¼šread uncommittedï¼‰ï¼šè¯»åˆ°äº†åˆ«çš„äº‹åŠ¡æ²¡æœ‰æäº¤çš„æ•°æ®ã€‚å¯èƒ½å­˜åœ¨ã€è„è¯» + ä¸å¯é‡å¤è¯» + å¹»è¯»ã€‘çš„é—®é¢˜ã€‚\n\n\nè¯»å·²æäº¤ï¼ˆRCï¼šread committedï¼‰ï¼šå¯èƒ½å­˜åœ¨ã€ä¸å¯é‡å¤è¯» + å¹»è¯»ã€‘é—®é¢˜ã€‚\n\n\nå¯é‡å¤è¯»ï¼ˆRRï¼šrepeatable readï¼‰ï¼šå¯èƒ½å­˜åœ¨ã€å¹»è¯»ã€‘é—®é¢˜ã€‚ã€MySQL é»˜è®¤ã€‘\n\n\nä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰ï¼šæ— ä»¥ä¸Šé—®é¢˜ï¼Œä½†æ•ˆç‡ä½ï¼Œä¸€èˆ¬åœ¨åˆ†å¸ƒå¼äº‹åŠ¡çš„æƒ…å†µä¸‹ç”¨è¯¥çº§åˆ«ã€‚\n\n\nâ—ä»€ä¹ˆæ˜¯è„è¯»ï¼Ÿå¹»è¯»ï¼Ÿä¸å¯é‡å¤è¯»ï¼Ÿ\nè„è¯» (Drity Read)ï¼šæ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å¤„ç†è¿‡ç¨‹ä¸­è¯»å–äº†å¦ä¸€ä¸ªæœªæäº¤çš„äº‹åŠ¡ä¸­çš„æ•°æ® , å¯¼è‡´ä¸¤æ¬¡æŸ¥è¯¢ç»“æœä¸ä¸€è‡´ã€‚\nå¯é‡å¤è¯» (Non-repeatable read)ï¼šäº‹åŠ¡å¼€å¯åå…³é—­å‰ï¼Œå¤šæ¬¡è¯»å–åŒä¸€æ¡è®°å½•ï¼Œç»“æœå´ä¸èƒ½ä¿è¯ä¸€è‡´ï¼Œæ‰€ä»¥å«ä¸å¯é‡å¤è¯»ã€‚ä¸»è¦é—®é¢˜ä¸åœ¨åŒä¸€ä¸ªæ•°æ®åº“çš„é—®é¢˜ï¼Œè€Œåœ¨ä¸åŒçš„æœåŠ¡å™¨ï¼Œä¸åŒæ•°æ®åº“æ—¶ä¼šå‡ºç°çš„é—®é¢˜ï¼Œå› ä¸ºä¸¤å°ç”µè„‘ä¹‹é—´è¦ä¿è¯æ•°æ®ç›¸åŒï¼Œæ˜¯éœ€è¦æ—¶é—´è¿›è¡Œå¤åˆ¶çš„ï¼Œä»è¡¨åœ¨å¤åˆ¶ä¸»è¡¨çš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¯èƒ½å› ä¸ºä¿®æ”¹æ•°æ®è¿‡å¿«è€Œå¯¼è‡´å¤åˆ¶åˆ°é”™è¯¯æ•°æ®ã€‚\nå¹»è¯» (Phantom Read)ï¼šselect æŸè®°å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ï¼Œå‡†å¤‡æ’å…¥æ­¤è®°å½•ï¼Œä½†æ‰§è¡Œ insert æ—¶å‘ç°æ­¤è®°å½•å·²å­˜åœ¨ï¼Œæ— æ³•æ’å…¥ã€‚æˆ–ä¸å­˜åœ¨æ‰§è¡Œ delete åˆ é™¤ï¼Œå´å‘ç°åˆ é™¤æˆåŠŸã€‚\nâ—äº‹åŠ¡çš„éš”ç¦»çº§åˆ«æ˜¯æ€ä¹ˆè§£å†³ä»¥ä¸Šä¸‰ç§é—®é¢˜çš„ï¼Ÿ\nè§£å†³è„è¯»ï¼šä¿®æ”¹æ—¶åŠ æ’ä»–é”ï¼ˆå†™é”ï¼‰ï¼Œç›´åˆ°äº‹åŠ¡æäº¤åæ‰é‡Šæ”¾ï¼Œè¯»å–æ—¶åŠ å…±äº«é”ï¼ˆè¯»é”ï¼‰ï¼Œå…¶ä»–äº‹åŠ¡åªèƒ½è¯»å–ï¼Œä¸èƒ½å†æœ‰æ›´æ–°æ“ä½œã€‚é˜²æ­¢è„è¯»ã€‚\nè§£å†³ä¸å¯é‡å¤è¯»ï¼šinnodb å¼•æ“é‡‡ç”¨äº† MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰æ¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ã€‚mvcc æ˜¯åˆ©ç”¨åœ¨æ¯æ¡æ•°æ®åé¢åŠ äº†éšè—çš„ä¸¤åˆ—ï¼ˆåˆ›å»ºç‰ˆæœ¬å·å’Œåˆ é™¤ç‰ˆæœ¬å·ï¼‰ã€‚å½“æ‰§è¡ŒæŸ¥è¯¢çš„æ—¶ï¼Œå½“å‰æŸ¥è¯¢ç‰ˆæœ¬å·&gt;= åˆ›å»ºç‰ˆæœ¬å· å¹¶ä¸” &gt;åˆ é™¤ç‰ˆæœ¬å·ï¼ŒMVCC å¯ä»¥åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä»£æ›¿è¡Œçº§é”ï¼Œä½¿ç”¨ MVCCï¼Œèƒ½é™ä½å…¶ç³»ç»Ÿå¼€é”€ã€‚\nè§£å†³å¹»è¯»ï¼šé‡‡ç”¨ next-key é”è§£å†³å¹»è¯»é—®é¢˜ï¼Œnext-key é”åŒ…å«ä¸¤éƒ¨åˆ†ï¼šè®°å½•é”ï¼ˆè¡Œé”ï¼‰+ é—´éš™é”ï¼Œå°±æ˜¯åœ¨ç´¢å¼•å’Œç´¢å¼•ä¹‹é—´ä¸Šé¢åŠ é”ã€‚\nâ—InnoDB æ˜¯æ€ä¹ˆåšåˆ°å¹¶å‘æ§åˆ¶çš„ï¼ŸMVCC\n\näº‹åŠ¡ idï¼Œåœ¨ mysql å†…éƒ¨æ˜¯å…¨å±€å”¯ä¸€é€’å¢çš„ã€‚\nå½“ä¸€ä¸ªäº‹åŠ¡å†…æŸ¥è¯¢çš„æ—¶å€™ï¼Œmysql åªä¼šæŸ¥è¯¢åˆ›å»ºäº‹åŠ¡ id &lt;= å½“å‰äº‹åŠ¡ id çš„æ•°æ®ä¸”å½“å‰äº‹åŠ¡ id &lt; åˆ é™¤äº‹åŠ¡ idã€‚\n\né€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰å®ç°ã€‚\næŒ‡çš„æ˜¯ä¸€ç§æé«˜å¹¶å‘çš„æŠ€æœ¯ã€‚æœ€æ—©çš„æ•°æ®åº“ç³»ç»Ÿï¼Œåªæœ‰è¯»è¯»ä¹‹é—´å¯ä»¥å¹¶å‘ï¼Œè¯»å†™ï¼Œå†™è¯»ï¼Œå†™å†™éƒ½è¦é˜»å¡ã€‚å¼•å…¥å¤šç‰ˆæœ¬ä¹‹åï¼Œåªæœ‰å†™å†™ä¹‹é—´ç›¸äº’é˜»å¡ï¼Œå…¶ä»–ä¸‰ç§æ“ä½œéƒ½å¯ä»¥å¹¶è¡Œï¼Œè¿™æ ·å¤§å¹…åº¦æé«˜äº† InnoDB çš„å¹¶å‘åº¦ã€‚\nåœ¨å†…éƒ¨å®ç°ä¸­ï¼ŒInnoDB é€šè¿‡ undo log ä¿å­˜æ¯æ¡æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ‰¾å›æ•°æ®å†å²ç‰ˆæœ¬æä¾›ç»™ç”¨æˆ·è¯»ï¼Œæ¯ä¸ªäº‹åŠ¡è¯»åˆ°çš„æ•°æ®ç‰ˆæœ¬å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œç”¨æˆ·åªèƒ½çœ‹åˆ°è¯¥äº‹åŠ¡åˆ›å»ºå¿«ç…§ä¹‹å‰å·²ç»æäº¤çš„ä¿®æ”¹å’Œè¯¥äº‹åŠ¡æœ¬èº«åšçš„ä¿®æ”¹ã€‚\nMVCC åœ¨ Read Committed å’Œ Repeatable Read ä¸¤ä¸ªéš”ç¦»çº§åˆ«ä¸‹å·¥ä½œã€‚\nMySQL çš„ InnoDB å­˜å‚¨å¼•æ“é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯ RR(å¯é‡å¤è¯»)ï¼Œæ˜¯é€šè¿‡ &quot; è¡Œçº§é” +MVCC&quot; ä¸€èµ·å®ç°çš„ï¼Œæ­£å¸¸è¯»çš„æ—¶å€™ä¸åŠ é”ï¼Œå†™çš„æ—¶å€™åŠ é”ã€‚è€Œ MVCC çš„å®ç°ä¾èµ–ï¼šéšè—å­—æ®µã€Read Viewã€Undo logã€‚\néšè—å­—æ®µæ˜¯ InnoDb å­˜å‚¨å¼•æ“åœ¨æ¯è¡Œæ•°æ®çš„åé¢è‡ªåŠ¨åŠ ä¸Šçš„å­—æ®µï¼ŒåŒ…æ‹¬äº‹åŠ¡ id å­—æ®µï¼ˆæœ€é‡è¦ï¼Œæ¯æ¬¡æ–°å¢æˆ–ä¿®æ”¹ä¼šä¿®æ”¹ id å·ï¼Œåˆ é™¤çš„è¯æ˜¯é€»è¾‘åˆ é™¤ï¼Œå½“åšæ›´æ–°å¤„ç†ï¼Œä¼šå¤šä¸€ä¸ªæ›´æ–°è®°å½•ï¼‰å’Œå›æ»šæŒ‡é’ˆå­—æ®µï¼ˆæŒ‡å‘ undo log çš„ä¸Šä¸€æ¬¡äº‹åŠ¡å¯¹åº”çš„æ•°æ®ï¼‰ã€‚\nReadView å°±æ˜¯å¿«ç…§ï¼Œä¸»è¦æ˜¯ç”¨æ¥åšå¯è§æ€§åˆ¤æ–­çš„ï¼Œä¿è¯å…¶å®ƒäº‹åŠ¡å¯¹è¯¥äº‹åŠ¡ä¸å¯è§ï¼Œé‡Œé¢åŒ…æ‹¬è¯¥äº‹åŠ¡çš„æœ€å¤§äº‹åŠ¡ IDï¼Œæœ€å°äº‹åŠ¡ ID ä»¥åŠæœªæäº¤çš„äº‹åŠ¡ ID ç­‰ã€‚\nUndo log ä¸­å­˜å‚¨çš„æ˜¯è€ç‰ˆæœ¬æ•°æ®ï¼Œç”¨äºå›æ»šã€‚å¦‚å½“ä¸€ä¸ªäº‹åŠ¡éœ€è¦è¯»å–è®°å½•è¡Œæ—¶ï¼Œå¦‚æœå½“å‰è®°å½•è¡Œä¸å¯è§ï¼Œå¯ä»¥é¡ºç€ undo log é“¾æ‰¾åˆ°æ»¡è¶³å…¶å¯è§æ€§æ¡ä»¶çš„è®°å½•è¡Œç‰ˆæœ¬ã€‚\né”\nMySQL æ•°æ®åº“é”çš„å®ç°åŸç†\nåœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå¯ä»¥æŒ‰ç…§é”çš„ç²’åº¦æŠŠæ•°æ®åº“é”åˆ†ä¸ºè¡Œçº§é” (INNODB å¼•æ“)ã€è¡¨çº§é” (MYISAM å¼•æ“) å’Œé¡µçº§é” (BDB å¼•æ“ )ã€‚\nMyISAM å’Œ InnoDB å­˜å‚¨å¼•æ“ä½¿ç”¨çš„é”ï¼š\n\n\nMyISAM é‡‡ç”¨è¡¨çº§é”ã€‚ï¼ˆä¸€ä¸ªä¾‹å­ï¼šhadoop å¤„ç†æ•°æ®å‡ºäº†é—®é¢˜ï¼Œä¸Šåˆ 10 ç‚¹è¿˜åœ¨æ’å…¥å¤§é‡æ•°æ®ï¼Œå¯¼è‡´é”è¡¨ã€‚é¡µé¢æŠ¥é”™ 504ï¼‰\n\n\nInnoDB æ”¯æŒè¡Œçº§é”å’Œè¡¨çº§é”ï¼Œé»˜è®¤ä¸ºè¡Œçº§é”ã€‚ï¼ˆinnoDB åœ¨æ‰§è¡Œå¢åˆ æ”¹æ—¶ä¼šè‡ªåŠ¨ç»™è¡ŒåŠ æ’ä»–é”ï¼‰\n\n\nè¡Œçº§é”ï¼šè¡Œçº§é”æ˜¯ MySQL ä¸­é”å®šç²’åº¦æœ€ç»†çš„ä¸€ç§é”ï¼Œè¡¨ç¤ºåªé’ˆå¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚è¡Œçº§é”èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚å…¶åŠ é”ç²’åº¦æœ€å°ï¼Œä½†åŠ é”çš„å¼€é”€ä¹Ÿæœ€å¤§ã€‚è¡Œçº§é”åˆ†ä¸ºå…±äº«é”ï¼ˆè¯»é”ï¼‰ å’Œ æ’ä»–é”ï¼ˆå†™é”ï¼‰ã€‚\nå…±äº«é”å’Œæ’ä»–é”\nå…±äº«é”: åˆå«åšè¯»é”ã€‚ å½“ç”¨æˆ·è¦è¿›è¡Œæ•°æ®çš„è¯»å–æ—¶ï¼Œå¯¹æ•°æ®åŠ ä¸Šå…±äº«é”ã€‚å…±äº«é”å¯ä»¥åŒæ—¶åŠ ä¸Šå¤šä¸ªã€‚\næ’ä»–é”: åˆå«åšå†™é”ã€‚ å½“ç”¨æˆ·è¦è¿›è¡Œæ•°æ®çš„å†™å…¥æ—¶ï¼Œå¯¹æ•°æ®åŠ ä¸Šæ’ä»–é”ã€‚æ’ä»–é”åªå¯ä»¥åŠ ä¸€ä¸ªï¼Œä»–å’Œå…¶ä»–çš„æ’ä»–é”ï¼Œå…±äº«é”éƒ½ç›¸æ–¥ã€‚\næ‚²è§‚é”å’Œä¹è§‚é”\næ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ä¸­çš„å¹¶å‘æ§åˆ¶çš„ä»»åŠ¡æ˜¯ç¡®ä¿åœ¨å¤šä¸ªäº‹åŠ¡åŒæ—¶å­˜å–æ•°æ®åº“ä¸­åŒä¸€æ•°æ®æ—¶ä¸ç ´åäº‹åŠ¡çš„éš”ç¦»æ€§å’Œç»Ÿä¸€æ€§ä»¥åŠæ•°æ®åº“çš„ç»Ÿä¸€æ€§ã€‚ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆä¹è§‚é”ï¼‰å’Œæ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆæ‚²è§‚é”ï¼‰æ˜¯å¹¶å‘æ§åˆ¶ä¸»è¦é‡‡ç”¨çš„æŠ€æœ¯æ‰‹æ®µã€‚\næ‚²è§‚é”ï¼šå‡å®šä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œå±è”½ä¸€åˆ‡å¯èƒ½è¿åæ•°æ®å®Œæ•´æ€§çš„æ“ä½œã€‚åœ¨æŸ¥è¯¢å®Œæ•°æ®çš„æ—¶å€™å°±æŠŠäº‹åŠ¡é”èµ·æ¥ï¼Œç›´åˆ°æäº¤äº‹åŠ¡ã€‚å®ç°æ–¹å¼ï¼šä½¿ç”¨æ•°æ®åº“ä¸­çš„é”æœºåˆ¶ã€‚\nä¹è§‚é”ï¼šå‡è®¾ä¸ä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œåªåœ¨æäº¤æ“ä½œæ—¶æ£€æŸ¥æ˜¯å¦è¿åæ•°æ®å®Œæ•´æ€§ã€‚åœ¨ä¿®æ”¹æ•°æ®çš„æ—¶å€™æŠŠäº‹åŠ¡é”èµ·æ¥ï¼Œé€šè¿‡ version çš„æ–¹å¼æ¥è¿›è¡Œé”å®šã€‚å®ç°æ–¹å¼ï¼šä¹è§‚é”ä¸€èˆ¬ä¼šä½¿ç”¨ç‰ˆæœ¬å·æœºåˆ¶æˆ– CAS ç®—æ³•å®ç°ã€‚\nä¸¤ç§é”çš„ä½¿ç”¨åœºæ™¯ï¼ˆâ—çº¿ä¸Šå°‘ç”¨æ‚²è§‚é”ï¼‰\nä»ä¸Šé¢å¯¹ä¸¤ç§é”çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ä¸¤ç§é”å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œä¸å¯è®¤ä¸ºä¸€ç§å¥½äºå¦ä¸€ç§ï¼Œåƒä¹è§‚é”é€‚ç”¨äºå†™æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ˆå¤šè¯»åœºæ™¯ï¼‰ï¼Œå³å†²çªçœŸçš„å¾ˆå°‘å‘ç”Ÿçš„æ—¶å€™ï¼Œè¿™æ ·å¯ä»¥çœå»äº†é”çš„å¼€é”€ï¼ŒåŠ å¤§äº†ç³»ç»Ÿçš„æ•´ä¸ªååé‡ã€‚\nä½†å¦‚æœæ˜¯å¤šå†™çš„æƒ…å†µï¼Œä¸€èˆ¬ä¼šç»å¸¸äº§ç”Ÿå†²çªï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸Šå±‚åº”ç”¨ä¼šä¸æ–­çš„è¿›è¡Œ retryï¼Œè¿™æ ·åå€’æ˜¯é™ä½äº†æ€§èƒ½ï¼Œæ‰€ä»¥ä¸€èˆ¬å¤šå†™çš„åœºæ™¯ä¸‹ç”¨æ‚²è§‚é”å°±æ¯”è¾ƒåˆé€‚ã€‚\nâ—å¦‚æœæ­»é”äº†å’‹åŠï¼Ÿ\næ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡åœ¨åŒä¸€èµ„æºä¸Šç›¸äº’å ç”¨ï¼Œå¹¶è¯·æ±‚é”å®šå¯¹æ–¹çš„èµ„æºï¼Œä»è€Œå¯¼è‡´æ¶æ€§å¾ªç¯çš„ç°è±¡ã€‚\nè¡¨çº§é”ä¸ä¼šäº§ç”Ÿæ­»é”ï¼Œè¡Œçº§é”å’Œé¡µçº§é”ä¼šäº§ç”Ÿæ­»é”ã€‚\nå¸¸è§çš„è§£å†³æ­»é”çš„æ–¹æ³•ï¼šä¸€èˆ¬æ˜¯çœ‹æ­»é”çš„ç›¸å…³ logï¼Œç„¶åè§£å†³å‡ºé—®é¢˜çš„ sql\n\n\nå¦‚æœä¸åŒç¨‹åºä¼šå¹¶å‘å­˜å–å¤šä¸ªè¡¨ï¼Œå°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®è¡¨ï¼Œå¯ä»¥å¤§å¤§é™ä½æ­»é”æœºä¼šã€‚\n\n\nåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå°½å¯èƒ½åšåˆ°ä¸€æ¬¡é”å®šæ‰€éœ€è¦çš„æ‰€æœ‰èµ„æºï¼Œå‡å°‘æ­»é”äº§ç”Ÿæ¦‚ç‡ï¼›\n\n\nå¯¹äºéå¸¸å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä¸šåŠ¡éƒ¨åˆ†ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å‡çº§é”çš„é¢—ç²’åº¦ï¼Œé€šè¿‡è¡¨çº§é”å®šæ¥å‡å°‘æ­»é”äº§ç”Ÿçš„æ¦‚ç‡ï¼›\n\n\nå¦‚æœä¸šåŠ¡å¤„ç†ä¸å¥½å¯ä»¥ç”¨åˆ†å¸ƒå¼äº‹åŠ¡é”æˆ–è€…ä½¿ç”¨ä¹è§‚é”ã€‚\næ•°æ®åº“ä¼˜åŒ–\nä¼˜åŒ–æ•°æ®åº“\n\n\næå‡ç¡¬ç›˜é…ç½®ï¼Œæ¢ SSD å›ºæ€ç¡¬ç›˜ï¼Œç¡¬ä»¶ç›´æ¥å†³å®šäº†ç£ç›˜è¯»å†™çš„å¿«æ…¢ã€‚\n\n\nè®¾è®¡ç´¢å¼•çš„æ—¶å€™ï¼Œå°½é‡ä¿è¯ä¸»é”®è¶³å¤Ÿå°ã€‚\n\n\nå¯¹æ•°æ®åº“ç»“æ„ä¼˜åŒ–ï¼Œç´¢å¼•å¯ä»¥é€‚å½“å†—ä½™ï¼Œå¯ä»¥å‡å°‘å¤šè¡¨è”æŸ¥ã€‚\n\n\nå°½é‡ä¿è¯æ•°æ®çš„æœ‰åºæ€§ï¼Œæå‡æ‰¹é‡æ’å…¥çš„æ€§èƒ½ã€‚\n\n\nåˆ†åº“åˆ†è¡¨ã€‚\n\n\næ¨¡ç³ŠæŸ¥è¯¢å’Œæµ·é‡æ•°æ®æŸ¥è¯¢ä½¿ç”¨ ESï¼šå€’æ’ç´¢å¼•ï¼Œè¿‘å®æ—¶æŸ¥è¯¢ã€‚\n\n\næ•°æ®è¿ç§»ä½¿ç”¨ XXL-Jobï¼šåªä¿ç•™å½“å¤©æ•°æ®ï¼Œåºå¤§çš„å†å²æ•°æ®æ”¾åˆ°å†å²è¡¨ã€‚\n\n\nSQL è¯­å¥çš„é€‰ç”¨ï¼šæ¯”å¦‚å›ºå®šé•¿åº¦ç”¨ char æ›´å¿«ï¼Œæ¯”å¦‚ç”¨ not exist(å­æŸ¥è¯¢ä»ç„¶å¯ä»¥ç”¨ç´¢å¼•æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨) æ›¿ä»£ not inï¼ˆç´¢å¼•å¤±æ•ˆï¼Œå› ä¸ºéœ€è¦éå†åˆ¤æ–­ï¼‰æ€§èƒ½æ›´å¥½ã€‚\n\n\nâ—SQL ä¼˜åŒ–\n\n\né€šè¿‡æ…¢ SQL æ—¥å¿—æŸ¥è¯¢\n\n\n\n\néœ€è¦æ‰‹åŠ¨å¼€å¯æ…¢æ—¥å¿—å¼€å…³ï¼š\n\n\n-- æŸ¥çœ‹æ…¢æ—¥å¿—æ˜¯å¦å¼€å¯show variables like &#x27;slow_query_log&#x27;;-- å¼€å¯MySQLæ…¢æ—¥å¿—æŸ¥è¯¢å¼€å…³set global slow_query_log = 1;-- è®¾ç½®æ…¢æ—¥å¿—çš„æ—¶é—´ä¸º2ç§’ï¼ŒSQLè¯­å¥æ‰§è¡Œæ—¶é—´è¶…è¿‡2ç§’ï¼Œå°±ä¼šè§†ä¸ºæ…¢æŸ¥è¯¢ï¼Œè®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—set global long_query_time = 2;\n\n\næŸ¥çœ‹æ…¢æ—¥å¿—è®°å½•çš„ sql\n\n\nshow global status like &#x27;slow_queries&#x27;; -- æŸ¥çœ‹æœ‰å¤šå°‘æ…¢æŸ¥è¯¢ show variables like &#x27;%slow_query%&#x27;; -- è·å–æ…¢æ—¥å¿—ç›®å½•\n\n\nä½¿ç”¨explainå‘½ä»¤æ¥æŸ¥çœ‹è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼Œå®ƒå¯ä»¥æ˜¾ç¤ºæ•°æ®åº“å¼•æ“å¯¹äº SQL è¯­å¥çš„æ‰§è¡Œçš„è¯¦ç»†æƒ…å†µï¼ŒåŒ…å«æ˜¯å¦ä½¿ç”¨ç´¢å¼•ï¼Œä½¿ç”¨ä»€ä¹ˆç´¢å¼•ï¼Œä½¿ç”¨çš„ç´¢å¼•çš„ç›¸å…³ä¿¡æ¯ç­‰ï¼Œå…·ä½“çš„åˆ¤æ–­å‚æ•°å¦‚ä¸‹ï¼š\n\n\n\n\n\nid\nselect_type\ntable\ntype\npossible_keys\nkey\nkey_len\nref\nrows\nExtra\n\n\n\nid ï¼šè¡¨ç¤ºæŸ¥è¯¢ä¸­å„ä¸ªå­æŸ¥è¯¢çš„æ‰§è¡Œé¡ºåºï¼Œid å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œã€‚\nSelect_typeï¼šæ¯ä¸ªå­æŸ¥è¯¢çš„æŸ¥è¯¢ç±»å‹ã€‚\n\n\nSIMPLEï¼šä¸åŒ…å«ä»»ä½•å­æŸ¥è¯¢æˆ– unionï¼ˆå…¨é“¾æ¥ï¼‰ç­‰æŸ¥è¯¢ã€‚\n\n\nPRIMARYï¼šåŒ…å«å­æŸ¥è¯¢çš„æœ€å¤–å±‚æŸ¥è¯¢æ˜¾ç¤ºä¸º PRIMARYã€‚\n\n\nSUBQUERYï¼šåœ¨ select æˆ– where å­—å¥ä¸­åŒ…å«çš„æŸ¥è¯¢ã€‚\n\n\nDERIVEDï¼šfrom å­—å¥ä¸­åŒ…å«çš„æŸ¥è¯¢ã€‚\n\n\nUNIONï¼šå‡ºç°åœ¨ union åçš„æŸ¥è¯¢è¯­å¥ä¸­ã€‚\n\n\nUNION RESULTï¼šä» UNION ä¸­è·å–ç»“æœé›†ã€‚\n\n\ntableï¼šæ˜¾ç¤ºå…·ä½“å¯¹åº”çš„è¡¨ã€‚\ntypeï¼ˆå¾ˆé‡è¦ï¼‰ï¼šæŸ¥çœ‹æœ‰æ²¡æœ‰èµ°ç´¢å¼•ï¼ŒåŠè®¿é—®ç±»å‹ã€‚\n\n\nALL æ‰«æå…¨è¡¨æ•°æ®\n\n\nindex éå†ç´¢å¼•\n\n\nrange ç´¢å¼•èŒƒå›´æŸ¥æ‰¾\n\n\nindex_subquery åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ ref\n\n\nunique_subquery åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ eq_ref\n\n\nref_or_null å¯¹ Null è¿›è¡Œç´¢å¼•çš„ä¼˜åŒ–çš„ ref\n\n\nfulltext ä½¿ç”¨å…¨æ–‡ç´¢å¼•\n\n\nref ä½¿ç”¨éå”¯ä¸€ç´¢å¼•æŸ¥æ‰¾æ•°æ®\n\n\neq_ref åœ¨ join æŸ¥è¯¢ä¸­ä½¿ç”¨ PRIMARY KEY or UNIQUE NOT NULL ç´¢å¼•å…³è”ã€‚\n\n\npossible_keys ï¼šå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•ï¼Œæ³¨æ„ä¸ä¸€å®šä¼šä½¿ç”¨ã€‚æŸ¥è¯¢æ¶‰åŠåˆ°çš„å­—æ®µä¸Šè‹¥å­˜åœ¨ç´¢å¼•ï¼Œåˆ™è¯¥ç´¢å¼•å°†è¢«åˆ—å‡ºæ¥ã€‚å½“è¯¥åˆ—ä¸º NULL æ—¶å°±è¦è€ƒè™‘å½“å‰çš„ SQL æ˜¯å¦éœ€è¦ä¼˜åŒ–äº†ã€‚\nkey ï¼šæ˜¾ç¤º MySQL åœ¨æŸ¥è¯¢ä¸­å®é™…ä½¿ç”¨çš„ç´¢å¼•ï¼Œè‹¥æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼Œæ˜¾ç¤ºä¸º NULLã€‚\n\n\nTIPSï¼šæŸ¥è¯¢ä¸­è‹¥ä½¿ç”¨äº†è¦†ç›–ç´¢å¼• (è¦†ç›–ç´¢å¼•ï¼šç´¢å¼•çš„æ•°æ®è¦†ç›–äº†éœ€è¦æŸ¥è¯¢çš„æ‰€æœ‰æ•°æ®)ï¼Œåˆ™è¯¥ç´¢å¼•ä»…å‡ºç°åœ¨ key åˆ—è¡¨ä¸­ã€‚\n\n\nkey_lengthï¼šç´¢å¼•é•¿åº¦\nrefï¼šè¡¨ç¤ºä¸Šè¿°è¡¨çš„è¿æ¥åŒ¹é…æ¡ä»¶ï¼Œå³å“ªäº›åˆ—æˆ–å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼\nrowsï¼šè¿”å›ä¼°ç®—çš„ç»“æœé›†æ•°ç›®ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå‡†ç¡®çš„å€¼ã€‚\nåœºæ™¯é¢˜\nå¦‚æœåœ¨å®é™…å·¥ä½œä¸­å‘ç° MySQL æ•°æ®åº“ CPU é£™å‡åˆ° 500%ï¼Œè¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ\n\n\nå…ˆç”¨æ“ä½œç³»ç»Ÿå‘½ä»¤ top å‘½ä»¤æŸ¥çœ‹æƒ…å†µï¼›\n\n\nå¦‚æœæ˜¯ mysql é€ æˆçš„ï¼Œå°±ç”¨ show processlist è¯­å¥çœ‹ä¸€ä¸‹ MySQL å®ä¾‹çš„è¿æ¥æƒ…å†µï¼Œå…¶ä¸­ state åˆ—å¯ä»¥æ˜¾ç¤ºä½¿ç”¨å½“å‰è¿æ¥çš„ SQL è¯­å¥çš„çŠ¶æ€ï¼Œtime æ˜¾ç¤ºè¿™ä¸ªçŠ¶æ€æŒç»­çš„æ—¶é—´ï¼Œinfo æ˜¾ç¤ºæ­£åœ¨æ‰§è¡Œçš„è¯­å¥ï¼›\n\n\næ‰¾åˆ°å¯èƒ½æœ‰é—®é¢˜çš„ SQL è¯­å¥åï¼Œå†é€šè¿‡ explain æ‰§è¡Œè®¡åˆ’çœ‹çœ‹å®ƒçš„ç´¢å¼•æƒ…å†µã€‚\n\n\né’ˆå¯¹å…·ä½“æƒ…å†µåšç›¸åº”çš„ä¼˜åŒ–ã€‚\n\n\nâ—åœ¨ä¸€ä¸ªåƒä¸‡çº§çš„æ•°æ®åº“æŸ¥å¯»ä¸­ï¼Œå¦‚ä½•æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Ÿåˆ†åˆ«è¯´å‡ºåœ¨æ•°æ®åº“è®¾è®¡ã€SQL è¯­å¥ã€java ç­‰å±‚é¢çš„è§£å†³æ–¹æ¡ˆã€‚(ä¸€å…±ä¸‰ä¸ªæ–¹é¢  æ•°æ®åº“è®¾è®¡æ–¹é¢ï¼ŒSql è¯­å¥æ–¹é¢ï¼Œjava æ–¹é¢)\n\n\næ•°æ®åº“è®¾è®¡æ–¹é¢ï¼š\n\nå¯¹æŸ¥è¯¢è¿›è¡Œä¼˜åŒ–ï¼Œåº”å°½é‡é¿å…å…¨è¡¨æ‰«æï¼Œé¦–å…ˆåº”è€ƒè™‘åœ¨ where åŠ order by æ¶‰åŠçš„åˆ—ä¸Šå»ºç«‹ç´¢å¼•ã€‚\nåº”å°½é‡é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œ null å€¼åˆ¤æ–­ï¼Œå¦åˆ™å°†å¯¼è‡´å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œå¦‚ï¼š select id from t where num is null å¯ä»¥åœ¨ num ä¸Šè®¾ç½®é»˜è®¤å€¼ 0ï¼Œç¡®ä¿è¡¨ä¸­ num åˆ—æ²¡æœ‰ null å€¼ï¼Œç„¶åè¿™æ ·æŸ¥è¯¢ï¼š select id from t where num=0\nå¹¶ä¸æ˜¯æ‰€æœ‰ç´¢å¼•å¯¹æŸ¥è¯¢éƒ½æœ‰æ•ˆï¼ŒSQL æ˜¯æ ¹æ®è¡¨ä¸­æ•°æ®æ¥è¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–çš„ï¼Œå½“ç´¢å¼•åˆ—æœ‰å¤§é‡æ•°æ®é‡å¤æ—¶ï¼ŒæŸ¥è¯¢å¯èƒ½ä¸ä¼šå»åˆ©ç”¨ç´¢å¼•ï¼Œå¦‚ä¸€è¡¨ä¸­æœ‰å­—æ®µ sexï¼Œmaleã€female å‡ ä¹å„ä¸€åŠï¼Œé‚£ä¹ˆå³ä½¿åœ¨ sex ä¸Šå»ºäº†ç´¢å¼•ä¹Ÿå¯¹æŸ¥è¯¢æ•ˆç‡èµ·ä¸äº†ä½œç”¨ã€‚\nç´¢å¼•å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œç´¢å¼•å›ºç„¶å¯ä»¥æé«˜ç›¸åº”çš„ select çš„æ•ˆç‡ï¼Œä½†åŒæ—¶ä¹Ÿé™ä½äº† insert åŠ update çš„æ•ˆç‡ï¼Œå› ä¸º insert æˆ– update æ—¶æœ‰å¯èƒ½ä¼šé‡å»ºç´¢å¼•ï¼Œæ‰€ä»¥æ€æ ·å»ºç´¢å¼•éœ€è¦æ…é‡è€ƒè™‘ï¼Œè§†å…·ä½“æƒ…å†µè€Œå®šã€‚ä¸€ä¸ªè¡¨çš„ç´¢å¼•æ•°æœ€å¥½ä¸è¦è¶…è¿‡ 6 ä¸ªï¼Œè‹¥å¤ªå¤šåˆ™åº”è€ƒè™‘ä¸€äº›ä¸å¸¸ä½¿ç”¨åˆ°çš„åˆ—ä¸Šå»ºçš„ç´¢å¼•æ˜¯å¦æœ‰å¿…è¦ã€‚\nåº”å°½å¯èƒ½çš„é¿å…æ›´æ–°ç´¢å¼•æ•°æ®åˆ—ï¼Œå› ä¸ºç´¢å¼•æ•°æ®åˆ—çš„é¡ºåºå°±æ˜¯è¡¨è®°å½•çš„ç‰©ç†å­˜å‚¨é¡ºåºï¼Œä¸€æ—¦è¯¥åˆ—å€¼æ”¹å˜å°†å¯¼è‡´æ•´ä¸ªè¡¨è®°å½•çš„é¡ºåºçš„è°ƒæ•´ï¼Œä¼šè€—è´¹ç›¸å½“å¤§çš„èµ„æºã€‚è‹¥åº”ç”¨ç³»ç»Ÿéœ€è¦é¢‘ç¹æ›´æ–°ç´¢å¼•æ•°æ®åˆ—ï¼Œé‚£ä¹ˆéœ€è¦è€ƒè™‘æ˜¯å¦åº”å°†è¯¥ç´¢å¼•å»ºä¸ºç´¢å¼•ã€‚\nå°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µï¼Œè‹¥åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µå°½é‡ä¸è¦è®¾è®¡ä¸ºå­—ç¬¦å‹ï¼Œè¿™ä¼šé™ä½æŸ¥è¯¢å’Œè¿æ¥çš„æ€§èƒ½ï¼Œå¹¶ä¼šå¢åŠ å­˜å‚¨å¼€é”€ã€‚ è¿™æ˜¯å› ä¸ºå¼•æ“åœ¨å¤„ç†æŸ¥è¯¢å’Œè¿æ¥æ—¶ä¼šé€ä¸ªæ¯”è¾ƒå­—ç¬¦ä¸²ä¸­æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œå¯¹äºæ•°å­—å‹è€Œè¨€åªéœ€è¦æ¯”è¾ƒä¸€æ¬¡å°±å¤Ÿäº†ã€‚\nå°½å¯èƒ½çš„ä½¿ç”¨ varchar/nvarchar ä»£æ›¿ char/nchar ï¼Œå› ä¸ºé¦–å…ˆå˜é•¿å­—æ®µå­˜å‚¨ç©ºé—´å°ï¼Œå¯ä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œå…¶æ¬¡å¯¹äºæŸ¥è¯¢æ¥è¯´ï¼Œåœ¨ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„å­—æ®µå†…æœç´¢æ•ˆç‡æ˜¾ç„¶è¦é«˜äº›ã€‚\nå°½é‡ä½¿ç”¨è¡¨å˜é‡æ¥ä»£æ›¿ä¸´æ—¶è¡¨ã€‚å¦‚æœè¡¨å˜é‡åŒ…å«å¤§é‡æ•°æ®ï¼Œè¯·æ³¨æ„ç´¢å¼•éå¸¸æœ‰é™ï¼ˆåªæœ‰ä¸»é”®ç´¢å¼•ï¼‰ã€‚\né¿å…é¢‘ç¹åˆ›å»ºå’Œåˆ é™¤ä¸´æ—¶è¡¨ï¼Œä»¥å‡å°‘ç³»ç»Ÿè¡¨èµ„æºçš„æ¶ˆè€—ã€‚\nä¸´æ—¶è¡¨å¹¶ä¸æ˜¯ä¸å¯ä½¿ç”¨ï¼Œé€‚å½“åœ°ä½¿ç”¨å®ƒä»¬å¯ä»¥ä½¿æŸäº›ä¾‹ç¨‹æ›´æœ‰æ•ˆï¼Œä¾‹å¦‚ï¼Œå½“éœ€è¦é‡å¤å¼•ç”¨å¤§å‹è¡¨æˆ–å¸¸ç”¨è¡¨ä¸­çš„æŸä¸ªæ•°æ®é›†æ—¶ã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸€æ¬¡æ€§äº‹ä»¶ï¼Œæœ€å¥½ä½¿ç”¨å¯¼å‡ºè¡¨ã€‚\nåœ¨æ–°å»ºä¸´æ—¶è¡¨æ—¶ï¼Œå¦‚æœä¸€æ¬¡æ€§æ’å…¥æ•°æ®é‡å¾ˆå¤§ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ select into ä»£æ›¿ create tableï¼Œé¿å…é€ æˆå¤§é‡ logï¼Œä»¥æé«˜é€Ÿåº¦ï¼›å¦‚æœæ•°æ®é‡ä¸å¤§ï¼Œä¸ºäº†ç¼“å’Œç³»ç»Ÿè¡¨çš„èµ„æºï¼Œåº”å…ˆ create tableï¼Œç„¶å insertã€‚\nå¦‚æœä½¿ç”¨åˆ°äº†ä¸´æ—¶è¡¨ï¼Œåœ¨å­˜å‚¨è¿‡ç¨‹çš„æœ€ååŠ¡å¿…å°†æ‰€æœ‰çš„ä¸´æ—¶è¡¨æ˜¾å¼åˆ é™¤ï¼Œå…ˆ truncate table ï¼Œç„¶å drop table ï¼Œè¿™æ ·å¯ä»¥é¿å…ç³»ç»Ÿè¡¨çš„è¾ƒé•¿æ—¶é—´é”å®šã€‚\n\n\n\nSQL è¯­å¥æ–¹é¢ï¼š\n\nåº”å°½é‡é¿å…åœ¨ where å­å¥ä¸­ä½¿ç”¨ != æˆ– &lt;&gt; æ“ä½œç¬¦ï¼Œå¦åˆ™å°†å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æã€‚\nåº”å°½é‡é¿å…åœ¨ where å­å¥ä¸­ä½¿ç”¨ or æ¥è¿æ¥æ¡ä»¶ï¼Œå¦åˆ™å°†å¯¼è‡´å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œselect id from t where num=10 or num=20 å¯ä»¥è¿™æ ·æŸ¥è¯¢ï¼š select id from t where num=10 union all select id from t where num=20\nin å’Œ not in ä¹Ÿè¦æ…ç”¨ï¼Œå¦åˆ™ä¼šå¯¼è‡´å…¨è¡¨æ‰«æï¼Œå¦‚ï¼š select id from t where num in(1,2,3) å¯¹äºè¿ç»­çš„æ•°å€¼ï¼Œèƒ½ç”¨ between å°±ä¸è¦ç”¨ in äº†ï¼š select id from t where num between 1 and 3\nä¸‹é¢çš„æŸ¥è¯¢ä¹Ÿå°†å¯¼è‡´å…¨è¡¨æ‰«æï¼š select id from t where name like â€˜%abc%â€™\nå¦‚æœåœ¨ where å­å¥ä¸­ä½¿ç”¨å‚æ•°ï¼Œä¹Ÿä¼šå¯¼è‡´å…¨è¡¨æ‰«æã€‚å› ä¸º SQL åªæœ‰åœ¨è¿è¡Œæ—¶æ‰ä¼šè§£æå±€éƒ¨å˜é‡ï¼Œä½†ä¼˜åŒ–ç¨‹åºä¸èƒ½å°†è®¿é—®è®¡åˆ’çš„é€‰æ‹©æ¨è¿Ÿåˆ°è¿è¡Œæ—¶ï¼›å®ƒå¿…é¡»åœ¨ç¼–è¯‘æ—¶è¿›è¡Œé€‰æ‹©ã€‚ç„¶è€Œï¼Œå¦‚æœåœ¨ç¼–è¯‘æ—¶å»ºç«‹è®¿é—®è®¡åˆ’ï¼Œå˜é‡çš„å€¼è¿˜æ˜¯æœªçŸ¥çš„ï¼Œå› è€Œæ— æ³•ä½œä¸ºç´¢å¼•é€‰æ‹©çš„è¾“å…¥é¡¹ã€‚å¦‚ä¸‹é¢è¯­å¥å°†è¿›è¡Œå…¨è¡¨æ‰«æï¼š select id from t where num=@numã€‚å¯ä»¥æ”¹ä¸ºå¼ºåˆ¶æŸ¥è¯¢ä½¿ç”¨ç´¢å¼•ï¼š select id from t with(index(ç´¢å¼•å)) where num=@num\nåº”å°½é‡é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œè¡¨è¾¾å¼æ“ä½œï¼Œè¿™å°†å¯¼è‡´å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æã€‚select id from t where num/2=100 åº”æ”¹ä¸º: select id from t where num=100*2\nåº”å°½é‡é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œå‡½æ•°æ“ä½œï¼Œè¿™å°†å¯¼è‡´å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æã€‚å¦‚ï¼š select id from t where substring(name,1,3)=â€™abcâ€™â€“name ä»¥ abc å¼€å¤´çš„ id select id from t where datediff(day,createdate,â€™2005-11-30â€²)=0â€“â€˜2005-11-30â€™ ç”Ÿæˆçš„ id åº”æ”¹ä¸º: select id from t where name like â€˜abc%â€™ select id from t where createdate&gt;=â€™2005-11-30â€² and createdate&lt;â€™2005-12-1â€²\nä¸è¦åœ¨ where å­å¥ä¸­çš„ = å·¦è¾¹è¿›è¡Œå‡½æ•°ã€ç®—æœ¯è¿ç®—æˆ–å…¶ä»–è¡¨è¾¾å¼è¿ç®—ï¼Œå¦åˆ™ç³»ç»Ÿå°†å¯èƒ½æ— æ³•æ­£ç¡®ä½¿ç”¨ç´¢å¼•ã€‚\nå¾ˆå¤šæ—¶å€™ç”¨ exists ä»£æ›¿ in æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼š select num from a where num in(select num from b)ã€‚ ç”¨ä¸‹é¢çš„è¯­å¥æ›¿æ¢ï¼š select num from a where exists(select 1 from b where num=a.num)\nä»»ä½•åœ°æ–¹éƒ½ä¸è¦ä½¿ç”¨ select * from t ï¼Œç”¨å…·ä½“çš„å­—æ®µåˆ—è¡¨ä»£æ›¿ *ï¼Œä¸è¦è¿”å›ç”¨ä¸åˆ°çš„ä»»ä½•å­—æ®µã€‚\nå°½é‡é¿å…ä½¿ç”¨æ¸¸æ ‡ï¼Œå› ä¸ºæ¸¸æ ‡çš„æ•ˆç‡è¾ƒå·®ï¼Œå¦‚æœæ¸¸æ ‡æ“ä½œçš„æ•°æ®è¶…è¿‡ 1 ä¸‡è¡Œï¼Œé‚£ä¹ˆå°±åº”è¯¥è€ƒè™‘æ”¹å†™ã€‚\nå°½é‡é¿å…å‘å®¢æˆ·ç«¯è¿”å›å¤§æ•°æ®é‡ï¼Œè‹¥æ•°æ®é‡è¿‡å¤§ï¼Œåº”è¯¥è€ƒè™‘ç›¸åº”éœ€æ±‚æ˜¯å¦åˆç†ã€‚\nå°½é‡é¿å…å¤§äº‹åŠ¡æ“ä½œï¼Œæé«˜ç³»ç»Ÿå¹¶å‘èƒ½åŠ›ã€‚\n\n\n\njava æ–¹é¢ï¼š\n\nå°½å¯èƒ½çš„å°‘é€ å¯¹è±¡ã€‚\nåˆç†æ‘†æ­£ç³»ç»Ÿè®¾è®¡çš„ä½ç½®ã€‚å¤§é‡æ•°æ®æ“ä½œï¼Œå’Œå°‘é‡æ•°æ®æ“ä½œä¸€å®šæ˜¯åˆ†å¼€çš„ã€‚å¤§é‡çš„æ•°æ®æ“ä½œï¼Œè‚¯å®šä¸æ˜¯ ORM æ¡†æ¶æå®šçš„ã€‚\nä½¿ç”¨ JDBC é“¾æ¥æ•°æ®åº“æ“ä½œæ•°æ®\næ§åˆ¶å¥½å†…å­˜ï¼Œè®©æ•°æ®æµèµ·æ¥ï¼Œè€Œä¸æ˜¯å…¨éƒ¨è¯»åˆ°å†…å­˜å†å¤„ç†ï¼Œè€Œæ˜¯è¾¹è¯»å–è¾¹å¤„ç†ï¼›\nåˆç†åˆ©ç”¨å†…å­˜ï¼Œæœ‰çš„æ•°æ®è¦ç¼“å­˜\n\n\n\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡"]},{"title":"é¢è¯• MQ","url":"/posts/a872196e/","content":"\n\nå‰è¨€\nâ—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24-08-22 åˆå§‹è®°å½•\n\nä½ çŸ¥é“ç›®å‰å¸‚é¢ä¸Šä½¿ç”¨çš„ MQ æœ‰å“ªäº›å—ï¼Ÿ\nRabbitMQã€RocketMQã€Kafkaã€‚\nä½ ä½¿ç”¨çš„æ˜¯å“ªç§ MQï¼Ÿä¸ºä»€ä¹ˆé€‰æ‹©è¿™ç±» MQ(qps)ï¼Ÿ\næˆ‘ä»¬é€‰ç”¨çš„æ˜¯ RabbitMQï¼Œå®ƒå¹¶å‘èƒ½åŠ›å¼ºï¼Œæ€§èƒ½å¥½ï¼Œå»¶æ—¶ä½ï¼Œç®¡ç†ç•Œé¢ä¹Ÿå¾ˆä¸°å¯Œï¼Œåªæ˜¯ååé‡è¾ƒä½ï¼Œä½†å¯¹äºä¸æ˜¯ç‰¹åˆ«ä¾èµ–å¤§æ•°æ®çš„é¡¹ç›®æ¥è¯´ï¼Œé€‰ç”¨ RabbitMQ å·²ç»è¶³å¤Ÿç”¨äº†ã€‚\nRocketMQ æ˜¯é˜¿é‡Œå¼€æºé¡¹ç›®ï¼Œååé‡æ˜¯æœ€é«˜çš„ï¼ˆ10 ä¸‡æ¬¡çº§ï¼‰ï¼Œä½†å…è´¹ç‰ˆçš„ MQ æ˜¯é˜‰å‰²ç‰ˆçš„ï¼Œå®¹æ˜“å‡ºé—®é¢˜ã€‚\nKafka ååé‡å¾ˆå¤§ï¼ˆ10 ä¸‡æ¬¡çº§ï¼‰ï¼Œä½†å®ƒä¸æ˜¯çœŸæ­£çš„ MQï¼Œåªæ˜¯ç±»ä¼¼ MQ çš„äº§å“ï¼Œå®ƒåªæ”¯æŒä¸»è¦ MQ åŠŸèƒ½ï¼Œæ¯”å¦‚å®ƒä¸å…·æœ‰æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ã€‚\nä»€ä¹ˆæ˜¯ RabbitMQï¼Ÿ\nRabbitMQ æ˜¯ä¸€æ¬¾å¼€æºçš„ï¼ŒErlang ç¼–å†™çš„ï¼ŒåŸºäº AMQP åè®®çš„æ¶ˆæ¯ä¸­é—´ä»¶ã€‚\nä»€ä¹ˆæ˜¯ AMQP åè®®ï¼Ÿ\nAMQP ä¸€ä¸ªæä¾›ç»Ÿä¸€æ¶ˆæ¯æœåŠ¡çš„åº”ç”¨å±‚æ ‡å‡†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—çš„é“¾æ¥åè®®ï¼ŒRabbitMQ æ˜¯ä¸»è¦æ ¹æ® AMQP åè®®è¿›è¡Œæ•°æ®é€šä¿¡å’Œä¼ è¾“çš„ã€‚æœ‰ç‚¹ç±»ä¼¼äº HTTP åè®®ã€‚\nAMPQ ä¸ JMS æœ‰ä»€ä¹ˆåŒºåˆ«çŸ¥é“å—ï¼Ÿ\nJMS æ˜¯å®šä¹‰äº†ç»Ÿä¸€çš„æ¥å£ï¼ˆAPIï¼‰ï¼Œæ¥å¯¹æ¶ˆæ¯æ“ä½œè¿›è¡Œç»Ÿä¸€ï¼›AMQP æ˜¯é€šè¿‡è§„å®šåè®®æ¥ç»Ÿä¸€æ•°æ®äº¤äº’çš„æ ¼å¼ã€‚\nJMS é™å®šäº†å¿…é¡»ä½¿ç”¨ Java è¯­è¨€ï¼›AMQP åªæ˜¯åè®®ï¼Œä¸è§„å®šå®ç°æ–¹å¼ï¼Œå› æ­¤æ˜¯è·¨è¯­è¨€çš„ã€‚\nJMS è§„å®šäº†ä¸¤ç§æ¶ˆæ¯æ¨¡å¼ï¼›è€Œ AMQP çš„æ¶ˆæ¯æ¨¡å¼æ›´åŠ ä¸°å¯Œã€‚\nä½ ä½¿ç”¨çš„æ˜¯ SpringCloudï¼ŒFeign å¯ä»¥è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä¸­é—´åŠ ä¸€ä¸ª MQ å‘¢ï¼Ÿ\nä¸ºäº†è§£è€¦ï¼Œå¦‚æœæ²¡æœ‰ä¸­é—´ä»¶è¿›è¡Œå¤„ç†ï¼Œé‚£ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´çš„å…³ç³»è¿‡äºç´§å¯†ï¼Œä¸€æ–¹æ”¹åŠ¨ï¼Œå¦ä¸€æ–¹ä¹Ÿå¿…é¡»æ”¹åŠ¨ã€‚\nMQ æœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ\n\n\nåº”ç”¨è§£è€¦ï¼ˆæ ¸å¿ƒï¼‰ï¼šé™ä½ç³»ç»Ÿçš„è€¦åˆæ€§ï¼Œæå‡å¯ç»´æŠ¤æ€§ã€‚\nåœºæ™¯ï¼šæœåŠ¡è°ƒç”¨ä¹‹é—´éƒ½å¯ä»¥è€ƒè™‘ MQã€‚\n\n\nå¼‚æ­¥æé€Ÿï¼šæå‡ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿååé‡ã€‚\nåœºæ™¯ï¼šå‘é€è®¢å•æ¶ˆæ¯ã€å‘é€çŸ­ä¿¡æ¶ˆæ¯ç­‰ã€‚\n\n\nå‰Šå³°å¡«è°·ï¼šå‡å°‘é«˜å³°æ—¶æœŸå¯¹æœåŠ¡å™¨çš„å‹åŠ›ã€‚\nåœºæ™¯ï¼šç§’æ€æ´»åŠ¨ã€é™æ—¶å®šè´­ç­‰ã€‚\n\n\nRabbitMQ æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ\n\n\nç³»ç»Ÿå¯ç”¨æ€§é™ä½\næœ¬æ¥ç³»ç»Ÿè¿è¡Œå¥½å¥½çš„ï¼Œç°åœ¨ä½ éè¦åŠ å…¥ä¸ªæ¶ˆæ¯é˜Ÿåˆ—è¿›å»ï¼Œé‚£æ¶ˆæ¯é˜Ÿåˆ—æŒ‚äº†ï¼Œä½ çš„ç³»ç»Ÿä¸æ˜¯å‘µå‘µäº†ã€‚å› æ­¤ï¼Œç³»ç»Ÿå¯ç”¨æ€§ä¼šé™ä½ã€‚\n\n\nç³»ç»Ÿå¤æ‚åº¦æé«˜\nåŠ å…¥äº†æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¦å¤šè€ƒè™‘å¾ˆå¤šæ–¹é¢çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šä¸€è‡´æ€§é—®é¢˜ã€å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹ã€å¦‚ä½•ä¿è¯æ¶ˆæ¯å¯é æ€§ä¼ è¾“ç­‰ã€‚å› æ­¤ï¼Œéœ€è¦è€ƒè™‘çš„ä¸œè¥¿æ›´å¤šï¼Œå¤æ‚æ€§å¢å¤§ã€‚\n\n\nä¸€è‡´æ€§é—®é¢˜\nA ç³»ç»Ÿå¤„ç†å®Œäº†ç›´æ¥è¿”å›æˆåŠŸäº†ï¼Œäººéƒ½ä»¥ä¸ºä½ è¿™ä¸ªè¯·æ±‚å°±æˆåŠŸäº†ï¼›ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œè¦æ˜¯ BCD ä¸‰ä¸ªç³»ç»Ÿé‚£é‡Œï¼ŒBD ä¸¤ä¸ªç³»ç»Ÿå†™åº“æˆåŠŸäº†ï¼Œç»“æœ C ç³»ç»Ÿå†™åº“å¤±è´¥äº†ï¼Œå’‹æ•´ï¼Ÿä½ è¿™æ•°æ®å°±ä¸ä¸€è‡´äº†ã€‚\n\n\næ¶ˆæ¯é¡ºåºé—®é¢˜\nå¦‚æœæœ‰ Aã€B ä¸¤ä¸ªæ¶ˆæ¯ï¼ŒB æ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ¶ˆè´¹çš„å‰ææ˜¯ A æ¶ˆæ¯å·²è¢«æ‰§è¡Œï¼Œè¿™æ—¶å€™å°±ä¸èƒ½å…ˆæ‰§è¡Œ Bï¼Œå¾—å…ˆæ‰§è¡Œ A æ‰è¡Œã€‚\n\n\né‚£æ€ä¹ˆè§£å†³ä»¥ä¸Šç¼ºç‚¹å‘¢ï¼Ÿ\n\n\nç³»ç»Ÿå¯ç”¨æ€§é™ä½ï¼šé›†ç¾¤æ¨¡å¼ä¿è¯é«˜å¯ç”¨ã€‚\né•œåƒé›†ç¾¤æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼ï¼Œæ‰æ˜¯æ‰€è°“çš„ RabbitMQ çš„é«˜å¯ç”¨æ¨¡å¼ã€‚è·Ÿæ™®é€šé›†ç¾¤æ¨¡å¼ä¸ä¸€æ ·çš„æ˜¯ï¼Œåœ¨é•œåƒé›†ç¾¤æ¨¡å¼ä¸‹ï¼Œä½ åˆ›å»ºçš„ queueï¼Œæ— è®ºå…ƒæ•°æ®è¿˜æ˜¯ queue é‡Œçš„æ¶ˆæ¯éƒ½ä¼šå­˜åœ¨äºå¤šä¸ªå®ä¾‹ä¸Šï¼Œå°±æ˜¯è¯´ï¼Œæ¯ä¸ª RabbitMQ èŠ‚ç‚¹éƒ½æœ‰è¿™ä¸ª queue çš„ä¸€ä¸ªå®Œæ•´é•œåƒï¼ŒåŒ…å« queue çš„å…¨éƒ¨æ•°æ®çš„æ„æ€ã€‚ç„¶åæ¯æ¬¡ä½ å†™æ¶ˆæ¯åˆ° queue çš„æ—¶å€™ï¼Œéƒ½ä¼šè‡ªåŠ¨æŠŠæ¶ˆæ¯åŒæ­¥åˆ°å¤šä¸ªå®ä¾‹çš„ queue ä¸Šã€‚RabbitMQ æœ‰å¾ˆå¥½çš„ç®¡ç†æ§åˆ¶å°ï¼Œå°±æ˜¯åœ¨åå°æ–°å¢ä¸€ä¸ªç­–ç•¥ï¼Œè¿™ä¸ªç­–ç•¥æ˜¯é•œåƒé›†ç¾¤æ¨¡å¼çš„ç­–ç•¥ï¼ŒæŒ‡å®šçš„æ—¶å€™æ˜¯å¯ä»¥è¦æ±‚æ•°æ®åŒæ­¥åˆ°æ‰€æœ‰èŠ‚ç‚¹çš„ï¼Œä¹Ÿå¯ä»¥è¦æ±‚åŒæ­¥åˆ°æŒ‡å®šæ•°é‡çš„èŠ‚ç‚¹ï¼Œå†æ¬¡åˆ›å»º queue çš„æ—¶å€™ï¼Œåº”ç”¨è¿™ä¸ªç­–ç•¥ï¼Œå°±ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°å…¶ä»–çš„èŠ‚ç‚¹ä¸Šå»äº†ã€‚è¿™æ ·çš„è¯ï¼Œå¥½å¤„åœ¨äºï¼Œä½ ä»»ä½•ä¸€ä¸ªæœºå™¨å®•æœºäº†ï¼Œæ²¡äº‹å„¿ï¼Œå…¶å®ƒæœºå™¨ï¼ˆèŠ‚ç‚¹ï¼‰è¿˜åŒ…å«äº†è¿™ä¸ª queue çš„å®Œæ•´æ•°æ®ï¼Œåˆ«çš„ consumer éƒ½å¯ä»¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸Šå»æ¶ˆè´¹æ•°æ®ã€‚åå¤„åœ¨äºï¼Œç¬¬ä¸€ï¼Œè¿™ä¸ªæ€§èƒ½å¼€é”€ä¹Ÿå¤ªå¤§äº†å§ï¼Œæ¶ˆæ¯éœ€è¦åŒæ­¥åˆ°æ‰€æœ‰æœºå™¨ä¸Šï¼Œå¯¼è‡´ç½‘ç»œå¸¦å®½å‹åŠ›å’Œæ¶ˆè€—å¾ˆé‡ï¼RabbitMQ ä¸€ä¸ª queue çš„æ•°æ®éƒ½æ˜¯æ”¾åœ¨ä¸€ä¸ªèŠ‚ç‚¹é‡Œçš„ï¼Œé•œåƒé›†ç¾¤ä¸‹ï¼Œä¹Ÿæ˜¯æ¯ä¸ªèŠ‚ç‚¹éƒ½æ”¾è¿™ä¸ª queue çš„å®Œæ•´æ•°æ®ã€‚\n\n\nç³»ç»Ÿå¤æ‚åº¦æé«˜\nåŠ å…¥ Rabbit ç¡®å®ä¼šå¢åŠ ç³»ç»Ÿå¤æ‚åº¦ï¼Œä½† MQ çš„è§£è€¦ã€æé€Ÿã€å‰Šå³°è¿™äº›æ–¹é¢çš„æ”¶ç›Šè¶…è¿‡ç®¡ç† MQ çš„æˆæœ¬ï¼Œæ‰€ä»¥è¯¥ç”¨è¿˜å¾—ç”¨ã€‚\n\n\nä¸€è‡´æ€§é—®é¢˜\nRabbitMQ åˆ†å¸ƒå¼æ¶ˆæ¯æ˜¯æœ€ç»ˆä¸€è‡´æ€§çš„ï¼Œå³ä½¿å¯èƒ½å› ä¸ºæ¶ˆæ¯å¤±è´¥è€Œå¯¼è‡´å‰åæ¶ˆæ¯ä¸ä¸€è‡´ï¼Œä½†åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯åœ¨ä¸åŒæœåŠ¡å™¨ä¸Šçš„ï¼Œä¸èƒ½åƒç®€å•çš„æœ¬åœ°å›æ»šä¸€æ ·ï¼Œæ‰€ä»¥å®ƒé€šè¿‡å‘é€å»¶è¿Ÿæ¶ˆæ¯å’Œå®šæ—¶æ¶ˆæ¯æ¥è¿›è¡Œæ¶ˆæ¯è¡¥å¿ï¼Œä¿è¯æœ€ç»ˆæ¶ˆæ¯æ˜¯ä¸€è‡´æ€§çš„ï¼Œå³æ˜¯ä¸€ä¸ªå®Œæ•´çš„äº‹åŠ¡ã€‚\nRabbitMQ æœ¬èº«æ˜¯æœ‰äº‹åŠ¡çš„åŠŸèƒ½çš„ï¼Œä½†æ˜¯åˆ†å¸ƒå¼çš„äº‹åŠ¡å¤„ç†æ•ˆç‡å¤ªä½ï¼Œä¸”å‘ç”Ÿé—®é¢˜çš„å¯èƒ½æ€§ä¸é«˜ï¼Œæ‰€ä»¥å¤šæ˜¯é€‰æ‹©æ”¾å¼ƒå¼ºä¸€è‡´æ€§ï¼Œè€Œé‡‡ç”¨æœ€ç»ˆä¸€è‡´æ€§ã€‚\n\n\næ¶ˆæ¯é¡ºåºé—®é¢˜\nåœ¨ MQ ä¸­å°†æœ‰é¡ºåºè¦æ±‚çš„ AB ä¸¤ä¸ªæ¶ˆæ¯åˆ†åˆ«ç”¨ä¸¤ä¸ªé˜Ÿåˆ—ä¸ä¸¤ä¸ªæ¶ˆè´¹ç«¯æ‰‹å·¥ ack æ¥æ”¶ï¼Œå¹¶ä¸”åœ¨æ¶ˆæ¯ä¸Šéœ€è¦æœ‰å¯¹åº”çš„åŒç»„ç¼–å·ä¿¡æ¯ï¼Œä»¥åŠå‘é€æ¬¡æ•°ï¼Œå¦‚æœ B æ‰§è¡Œçš„å‰ææ˜¯å·²ç»æ¶ˆè´¹äº† Aï¼Œé‚£éœ€è¦åœ¨æ¶ˆè´¹ç«¯åˆ¤æ–­ A æ¶ˆæ¯æ˜¯å¦å·²ç»æ­£ç¡®æ¥æ”¶ï¼ˆä¹Ÿå°±æ˜¯æŸ¥è¯¢æˆåŠŸçš„æ¶ˆæ¯åº“ï¼‰ã€‚å¦‚æœ A å·²ç»æ¶ˆè´¹æˆåŠŸï¼Œåˆ™æ¶ˆè´¹ Bï¼Œå¦‚æœ A æ¶ˆè´¹å¤±è´¥ï¼Œæˆ–è€… A è¿˜æ²¡æœ‰æ¶ˆè´¹ï¼Œåˆ™ B æ¶ˆæ¯ä¹Ÿç›´æ¥è¿”å›ä¸ºæ¶ˆæ¯å¤±è´¥ï¼Œå¹¶ä¸”ä¸é‡å›é˜Ÿåˆ—ã€‚å¹¶ä¸”è®©æ¶ˆæ¯æä¾›æ–¹é‡æ–°å‘é€ AB æ¶ˆæ¯ï¼Œå¦‚æœè¿ç»­ä¸‰æ¬¡å‘é€æ¶ˆæ¯ä»ç„¶æ¶ˆè´¹å¤±è´¥ï¼Œåˆ™ AB ä¸¤ä¸ªæ¶ˆæ¯ç¬¬å››æ¬¡å¤„ç†æ—¶å°±æ‰”å…¥æ­»ä¿¡é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…äººå·¥å¤„ç†ã€‚\n\n\nRabbitMQ äº‹åŠ¡æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\näº‹åŠ¡çš„å®ç°ä¸»è¦æ˜¯å¯¹ä¿¡é“ï¼ˆChannelï¼‰çš„è®¾ç½®ï¼Œä¸»è¦çš„æ–¹æ³•æœ‰ä¸‰ä¸ªï¼š\n\n\nchannel.txSelect() å£°æ˜å¯åŠ¨äº‹åŠ¡æ¨¡å¼ï¼›\n\n\nchannel.txComment() æäº¤äº‹åŠ¡ï¼›\n\n\nchannel.txRollback() å›æ»šäº‹åŠ¡ï¼›\n\n\nRabbitMQ çš„å®ç°åŸç†æ˜¯æ€ä¹ˆæ ·å­çš„ï¼Ÿ\né¦–å…ˆï¼Œæ¶ˆæ¯æä¾›æ–¹ä¼šå’Œ RabbitMQ ä¹‹é—´å»ºç«‹èµ· TCP è¿æ¥ï¼ˆConnectionï¼‰ï¼Œæ¯ä¸ªè¿æ¥ä¸­ä¼šæœ‰å¤šä¸ªé€šä¿¡çš„ä¿¡é“ï¼ˆchannelï¼‰æ¥æè¿é€šä¿¡æ•ˆç‡ï¼Œä¸åŒçš„ä¿¡é“ä¹‹é—´é€šè¿‡ä¿¡é“ id æ¥å®ç°ä¿¡æ¯éš”ç¦»ã€‚\nè€Œåœ¨ RabbitMQ ä¸­ï¼Œæ¶ˆæ¯æä¾›è€…å‘å‡ºçš„æ¶ˆæ¯ä¼šå…ˆåˆ° RabbitMQ ä¸­çš„äº¤æ¢æœºä¸­ï¼Œç”±äº¤æ¢æœºæ ¹æ®åˆ†å‘è§„åˆ™ï¼Œé€šè¿‡é˜Ÿåˆ—çš„å½¢å¼åˆ†å‘æ¶ˆæ¯ã€‚\næ¶ˆæ¯æ¥æ”¶æ–¹ä¸ RabbitMQ ä¹‹é—´ä¹Ÿä¸€æ ·æ˜¯é€šè¿‡ TCP è¿æ¥å’Œä¿¡é“å»ºç«‹è¿æ¥å’Œé€šä¿¡ã€‚\næ­¤å¤–ï¼Œåœ¨ RabbitMQ ä¸­ï¼Œäº¤æ¢æœºä¸é˜Ÿåˆ—ä¹‹é—´ä¸åŒçš„è¾¹æ¥æ–¹å¼ï¼Œä¹Ÿäº§ç”Ÿäº†ä¸åŒçš„å·¥ä½œæ¨¡å¼ã€‚\nRabbitMQ æœ‰å“ªäº›å·¥ä½œæ¨¡å¼ï¼Ÿ\n\n\nç®€å•æ¨¡å¼ï¼šå°±æ˜¯ä¸é€šè¿‡äº¤æ¢æœºï¼Œæ¶ˆæ¯ç›´æ¥é€šè¿‡é˜Ÿåˆ—ï¼Œä¸€å¯¹ä¸€æ”¶å‘ã€‚\n\n\nå·¥ä½œé˜Ÿåˆ—æ¨¡å¼ï¼šä¹Ÿæ˜¯ä¸é€šè¿‡äº¤æ¢æœºï¼Œæ¶ˆæ¯ç›´æ¥é€šè¿‡é˜Ÿåˆ—ï¼Œåªæ˜¯ä¸€ä¸ªå‘é€æ–¹å¯ä»¥æœ‰å¤šä¸ªæ¥æ”¶ç«¯ã€‚\n\n\nå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼šç”±äº¤æ¢æœºåˆ†å‘æ¶ˆæ¯åˆ°ä¸åŒé˜Ÿåˆ—ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…åªç›‘å¬è‡ªå·±çš„é˜Ÿåˆ—ã€‚\n\n\nè·¯ç”±æ¨¡å¼ï¼šç”±äº¤æ¢æœºåˆ†å‘æ¶ˆæ¯ï¼Œä½†æ˜¯å‘é€æ–¹éœ€è¦æŒ‡å®šè·¯ç”± keyï¼Œäº¤æ¢æœºä¼šæ ¹æ®ä¸åŒçš„ routing key åˆ†å‘ç»™ä¸åŒçš„é˜Ÿåˆ—ï¼Œæ¶ˆè´¹æ–¹å¯¹åº”è‡ªå·±éœ€è¦çš„é˜Ÿåˆ—ã€‚\n\n\né€šé…ç¬¦æ¨¡å¼ï¼šå’Œè·¯ç”±æ¨¡å¼æœ‰äº›ç›¸è¿‘ï¼Œåªæ˜¯é€šé…ç¬¦æ¨¡å¼å¯ä»¥åœ¨ç»‘å®š routing key æ—¶ä½¿ç”¨é€šé…ç¬¦ã€‚\n\n\nRPC æ¨¡å¼ï¼šRPC è¿œç¨‹è°ƒç”¨æ¨¡å¼ï¼Œä¸¥æ ¼æ¥è¯´ä¸å¤ªç®—æ˜¯ MQã€‚\n\n\nä¸ºä»€ä¹ˆ RPC ä¸¥æ ¼æ¥è¯´ä¸èƒ½ç®—æ˜¯ MQï¼Ÿ\nRPCï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œå®é™…ä¸Šæ˜¯ä¸€ç§æŠ€æœ¯æ€æƒ³ï¼Œè€Œä¸€ç§è§„èŒƒæˆ–åè®®ï¼Œä¸€èˆ¬æ¥è¯´ RPC è¿œç¨‹è°ƒç”¨æ˜¯åŒæ­¥é€šä¿¡çš„ï¼Œä¸” RPC æ¨¡å¼æ˜¯æ²¡æœ‰é˜Ÿåˆ—çš„ï¼Œå¤šç”¨åœ¨ç«‹å³ç­‰å¾…è¿”å›å¤„ç†ç»“æœçš„åœºæ™¯ï¼Œæ¯”å¦‚ä½¿ç”¨åŸºäº RPC æ€æƒ³çš„ Dubboã€‚è€Œ MQ æ˜¯ç”¨æ¥å¼‚æ­¥æé€Ÿçš„ï¼Œæ‰€ä»¥ä¸¥æ ¼æ¥è¯´ï¼ŒRPC æ¨¡å¼ä¸èƒ½ç®—æ˜¯ MQã€‚\næ¶ˆæ¯æ€ä¹ˆè·¯ç”±ï¼Ÿ\n\n\næ¶ˆæ¯æä¾›æ–¹ -&gt;è·¯ç”± -&gt;ä¸€è‡³å¤šä¸ªé˜Ÿåˆ—æ¶ˆæ¯å‘å¸ƒåˆ°äº¤æ¢å™¨æ—¶ï¼Œæ¶ˆæ¯å°†æ‹¥æœ‰ä¸€ä¸ªè·¯ç”±é”®ï¼ˆrouting keyï¼‰ï¼Œåœ¨æ¶ˆæ¯åˆ›å»ºæ—¶è®¾å®šã€‚é€šè¿‡é˜Ÿåˆ—è·¯ç”±é”®ï¼Œå¯ä»¥æŠŠé˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢å™¨ä¸Šã€‚æ¶ˆæ¯åˆ°è¾¾äº¤æ¢å™¨åï¼ŒRabbitMQ ä¼šå°†æ¶ˆæ¯çš„è·¯ç”±é”®ä¸é˜Ÿåˆ—çš„è·¯ç”±é”®è¿›è¡ŒåŒ¹é…ï¼ˆé’ˆå¯¹ä¸åŒçš„äº¤æ¢å™¨æœ‰ä¸åŒçš„è·¯ç”±è§„åˆ™ï¼‰ï¼›\n\n\nå¸¸ç”¨çš„äº¤æ¢å™¨ä¸»è¦åˆ†ä¸ºä¸€ä¸‹ä¸‰ç§ï¼š\n\nfanoutï¼šå¦‚æœäº¤æ¢å™¨æ”¶åˆ°æ¶ˆæ¯ï¼Œå°†ä¼šå¹¿æ’­åˆ°æ‰€æœ‰ç»‘å®šçš„é˜Ÿåˆ—ä¸Šã€‚\ndirectï¼šå¦‚æœè·¯ç”±é”®å®Œå…¨åŒ¹é…ï¼Œæ¶ˆæ¯å°±è¢«æŠ•é€’åˆ°ç›¸åº”çš„é˜Ÿåˆ—ã€‚\ntopicï¼šå¯ä»¥ä½¿æ¥è‡ªä¸åŒæºå¤´çš„æ¶ˆæ¯èƒ½å¤Ÿåˆ°è¾¾åŒä¸€ä¸ªé˜Ÿåˆ—ã€‚ ä½¿ç”¨ topic äº¤æ¢å™¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ã€‚\n\n\n\næ¶ˆæ¯åŸºäºä»€ä¹ˆä¼ è¾“ï¼Ÿ\nç”±äº TCP è¿æ¥çš„åˆ›å»ºå’Œé”€æ¯å¼€é”€è¾ƒå¤§ï¼Œä¸”å¹¶å‘æ•°å—ç³»ç»Ÿèµ„æºé™åˆ¶ï¼Œä¼šé€ æˆæ€§èƒ½ç“¶é¢ˆã€‚RabbitMQ ä½¿ç”¨ä¿¡é“çš„æ–¹å¼æ¥ä¼ è¾“æ•°æ®ã€‚ä¿¡é“æ˜¯å»ºç«‹åœ¨çœŸå®çš„ TCP è¿æ¥å†…çš„è™šæ‹Ÿè¿æ¥ï¼Œä¸”æ¯æ¡ TCP è¿æ¥ä¸Šçš„ä¿¡é“æ•°é‡æ²¡æœ‰é™åˆ¶ã€‚\nRabbitMQ ä¸­çš„äº¤æ¢æœºå¯ä»¥å‚¨å­˜æ¶ˆæ¯å—ï¼Ÿ\nä¸å¯ä»¥ã€‚äº¤æ¢æœºåªè´Ÿè´£è½¬å‘æ¶ˆæ¯ï¼Œä¸å…·å¤‡å­˜å‚¨æ¶ˆæ¯çš„èƒ½åŠ›ã€‚\nå¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±å‘¢ï¼Ÿ\n\n\nåœ¨ç”Ÿäº§è€…ä¸¢å¤±â€”â€”confirm ç¡®è®¤æ¨¡å¼\n\nä½¿ç”¨ RabbitMQ äº‹åŠ¡æœºåˆ¶ï¼Œä½†å®ƒæ˜¯åŒæ­¥çš„ï¼Œä¸”å¾ˆè€—æ€§èƒ½ã€‚\nå¼€å¯ confirm ç¡®è®¤æ¨¡å¼ï¼Œç¡®è®¤æ¶ˆæ¯æ˜¯å¦ä»â€œç”Ÿäº§è€…â€å‘é€åˆ°â€œäº¤æ¢æœºâ€ï¼ŒæˆåŠŸå›ä¼  ack æ¶ˆæ¯ï¼Œå¤±è´¥å¯ä»¥é‡è¯•æˆ–æŠ›å¼‚å¸¸ã€‚ä¸” confirm æ¨¡å¼æ˜¯å¼‚æ­¥å›è°ƒæ¥å£é€šçŸ¥ MQ æ˜¯å¦æ¥æ”¶åˆ°æ¶ˆæ¯ã€‚ä¸€èˆ¬éƒ½é‡‡ç”¨è¿™ç§æ–¹å¼ã€‚\n\n\n\nåœ¨ MQ ä¸­ä¸¢å¤±â€”â€”æŒä¹…åŒ–\n\nå¼€å¯ RabbitMQ æŒä¹…åŒ–ï¼Œé˜²æ­¢ RabbitMQ è‡ªå·±å¼„ä¸¢æ•°æ®ã€‚é™¤éæå°æ¦‚ç‡è¿˜æ²¡æ¥å¾—åŠæŒä¹…åŒ–ï¼ŒMQ å°±å…ˆæŒ‚äº†ï¼Œå³ä½¿è¿™æ ·ï¼Œä¹Ÿåªä¼šä¸¢å¤±æå°‘çš„æ•°æ®é‡ã€‚\næ‰€ä»¥ï¼ŒæŒä¹…åŒ–å¯ä»¥è·Ÿç”Ÿäº§è€…é‚£è¾¹çš„ confirm æœºåˆ¶é…åˆèµ·æ¥ï¼Œåªæœ‰æ¶ˆæ¯è¢«æŒä¹…åŒ–åˆ°ç£ç›˜ä¹‹åï¼Œæ‰ä¼šé€šçŸ¥ç”Ÿäº§è€… ack äº†ï¼Œæ‰€ä»¥å“ªæ€•æ˜¯åœ¨æŒä¹…åŒ–åˆ°ç£ç›˜ä¹‹å‰ï¼ŒRabbitMQ æŒ‚äº†ï¼Œæ•°æ®ä¸¢äº†ï¼Œç”Ÿäº§è€…æ”¶ä¸åˆ° ackï¼Œä½ ä¹Ÿæ˜¯å¯ä»¥è‡ªå·±é‡å‘çš„ã€‚\nä½†æŒä¹…åŒ–çš„è¿‡ç¨‹ä¹Ÿæ˜¯å¾ˆè€—æ€§èƒ½çš„ã€‚\n\n\n\nåœ¨æ¶ˆè´¹è€…ä¸¢å¤±â€”â€”ack æœºåˆ¶\n\nç”¨ RabbitMQ æä¾›çš„ ack æœºåˆ¶ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä½ å¿…é¡»å…³é—­ RabbitMQ çš„è‡ªåŠ¨ ackï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ª api æ¥è°ƒç”¨å°±è¡Œï¼Œç„¶åæ¯æ¬¡ä½ è‡ªå·±ä»£ç é‡Œç¡®ä¿å¤„ç†å®Œçš„æ—¶å€™ï¼Œå†åœ¨ç¨‹åºé‡Œ ack ä¸€æŠŠã€‚è¿™æ ·çš„è¯ï¼Œå¦‚æœä½ è¿˜æ²¡å¤„ç†å®Œï¼Œä¸å°±æ²¡æœ‰ ack äº†ï¼Ÿé‚£ RabbitMQ å°±è®¤ä¸ºä½ è¿˜æ²¡å¤„ç†å®Œï¼Œè¿™ä¸ªæ—¶å€™ RabbitMQ ä¼šæŠŠè¿™ä¸ªæ¶ˆè´¹åˆ†é…ç»™åˆ«çš„ consumer å»å¤„ç†ï¼Œæ¶ˆæ¯æ˜¯ä¸ä¼šä¸¢çš„ã€‚ä»¥ä¸Šä¸‰ç§æ–¹å¼ï¼Œåªæ˜¯é˜²æ­¢ä¸¢å¤±ï¼Œä½†å…·ä½“è¡¥æ¶ˆæ¯ï¼Œè¿˜éœ€è¦é æ¶ˆæ¯çš„è¡¥å¿æœºåˆ¶ï¼ˆä¹Ÿå°±æ˜¯æ¶ˆæ¯çš„å¯é æ€§ä¿è¯ï¼‰ã€‚\n\n\n\nâ—RabbitMQ å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§å‘¢ï¼Ÿ\næ¶ˆæ¯è¡¥å¿ã€‚ï¼ˆå»¶è¿Ÿæ¶ˆæ¯ + å®šæ—¶æ‰«æï¼‰\n\n\nç”±ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ç»™ MQï¼ŒMQ ä¼šå°†æ¶ˆæ¯ç»™åˆ°æ¶ˆè´¹è€…ï¼Œæ¶ˆæ¯è€…æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè¿”å›ä¸€ä¸ªæ¶ˆæ¯ç¡®è®¤ï¼Œè¿™ä¸ªâ€œæ¶ˆæ¯ç¡®è®¤â€ä¼šè¢« MQ æ”¾åˆ°â€œå›è°ƒæ£€æŸ¥æœåŠ¡â€ä¸­ï¼Œâ€œå›è°ƒæ£€æŸ¥æœåŠ¡â€ä¼šå°†æ”¶åˆ°çš„æ¶ˆæ¯ç»™åˆ°å®šæ—¶æ£€æŸ¥çš„ MDBã€‚\n\n\nä½†åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸æˆ–è€…ç½‘ç»œæ³¢åŠ¨ï¼Œå°±ä¼šå¯¼è‡´æ¶ˆæ¯åˆ°ä¸äº†å›è°ƒæ£€æŸ¥æœåŠ¡ï¼Œæ‰€ä»¥ä¸ºäº†ä¿è¯èƒ½å¤Ÿæ¶ˆæ¯å¯é æ€§ï¼Œä¼šç”±ç”Ÿäº§è€…å»¶è¿Ÿä¸€æ®µæ—¶é—´åï¼Œå†å‘é€ä¸€ä¸ªç›¸åŒçš„æ¶ˆæ¯ç»™ MQï¼Œè¿™ä¸ªæ¶ˆæ¯ä¼šç›´æ¥è¢« MQ å‘é€åˆ°å›è°ƒæ£€æŸ¥æœåŠ¡ã€‚\n\n\nå›è°ƒæ£€æŸ¥æœåŠ¡ä¼šå°†å»¶è¿Ÿå‘é€çš„æ¶ˆæ¯å’Œ MDB ä¸­çš„æ¶ˆæ¯å¯¹æ¯”ï¼Œå¦‚æœ MDB ä¸­æ²¡æœ‰è¯¥æ¶ˆæ¯ï¼Œå°±ä¼šè°ƒç”¨ç”Ÿäº§è€…ï¼Œè®©ç”Ÿäº§è€…é‡æ–°å‘é€æ¶ˆæ¯ã€‚\n\n\nä½†åœ¨ä»¥ä¸Šè¿‡ç¨‹ï¼Œè¿˜å¯èƒ½å‡ºç°â€œå»¶è¿Ÿå‘é€æ¶ˆæ¯â€ä¹Ÿå‡ºé—®é¢˜ï¼Œä¸ºäº†æ›´æ·±å±‚ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Œè¿˜éœ€è¦ä¸€ä¸ªå®šæ—¶æ£€æŸ¥æœåŠ¡ï¼Œæ¯éš”ä¸€æ®µå›ºå®šæ—¶é—´ï¼Œå®šæ—¶æ£€æŸ¥æœåŠ¡ä¼šå°† MDB é‡Œçš„æ¶ˆæ¯å’Œ DB ä¸­çš„æ¶ˆæ¯è¿›è¡ŒåŒ¹é…ï¼ˆæ£€æŸ¥æŸä¸ªæ—¶é—´æ®µçš„è¡¨ï¼Œè€Œä¸æ˜¯å…¨è¡¨æ‰«æï¼‰ï¼Œå¦‚æœæœ‰ MDB ç¼ºå¤±çš„æ¶ˆæ¯ï¼Œå°±ä¼šè°ƒç”¨ç”Ÿäº§è€…é‡æ–°å‘é€æ¶ˆæ¯ã€‚\n\n\nä»€ä¹ˆæ˜¯ TTLï¼Ÿä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼Œæ¶ˆæ¯æˆä¸ºæ­»ä¿¡æœ‰å“ªå‡ ç§æƒ…å†µï¼Ÿä»€ä¹ˆæ˜¯å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\n\n\nTTLï¼šå…¨ç§° Time To Liveï¼ˆå­˜æ´»æ—¶é—´/è¿‡æœŸæ—¶é—´ï¼‰\n\nå¦‚æœç»™æ¶ˆæ¯è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå³ä½¿åˆ°äº†è¿‡æœŸæ—¶é—´ï¼Œæ¶ˆæ¯ä¹Ÿä¸ä¼šç«‹é©¬è¢«æ¸…é™¤ï¼Œåªæœ‰ç­‰æ¶ˆæ¯åˆ°äº†é˜Ÿåˆ—çš„å¤´ä¸Šï¼Œæ‰ä¼šè¢«åˆ¤æ–­æ˜¯å¦è¿‡æœŸæ¸…é™¤ã€‚\nå¦‚æœç»™æ•´ä¸ªé˜Ÿåˆ—è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå³æ¯ä¸€ä¸ªè¿›å…¥é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼Œéƒ½ä¼šå„è‡ªè¢«è®¾ç½®ä¸ºäº†ç›¸åŒçš„è¿‡æœŸæ—¶é—´ã€‚è€Œéæ•´ä¸ªé˜Ÿåˆ—å®šæ—¶éš”ä¸€æ®µæ—¶é—´æ¸…é™¤ã€‚\nå¦‚æœå•ç‹¬æ¶ˆæ¯å’Œæ•´ä¸ªé˜Ÿåˆ—ä¸¤åˆ™éƒ½è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œä»¥æ—¶é—´çŸ­çš„ä¸ºå‡†ã€‚\n\n\n\næ­»ä¿¡é˜Ÿåˆ—ï¼šè‹±æ–‡ç¼©å†™ï¼šDLXÂ  ã€‚Dead Letter Exchangeï¼ˆæ­»ä¿¡äº¤æ¢æœºï¼‰\n\næ¶ˆæ¯æˆä¸ºæ­»ä¿¡çš„ä¸‰ç§æƒ…å†µï¼š\n\né˜Ÿåˆ—æ¶ˆæ¯é•¿åº¦åˆ°è¾¾é™åˆ¶ï¼›\næ¶ˆè´¹è€…æ‹’æ¥æ¶ˆè´¹æ¶ˆæ¯ï¼ŒbasicNack/basicReject,å¹¶ä¸”ä¸æŠŠæ¶ˆæ¯é‡æ–°æ”¾å…¥åŸç›®æ ‡é˜Ÿåˆ—ï¼Œrequeue=falseï¼›\nåŸé˜Ÿåˆ—å­˜åœ¨æ¶ˆæ¯è¿‡æœŸè®¾ç½®ï¼Œæ¶ˆæ¯åˆ°è¾¾è¶…æ—¶æ—¶é—´æœªè¢«æ¶ˆè´¹ï¼›\n\n\n\n\n\nå»¶è¿Ÿé˜Ÿåˆ—ï¼šå³æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—åä¸ä¼šç«‹å³è¢«æ¶ˆè´¹ï¼Œåªæœ‰åˆ°åˆ°è¾¾æŒ‡å®šæ—¶é—´åï¼Œæ‰ä¼šè¢«æ¶ˆè´¹ã€‚\n\nRabbitMQ ä¸­å¹¶æœªæä¾›å»¶è¿Ÿé˜Ÿåˆ—åŠŸèƒ½ï¼Œé‡‡ç”¨ã€TTLã€‘+ã€æ­»ä¿¡é˜Ÿåˆ—ã€‘ ç»„åˆå®ç°å»¶è¿Ÿé˜Ÿåˆ—çš„æ•ˆæœã€‚\n\n\n\næœ‰å‡ ç™¾ä¸‡æ¶ˆæ¯æŒç»­ç§¯å‹å‡ å°æ—¶ï¼Œè¯´è¯´æ€ä¹ˆè§£å†³ï¼Ÿ\næ¶ˆæ¯ç§¯å‹å¤„ç†åŠæ³•ï¼šä¸´æ—¶ç´§æ€¥æ‰©å®¹ï¼š\nå…ˆä¿®å¤ consumer çš„é—®é¢˜ï¼Œç¡®ä¿å…¶æ¢å¤æ¶ˆè´¹é€Ÿåº¦ï¼Œç„¶åå°†ç°æœ‰ consumer éƒ½åœæ‰ã€‚\nä¸´æ—¶å»ºç«‹å¥½åŸå…ˆ 10 å€çš„ queue æ•°é‡ã€‚\nç„¶åå†™ä¸€ä¸ªä¸´æ—¶çš„åˆ†å‘æ•°æ®çš„ consumer ç¨‹åºï¼Œè¿™ä¸ªç¨‹åºéƒ¨ç½²ä¸Šå»æ¶ˆè´¹ç§¯å‹çš„æ•°æ®ï¼Œæ¶ˆè´¹ä¹‹åä¸åšè€—æ—¶çš„å¤„ç†ï¼Œç›´æ¥å‡åŒ€è½®è¯¢å†™å…¥ä¸´æ—¶å»ºç«‹å¥½çš„ 10 å€æ•°é‡çš„ queueã€‚\næ¥ç€ä¸´æ—¶å¾ç”¨ 10 å€çš„æœºå™¨æ¥éƒ¨ç½² consumerï¼Œæ¯ä¸€æ‰¹ consumer æ¶ˆè´¹ä¸€ä¸ªä¸´æ—¶ queue çš„æ•°æ®ã€‚è¿™ç§åšæ³•ç›¸å½“äºæ˜¯ä¸´æ—¶å°† queue èµ„æºå’Œ consumer èµ„æºæ‰©å¤§ 10 å€ï¼Œä»¥æ­£å¸¸çš„ 10 å€é€Ÿåº¦æ¥æ¶ˆè´¹æ•°æ®ã€‚\nç­‰å¿«é€Ÿæ¶ˆè´¹å®Œç§¯å‹æ•°æ®ä¹‹åï¼Œå¾—æ¢å¤åŸå…ˆéƒ¨ç½²çš„æ¶æ„ï¼Œé‡æ–°ç”¨åŸå…ˆçš„ consumer æœºå™¨æ¥æ¶ˆè´¹æ¶ˆæ¯ã€‚\næ¶ˆæ¯é˜Ÿåˆ—æ»¡äº†ä»¥åè¯¥æ€ä¹ˆå¤„ç†\næ²¡åŠæ³•äº†ï¼Œè¯´æ˜ç´§æ€¥æ‰©å®¹ä¹Ÿæ¥ä¸åŠäº†ï¼Œåªèƒ½â€œä¸¢å¼ƒ + æ‰¹é‡é‡å¯¼â€äº†ï¼Œå†™ç¨‹åºå¿«é€Ÿæ¶ˆè´¹ï¼Œç„¶åé‡å¯¼ã€‚\nRabbitMQ å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„ä¸é‡å¤æ¶ˆè´¹å‘¢ï¼Ÿã€é‡è¦ã€‘\nä¸€æ¡æ•°æ®é‡å¤å‡ºç°ä¸¤æ¬¡ï¼Œæ•°æ®åº“é‡Œå°±åªæœ‰ä¸€æ¡æ•°æ®ï¼Œè¿™å°±æ˜¯ä¿è¯äº†ç³»ç»Ÿçš„å¹‚ç­‰æ€§ã€‚\nä¿éšœäº†æ¶ˆæ¯çš„å¹‚ç­‰æ€§ï¼ŒåŒä¸€æ¡æ¶ˆæ¯è¢«é‡å¤æ¶ˆè´¹ä¹Ÿå°±ä¸å½±å“äº†ï¼Œå› ä¸ºä¸å½±å“æœ€ç»ˆæ‰§è¡Œç»“æœã€‚\n\n\næ–¹æ³•ä¸€ï¼šé‡‡ç”¨ä¹è§‚é”æœºåˆ¶ä¿è¯æ¶ˆæ¯å¹‚ç­‰æ€§ã€‚åœ¨æ•°æ®åº“ä¸­ä¼šå¢åŠ ä¸€ä¸ªç‰ˆæœ¬å­—æ®µï¼Œæ‰§è¡Œæ—¶ä¹Ÿä¼šåŒ¹é…ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬ä¸ä¸€è‡´ï¼ŒSQL è¯­å¥çš„åŒ¹é…å°±ä¸æˆç«‹ï¼Œå°±ä¸ä¼šæ‰§è¡Œã€‚\n\n\næ–¹æ³•äºŒï¼šä½ æ‹¿åˆ°è¿™ä¸ªæ¶ˆæ¯åšæ•°æ®åº“çš„ insert æ“ä½œï¼Œé‚£å°±å®¹æ˜“äº†ï¼Œç»™è¿™ä¸ªæ¶ˆæ¯åšä¸€ä¸ªå”¯ä¸€çš„ä¸»é”®ï¼Œé‚£ä¹ˆå°±ç®—å‡ºç°é‡å¤æ¶ˆè´¹çš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´ä¸»é”®å†²çªï¼Œé¿å…æ•°æ®åº“å‡ºç°è„æ•°æ®ã€‚\n\n\næ–¹æ³•ä¸‰ï¼šä½ æ‹¿åˆ°è¿™ä¸ªæ¶ˆæ¯åš redis çš„ set çš„æ“ä½œï¼Œé‚£å°±å®¹æ˜“äº†ï¼Œä¸ç”¨è§£å†³ï¼Œå› ä¸ºä½ æ— è®º set å‡ æ¬¡ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œset æ“ä½œæœ¬æ¥å°±ç®—å¹‚ç­‰æ“ä½œã€‚\n\n\næ–¹æ³•å››ï¼šå¦‚æœä¸Šé¢ä¸¤ç§æƒ…å†µè¿˜ä¸è¡Œï¼Œä¸Šå¤§æ‹›ã€‚å‡†å¤‡ä¸€ä¸ªç¬¬ä¸‰æ–¹ä»‹è´¨ï¼Œæ¥åšæ¶ˆè´¹è®°å½•ã€‚ä»¥ redis ä¸ºä¾‹ï¼Œç»™æ¶ˆæ¯åˆ†é…ä¸€ä¸ªå…¨å±€ idï¼Œåªè¦æ¶ˆè´¹è¿‡è¯¥æ¶ˆæ¯ï¼Œå°† &lt;id,message&gt; ä»¥ K-V å½¢å¼å†™å…¥ redisã€‚é‚£æ¶ˆè´¹è€…å¼€å§‹æ¶ˆè´¹å‰ï¼Œå…ˆå» redis ä¸­æŸ¥è¯¢æœ‰æ²¡æœ‰æ¶ˆè´¹è®°å½•å³å¯ï¼Œå…ˆæ ¹æ®è¿™ä¸ª id å»æ¯”å¦‚ redis é‡ŒæŸ¥ä¸€ä¸‹ï¼Œä¹‹å‰æ¶ˆè´¹è¿‡å—ï¼Ÿå¦‚æœæ²¡æœ‰æ¶ˆè´¹è¿‡ï¼Œä½ å°±å¤„ç†ï¼Œç„¶åè¿™ä¸ª id å†™ redisã€‚å¦‚æœæ¶ˆè´¹è¿‡äº†ï¼Œé‚£ä½ å°±åˆ«å¤„ç†äº†ï¼Œä¿è¯åˆ«é‡å¤å¤„ç†ç›¸åŒçš„æ¶ˆæ¯å³å¯ã€‚\n\n\nå¦‚ä½•è§£å†³æ¶ˆæ¯é˜Ÿåˆ—çš„å»¶æ—¶ä»¥åŠè¿‡æœŸå¤±æ•ˆé—®é¢˜ï¼Ÿ\nå‡è®¾ä½ ç”¨çš„æ˜¯ RabbitMQï¼ŒRabbtiMQ æ˜¯å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´çš„ï¼Œä¹Ÿå°±æ˜¯ TTLã€‚å¦‚æœæ¶ˆæ¯åœ¨ queue ä¸­ç§¯å‹è¶…è¿‡ä¸€å®šçš„æ—¶é—´å°±ä¼šè¢« RabbitMQ ç»™æ¸…ç†æ‰ï¼Œè¿™ä¸ªæ•°æ®å°±æ²¡äº†ã€‚è¿™å°±ä¸æ˜¯è¯´æ•°æ®ä¼šå¤§é‡ç§¯å‹åœ¨ mq é‡Œï¼Œè€Œæ˜¯å¤§é‡çš„æ•°æ®ä¼šç›´æ¥æä¸¢ã€‚\næˆ‘ä»¬å¯ä»¥é‡‡å–ä¸€ä¸ªæ–¹æ¡ˆï¼Œå°±æ˜¯æ‰¹é‡é‡å¯¼ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¹‹å‰çº¿ä¸Šä¹Ÿæœ‰ç±»ä¼¼çš„åœºæ™¯å¹²è¿‡ã€‚å°±æ˜¯å¤§é‡ç§¯å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å½“æ—¶å°±ç›´æ¥ä¸¢å¼ƒæ•°æ®äº†ï¼Œç„¶åç­‰è¿‡äº†é«˜å³°æœŸä»¥åï¼Œæ¯”å¦‚å¤§å®¶ä¸€èµ·å–å’–å•¡ç†¬å¤œåˆ°æ™šä¸Š 12 ç‚¹ä»¥åï¼Œç”¨æˆ·éƒ½ç¡è§‰äº†ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¼€å§‹å†™ç¨‹åºï¼Œå°†ä¸¢å¤±çš„é‚£æ‰¹æ•°æ®ï¼ˆå‘é€çš„æ•°æ®åº“å’Œç¡®è®¤æ¥æ”¶çš„æ•°æ®åº“åŒ¹é…ï¼‰ï¼Œå†™ä¸ªä¸´æ—¶ç¨‹åºï¼Œä¸€ç‚¹ä¸€ç‚¹çš„æŸ¥å‡ºæ¥ï¼Œç„¶åé‡æ–°çŒå…¥ mq é‡Œé¢å»ï¼ŒæŠŠç™½å¤©ä¸¢çš„æ•°æ®ç»™ä»–è¡¥å›æ¥ã€‚ä¹Ÿåªèƒ½æ˜¯è¿™æ ·äº†ã€‚\nå‡è®¾ 1 ä¸‡ä¸ªè®¢å•ç§¯å‹åœ¨ mq é‡Œé¢ï¼Œæ²¡æœ‰å¤„ç†ï¼Œå…¶ä¸­ 1000 ä¸ªè®¢å•éƒ½ä¸¢äº†ï¼Œä½ åªèƒ½æ‰‹åŠ¨å†™ç¨‹åºæŠŠé‚£ 1000 ä¸ªè®¢å•ç»™æŸ¥å‡ºæ¥ï¼Œæ‰‹åŠ¨å‘åˆ° mq é‡Œå»å†è¡¥ä¸€æ¬¡ã€‚\nå¦‚æœè¦ä½ è‡ªå·±è®¾è®¡ä¸€ä¸ª MQï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡ï¼Ÿ\n\n\né‡å¯èµ·ä¸€ä¸ªæœåŠ¡å™¨æ¥ï¼ˆä½¿ç”¨ Redisï¼‰å……å½“ RabbitMQï¼Œå®ç° MQ çš„è§£è€¦åŠŸèƒ½ã€‚\n\n\nè¿™ä¸ªæœåŠ¡å™¨éœ€è¦å¯ä»¥å­˜å‚¨å’Œè½¬å‘æ¶ˆæ¯ï¼Œå­˜å‚¨æ˜¯ä¸ºäº†å®ç°æ°¸ä¹…åŒ–ï¼Œé˜²æ­¢æœåŠ¡å™¨å‡ºé—®é¢˜ï¼Œæ¶ˆæ¯ä¸¢å¤±ï¼›è½¬å‘æ¶ˆæ¯åˆ™æ˜¯å¯ä»¥é€šè¿‡ä¸åŒé˜Ÿåˆ—æ¥å®ç°æŒ‡å®šæ¶ˆè´¹ç«¯ï¼Œå®ç°å¼‚æ­¥æé€ŸåŠŸèƒ½å’Œå‰Šå³°å¡«è°·çš„åŠŸèƒ½ã€‚\n\n\nå»ºç«‹æ¶ˆæ¯è¡¥å°æœºåˆ¶ï¼Œé˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ã€‚\n\n\næ€ä¹ˆä½¿ç”¨ Redis å®ç° MQ åŠŸèƒ½å‘¢ï¼Ÿ\n\n\nä½¿ç”¨ list ç±»å‹ä¿å­˜æ•°æ®ä¿¡æ¯ï¼Œrpush ç”Ÿäº§æ¶ˆæ¯ï¼Œlpop æ¶ˆè´¹æ¶ˆæ¯ï¼Œå½“ lpop æ²¡æœ‰æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥ sleep ä¸€æ®µæ—¶é—´ï¼Œç„¶åå†æ£€æŸ¥æœ‰æ²¡æœ‰ä¿¡æ¯ï¼Œå¦‚æœä¸æƒ³ sleep çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ blpop, åœ¨æ²¡æœ‰ä¿¡æ¯çš„æ—¶å€™ï¼Œä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°ä¿¡æ¯çš„åˆ°æ¥ã€‚redis å¯ä»¥é€šè¿‡ pub/sub ä¸»é¢˜è®¢é˜…æ¨¡å¼å®ç°ä¸€ä¸ªç”Ÿäº§è€…ï¼Œå¤šä¸ªæ¶ˆè´¹è€…ï¼Œå½“ç„¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„ç¼ºç‚¹ï¼Œå½“æ¶ˆè´¹è€…ä¸‹çº¿æ—¶ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ã€‚\n\n\nä½¿ç”¨ sortedsetï¼Œä½¿ç”¨æ—¶é—´æˆ³åš score, æ¶ˆæ¯å†…å®¹ä½œä¸º keyï¼Œè°ƒç”¨ zadd æ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä½¿ç”¨ zrangbyscore è·å– n ç§’ä¹‹å‰çš„æ•°æ®åšè½®è¯¢å¤„ç†ã€‚\n\n\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡"]},{"title":"ã€é¢è¯•è®°å½•ã€‘ä¸€å¹´åŠ Java","url":"/posts/a862a019/","content":"\n\nå‰è¨€è¿˜æ˜¯è£¸è¾äº†ï¼Œå¤§æ¦‚ä¼‘æ¯äº† 3 ä¸ªæœˆï¼Œç°åœ¨ç»§ç»­å‡†å¤‡é¢è¯•ã€‚å¾ˆå¤šå…«è‚¡æ–‡éƒ½å¿˜è®°äº†ã€‚åˆå¹¶äº†ä¹‹å‰åä¸º OD çš„åˆ·é¢˜è®°å½•ï¼Œç®—æ˜¯ç¬¬ä¸€æ¬¡è·³æ§½çš„é¢è¯•è®°å½•æ€»ç»“ã€‚ä¸€å…±é¢äº†ä¸‰å®¶ï¼Œè¿‡äº†ä¸¤ä¸ªï¼Œæ¨äº†å¤–åŒ…ã€‚é—²é±¼ä¸Šå’¨è¯¢äº†ä¸€ä¸‹ï¼Œæ„æ€æ˜¯è®©æˆ‘ç»§ç»­é¢ï¼Œä½†æ˜¯ä¸æƒ³é¢äº†ï¼Œè€Œä¸”è¿™è¾¹offerå·²ç»æ¥äº†ï¼Œæš‚æ—¶å°±å…ˆè¿™æ ·å§ã€‚\n\n\næ›´æ–°\n\n\n24.03.28 åä¸º OD åˆ·é¢˜è®°å½•24.08.21 åˆè‚¥è‹±æ³½ä¿¡æ¯ç§‘æŠ€ï¼ˆå¤–åŒ…ä¸­åä¿é™©ï¼‰é¢è¯•è®°å½•24.08.22 ä¸­å¾ç§‘æŠ€ã€ç½‘æ–°æ’å¤©ï¼ˆå¤–æ´¾é“å¯Œï¼‰é¢è¯•è®°å½•24.09.05 ç½‘æ–°æ’å¤©ï¼ˆå¤–æ´¾é“å¯Œï¼‰äºŒé¢è®°å½•åŠæ€»ç»“\n\nåä¸º OD\nåˆ·é¢˜è®°å½•\nä¸ºå—æœ¯ï¼ˆä¸æ˜¯ï¼‰ï¼Œå…¶å®ä¸€ç›´è§‰å¾—äºŒæœ¬æ¯•ä¸šå»è¿™è¾¹ä¹Ÿè›®å¥½çš„ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰åŠ¨åŠ›åˆ·é¢˜ã€‚ä»Šå¤©å»é¢è¯•ï¼Œå•¥ä¹Ÿæ²¡å‡†å¤‡ï¼Œå°±çœ‹äº†ä¸€å¤©æ—©å·²å¿˜è®°çš„å…«è‚¡æ–‡ï¼Œæœç„¶æŒ‚äº†ã€‚ä½†æ˜¯ Boss ä¸Šæ”¶åˆ°åä¸º OD çš„ Hr çš„æ¶ˆæ¯ï¼ˆå¥½åƒæ˜¯æœ€è¿‘çªç„¶åŠ äº†å²—ä½ï¼Ÿï¼‰ï¼Œæ€»ä¹‹çº¦äº†ä¸¤å‘¨åæœºè€ƒï¼ˆæ€ä¹ˆæ•¢çš„ï¼ŒçœŸçš„ä¸€ç‚¹éƒ½æ²¡å‡†å¤‡è¿‡ï¼‰\n240328\n\n\nHJ1Â å­—ç¬¦ä¸²æœ€åä¸€ä¸ªå•è¯çš„é•¿åº¦\n\n\næ€è·¯å±…ç„¶æ˜¯éå†ï¼Œé‡0æ¸…ç©ºè®¡æ•°ï¼ŒçœŸçš„æ²¡æƒ³åˆ°ã€‚æ˜¾å¾—æˆ‘çš„æ–¹æ³•å¾ˆç¬¨ã€‚\n\n\nHJ2Â è®¡ç®—æŸå­—ç¬¦å‡ºç°æ¬¡æ•°\n\n\nHJ3Â æ˜æ˜çš„éšæœºæ•°\n\n\nè¯­æ³•ç³–å°±è¯­æ³•ç³–å§ï¼Œæˆ‘æ”¾å¼ƒäº†\n\n\nHJ4Â å­—ç¬¦ä¸²åˆ†éš”\n\n\nHJ5Â è¿›åˆ¶è½¬æ¢\n\n\n240330\n\n\nHJ6Â è´¨æ•°å› å­\n\n\n240402\n\n\nHJ7Â å–è¿‘ä¼¼å€¼\n\n\nç”¨äº†API\n\n\nHJ8Â å–è¿‘ä¼¼å€¼\n\n\nHJ9Â æå–ä¸é‡å¤çš„æ•´æ•°\n\n\nHJ10Â å­—ç¬¦ä¸ªæ•°ç»Ÿè®¡\n\n\nHJ11Â æ•°å­—é¢ å€’\n\n\n240404ï¼ˆç‰›å®¢åä¸ºæœºè¯•é¢˜åº“ï¼‰\n\n\nHJ12Â å­—ç¬¦ä¸²åè½¬\n\n\nHJ13Â å¥å­é€†åº\n\n\n// å¿˜äº†è¿™ä¸ªAPIString.join(&quot; &quot;, strings)\n\n\nHJ14Â å­—ç¬¦ä¸²æ’åº\n\n\nHJ15Â æ±‚ int å‹æ­£æ•´æ•°åœ¨å†…å­˜ä¸­å­˜å‚¨æ—¶ 1 çš„ä¸ªæ•°\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - å¯»æ‰¾èº«é«˜ç›¸è¿‘çš„å°æœ‹å‹ï¼ˆC å·ï¼‰\n\n\n240406ï¼ˆåä¸º OD æœºè¯• 2024 å¹´æœ€æ–°é¢˜åº“ -C å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - å›´æ£‹çš„æ°”ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - ç”¨è¿ç»­è‡ªç„¶æ•°ä¹‹å’Œæ¥è¡¨è¾¾æ•´æ•°ï¼ˆC å·ï¼‰\n\n\næœ¬é¢˜ç”¨æ»‘åŠ¨çª—å£è¿›è¡Œæ±‚è§£ã€‚ä¹‹å‰éƒ½ä¸ä¼šè¿™ä¸ªã€‚æ ‡è®°ä¸€ä¸‹éœ€è¦äºŒåˆ·ã€‚\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - å¼€æºé¡¹ç›®çƒ­æ¦œï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ -API é›†ç¾¤è´Ÿè½½ç»Ÿè®¡ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æ•´æ•°å¯¹æœ€å°å’Œï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - ç´ æ•°ä¹‹ç§¯ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ -CPU ç®—åŠ›åˆ†é…ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æœ€å¤§åæ ‡å€¼ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - å¯»æ‰¾æœ€å¯Œè£•çš„å°å®¶åº­ï¼ˆC å·ï¼‰\n\n\n240407ï¼ˆåä¸º OD æœºè¯• 2024 å¹´æœ€æ–°é¢˜åº“ -C å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - åˆ†æœˆé¥¼ï¼ˆC å·ï¼‰\n\n\nä¸ä¼šï¼Œæ²¡æœ‰æ€è·¯ï¼Œå…ˆè·³è¿‡ã€‚\n240408ï¼ˆåä¸º OD æœºè¯• 2024 å¹´æœ€æ–°é¢˜åº“ -C å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æ‰¾åŸå¸‚ï¼ˆC å·ï¼‰\n\n\næ²¡æœ‰æ€è·¯ï¼Œ200åˆ†é¢˜æ‰“ç®—å‘¨æœ«å†åˆ·äº†ï¼Œå…ˆçœ‹çœ‹æœ‰æ²¡æœ‰ç±»ä¼¼çš„é¢˜è§£ã€‚\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æŸ¥æ‰¾æ¥å£æˆåŠŸç‡æœ€ä¼˜æ—¶é—´æ®µï¼ˆC å·ï¼‰\n\n\nä¸¥é‡è¶…æ—¶ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºä¸€è¾¹ä¸Šç­ä¸€è¾¹åšçš„åŸå› æ€è·¯éƒ½æ˜¯ä¹±çš„\n240409ï¼ˆåä¸º OD æœºè¯• 2024 å¹´æœ€æ–°é¢˜åº“ -C å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - åˆ†å‰²å‡è¡¡å­—ç¬¦ä¸²ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - è™šæ‹Ÿæ¸¸æˆç†è´¢ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - é è°±çš„è½¦ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æ‰§è¡Œæ—¶é•¿ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - ä¸‡èƒ½å­—ç¬¦å•è¯æ‹¼å†™ï¼ˆC å·ï¼‰\n\n\n240410ï¼ˆåä¸º OD æœºè¯• 2024 å¹´æœ€æ–°é¢˜åº“ -C å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æ¥è‡ªå¼‚å›½çš„å®¢äººï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æ±‚æœ€å¤šå¯ä»¥æ´¾å‡ºå¤šå°‘æ”¯å›¢é˜Ÿï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æœ€é•¿å­å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æœºåœºèˆªç­è°ƒåº¦ç¨‹åºï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æ•°çš„åˆ†è§£ï¼ˆC å·ï¼‰\n\n\n240411ï¼ˆåä¸º OD æœºè¯• 2024 å¹´æœ€æ–°é¢˜åº“ -C å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æ™ºèƒ½æˆç»©è¡¨ï¼ˆC å·ï¼‰\n\n\nåä¸º OD æœºè¯•çœŸé¢˜ - æå–å­—ç¬¦ä¸²ä¸­çš„æœ€é•¿æ•°å­¦è¡¨è¾¾å¼å¹¶è®¡ç®—ï¼ˆC å·ï¼‰\n\n\nä¸å¸Œæœ›è€ƒåˆ°è¿™é¢˜ã€‚æ€ä¹ˆè¿˜æœ‰æ­£åˆ™æ­£åˆ™å®åœ¨ä¸å¤ªç†Ÿï¼Œè¿™é¢˜ç¡¬è®°((+-)?(\\\\d+[+-*])*\\\\d)åˆ¤æ–­å‡ºæœ€é•¿æ­£åˆ™å¼å­ä¹‹åçš„æ€è·¯ä¸ºï¼š1ã€è®°å½•åˆå§‹åŠ å‡å·2ã€å¦‚æœæ˜¯+ï¼Œè®°å½•æ•°ä¹˜1ï¼›å¦‚æœæ˜¯-ï¼Œè®°å½•æ•°ä¹˜-1ï¼›å¦‚æœæ˜¯ä¹˜ï¼Œè·å–å‰ä¸€ä¸ªæ•°å¹¶ä¹˜å¹¶è®°å½•ä¹˜ç§¯\næœºè¯•ï¼ˆ240417ï¼‰\næ²¡è¿‡ã€‚ã€‚ã€‚293 ä½†æ˜¯è¦ 300 åˆ†ã€‚ç®—äº†ã€‚æœ¬æ¥ä¹Ÿæ²¡æŠ¥å¤šå¤§å¸Œæœ›ã€‚\nè¿˜æ˜¯å¤šåˆ·ç‚¹é¢˜å†æŠ•ç®€å†ã€‚ç°é˜¶æ®µï¼Œè¾ä¸è¾èŒéƒ½æ— æ‰€è°“äº†ï¼ˆæœ€å¥½æ˜å¤©å°±æŠŠæˆ‘è£äº†ï¼ï¼ï¼å¤§æ™šä¸Š 10 ç‚¹ç¾¤é‡Œ@äººæ˜¯ä¸æ˜¯æœ‰ç—…å•Šï¼Œåˆä¸æ˜¯ bugï¼Ÿï¼Ÿï¼Ÿï¼Ÿè° tm ç†ä½ ï¼Ÿï¼Ÿï¼Ÿï¼ï¼ï¼ï¼‰\n1 å¹´å¤šçš„ Java ç°åœ¨çœŸçš„ç‹—éƒ½å«Œï¼Œæ‰“ç®—å®åœ¨æ²¡æœ‰å»å¤„ï¼Œ6 ä¸ªæœˆä¹‹åå†è€ƒä¸€æ¬¡ï¼Œåæ­£æœ¬æ¬¡åˆ·é¢˜æ„Ÿè§‰è¿˜è¡Œï¼Œä¸æ˜¯ç‰¹åˆ«éš¾ã€‚\nåç»­\næ‰“ç®—å…ˆåˆ·ç‚¹ç®—æ³• + å…«è‚¡äº†ã€‚å®åœ¨ä¸è¡Œå•ƒç‚¹å­˜æ¬¾ï¼Œåæ­£è¿˜æ²¡è¾èŒã€‚ã€‚ã€‚\nåˆè‚¥è‹±æ³½ä¿¡æ¯ç§‘æŠ€ï¼ˆå¤–åŒ…ä¸­åä¿é™©ï¼‰\n\næ²¡æ„å¤–åº”è¯¥ä¸€é¢æŒ‚äº†ã€‚\n\nä¸€é¢\né¢è¯•å®˜äººå¾ˆå¥½ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šé—®çš„éƒ½æ˜¯å…³äºé¡¹ç›®çš„åœºæ™¯é¢˜ï¼Œè¿™æ¬¡å…³äºé¡¹ç›®çš„é¢˜ç›®ä¸€ç‚¹éƒ½æ²¡æœ‰å‡†å¤‡ï¼Œæ„Ÿè§‰åœ¨ä¹±ç­”ï¼ˆé‚£ç§åˆ†ä¸æ¸…é—®é¢˜é‡ç‚¹çš„ä¹±ç­”ï¼‰ã€‚å…«è‚¡æ–‡åªé—®äº†çº¿ç¨‹æ± çš„è¿è¡Œè¿‡ç¨‹ï¼Œä¼šï¼Œä½†æ˜¯é©¬ä¸Šå°±é—®ååºçš„ä½¿ç”¨ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰ç”¨è¿‡çš„æŠ€æœ¯æˆ‘éƒ½è¯´æ²¡æœ‰ï¼ˆåŒ…æ‹¬çº¿ç¨‹æ± ï¼Œå¾®æœåŠ¡çš„æ²»ç†ç­‰ã€‚å®åœ¨ä¸è¡Œè¿™å—å†™ä»£ç è·‘é€šäº†ç¼–ä¸€ä¸‹çœ‹çœ‹ï¼‰ã€‚\né¢è¯•é¢˜å’Œå›ç­”ç‚¹\n\n\nå…ˆé—®çº¿ç¨‹æ± è¿è¡Œé¡ºåºï¼ŒèƒŒå‡ºæ¥äº†ã€‚ç„¶åé—®çº¿ç¨‹æ± åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨ã€‚\nåœ¨æƒ³å®šè¿™ä¸ªé¡¹ç›®ä¸­ï¼Œç”¨ AOP åˆ‡é¢è¿›è¡Œäº†æ—¥å¿—çš„è®°å½•ï¼Œåœ¨æ—¥å¿—è®°å½•çš„æ—¶å€™ç”¨åˆ°äº†çº¿ç¨‹æ± ã€‚ä½¿ç”¨çš„æ˜¯å¸¸ç”¨çš„çº¿ç¨‹æ± ä¸­çš„ScheduledThreadPoolExecutorï¼ˆå®šæ—¶/å»¶æ—¶æ‰§è¡Œä»»åŠ¡ï¼‰ã€‚å¥½å¤„æ˜¯å¯ä»¥å°†æ—¥å¿—è®°å½•æ“ä½œæ”¾å…¥å•ç‹¬çš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä»è€Œé‡Šæ”¾ä¸»çº¿ç¨‹çš„èµ„æºï¼Œä½¿å…¶èƒ½å¤Ÿæ›´å¿«åœ°å¤„ç†å…¶ä»–ä»»åŠ¡ã€‚åæ­£å°±å›´ç»•è¿™ä¸ªæŠŠçº¿ç¨‹æ± å…«è‚¡æ–‡éƒ½è¯´ä¸€éï¼ŒåŒ…æ‹¬æ ¸å¿ƒçº¿ç¨‹æ•°å•¥çš„ã€‚\n\n\nè®²ä¸€ä¸‹å¾®æœåŠ¡ä½“ç³»ã€‚\nè¯´äº†æ³¨å†Œä¸­å¿ƒ Nacosï¼Œç½‘å…³ Gatewayï¼Œè¿œç¨‹è°ƒç”¨ Feignï¼Œå¾®æœåŠ¡æ²»ç†ï¼ˆæœåŠ¡é™æµ Sentinalã€åˆ†å¸ƒå¼äº‹åŠ¡ Seataï¼‰\n\n\nç„¶åé—®é¡¹ç›®ä¸­æ˜¯å¦ç”¨äº†åˆ†å¸ƒå¼äº‹åŠ¡ Seataã€‚\næ²¡æœ‰ã€‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯ä¹Ÿè¦å»ç ”ç©¶ä¸€ä¸‹\n\n\né—®ä¸ºä»€ä¹ˆè¦è¿›è¡Œå¾®æœåŠ¡æ‹†åˆ†ã€‚\né¦–å…ˆè¿™æ˜¯ä¸ªå·¥å‚é¡¹ç›®ï¼Œæ²¡æœ‰é«˜å¹¶å‘ã€‚ï¼ˆè¿™é‡Œéœ€è¦æŒ‰ç‚¹å›ç­”ï¼ï¼ï¼ï¼ï¼‰\n\næ¨¡å—åŒ–ã€‚é€šè¿‡æ‹†åˆ†æˆå¾®æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²å’Œæ‰©å±•ï¼Œæœ‰åŠ©äºå›¢é˜Ÿèšç„¦äºç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½æˆ–é¢†åŸŸã€‚\nçµæ´»æ€§å’Œå¼¹æ€§ã€‚æœåŠ¡å¯ä»¥ç‹¬ç«‹æ‰©å±•ï¼Œåªé’ˆå¯¹éœ€è¦æ›´å¤šèµ„æºçš„ç‰¹å®šæœåŠ¡è¿›è¡Œæ‰©å±•ï¼Œè€Œä¸å¿…æ‰©å±•æ•´ä¸ªåº”ç”¨ï¼Œè¿™æ ·å¯ä»¥æ›´æœ‰æ•ˆåœ°åˆ©ç”¨èµ„æºã€‚\næ•…éšœéš”ç¦»ï¼šå¦‚æœä¸€ä¸ªæœåŠ¡å¤±è´¥ï¼Œå…¶ä»–æœåŠ¡ä»ç„¶å¯ä»¥ç»§ç»­è¿è¡Œï¼Œè¿™æœ‰åŠ©äºæé«˜ç³»ç»Ÿçš„æ•´ä½“ç¨³å®šæ€§ã€‚\nè¾¹ç•Œæ¸…æ™°ï¼šå¾®æœåŠ¡ä¹‹é—´çš„è¾¹ç•Œæ¸…æ™°ï¼Œæœ‰åŠ©äºæ˜ç¡®æ¥å£å®šä¹‰å’ŒæœåŠ¡èŒè´£ã€‚\nå¯é‡ç”¨æ€§ï¼šå¾®æœåŠ¡å¯ä»¥ç‹¬ç«‹éƒ¨ç½²å’Œè¿è¡Œï¼Œæ˜“äºè¢«å…¶ä»–æœåŠ¡æˆ–åº”ç”¨é‡ç”¨ã€‚ï¼ˆè¯´ä¸€ä¸‹æ³¨å†Œå’Œè®¤è¯è¿˜æœ‰ activiti è¿™å—è°ƒå‡ºæ¥ä½¿ç”¨äº†ï¼‰\n\n\n\nNacoa ä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œæ€ä¹ˆè€ƒè™‘é«˜å¯ç”¨çš„é—®é¢˜ã€‚\nç”¨é›†ç¾¤ï¼ˆè¿™æ®µå»ºè®®èƒŒä¸€ä¸‹ Nacos é›†ç¾¤çš„ç›¸å…³é—®é¢˜ï¼‰ï¼Œåªèƒ½å›ç­”è¯´ï¼Œç›®å‰ç”¨çš„æ˜¯å•ä½“å¯åŠ¨ï¼Œç„¶åè¿ç»´ä¹Ÿæ˜¯æˆ‘è´Ÿè´£ï¼Œæ‰€ä»¥å‡ºé—®é¢˜ä¹Ÿæ˜¯æˆ‘è§£å†³ã€‚ã€‚ã€‚\n\n\nå…³äºå¾®æœåŠ¡è¿œç¨‹è°ƒç”¨é€ æˆçš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼ŒFeign è°ƒç”¨å¤±è´¥æ•°æ®ä¸ä¸€è‡´ï¼Ÿ\nå›ç­”è¯´æ²¡æœ‰é‡åˆ°è¿‡ï¼ŒæœåŠ¡è°ƒç”¨å¤±è´¥å°±æ˜¯é…ç½®äº†ä¸€ä¸ª FallbackFactoryã€‚åº”è¯¥è¿˜æ˜¯è¦é—®åˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†çš„é—®é¢˜ï¼Œå¤ªéš¾äº†å®åœ¨ä¸ä¼šã€‚\n\n\nGateway çš„ä½œç”¨ã€‚ï¼ˆå‰ä¸‰ä¸ªæ˜¯ç­”å‡ºæ¥çš„ã€åé¢çš„çœŸçš„æ²¡æœ‰ç”¨åˆ°è¿‡ã€‚åç»­é¢è¯•æ—¶çœ‹æƒ…å†µå§ï¼‰\n\nè¯·æ±‚è·¯ç”±ï¼šAPI ç½‘å…³ä½œä¸ºç³»ç»Ÿçš„å•ä¸€å…¥å£ç‚¹ï¼Œè´Ÿè´£å°†å¤–éƒ¨è¯·æ±‚è·¯ç”±åˆ°æ­£ç¡®çš„å¾®æœåŠ¡å®ä¾‹ä¸Šã€‚å®ƒå¯ä»¥åŸºäº URL è·¯å¾„ã€è¯·æ±‚å‚æ•°ã€æŠ¥å¤´ç­‰ä¿¡æ¯è¿›è¡Œè·¯ç”±å†³ç­–ã€‚\nè·¨åŸŸå¤„ç†ï¼šAPI ç½‘å…³å¯ä»¥å¤„ç†è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰é—®é¢˜ï¼Œä½¿å¾—å‰ç«¯åº”ç”¨ç¨‹åºèƒ½å¤Ÿå®‰å…¨åœ°ä¸åç«¯å¾®æœåŠ¡è¿›è¡Œé€šä¿¡ã€‚\nè®¤è¯ä¸æˆæƒï¼šAPI ç½‘å…³è´Ÿè´£å¯¹è¯·æ±‚è¿›è¡Œè®¤è¯å’Œæˆæƒï¼Œç¡®ä¿åªæœ‰åˆæ³•çš„è¯·æ±‚èƒ½å¤Ÿè®¿é—®åç«¯çš„å¾®æœåŠ¡ã€‚\nåè®®è½¬æ¢ï¼šä¸åŒå¾®æœåŠ¡å¯èƒ½ä½¿ç”¨ä¸åŒçš„é€šä¿¡åè®®ï¼ŒAPI ç½‘å…³å¯ä»¥å°†å¤–éƒ¨ä½¿ç”¨çš„åè®®ï¼ˆå¦‚ HTTP/HTTPSï¼‰è½¬æ¢ä¸ºå†…éƒ¨æœåŠ¡ä½¿ç”¨çš„åè®®ï¼ˆå¦‚ Thriftã€gRPC ç­‰ï¼‰ã€‚\nèšåˆæœåŠ¡ï¼šå½“ä¸€ä¸ªè¯·æ±‚éœ€è¦å¤šä¸ªå¾®æœåŠ¡åä½œæ‰èƒ½å®Œæˆæ—¶ï¼ŒAPI ç½‘å…³å¯ä»¥èšåˆå¤šä¸ªæœåŠ¡çš„ç»“æœï¼Œå‡å°‘å®¢æˆ·ç«¯ä¸å¤šä¸ªå¾®æœåŠ¡çš„ç›´æ¥é€šä¿¡ã€‚\né™æµä¸ç†”æ–­ï¼šä¸ºäº†ä¿æŠ¤åç«¯æœåŠ¡ï¼ŒAPI ç½‘å…³å¯ä»¥å®ç°é™æµï¼ˆé™åˆ¶è¯·æ±‚çš„é¢‘ç‡ï¼‰å’Œç†”æ–­ï¼ˆåœ¨æœåŠ¡ä¸å¯ç”¨æ—¶é˜²æ­¢ç³»ç»Ÿé›ªå´©ï¼‰ã€‚\nç›‘æ§ä¸æ—¥å¿—ï¼šAPI ç½‘å…³å¯ä»¥è®°å½•æ‰€æœ‰è¿›å…¥ç³»ç»Ÿçš„è¯·æ±‚ï¼Œå¹¶ç›‘æ§è¿™äº›è¯·æ±‚çš„å¤„ç†æ—¶é—´å’ŒçŠ¶æ€ï¼Œè¿™å¯¹äºæ•…éšœæ’æŸ¥å’Œæ€§èƒ½åˆ†æéå¸¸æœ‰ç”¨ã€‚\nç¼“å­˜ï¼šå¯¹äºæŸäº›ä¸ç»å¸¸å˜æ›´çš„æ•°æ®ï¼ŒAPI ç½‘å…³å¯ä»¥å®ç°ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘å¯¹åç«¯æœåŠ¡çš„è°ƒç”¨ï¼Œæé«˜å“åº”é€Ÿåº¦ã€‚\né™æ€èµ„æºæœåŠ¡ï¼šAPI ç½‘å…³å¯ä»¥ç”¨æ¥æœåŠ¡é™æ€èµ„æºï¼Œå¦‚ HTMLã€CSSã€JavaScript æ–‡ä»¶ç­‰ã€‚\n\n\n\næ—¢ç„¶è¯´åˆ°äº†è·¨åŸŸï¼Œè¯´ä¸€ä¸‹è·¨åŸŸçš„åŸå› ã€‚ï¼ˆğŸ˜­å¿˜è®°å‡†å¤‡äº†ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¿…é¡»è¦ä¼šçš„ï¼Œéœ€è¦æ€»ç»“ï¼‰\n\n\n\nå†…é“¾ï¼š[[è·¨åŸŸäº§ç”Ÿçš„åŸå› åŠè§£å†³æ–¹æ¡ˆ]]\nå¤–é“¾ï¼šè·¨åŸŸäº§ç”Ÿçš„åŸå› åŠè§£å†³æ–¹æ¡ˆ\n\n\n\nè¯´ä¸€ä¸‹ Gateway æ€ä¹ˆè§£å†³è·¨åŸŸé—®é¢˜ï¼ˆè¿™ä¸ªç›´æ¥èƒŒä¸€ä¸‹ï¼Œè¯´å‡ºæ¥äº†ï¼Œä½†æ˜¯è¿˜æ˜¯è¦é—®åŸå› ï¼‰\n\n\nspring:  cloud:\tgateway:  \t  globalcors:  \t    cors-configurations:  \t      &#x27;[/**]&#x27;: # åŒ¹é…æ‰€æœ‰è¯·æ±‚  \t        allowedHeaders: &quot;*&quot;  \t        allowedOrigins: &quot;*&quot; #è·¨åŸŸå¤„ç† å…è®¸æ‰€æœ‰çš„åŸŸ  \t        allowedMethods: # æ”¯æŒçš„æ–¹æ³•  \t          - GET  \t          - POST  \t          - PUT  \t          - DELETE  \t          - OPTIONS\n\n\nGateway è®¤è¯ï¼Œç”¨äº†ä»€ä¹ˆï¼ˆè€ƒè™‘è¦ä¸è¦åŠ ä¸Šä¸€äº›å¤æ‚çš„æ¡†æ¶çŸ¥è¯†ï¼‰\nè¯´äº† JWTã€‚ç»§ç»­é—® token èƒ½ä¸èƒ½è¢«ä¼ªé€ ã€‚ï¼ˆè¿™é‡Œè¦èƒŒä¹‹å‰çš„å›ç­”â—â—â—å¤ªä¹…äº†æœ‰ç‚¹å¿˜è®°äº†ï¼‰\n\n\næƒ³å®šè¿œç¨‹è°ƒç”¨çš„å›¾ç”Ÿå›¾ï¼Œæ˜¯ä»€ä¹ˆã€‚\nè¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±è¯´æ˜¯åˆ«äººéƒ¨ç½²çš„ã€‚\n\n\né—®äº†è¿™ä¸ªé¡¹ç›®ä¸»è¦è´Ÿè´£å“ªä¸€å—ã€‚å…³äºå•†åŸçš„ä¸Šæ¶æ”¯ä»˜ç­‰ä¸€ç³»åˆ—åŠŸèƒ½æ˜¯ä¸æ˜¯éƒ½å®ç°äº†ã€‚\né¢æˆ‘è¯´éƒ½æ˜¯æˆ‘è´Ÿè´£çš„ï¼Œå…¶å®ä¸‹ä¸€æ­¥åº”è¯¥è¦é—®å…·ä½“çš„ä¸šåŠ¡é€»è¾‘è®²ä¸€ä¸‹ã€‚æˆ‘è¯´æ˜¯çš„ï¼Œç„¶ååŒ…æ‹¬ H5ï¼ŒAndroid ï¼Œåå°ï¼Œä½†æ˜¯éƒ½æ˜¯å‰ç«¯æ‰“åŒ…ã€‚ï¼ˆå¥½åƒèƒ½è®²çš„æ¯”è¾ƒå°‘ï¼Œåªæœ‰æ”¯ä»˜çš„ MQ å¯ä»¥è®²ä¸€ä¸‹ï¼Œä½†æ˜¯ä¸€å¼€å§‹å°±é—®äº†è¿™ä¸ªã€‚é—®é¢˜æ˜¯ RabbitMQ åœ¨å“ªä¸ªéƒ¨åˆ†ç”¨åˆ°ï¼Œå°±è¯´äº†è¿™è¾¹æ”¯ä»˜å»¶æ—¶çš„é—®é¢˜ï¼‰\n\n\nRabbitMQ ç»§ç»­é—®è¿˜æœ‰å“ªé‡Œå¯ä»¥ç”¨åˆ°\nå›ç­”äº†å¼‚æ­¥ï¼Œéšä¾¿ä¸¾äº†ä¸€ä¸ªæ”¯ä»˜æˆåŠŸå‘é‚®ä»¶çš„ä¾‹å­ã€‚\n\n\nç»§ç»­é—®å‘å¤±è´¥äº†æ€ä¹ˆåŠï¼ˆè¿™é‡Œè¦é—®çš„æ˜¯ ACKï¼Œä½†æ˜¯å¿˜è®°å‡†å¤‡ MQ ç›¸å…³çš„å…«è‚¡æ–‡äº†â—â—â—ï¼‰\nä¸€ç›´åœ¨å¼•å…¥ ACK çš„æœºåˆ¶ï¼Œä½†æ˜¯çœŸçš„æƒ³ä¸èµ·æ¥äº†ã€‚å°±è¯´äº†ä¸€ä¸ªè®¾ç½®æ¶ˆæ¯é‡å‘çš„é…ç½®ã€‚\n\n\nçœ‹åˆ°é¡¹ç›®ç”¨äº† Flowableï¼Œé—®ä¸ºä»€ä¹ˆä½¿ç”¨ï¼Œæ˜¯æµç¨‹æ¯”è¾ƒå¤æ‚å—ã€‚\nä¸æ˜¯å¤æ‚ï¼Œæ˜¯éœ€è¦æµç¨‹å¯è§†åŒ–é…ç½®\n\n\nååºé—®å¼€å‘ä¸­æ„Ÿè§‰æ¯”è¾ƒéš¾çš„éƒ¨åˆ†ã€‚ï¼ˆä¸çŸ¥é“è¦ä¸è¦è¯´è¿™ä¸ªéš¾ç‚¹ï¼Œè¿˜æ˜¯æ¢ä¸€ä¸ªéš¾ç‚¹ï¼‰\nè¯´äº†æµç¨‹è¿™å—ï¼ˆå¥½åƒæ²¡æœ‰ä»€ä¹ˆå¯ä»¥è¯´äº†ï¼‰ã€‚ä¸€å¼€å§‹æ˜¯ç½‘ä¸Šæœç´¢ç”¨èƒ½ç›´æ¥ç”Ÿæˆ xml æ–‡ä»¶çš„ä»£ç ï¼ŒæŠŠè¿™ä¸ªæµç¨‹éƒ¨ç½²åˆ°æˆ‘ä»¬çš„æœåŠ¡ä¸Šï¼ˆä½†æ˜¯éœ€æ±‚æ˜¯èƒ½å¿«é€Ÿéƒ¨ç½²æµç¨‹ä½¿ç”¨ï¼‰ã€‚ä¸€å¼€å§‹ç”¨çš„å¼€æºé¡¹ç›®çš„æµåŠ¨è¿‡ç¨‹çš„é…ç½®æ¯”è¾ƒéš¾ï¼ˆå› ä¸ºè¿™é‡Œå½“æ—¶è¿˜è¦é…ç½®ç»“æŸçš„ç›‘å¬å™¨ä¹‹ç±»çš„æ“ä½œï¼Œå¯èƒ½ç›´æ¥ç»™ä¸ä¼šå¼€å‘çš„äººä½¿ç”¨æ¯”è¾ƒå›°éš¾ï¼‰ï¼Œåé¢æœåˆ°ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå°±å¼•å…¥æˆ‘ä»¬ç³»ç»Ÿï¼ˆä¸‹æ¬¡å°±è¯´å‚è€ƒå¼€æºé¡¹ç›®ï¼Œå†™çš„æµç¨‹è‡ªåŠ¨åŒ–é…ç½®ğŸ˜–ï¼‰ã€‚ç„¶åç»Ÿä¸€åœ¨ç»“æŸèŠ‚ç‚¹çš„åœ°æ–¹åŠ äº†ä¸€ä¸ªç›‘å¬å™¨ï¼Œæ ¹æ®ä¸åŒçš„æµç¨‹ï¼Œè°ƒç”¨å¾®æœåŠ¡æ§åˆ¶ä¸šåŠ¡è¡¨çš„æ“ä½œï¼ˆè¿™é‡Œä»¥åé—®å¯ä»¥è¯´ä¸€ä¸‹ç”¨ç­–ç•¥æ¨¡å¼ä¼˜åŒ–äº†æœåŠ¡é—´çš„è°ƒç”¨ï¼Œå—¯ä½†æ˜¯å¯èƒ½æœ‰é—®é¢˜å°±æ˜¯è°ƒç”¨å¤±è´¥äº†æ€ä¹ˆåŠï¼Œä¸ç„¶è¯´å†™åˆ° MQ äº†ï¼Ÿï¼‰\n\n\né—®äº†è¿™ç§é—®é¢˜ä¸ºä»€ä¹ˆæ²¡æœ‰è€å‘˜å·¥å¸¦ä»€ä¹ˆçš„ã€‚\né¢æˆ‘è¯´åé¢å¼€å‘å°±æˆ‘ä¸€ä¸ªäº†ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±è§£å†³çš„ã€‚å·²ç»æœ‰ç‚¹ç ´é˜²äº†ã€‚\n\n\né—®å­¦äº†ä»€ä¹ˆæ–°æŠ€æœ¯ï¼ˆå› ä¸ºç®€å†é‡Œä¹±å†™çƒ­çˆ±æŠ€æœ¯ï¼Œå­¦ä¹ æ–°æŠ€æœ¯ã€‚ã€‚ã€‚ï¼‰\nè¯´äº† copilotï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¯´ä»€ä¹ˆäº†ã€‚åæ­£å°±è¯´äº† GPT é‚£ä¸€å¥—ï¼Œè¿˜è¯´äº†è‡ªå·±åœ¨å†™åšå®¢ï¼ˆçœŸçš„å†…å¿ƒå·²ç»åœ¨å–Šæ•‘å‘½äº†ï¼‰\n\n\né—®è·å–å’Œäº¤æµä»£ç çš„é€”å¾„\nç¥ç»æˆ‘è¯´å¼€æºé¡¹ç›®çš„ç¾¤ï¼ˆä¸çŸ¥é“æˆ‘åœ¨è¯´ä»€ä¹ˆï¼Œèƒ¡è¨€ä¹±è¯­ï¼‰ã€åšå®¢\n\n\nåé—®\næ„Ÿè§‰æ²¡æˆå°±ç®€å•é—®äº†ä¸€ä¸‹æœ‰å‡ è½®é¢è¯•ã€‚\n\n\næ€»ç»“\næ²¡æœ‰æ ¹æ®ç®€å†å‡†å¤‡é¢è¯•ï¼ˆå¤§å¿Œâ—â—â—ï¼‰\næ€»ç»“çš„æ—¶å€™å‘ç°é—®çš„å¥½éš¾å•Šï¼ŒåŸºæœ¬ä¸Šè¦é—®çš„å°±æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡å’Œå¤šçº¿ç¨‹ï¼ˆçº¿ç¨‹æ± ï¼‰ï¼Œå¤šçº¿ç¨‹å¯ä»¥å»å‡†å¤‡ä¸€ä¸‹ï¼ˆé¡ºä¾¿è¿™å—çš„å…«è‚¡æ–‡ä¹ŸèƒŒçš„è¿˜è¡Œï¼‰ã€‚æ²¡æœ‰ä»€ä¹ˆå…«è‚¡æ–‡ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªï¼Œéš¾é“æ˜¯å› ä¸ºç¬¬ä¸€ä¸ªæˆ‘èƒŒçš„å¤ªæ˜æ˜¾äº†å—ã€‚\nä¸­å¾ç§‘æŠ€\n\nå¬è¯´å›¢é˜Ÿç¼©å‡äº†ä¸€åŠï¼Œç„¶åé‡æ–°æ‹›äººï¼Œåå‡ ä»½é‡Œé€‰ä¸€ä¸¤ä¸ªã€‚ç­‰é€šçŸ¥ã€‚ã€‚ã€‚ä¸¤å¤©é¢è¯•éƒ½æåˆ°äº†åˆ†å¸ƒå¼é”ç›¸å…³çš„å†…å®¹ï¼Œè¿™ä¸ªéœ€è¦å¥½å¥½ç ”ç©¶ä¸€ä¸‹â—â—â—æ²¡æœ‰åŠæ—¶è®°å½•ï¼Œæœ‰ç‚¹æ··ä¹±äº†ã€‚\nåæ¥æœåˆ°äº†å…¬å¸çš„å®˜ç½‘ï¼Œä½†æ˜¯æ²¡æœ‰æ³¨å†Œå…¥å£â”ã€‚\n\nä¸€é¢ï¼ˆå°±ä¸€é¢ï¼‰\né¢è¯•é¢˜å’Œå›ç­”ç‚¹\n\n\nå…³äºé¡¹ç›®é—®äº†å¾ˆå¤šï¼ˆä¹‹å‰çš„å›¢é˜Ÿï¼Œå¼€å‘äººæ•°ï¼Œå¾®æœåŠ¡æ•´åˆç­‰ç­‰ï¼‰\nå®è¯å®è¯´æˆ‘ä¸€ä¸ªäººå¹²çš„ã€‚\n\n\nä»“åº“éƒ¨åˆ†çš„è¡¨è®¾è®¡ï¼Œå…³äºæ€ä¹ˆé”åº“å­˜çš„\næˆ‘è¯´æˆ‘åˆ†è¡¨äº†ï¼Œç®€å•çš„è¯´äº†ä¸€ä¸‹ï¼Œä½†æ˜¯åº”è¯¥ä¸æ˜¯ä»–æƒ³è¦çš„ç­”æ¡ˆï¼Œç½‘ä¸Šæœäº†ä¸€ä¸‹åˆ†å¸ƒå¼é”åº“å­˜çš„é—®é¢˜ï¼ˆå‡†å¤‡å¥½äº†è¿™ä¸ªï¼Œåé¢é¢è¯•é‡éš¾ç‚¹å¯ä»¥è¯´è¿™ä¸ªâ—â—â—ï¼‰ã€‚\nè¿™å—å¦‚æœæ˜¯å•ä½“æ¶æ„å¯ä»¥å‚è€ƒä¹‹å‰çš„å¼€æºé¡¹ç›®å¯ä»¥è®¾è®¡ä¸€ä¸ªå‡ºå…¥åº“äº‹åŠ¡è¡¨ï¼Œç„¶åæ‰€æœ‰çš„å‡ºå…¥åº“è¡¨å…³è”è¿™ä¸ªå‡ºå…¥åº“äº‹åŠ¡è¡¨ï¼Œä½†æ˜¯æ˜¯åˆ†å¸ƒå¼å°±ä¸è¡Œ // todo å…³äºè¿™å—è¯¦ç»†è®¾ç½®ã€‚\n\n\nä¹è§‚é”ï¼šÂ ä¹è§‚é”æ˜¯ä¸€ç§åœ¨æ•°æ®æ“ä½œæ—¶ä¸ä½¿ç”¨ä¼ ç»Ÿé”æœºåˆ¶ï¼Œè€Œæ˜¯åœ¨æ•°æ®æäº¤æ—¶æ£€æŸ¥æ•°æ®å†²çªçš„ç­–ç•¥ã€‚åœ¨ä¹è§‚é”ä¸­ï¼Œå½“ä¸€ä¸ªæ“ä½œå°è¯•æ›´æ–°åº“å­˜æ—¶ï¼Œå®ƒå‡è®¾å…¶ä»–æ“ä½œä¸ä¼šä¿®æ”¹åŒä¸€æ•°æ®ã€‚å¦‚æœåœ¨æäº¤æ—¶å‘ç°å†²çªï¼Œé€šå¸¸ä¼šå›æ»šæ“ä½œå¹¶é€šçŸ¥ç”¨æˆ·ã€‚\n\n\næ‚²è§‚é”ï¼šÂ æ‚²è§‚é”æ˜¯ä¸€ç§åœ¨æ•°æ®æ“ä½œæ—¶ç«‹å³è·å–é”çš„ç­–ç•¥ã€‚å½“ä¸€ä¸ªæ“ä½œå°è¯•æ›´æ–°åº“å­˜æ—¶ï¼Œå®ƒä¼šç«‹å³è·å–ä¸€ä¸ªç‹¬å é”ï¼Œé˜»æ­¢å…¶ä»–æ“ä½œåœ¨åŒä¸€æ—¶é—´å†…ä¿®æ”¹åŒä¸€æ•°æ®ã€‚å½“æ“ä½œå®Œæˆåï¼Œé”ä¼šè¢«é‡Šæ”¾ï¼Œå…¶ä»–æ“ä½œå¯ä»¥ç»§ç»­æ‰§è¡Œã€‚\n\n\nåˆ†å¸ƒå¼é”ï¼šÂ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºæ•°æ®å¯èƒ½åˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå› æ­¤éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é”æ¥ä¿è¯å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®ã€‚å¸¸è§çš„åˆ†å¸ƒå¼é”å®ç°åŒ…æ‹¬ ZooKeeperã€Redis ç­‰ã€‚\n\n\näº‹åŠ¡ç®¡ç†ï¼šÂ ä½¿ç”¨æ•°æ®åº“çš„äº‹åŠ¡ç®¡ç†åŠŸèƒ½æ¥ä¿è¯åº“å­˜æ“ä½œçš„åŸå­æ€§ã€‚åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ‰€æœ‰å¯¹åº“å­˜çš„ä¿®æ”¹è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œç¡®ä¿åº“å­˜çš„ä¸€è‡´æ€§ã€‚\n\n\nåº“å­˜é”å®šæœºåˆ¶ï¼šÂ æŸäº›ä»“åº“ç®¡ç†ç³»ç»Ÿå¯èƒ½ä¼šå®ç°è‡ªå·±çš„åº“å­˜é”å®šæœºåˆ¶ï¼Œæ¯”å¦‚åœ¨æäº¤åº“å­˜æ›´æ–°è¯·æ±‚æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥å½“å‰åº“å­˜æ˜¯å¦å¯ä»¥æ»¡è¶³è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥ï¼Œåˆ™é”å®šåº“å­˜ï¼Œæ‰§è¡Œæ“ä½œï¼Œæœ€åè§£é”åº“å­˜ã€‚\n\n\nåº“å­˜é¢„ç•™æœºåˆ¶ï¼šÂ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦æå‰é¢„ç•™åº“å­˜ä»¥æ”¯æŒè®¢å•å¤„ç†ã€‚è¿™é€šå¸¸æ¶‰åŠåˆ°ä¸€ä¸ªé¢å¤–çš„åº“å­˜çŠ¶æ€ï¼Œå¦‚â€œé¢„ç•™â€æˆ–â€œé¢„ç•™ä¸­â€ï¼Œåœ¨å®é™…å‡ºåº“å‰ï¼Œåº“å­˜çŠ¶æ€ä¿æŒä¸ºâ€œé¢„ç•™ä¸­â€ï¼Œä»è€Œå®ç°å¯¹åº“å­˜çš„é”å®šã€‚\n\n\næ¶ˆæ¯é˜Ÿåˆ—ï¼šÂ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—æ¥å®ç°åº“å­˜çš„é”æœºåˆ¶ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæ“ä½œéœ€è¦æ›´æ–°åº“å­˜æ—¶ï¼Œå®ƒé¦–å…ˆå‘æ¶ˆæ¯é˜Ÿåˆ—å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åç­‰å¾…å“åº”ã€‚å¦‚æœå“åº”è¡¨æ˜åº“å­˜å¯ä»¥æ›´æ–°ï¼Œåˆ™æ‰§è¡Œæ“ä½œï¼›å¦‚æœå“åº”è¡¨æ˜åº“å­˜ä¸å¯æ›´æ–°ï¼Œåˆ™æ”¾å¼ƒæ“ä½œã€‚\n\n\n\n\nç„¶åæ˜¯é—®ä¸€ç‚¹å…³äºæŠ€æœ¯çš„é—®é¢˜ï¼Œå…³äº Java ä¸­çš„é›†åˆ\nå…«è‚¡æ–‡å…³äºé›†åˆå…¨èƒŒã€‚è¯´åˆ° HashMap åº•å±‚é—®äº†è¦ä¸è¦ç»§ç»­ã€‚\n\n\nå—¯ç„¶åè¯´å¯ä»¥è¯´ä¸‹å¤šçº¿ç¨‹çš„é—®é¢˜ï¼Œæ¯”å¦‚ HashTable å’Œ ConcurrentHashMapã€‚\nHashTable åº•å±‚å°±æ˜¯åŠ é”ï¼Œå¾ˆå°‘ç”¨ï¼›ConcurrentHashMap å…¨èƒŒã€‚ç„¶åæäº†ä¸€ä¸‹ ArrayList ä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå¯ä»¥ç”¨ Collections.synchronizedList()ï¼Œä½†æ˜¯éå†çš„æ—¶å€™è¿˜æ˜¯è¦åŠ é”ï¼Œå› ä¸ºåªæœ‰ addï¼Œremove ç­‰æ–¹æ³•åŠ äº†é”ã€‚\n\n\né—® List éå†èƒ½ä¸èƒ½ remove\nè¯´ä¸è¡Œï¼Œä¼š Fail-fastï¼ˆä¸‹æ¬¡åŠ ä¸Šè¿­ä»£å™¨æ˜¯å¯ä»¥çš„ï¼‰\n\n\né—® Redis çš„é—®é¢˜ï¼Œåˆ†å¸ƒå¼å¤šçº¿ç¨‹é—®é¢˜ã€‚\nåº”è¯¥æ˜¯è¦é—®è¿™ä¸ªï¼Œä½†æ˜¯æˆ‘ç›´æ¥æ•´åˆ°å¤šçº¿ç¨‹ï¼Œçº¿ç¨‹æ± é‚£é‡Œå»äº†ğŸ˜¥ã€‚ï¼ˆç„¶åé—®ä¸æ˜¯åœ¨é—® Redisï¼Œå’‹æ•´åˆ°é‚£é‡Œå»äº†ğŸ˜—ï¼‰ã€‚æˆ‘è¯´ Redis æˆ‘åªæ˜¯ç®€å•çš„ä½¿ç”¨ï¼Œå­˜çŸ­ä¿¡éªŒè¯ç ç”¨åˆ°äº†ã€‚\n\n\nç„¶åé—®å¤šçº¿ç¨‹ï¼Œæ ¸å¿ƒçº¿ç¨‹å‚æ•°\nï¼ˆå¯èƒ½è¢«æˆ‘å¸¦è·‘åäº†ï¼‰è¯´äº†é¢è¯•å‰åˆšåˆšå‡†å¤‡çš„é‚£ä¸ªçº¿ç¨‹æ± ï¼ˆæ—¥å¿—è®°å½•çš„é‚£ä¸ªï¼‰ï¼ŒåŒ…æ‹¬è¿™å—çš„å…«è‚¡ï¼Œå¤šæ‰¯ä¸€ç‚¹ï¼ŒåŠ ä¸Šçº¿ç¨‹æ± çš„æ‰§è¡Œé¡ºåºã€æ‹’ç»ç­–ç•¥ä»€ä¹ˆçš„ã€‚\n\n\nMQ çš„æ¶ˆæ¯ä¿è¯\nä¸ä¼šè¿™ä¸ªã€‚å’Œä¹‹å‰å›ç­”ä¸€æ ·é‡è¯•æœºåˆ¶ï¼Œä½†æ˜¯ç»§ç»­é—®é˜Ÿåˆ—æ»¡äº†æ€ä¹ˆåŠã€‚éœ€è¦åŠ å¼ºèƒŒã€‚MQ çš„ç›¸å…³å…«è‚¡å¿˜è®°å‡†å¤‡äº†ï¼Œè¿™å‘¨æœ«çš„é‡ç‚¹â—â—â—\n\n\næœåŠ¡å™¨éƒ¨ç½²ï¼Œæœ‰æ²¡æœ‰ç”¨è¿‡ jekins\næ²¡æœ‰ï¼Œåæ¥ä»–è¯´ä»–ä»¬æ˜¯ï¼Œæˆ‘è¯´æˆ‘å»çœ‹ä¸€ä¸‹ã€‚ã€‚ã€‚\n\n\nç¦»èŒçŠ¶æ€ï¼ŒæŠ•äº†å¤šä¹…ç®€å†ï¼Œæœ‰æ²¡æœ‰ offerï¼Œä¸ºä»€ä¹ˆç¦»èŒï¼Œåªå‰©æˆ‘ä¸€ä¸ªå¼€å‘çš„è¯ï¼Œåº”è¯¥è¿˜æ˜¯è›®é‡è¦çš„ã€‚ã€‚ã€‚\nç›´æ¥è¯´å‘ä¸å‡ºå·¥èµ„ã€‚\n\n\næœŸæœ›è–ªèµ„ï¼Œåé—®\n\n\næ€»ç»“\næä¾›äº†é¢è¯•é‡éš¾ç‚¹çš„æ–°æ€è·¯ï¼Œæ„Ÿè§‰å¦‚æœæ˜¯ç‰©æµä»“å‚¨å¿…ä¼šé—®åˆ°è¿™ä¸ªï¼Œè¿˜æœ‰éœ€è¦å…³æ³¨ä¸€ä¸‹é«˜å¯ç”¨ç›¸å…³çš„é—®é¢˜ï¼Œè¿™å‘¨å¥½å¥½å‡†å¤‡ä¸€ä¸‹ã€‚\næ€»ç»“\nè¿™ä¸ªè¿‡äº†ï¼Œæœ€åå»çš„è¿™é‡Œã€‚\nç½‘æ–°æ’å¤©ï¼ˆå¤–æ´¾é“å¯Œï¼‰\n\nå—¯ï¼Œåˆåœ¨èƒ¡è¨€ä¹±è¯­ï¼Œä¸€ç´§å¼ å°±èƒ¡è¨€ä¹±è¯­ã€‚åé¢æœäº†å¦‚æœåˆ°å¥½çš„é¡¹ç›®ç»„å°±æ˜¯ 1055ï¼Œåæ‚”ï¼Œæ—©çŸ¥é“æœ€åé¢è¿™ä¸ªï¼Œå±…ç„¶è¿˜æœ‰è¿™ç§å¤–åŒ…ğŸ˜­ã€‚å…¨éƒ¨éƒ½æ˜¯å…«è‚¡æ–‡ã€‚ï¼ˆå…¶å®æ­£å¸¸å¤–åŒ…åº”è¯¥éƒ½æ˜¯è¿™æ ·å§ï¼Œç¬¬ä¸€å¤©èƒŒäº†åŠå¤©å…«è‚¡æ²¡æœ‰æ€ä¹ˆé—®ï¼Œå—¯åº”è¯¥ä¹Ÿé—®äº†ï¼Œä½†æ˜¯æ²¡æœ‰è¿™ä¹ˆé¢‘ç¹ï¼Œæ„Ÿè§‰è¿™è¾¹é¢è¯•æ˜¯å…«è‚¡æ–‡é›†åˆï¼‰\n\nä¸€é¢ï¼ˆå…«è‚¡ï¼‰\né¢è¯•é¢˜å’Œå›ç­”ç‚¹\n\n\nè‡ªæˆ‘ä»‹ç»ï¼ˆ+ ç®€å•çš„è‹±æ–‡è‡ªæˆ‘ä»‹ç»ï¼‰\nè‹±æ–‡ï¼Œå—¯ï¼Œå¿˜å…‰äº†ã€‚\n\n\nArrayList å’Œ LinkedList åŒºåˆ«\n\n\nArrayList åˆå§‹å®¹é‡\n\n\nHashMap åº•å±‚ç»“æ„\n\n\nHashMap æ‰©å®¹æœºåˆ¶\nå¡ä½äº†ï¼Œå¡åˆ° put äº†ï¼Œç„¶åè¯´è¯´å‡ å€å°±è¡Œ\n\n\nAOP çš„åŸç†ğŸ¤¡\n\n\nSPI æœºåˆ¶ğŸ¤¡\n\n\nJava ä¸­æœ‰å“ªäº›é”ï¼Ÿ\nåªè¯´äº† Lock å’Œ synchronizedï¼Œé¡ºä¾¿æåˆ°äº†å…¬å¹³é”å’Œéå…¬å¹³é”ã€‚\n\n\nè¿˜æœ‰å—ï¼Ÿ\nå¯èƒ½æƒ³é—® CASï¼Ÿè¿˜æ˜¯é”çš„åˆ†ç±»ï¼Ÿä¸çŸ¥é“æˆ‘ç›´æ¥è¯´çš„æ²¡æœ‰äº†å§ã€‚ã€‚ã€‚\n\n\nçº¿ç¨‹çš„ run() å’Œ start() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n\nsleep() å’Œ wait() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n\nMySQL çš„ç´¢å¼•\nä¸çŸ¥é“å…·ä½“è¦é—®ä»€ä¹ˆã€‚ã€‚ã€‚è¯´äº†ä¸€ä¸‹ innodb æ˜¯èšç°‡ç´¢å¼•ã€‚ç„¶åé—®äº†ä¸€ä¸‹è¿™ä¸ªè¦é—®ä»€ä¹ˆã€‚ã€‚ã€‚ç„¶åè¯´ä¸é—®äº†\n\n\näº‹åŠ¡çš„å‡ ä¸ªç‰¹æ€§ï¼ŸACID æ˜¯ä»€ä¹ˆğŸ¤¡\n\n\nSQL ä¼˜åŒ–\n\n\næœ‰æ²¡æœ‰ç”¨è¿‡åºåˆ—ã€è§¦å‘å™¨\næˆ‘è¯´æˆ‘ä¸çŸ¥é“ï¼Œé—®æˆ‘æœ‰æ²¡æœ‰ç”¨è¿‡ Oracle\n\n\nMQï¼Œæœ‰æ²¡æœ‰ç”¨è¿‡ Kafka\n\n\nLinux å¸¸è§å‘½ä»¤ğŸ¤¡\n\n\næ€ä¹ˆåœ¨ç³»ç»Ÿä¸­æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶\nfindã€‚\n\n\nä¼šä¸ä¼šå‰ç«¯\n\n\næœ€åè‹±è¯­è‡ªæˆ‘ä»‹ç»ï¼Œåé—®\nè‹±è¯­çœŸçš„æƒ³ä¸å‡ºæ¥é˜¿å·´äº†åŠå¤©ï¼Œåé—®æ‡’å¾—é—®äº†å°±è¯´æ²¡æœ‰ã€‚\n\n\næ€»ç»“\nå…«è‚¡æ–‡ä¸ç†Ÿï¼Œæ€»è§ˆé‡Œçš„é¢˜ç›®å¿…ä¼šã€‚å¥½åƒè¿‡äº†ï¼Œåœ¨æ¨é¡¹ç›®ç»„ï¼Œä¸çŸ¥é“è¡Œä¸è¡Œã€‚\näºŒé¢ï¼ˆé¡¹ç›®ï¼‰\né—´éš”çš„æ—¶é—´æ¯”è¾ƒä¹…äº†ï¼Œé¢è¯•é€šè¿‡äº†ï¼Œåªè®°å½•ä¸€ä¸‹è¿‡ç¨‹ä¸­è®©åšçš„ä¸€é“æ¯”è¾ƒæœ‰æ„æ€çš„é¢˜ç›®ã€‚\nä¸å€ŸåŠ© java è‡ªå¸¦çš„å¹¶å‘å®¹å™¨ç±»ï¼Œå®ç°ä¸€ä¸ªååç‡å°½å¯èƒ½é«˜çš„å…ˆå…¥å…ˆå‡ºæ•°æ®ç»“æ„ï¼Œæœ€å¤šèƒ½å®¹çº³1000ä¸ªå…ƒç´ ã€‚å®ç°çº¿ç¨‹æ— é”å®‰å…¨ã€‚\n/**  Â * @author ZYF  Â * @date: 2024/8/28 17:26  Â * @description:  Â */  public class LockFreeQueue&lt;E&gt; &#123;  Â  Â  private final AtomicReferenceArray&lt;E&gt; array;Â  Â  Â  Â  private final AtomicInteger head;  Â  Â  private final AtomicInteger tail;Â  Â  Â  Â  private final int capacity;    Â  Â  public LockFreeQueue(int capacity) &#123;  Â  Â  Â  Â  // ç¯å½¢ç¼“å†²åŒºå®é™…å¤§å°ä¸º capacity + 1  Â  Â  Â  Â  this.capacity = capacity + 1;  Â  Â  Â  Â  this.array = new AtomicReferenceArray&lt;&gt;(this.capacity);Â  Â  Â  Â  Â  Â  Â  Â  this.head = new AtomicInteger(0);  Â  Â  Â  Â  this.tail = new AtomicInteger(0);  Â  Â  &#125;Â  Â  Â  Â  Â  Â  public boolean offer(E item) &#123;  Â  Â  Â  Â  if (item == null) &#123;  Â  Â  Â  Â  Â  Â  throw new NullPointerException(&quot;Item cannot be null&quot;);  Â  Â  Â  Â  &#125;    Â  Â  Â  Â  while (true) &#123;  Â  Â  Â  Â  Â  Â  int currentTail = tail.get();  Â  Â  Â  Â  Â  Â  int nextTail = (currentTail + 1) % capacity;    Â  Â  Â  Â  Â  Â  if (nextTail == head.get()) &#123;  Â  Â  Â  Â  Â  Â  Â  Â  // é˜Ÿåˆ—å·²æ»¡  Â  Â  Â  Â  Â  Â  Â  Â  return false;  Â  Â  Â  Â  Â  Â  &#125;    Â  Â  Â  Â  Â  Â  if (array.compareAndSet(currentTail, null, item)) &#123;  Â  Â  Â  Â  Â  Â  Â  Â  // æ’å…¥æˆåŠŸï¼Œæ›´æ–°å°¾æŒ‡é’ˆ  Â  Â  Â  Â  Â  Â  Â  Â  tail.compareAndSet(currentTail, nextTail);  Â  Â  Â  Â  Â  Â  Â  Â  return true;  Â  Â  Â  Â  Â  Â  &#125;  Â  Â  Â  Â  &#125;  Â  Â  &#125;    Â  Â  public E poll() &#123;  Â  Â  Â  Â  while (true) &#123;  Â  Â  Â  Â  Â  Â  int currentHead = head.get();  Â  Â  Â  Â  Â  Â  int currentTail = tail.get();    Â  Â  Â  Â  Â  Â  if (currentHead == currentTail) &#123;  Â  Â  Â  Â  Â  Â  Â  Â  // é˜Ÿåˆ—ä¸ºç©º  Â  Â  Â  Â  Â  Â  Â  Â  return null;  Â  Â  Â  Â  Â  Â  &#125;    Â  Â  Â  Â  Â  Â  E item = array.get(currentHead);  Â  Â  Â  Â  Â  Â  if (item != null &amp;&amp; array.compareAndSet(currentHead, item, null)) &#123;  Â  Â  Â  Â  Â  Â  Â  Â  // è¯»å–æˆåŠŸï¼Œæ›´æ–°å¤´æŒ‡é’ˆ  Â  Â  Â  Â  Â  Â  Â  Â  head.compareAndSet(currentHead, (currentHead + 1) % capacity);  Â  Â  Â  Â  Â  Â  Â  Â  return item;  Â  Â  Â  Â  Â  Â  &#125;  Â  Â  Â  Â  &#125;  Â  Â  &#125;    Â  Â  public boolean isEmpty() &#123;  Â  Â  Â  Â  return head.get() == tail.get();  Â  Â  &#125;    Â  Â  public boolean isFull() &#123;  Â  Â  Â  Â  return (tail.get() + 1) % capacity == head.get();  Â  Â  &#125;  &#125;  \næ€»ç»“\næœ€åæ²¡æœ‰å»è¿™é‡Œï¼Œå› ä¸ºå¤–åŒ…ã€‚ä½†æ˜¯å¾…é‡æ¯”ç°åœ¨çš„å¥½ï¼Œå¸Œæœ›ä¹‹åä¸ä¼šåæ‚”ã€‚\n","categories":["é¢è¯•","é¢è¯•è®°å½•"],"tags":["Java","é¢è¯•"]},{"title":"é¢è¯•-æ•°æ®ç»“æ„å’Œç®—æ³•","url":"/posts/1b906b1a/","content":"\n\nå‰è¨€æ ¹æ®åˆ·é¢˜è®°å½•ï¼Œæ•´ç†å„ä¸ªç±»å‹çš„ç‰¹ç‚¹\n\n\næ›´æ–°\n\n\n24.04.22 åˆå§‹è®°å½• æ•°ç»„çš„æ€»ç»“24.05.23 é“¾è¡¨çš„æ€»ç»“24.05.24 å“ˆå¸Œè¡¨çš„æ€»ç»“24.05.29 å­—ç¬¦ä¸²çš„æ€»ç»“ï¼ˆKMPï¼‰24.06.09 äºŒå‰æ ‘æ€»ç»“24.07.10 åŠ¨æ€è§„åˆ’æ€»ç»“\n\næ•°æ®ç»“æ„\næ•°ç»„\nåŸºç¡€ç†è®º\n1ã€æ•°ç»„æ˜¯å­˜æ”¾åœ¨è¿ç»­å†…å­˜ç©ºé—´ä¸Šçš„ç›¸åŒç±»å‹æ•°æ®çš„é›†åˆã€‚\n\n\næ•°ç»„ä¸‹æ ‡ä» 0 å¼€å§‹\n\n\næ•°ç»„çš„å†…å­˜ç©ºé—´åœ°å€è¿ç»­\n\n\n2ã€å› ä¸ºæ•°ç»„çš„åœ¨å†…å­˜ç©ºé—´çš„åœ°å€æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨åˆ é™¤æˆ–è€…å¢æ·»å…ƒç´ çš„æ—¶å€™ï¼Œå°±éš¾å…è¦ç§»åŠ¨å…¶ä»–å…ƒç´ çš„åœ°å€ã€‚\n3ã€æ•°ç»„çš„å…ƒç´ æ˜¯ä¸èƒ½åˆ çš„ï¼Œåªèƒ½è¦†ç›–ã€‚\n4ã€äºŒç»´æ•°ç»„åœ¨å†…å­˜çš„ç©ºé—´åœ°å€ä¸è¿ç»­\nç»å…¸é¢˜ç›®\näºŒåˆ†æ³•\néœ€è¦éµå¾ªå¾ªç¯ä¸å˜é‡åŸåˆ™ã€‚è¿™é‡Œçš„å¾ªç¯ä¸å˜é‡åŸåˆ™åœ¨äºŒåˆ†æ³•ä¸­çš„è¡¨ç°å°±æ˜¯ï¼Œå¾ªç¯è¿‡ç¨‹ä¸­å·¦é—­å³å¼€ï¼Œè¿™ä¸ªè§„åˆ™æ˜¯ä¸å˜çš„ã€‚\nåŒæŒ‡é’ˆæ³•\nå¿«æ…¢æŒ‡é’ˆæ³•ï¼šé€šè¿‡ä¸€ä¸ªå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆåœ¨ä¸€ä¸ª for å¾ªç¯ä¸‹å®Œæˆä¸¤ä¸ª for å¾ªç¯çš„å·¥ä½œã€‚\nåŒå‘æŒ‡é’ˆæ³•ï¼šä¸€ä¸ªæŒ‡é’ˆä»å·¦å‘å³ä¸€ä¸ªæŒ‡é’ˆä»å³å‘å·¦ã€‚ä»å·¦å‘å³çš„æ‰¾ç­‰äºç›®æ ‡å€¼çš„ä½ç½®ï¼Œä»å³å‘å·¦æ‰¾ä¸ç­‰äºç›®æ ‡çš„ä½ç½®ï¼Œæ¯æ¬¡æ‰¾åˆ°ä¸€ä¸ªç”¨ä¸ç­‰äºè¦†ç›–ç­‰äºã€‚ï¼ˆå°±æ˜¯è‡ªå·±ç¬¬ä¸€æ¬¡é¢˜è§£æ—¶çš„åšæ³•ï¼‰\næ»‘åŠ¨çª—å£\nåŠ¨æ€æ›´æ–°çª—å£çš„å¤§å°ï¼Œæ‰¾åˆ°æœ€ä¼˜è§£ã€‚\næ»‘åŠ¨çª—å£çš„ç²¾å¦™ä¹‹å¤„åœ¨äºæ ¹æ®å½“å‰å­åºåˆ—å’Œå¤§å°çš„æƒ…å†µï¼Œä¸æ–­è°ƒèŠ‚å­åºåˆ—çš„èµ·å§‹ä½ç½®ã€‚ä»è€Œå°† O(n^2) çš„æš´åŠ›è§£æ³•é™ä¸º O(n)ã€‚\næ¨¡æ‹Ÿè¡Œä¸º\nç›®å‰é‡åˆ°çš„é¢˜å‹æ˜¯èºæ—‹çŸ©é˜µã€‚\nè¿™ç±»é¢˜ç›®åªè¦æ¨¡æ‹Ÿæ•°ç»„éœ€è¦æ‰§è¡Œçš„æ“ä½œå°±è¡Œï¼Œéœ€è¦æ³¨æ„è¾¹ç•Œå€¼ï¼Œéµå¾ªå¾ªç¯ä¸å˜é‡åŸåˆ™ã€‚\né“¾è¡¨\nåŸºç¡€ç†è®º\nåˆ†ç±»\n\n\nå•é“¾è¡¨\næŒ‡é’ˆåŸŸåªèƒ½æŒ‡å‘èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚\n\n\nåŒé“¾è¡¨\næ¯ä¸€ä¸ªèŠ‚ç‚¹æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªæŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹ã€‚\n\n\nå¾ªç¯é“¾è¡¨\né“¾è¡¨é¦–å°¾ç›¸è¿ã€‚\n\n\nå­˜å‚¨æ–¹å¼\næ•°ç»„æ˜¯åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­åˆ†å¸ƒçš„ï¼Œä½†æ˜¯é“¾è¡¨åœ¨å†…å­˜ä¸­å¯ä¸æ˜¯è¿ç»­åˆ†å¸ƒçš„ã€‚\né“¾è¡¨æ˜¯é€šè¿‡æŒ‡é’ˆåŸŸçš„æŒ‡é’ˆé“¾æ¥åœ¨å†…å­˜ä¸­å„ä¸ªèŠ‚ç‚¹ã€‚\næ‰€ä»¥é“¾è¡¨ä¸­çš„èŠ‚ç‚¹åœ¨å†…å­˜ä¸­ä¸æ˜¯è¿ç»­åˆ†å¸ƒçš„ ï¼Œè€Œæ˜¯æ•£ä¹±åˆ†å¸ƒåœ¨å†…å­˜ä¸­çš„æŸåœ°å€ä¸Šï¼Œåˆ†é…æœºåˆ¶å–å†³äºæ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†ã€‚\né“¾è¡¨çš„å®šä¹‰\npublic class ListNode &#123;      public int val;      public ListNode next;        public ListNode() &#123;      &#125;        public ListNode(int val) &#123;          this.val = val;      &#125;  &#125;\né“¾è¡¨æ“ä½œ\nåˆ é™¤èŠ‚ç‚¹\nå°†è¯¥èŠ‚ç‚¹è·³è¿‡ï¼Œå‰ä¸€èŠ‚ç‚¹æŒ‡å‘åä¸€èŠ‚ç‚¹ã€‚\næ·»åŠ èŠ‚ç‚¹\nå‰ä¸€èŠ‚ç‚¹æŒ‡å‘è¯¥èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹æŒ‡å‘åä¸€èŠ‚ç‚¹ã€‚\næ€§èƒ½åˆ†æ\n\n\n\n\næ’å…¥/åˆ é™¤ï¼ˆæ—¶é—´å¤æ‚åº¦ï¼‰\næŸ¥è¯¢ï¼ˆæ—¶é—´å¤æ‚åº¦ï¼‰\né€‚ç”¨åœºæ™¯\n\n\n\n\næ•°ç»„\nO(n)\nO(1)\næ•°æ®é‡å›ºå®šï¼Œé¢‘ç¹æŸ¥è¯¢ï¼Œè¾ƒå°‘å¢åˆ \n\n\né“¾è¡¨\nO(1)\nO(n)\næ•°æ®é‡ä¸å›ºå®šï¼Œé¢‘ç¹å¢åˆ ï¼Œè¾ƒå°‘æŸ¥è¯¢\n\n\n\nç»å…¸é¢˜ç›®\nè™šæ‹Ÿå¤´èŠ‚ç‚¹\né“¾è¡¨ä¸­çš„å¢åˆ æ“ä½œï¼Œéƒ½æ˜¯éœ€è¦æ“ä½œå‰ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡ŒæŒ‡å‘ã€‚ä½†æ˜¯å¯¹äºå¤´èŠ‚ç‚¹çš„æ“ä½œï¼Œç”±äºæ²¡æœ‰å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯æ¬¡éƒ½éœ€è¦å•ç‹¬å¤„ç†ã€‚å› æ­¤ä½¿ç”¨è™šæ‹Ÿå¤´ç»“ç‚¹çš„æŠ€å·§ã€‚ï¼ˆåŸºæœ¬ä¸Šåšé¢˜éƒ½æ˜¯åŠ ä¸Šè™šæ‹ŸèŠ‚ç‚¹æ¯”è¾ƒæ–¹ä¾¿ï¼‰\né“¾è¡¨çš„åŸºæœ¬æ“ä½œ\n\n\nè·å–é“¾è¡¨ç¬¬ index ä¸ªèŠ‚ç‚¹çš„æ•°å€¼\n\n\nåœ¨é“¾è¡¨çš„æœ€å‰é¢æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹\n\n\nåœ¨é“¾è¡¨çš„æœ€åé¢æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹\n\n\nåœ¨é“¾è¡¨ç¬¬ index ä¸ªèŠ‚ç‚¹å‰é¢æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹\n\n\nåˆ é™¤é“¾è¡¨çš„ç¬¬ index ä¸ªèŠ‚ç‚¹çš„æ•°å€¼\n\n\nåè½¬é“¾è¡¨\n\n\nè¿­ä»£æ³•ç”¨åŒæŒ‡é’ˆï¼Œæ”¹å˜ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æŒ‡é’ˆæ–¹å‘\n\n\né€’å½’æ³•å’Œè¿­ä»£æ³•çš„æ€è·¯åŸºæœ¬ä¸€æ ·ï¼ŒæŠŠç§»åŠ¨ä¸‹ä¸€æ­¥çš„æ“ä½œæ”¾åˆ°é€’å½’é‡Œè¿›è¡Œã€‚\n\n\nä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹\nè¿™é¢˜ä¹Ÿç”¨åˆ°äº†è™šæ‹Ÿå¤´èŠ‚ç‚¹çš„æ–¹æ³•ã€‚\n\n\néœ€è¦äº¤æ¢çš„ä¸¤ä¸ªèŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒæŒ‡å‘éœ€è¦äº¤æ¢çš„ç¬¬äºŒä¸ªèŠ‚ç‚¹\n\n\nèŠ‚ç‚¹äº¤æ¢\n\n\nåˆ é™¤å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹\nè¿ç”¨è™šæ‹Ÿå¤´èŠ‚ç‚¹ + åŒæŒ‡é’ˆã€‚\næ€è·¯æ˜¯ï¼Œä¸€ä¸ªæŒ‡é’ˆå…ˆèµ° N æ­¥ï¼Œç„¶åä¸¤ä¸ªæŒ‡é’ˆä¸€èµ·å‘åã€‚å½“å¿«æŒ‡é’ˆæŒ‡å‘æœ«å°¾æ—¶ï¼Œæ…¢æŒ‡é’ˆçš„ä½ç½®æ­£å¥½æ˜¯å€’æ•°ç¬¬ N ä¸ªèŠ‚ç‚¹ã€‚ç„¶åå®Œæˆåˆ é™¤æ“ä½œã€‚\né“¾è¡¨ç›¸äº¤\nè¿™é‡Œçš„ç›¸äº¤æŒ‡çš„æ˜¯å¼•ç”¨å®Œå…¨ç›¸åŒï¼Œå³ï¼šå†…å­˜åœ°å€å®Œå…¨ç›¸åŒçš„äº¤ç‚¹\nç¯å½¢é“¾è¡¨\n\n\nåˆ¤æ–­æ˜¯å¦æœ‰ç¯\n\n\nåˆ¤æ–­äº¤ç‚¹ä½ç½®è¿™æ˜¯ä¸€é“æ•°å­¦é¢˜ï¼Œå…·ä½“è§£æåœ¨å¯¹åº”çš„æ–‡ç« ä¸­ç»™å‡ºã€‚\n\n\nå“ˆå¸Œè¡¨\nåŸºç¡€ç†è®º\nå®šä¹‰\nå“ˆå¸Œè¡¨æ˜¯æ ¹æ®å…³é”®ç çš„å€¼è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚\n\nä¸€èˆ¬ä½¿ç”¨\nä¸€èˆ¬å“ˆå¸Œè¡¨éƒ½æ˜¯ç”¨æ¥å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å‡ºç°é›†åˆé‡Œã€‚\nå“ˆå¸Œå‡½æ•°/å“ˆå¸Œç¢°æ’\nå“ˆå¸Œå‡½æ•°æ˜¯æŠŠä¼ å…¥çš„ key æ˜ å°„åˆ°ç¬¦å·è¡¨çš„ç´¢å¼•ä¸Šã€‚\nå“ˆå¸Œç¢°æ’å¤„ç†æœ‰å¤šä¸ª key æ˜ å°„åˆ°ç›¸åŒç´¢å¼•ä¸Šæ—¶çš„æƒ…æ™¯ï¼Œå¤„ç†ç¢°æ’çš„æ™®éæ–¹å¼æ˜¯æ‹‰é“¾æ³•å’Œçº¿æ€§æ¢æµ‹æ³•ã€‚\nå¸¸è§çš„ä¸‰ç§å“ˆå¸Œç»“æ„\n\n\næ•°ç»„\n\n\nsetï¼ˆé›†åˆï¼‰\n\n\nmapï¼ˆæ˜ å°„ï¼‰\n\n\nå“ˆå¸Œè¡¨ç»å…¸é¢˜ç›®\næ•°ç»„ä½œä¸ºå“ˆå¸Œè¡¨\nä¸€èˆ¬é¢˜ç›®ä¸­å‡ºç°è§„å®š map å¤§å°ï¼ˆæ¯”å¦‚æ˜è¯´éƒ½æ˜¯å°å†™å­—æ¯ï¼‰ï¼Œå°±å¯ä»¥ä½¿ç”¨æ•°ç»„ã€‚è¿™äº›é¢˜ç”¨ map ç¡®å®å¯ä»¥ï¼Œä½†ä½¿ç”¨ map çš„ç©ºé—´æ¶ˆè€—è¦æ¯”æ•°ç»„å¤§ä¸€äº›ï¼Œå› ä¸º map è¦ç»´æŠ¤çº¢é»‘æ ‘æˆ–è€…ç¬¦å·è¡¨ï¼Œè€Œä¸”è¿˜è¦åšå“ˆå¸Œå‡½æ•°çš„è¿ç®—ã€‚æ‰€ä»¥æ•°ç»„æ›´åŠ ç®€å•ç›´æ¥æœ‰æ•ˆï¼\n\nå…³è”é¢˜ç›®ï¼š\næœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯\nèµé‡‘ä¿¡\n\nset ä½œä¸ºå“ˆå¸Œè¡¨\nå¦‚æœé¢˜ç›®æ²¡æœ‰é™åˆ¶å¤§å°ï¼Œå°±æ— æ³•ä½¿ç”¨æ•°ç»„ã€‚\nä¸»è¦å› ä¸ºï¼š\n\n\næ•°ç»„çš„å¤§å°æ˜¯æœ‰é™çš„ï¼Œå—åˆ°ç³»ç»Ÿæ ˆç©ºé—´ï¼ˆä¸æ˜¯æ•°æ®ç»“æ„çš„æ ˆï¼‰çš„é™åˆ¶ã€‚\n\n\nå¦‚æœæ•°ç»„ç©ºé—´å¤Ÿå¤§ï¼Œä½†å“ˆå¸Œå€¼æ¯”è¾ƒå°‘ã€ç‰¹åˆ«åˆ†æ•£ã€è·¨åº¦éå¸¸å¤§ï¼Œä½¿ç”¨æ•°ç»„å°±é€ æˆç©ºé—´çš„æå¤§æµªè´¹ã€‚\n\n\n\nå…³è”é¢˜ç›®ï¼š\nä¸¤ä¸ªæ•°ç»„çš„äº¤é›†\nå¿«ä¹æ•°\n\nmapä½œä¸ºå“ˆå¸Œè¡¨\nset æ˜¯ä¸€ä¸ªé›†åˆï¼Œé‡Œé¢æ”¾çš„å…ƒç´ åªèƒ½æ˜¯ä¸€ä¸ª keyï¼Œä½†æ˜¯é‡åˆ° key ä¸ value éƒ½è¦ä¿å­˜æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨ mapã€‚\nå­—ç¬¦ä¸²\nåŸºç¡€ç†è®º\nå®šä¹‰\nå­—ç¬¦ä¸²æ˜¯è‹¥å¹²å­—ç¬¦ç»„æˆçš„æœ‰é™åºåˆ—ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå­—ç¬¦æ•°ç»„ã€‚\nå­—ç¬¦ä¸²ç»å…¸é¢˜ç›®\nåŒæŒ‡é’ˆ\nåŒæŒ‡é’ˆæ³•åœ¨æ•°ç»„ï¼Œé“¾è¡¨å’Œå­—ç¬¦ä¸²ä¸­å¾ˆå¸¸ç”¨ã€‚\n\nå…³è”é¢˜ç›®ï¼š\nåè½¬å­—ç¬¦ä¸²ï¼šåªæ˜¯ç®€å•ä½¿ç”¨ temp ä½œä¸ºä¸­é—´å˜é‡ã€‚\næ›¿æ¢å­—ç¬¦ï¼šæ•°ç»„å¡«å……ç±»çš„é—®é¢˜ï¼Œå¯ä»¥å…ˆé¢„å…ˆç»™æ•°ç»„æ‰©å®¹å¸¦å¡«å……åçš„å¤§å°ï¼Œç„¶åå†ä»åå‘å‰è¿›è¡Œæ“ä½œã€‚\nä¸ç§»é™¤æ“ä½œæœ‰å…³çš„åŒæŒ‡é’ˆæ“ä½œï¼š\nç¿»è½¬å­—ç¬¦ä¸²å†…çš„å•è¯ ä¸­çš„ç§»é™¤ç©ºæ ¼éƒ¨åˆ†ã€‚\nä¹‹å‰æ•°ç»„éƒ¨åˆ†ä¸­ ç§»é™¤æ•°ç»„å…ƒç´ \n\nåè½¬ç³»åˆ—\nåè½¬å°±æ˜¯åŒæŒ‡é’ˆï¼ˆå¤´å°¾æŒ‡é’ˆä¸€èµ·å‘ä¸­é—´ç§»åŠ¨ï¼Œç„¶åäº¤æ¢æ•°ç»„å…ƒç´ ï¼‰\n\nå…³è”é¢˜ç›®ï¼š\nåè½¬å­—ç¬¦ä¸²II\nç¿»è½¬å­—ç¬¦ä¸²å†…çš„å•è¯ï¼šè¿™é¢˜çš„åè½¬ç”¨äº†ä¸¤æ¬¡ï¼Œå…ˆæ•´ä½“åè½¬ï¼Œå†åˆ†æ®µåè½¬ã€‚\nå³æ—‹è½¬å­—ç¬¦ä¸²ï¼šå’Œä¸Šé¢˜ä¸€æ ·éœ€è¦å…ˆå±€éƒ¨åè½¬å†æ•´ä½“åè½¬ã€‚ï¼ˆè¿™ç§é¢˜ç¬”è¯•é‡åˆ°ç›´æ¥ API å¿«ä¸€ç‚¹ï¼‰\n\nKMP\nKMP ç®—æ³•æ˜¯å­—ç¬¦ä¸²æŸ¥æ‰¾æœ€é‡è¦çš„ç®—æ³•ã€‚\nKMP çš„ä¸»è¦æ€æƒ³æ˜¯å½“å‡ºç°å­—ç¬¦ä¸²ä¸åŒ¹é…æ—¶ï¼Œå¯ä»¥çŸ¥é“ä¸€éƒ¨åˆ†ä¹‹å‰å·²ç»åŒ¹é…çš„æ–‡æœ¬å†…å®¹ï¼Œå¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯é¿å…ä»å¤´å†å»åšåŒ¹é…äº†ã€‚\n\nå…³è”é¢˜ç›®ï¼š\nå®ç° strStr() ã€é‡å¤çš„å­å­—ç¬¦ä¸²\n\nå‰ç¼€è¡¨\nä½œç”¨ï¼šå‰ç¼€è¡¨æ˜¯ç”¨æ¥å›é€€çš„ï¼Œå®ƒè®°å½•äº†æ¨¡å¼ä¸²ä¸ä¸»ä¸² (æ–‡æœ¬ä¸²) ä¸åŒ¹é…çš„æ—¶å€™ï¼Œæ¨¡å¼ä¸²åº”è¯¥ä»å“ªé‡Œå¼€å§‹é‡æ–°åŒ¹é…ã€‚\nå¸¸è§çš„åŸºç¡€é¢˜ç›®æ˜¯åœ¨æ–‡æœ¬ä¸²ä¸­æŸ¥æ‰¾ä¸€ä¸ªæ¨¡å¼ä¸²ï¼Œä¾‹ï¼šåœ¨ aabaabaafa ä¸­æŸ¥æ‰¾ aabaafã€‚è¿™ä¸ªæŸ¥æ‰¾æ˜¯æ–‡æœ¬ä¸²æŒ‡é’ˆé¡ºåºåç§»ï¼ˆä¸å˜ï¼‰ï¼Œæ´»åŠ¨æ¨¡å¼ä¸²è¿›è¡ŒåŒ¹é…ã€‚\nå‰ç¼€è¡¨ç”¨äºè®°å½•æŸ¥æ‰¾å¤±è´¥åï¼Œæ¨¡å¼ä¸²ä¸‹ä¸€æ¬¡è¿”å›æŸ¥æ‰¾çš„ç‚¹ã€‚ä¾‹ï¼šæ–‡æœ¬ä¸²æŒ‡é’ˆåˆ°ç¬¬äºŒä¸ª b æ—¶ï¼ŒæŸ¥æ‰¾å¤±è´¥ï¼Œè¿™æ—¶æ¨¡å¼ä¸²ä» b è¿™ä¸ªä½ç½®é‡æ–°æŸ¥è¯¢ã€‚\nä»€ä¹ˆæ˜¯å‰ç¼€è¡¨ï¼Ÿ\nè®°å½•ä¸‹æ ‡ i ä¹‹å‰ï¼ˆåŒ…æ‹¬ iï¼‰çš„å­—ç¬¦ä¸²ä¸­ï¼Œæœ‰å¤šå¤§é•¿åº¦çš„ç›¸åŒå‰ç¼€åç¼€ã€‚\næœ€é•¿å…¬å…±å‰åç¼€\nå‰ç¼€æ˜¯æŒ‡ä¸åŒ…å«æœ€åä¸€ä¸ªå­—ç¬¦çš„æ‰€æœ‰ä»¥ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å¤´çš„è¿ç»­å­ä¸²ã€‚\nåç¼€æ˜¯æŒ‡ä¸åŒ…å«ç¬¬ä¸€ä¸ªå­—ç¬¦çš„æ‰€æœ‰ä»¥æœ€åä¸€ä¸ªå­—ç¬¦ç»“å°¾çš„è¿ç»­å­ä¸²ã€‚è¿™ä¸ªéƒ¨åˆ†æš‚æ—¶æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„ã€‚\nä¸ºä»€ä¹ˆä½¿ç”¨å‰ç¼€è¡¨å¯ä»¥å‘Šè¯‰æˆ‘ä»¬åŒ¹é…å¤±è´¥ä¹‹åè·³åˆ°å“ªé‡Œé‡æ–°åŒ¹é…ï¼Ÿ\n\nè¿™å¼ å›¾æ˜¯æ•™ç¨‹å†…çš„å›¾ï¼Œä¸‹æ ‡ 5 ä¹‹å‰è¿™éƒ¨åˆ†çš„å­—ç¬¦ä¸²ï¼ˆä¹Ÿå°±æ˜¯å­—ç¬¦ä¸² aabaaï¼‰çš„æœ€é•¿ç›¸ç­‰çš„å‰ç¼€ å’Œ åç¼€å­—ç¬¦ä¸²æ˜¯ å­å­—ç¬¦ä¸² aa ï¼Œå› ä¸ºæ‰¾åˆ°äº†æœ€é•¿ç›¸ç­‰çš„å‰ç¼€å’Œåç¼€ï¼ŒåŒ¹é…å¤±è´¥çš„ä½ç½®æ˜¯åç¼€å­ä¸²çš„åé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰¾åˆ°ä¸å…¶ç›¸åŒçš„å‰ç¼€çš„åé¢é‡æ–°åŒ¹é…å°±å¯ä»¥äº†ã€‚\nå¦‚ä½•æ‰¾åˆ°ä¸€å¼ å‰ç¼€è¡¨\nä¸æ˜¯å¾ˆèƒ½ç†è§£ï¼Œä½†æ˜¯èƒŒä¸‹æ¥äº†\n// éœ€è¦æ‰¾åˆ°å‰ç¼€è¡¨çš„å­—ç¬¦ä¸²String s;// åˆå§‹åŒ–int j = 0;int[] next = new int[s.length];for(int i = 1; i &lt; s.length, i++) &#123;\t// ä¸ç›¸åŒçš„æƒ…å†µ\twhile(j != 0 &amp;&amp; s.charAt[i] != s.charAt[j]) &#123;\t\tj = next[j - 1];\t&#125;\tif(s.charAt[i] == s.charAt[j]) &#123;\t\tj++;\t&#125;\tnext[i] = j;&#125;\næ ˆä¸é˜Ÿåˆ—\nåŸºç¡€ç†è®º\né˜Ÿåˆ—æ˜¯å…ˆè¿›å…ˆå‡ºï¼Œæ ˆæ˜¯å…ˆè¿›åå‡ºã€‚\næ ˆä¸é˜Ÿåˆ—çš„åŸºç¡€å¯ä»¥é€šè¿‡ä¸‹é¢ä¸¤é¢˜å›å¿†ã€‚\n\nç”¨æ ˆå®ç°é˜Ÿåˆ—\nç”¨é˜Ÿåˆ—å®ç°æ ˆ\n\næ ˆç»å…¸é¢˜ç›®\n\næœ‰æ•ˆçš„æ‹¬å·ï¼šæ‹¬å·åŒ¹é…æ˜¯ä½¿ç”¨æ ˆè§£å†³çš„ç»å…¸é—®é¢˜ã€‚\nåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç›¸é‚»é‡å¤é¡¹ï¼šæ€è·¯å°±æ˜¯å¯ä»¥æŠŠå­—ç¬¦ä¸²é¡ºåºæ”¾åˆ°ä¸€ä¸ªæ ˆä¸­ï¼Œç„¶åå¦‚æœç›¸åŒçš„è¯ æ ˆå°±å¼¹å‡ºï¼Œè¿™æ ·æœ€åæ ˆé‡Œå‰©ä¸‹çš„å…ƒç´ éƒ½æ˜¯ç›¸é‚»ä¸ç›¸åŒçš„å…ƒç´ äº†ã€‚\né€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ï¼šè¿™é¢˜ä¸»è¦åœ¨äºé¢˜ç›®ä¸­ç»™å‡ºçš„ç™¾åº¦é“¾æ¥ï¼Œå…¶ä¸­æè¿°äº†é€†æ³¢å…°å¼å­çš„æ„æ€ã€‚è®¡ç®—æ–¹å¼å°±æ˜¯éå†å¼å­ï¼Œé‡åˆ°æ•°å­—å…¥æ ˆï¼Œé‡åˆ°è¿ç®—ç¬¦å‡ºæ ˆä¸¤ä¸ªæ•°å­—è¿›è¡Œè®¡ç®—ï¼Œè®¡ç®—ç»“æœå†å…¥æ ˆã€‚ç›´åˆ°å¼å­å¾ªç¯å®Œæ¯•ã€‚\n\né˜Ÿåˆ—ç»å…¸é¢˜ç›®\n\næ»‘åŠ¨çª—å£æœ€å¤§å€¼ï¼šè¿™é¢˜éœ€è¦ç”¨åˆ°å•è°ƒé˜Ÿåˆ—ï¼Œå³å•è°ƒé€’å‡æˆ–å•è°ƒé€’å¢çš„é˜Ÿåˆ—ï¼ˆéœ€è¦è‡ªå·±å®šä¹‰æ•°æ®ç»“æ„ï¼‰\nå‰ K ä¸ªé«˜é¢‘å…ƒç´ ï¼šè¿™é¢˜éœ€è¦ç”¨åˆ°ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå…¶å®å°±æ˜¯å †ï¼ˆå †æ˜¯ä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œæ ‘ä¸­æ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½ä¸å°äºï¼ˆæˆ–ä¸å¤§äºï¼‰å…¶å·¦å³å­©å­çš„å€¼ã€‚ï¼‰\n\näºŒå‰æ ‘\nåŸºç¡€ç†è®º\näºŒå‰æ ‘çš„ç§ç±»\næ»¡äºŒå‰æ ‘\næ»¡äºŒå‰æ ‘ï¼šå¦‚æœä¸€æ£µäºŒå‰æ ‘åªæœ‰åº¦ä¸º 0 çš„ç»“ç‚¹å’Œåº¦ä¸º 2 çš„ç»“ç‚¹ï¼Œå¹¶ä¸”åº¦ä¸º 0 çš„ç»“ç‚¹åœ¨åŒä¸€å±‚ä¸Šï¼Œåˆ™è¿™æ£µäºŒå‰æ ‘ä¸ºæ»¡äºŒå‰æ ‘ã€‚\nè¿™æ£µäºŒå‰æ ‘ä¸ºæ»¡äºŒå‰æ ‘ï¼Œä¹Ÿå¯ä»¥è¯´æ·±åº¦ä¸º kï¼Œæœ‰ 2^k-1 ä¸ªèŠ‚ç‚¹çš„äºŒå‰æ ‘ã€‚\nå®Œå…¨äºŒå‰æ ‘\nå®Œå…¨äºŒå‰æ ‘çš„å®šä¹‰å¦‚ä¸‹ï¼šåœ¨å®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œé™¤äº†æœ€åº•å±‚èŠ‚ç‚¹å¯èƒ½æ²¡å¡«æ»¡å¤–ï¼Œå…¶ä½™æ¯å±‚èŠ‚ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼ï¼Œå¹¶ä¸”æœ€ä¸‹é¢ä¸€å±‚çš„èŠ‚ç‚¹éƒ½é›†ä¸­åœ¨è¯¥å±‚æœ€å·¦è¾¹çš„è‹¥å¹²ä½ç½®ã€‚è‹¥æœ€åº•å±‚ä¸ºç¬¬ h å±‚ï¼ˆh ä» 1 å¼€å§‹ï¼‰ï¼Œåˆ™è¯¥å±‚åŒ…å« 1~ 2^(h-1) ä¸ªèŠ‚ç‚¹ã€‚\nä¼˜å…ˆçº§é˜Ÿåˆ—å…¶å®æ˜¯ä¸€ä¸ªå †ï¼Œå †å°±æ˜¯ä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼ŒåŒæ—¶ä¿è¯çˆ¶å­èŠ‚ç‚¹çš„é¡ºåºå…³ç³»ã€‚\näºŒå‰æœç´¢æ ‘\näºŒå‰æœç´¢æ ‘æ˜¯ä¸€ä¸ªæœ‰åºæ ‘\n\n\nè‹¥å®ƒçš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›\n\n\nè‹¥å®ƒçš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›\n\n\nå®ƒçš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘\n\n\nå¹³è¡¡äºŒå‰æœç´¢æ ‘\nå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼šåˆè¢«ç§°ä¸º AVLï¼ˆAdelson-Velsky and Landisï¼‰æ ‘ï¼Œä¸”å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼šå®ƒæ˜¯ä¸€æ£µç©ºæ ‘æˆ–å®ƒçš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ 1ï¼Œå¹¶ä¸”å·¦å³ä¸¤ä¸ªå­æ ‘éƒ½æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚\näºŒå‰æ ‘çš„å­˜å‚¨æ–¹å¼\näºŒå‰æ ‘å¯ä»¥é“¾å¼å­˜å‚¨ï¼Œä¹Ÿå¯ä»¥é¡ºåºå­˜å‚¨ã€‚\né‚£ä¹ˆé“¾å¼å­˜å‚¨æ–¹å¼å°±ç”¨æŒ‡é’ˆï¼Œ é¡ºåºå­˜å‚¨çš„æ–¹å¼å°±æ˜¯ç”¨æ•°ç»„ã€‚\nç”¨æ•°ç»„æ¥å­˜å‚¨äºŒå‰æ ‘å¦‚ä½•éå†ï¼Ÿå¦‚æœçˆ¶èŠ‚ç‚¹çš„æ•°ç»„ä¸‹æ ‡æ˜¯ iï¼Œé‚£ä¹ˆå®ƒçš„å·¦å­©å­å°±æ˜¯ i * 2 + 1ï¼Œå³å­©å­å°±æ˜¯ i * 2 + 2ã€‚\näºŒå‰æ ‘çš„éå†æ–¹å¼\näºŒå‰æ ‘ä¸»è¦æœ‰ä¸¤ç§éå†æ–¹å¼ï¼š\n\n\næ·±åº¦ä¼˜å…ˆéå†ï¼šå…ˆå¾€æ·±èµ°ï¼Œé‡åˆ°å¶å­èŠ‚ç‚¹å†å¾€å›èµ°ã€‚\n\n\nå¹¿åº¦ä¼˜å…ˆéå†ï¼šä¸€å±‚ä¸€å±‚çš„å»éå†ã€‚\nè¿™ä¸¤ç§éå†æ˜¯å›¾è®ºä¸­æœ€åŸºæœ¬çš„ä¸¤ç§éå†æ–¹å¼\nä»æ·±åº¦ä¼˜å…ˆéå†å’Œå¹¿åº¦ä¼˜å…ˆéå†è¿›ä¸€æ­¥æ‹“å±•ï¼š\n\n\n\n\næ·±åº¦ä¼˜å…ˆéå†\n\nå‰åºéå†ï¼ˆé€’å½’æ³•ï¼Œè¿­ä»£æ³•ï¼‰\nä¸­åºéå†ï¼ˆé€’å½’æ³•ï¼Œè¿­ä»£æ³•ï¼‰\nååºéå†ï¼ˆé€’å½’æ³•ï¼Œè¿­ä»£æ³•ï¼‰\n\n\n\nå¹¿åº¦ä¼˜å…ˆéå†\n\nå±‚æ¬¡éå†ï¼ˆè¿­ä»£æ³•ï¼‰\nè¿™é‡Œå‰ä¸­åï¼Œå…¶å®æŒ‡çš„å°±æ˜¯ä¸­é—´èŠ‚ç‚¹çš„éå†é¡ºåºï¼Œå‰ä¸­ååºæŒ‡çš„å°±æ˜¯ä¸­é—´èŠ‚ç‚¹çš„ä½ç½®ã€‚\n\n\n\n\nâ—äºŒå‰æ ‘çš„é€’å½’éå†ã€äºŒå‰æ ‘çš„è¿­ä»£éå†ã€äºŒå‰æ ‘çš„ç»Ÿä¸€è¿­ä»£æ³•ï¼š(https://kiml.site/posts/a297f438/)\näºŒå‰æ ‘çš„å±‚åºéå†\n\nâ—é€’å½’ç®—æ³•çš„ä¸‰è¦ç´ \n\n\nç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ï¼šÂ ç¡®å®šå“ªäº›å‚æ•°æ˜¯é€’å½’çš„è¿‡ç¨‹ä¸­éœ€è¦å¤„ç†çš„ï¼Œé‚£ä¹ˆå°±åœ¨é€’å½’å‡½æ•°é‡ŒåŠ ä¸Šè¿™ä¸ªå‚æ•°ï¼Œ å¹¶ä¸”è¿˜è¦æ˜ç¡®æ¯æ¬¡é€’å½’çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆè¿›è€Œç¡®å®šé€’å½’å‡½æ•°çš„è¿”å›ç±»å‹ã€‚\n\n\nç¡®å®šç»ˆæ­¢æ¡ä»¶ï¼šÂ å†™å®Œäº†é€’å½’ç®—æ³•, è¿è¡Œçš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°æ ˆæº¢å‡ºçš„é”™è¯¯ï¼Œå°±æ˜¯æ²¡å†™ç»ˆæ­¢æ¡ä»¶æˆ–è€…ç»ˆæ­¢æ¡ä»¶å†™çš„ä¸å¯¹ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿæ˜¯ç”¨ä¸€ä¸ªæ ˆçš„ç»“æ„æ¥ä¿å­˜æ¯ä¸€å±‚é€’å½’çš„ä¿¡æ¯ï¼Œå¦‚æœé€’å½’æ²¡æœ‰ç»ˆæ­¢ï¼Œæ“ä½œç³»ç»Ÿçš„å†…å­˜æ ˆå¿…ç„¶å°±ä¼šæº¢å‡ºã€‚\n\n\nç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘ï¼šÂ ç¡®å®šæ¯ä¸€å±‚é€’å½’éœ€è¦å¤„ç†çš„ä¿¡æ¯ã€‚åœ¨è¿™é‡Œä¹Ÿå°±ä¼šé‡å¤è°ƒç”¨è‡ªå·±æ¥å®ç°é€’å½’çš„è¿‡ç¨‹ã€‚\n\n\näºŒå‰æ ‘çš„å®šä¹‰\npublic class TreeNode &#123;    int val;    TreeNode left;    TreeNode right;    TreeNode() &#123;&#125;    TreeNode(int val) &#123; this.val = val; &#125;    TreeNode(int val, TreeNode left, TreeNode right) &#123;        this.val = val;        this.left = left;        this.right = right;    &#125;&#125;\nç»å…¸é¢˜ç›®\néå†æ–¹å¼\n\nâ—äºŒå‰æ ‘çš„é€’å½’éå†ã€äºŒå‰æ ‘çš„è¿­ä»£éå†ã€äºŒå‰æ ‘çš„ç»Ÿä¸€è¿­ä»£æ³•ï¼š(https://kiml.site/posts/a297f438/)\näºŒå‰æ ‘çš„å±‚åºéå†\n\nå±‚åºéå†ç›¸å…³çš„é¢˜ç›®æ¯”è¾ƒå¤šï¼Œæ²¡æœ‰å†™åˆ°ç¬”è®°é‡Œé¢ã€‚ï¼ˆä¸€ä¸ªæ¨¡æ¿å¯ä»¥åšåé“é¢˜ï¼Œéƒ¨åˆ†åœ¨ github ä¸Šæäº¤äº†ï¼Œéƒ¨åˆ†æ²¡æœ‰åšã€‚ï¼‰\näºŒå‰æ ‘çš„å±æ€§\n\n\næ˜¯å¦å¯¹ç§°ã€ç›¸åŒ\n\n\n\nå¯¹ç§°äºŒå‰æ ‘\né€’å½’ï¼šååºéå†ã€‚åˆ¤æ–­å·¦å³å­æ ‘ï¼šå·¦å³ä¸­ã€å³å·¦ä¸­æ˜¯å¦ç›¸ç­‰ã€‚\nè¿­ä»£ï¼šä½¿ç”¨é˜Ÿåˆ—/æ ˆå°†ä¸¤ä¸ªèŠ‚ç‚¹é¡ºåºæ”¾å…¥å®¹å™¨ä¸­è¿›è¡Œæ¯”è¾ƒã€‚\n\n\n\næ±‚æœ€å¤§æ·±åº¦\n\n\n\näºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦\né€’å½’ï¼šååºéå†ï¼Œæ±‚æ ¹èŠ‚ç‚¹æœ€å¤§é«˜åº¦å°±æ˜¯æœ€å¤§æ·±åº¦ï¼Œé€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›å€¼åšè®¡ç®—æ ‘çš„é«˜åº¦ã€‚\n\n\n\næ±‚æœ€å°æ·±åº¦\n\n\n\näºŒå‰æ ‘çš„æœ€å°æ·±åº¦\né€’å½’ï¼šååºéå†ï¼Œå³èŠ‚ç‚¹ä¸ºç©ºï¼Œå‘å·¦é€’å½’ï¼›å·¦èŠ‚ç‚¹ä¸ºç©ºï¼Œå‘å³é€’å½’ã€‚\n\n\n\næ±‚èŠ‚ç‚¹æ•°\n\n\n\nå®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°\næ™®é€šäºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ï¼šå±‚åºéå†\nå®Œå…¨äºŒå‰æ ‘ï¼š\nåˆ†ä¸¤ç§æƒ…å†µï¼šæ»¡äºŒå‰æ ‘/æœ€åä¸€å±‚èŠ‚ç‚¹æ²¡æœ‰æ»¡ã€‚ä½†æ˜¯è¿™ä¸¤ç§æƒ…å†µå¯ä»¥ç®€åŒ–ä¸ºä¸€ç§ï¼Œå³å­©å­èŠ‚ç‚¹å¿…å®šä¸ºæ»¡äºŒå‰æ ‘ï¼ˆæŒ‰æ»¡äºŒå‰æ ‘ç®—èŠ‚ç‚¹ï¼‰\näºæ˜¯å°±å˜æˆåˆ¤æ–­å­æ ‘æ˜¯å¦æ˜¯æ»¡äºŒå‰æ ‘ï¼šå‘å·¦é€’å½’çš„æ·±åº¦ç­‰äºå‘å³é€’å½’çš„æ·±åº¦\n\n\n\næ˜¯å¦å¹³è¡¡\n\n\n\nå¹³è¡¡äºŒå‰æ ‘\né€’å½’ï¼šååºéå†ã€‚åˆ¤æ–­å­æ ‘æ˜¯å¦å¹³è¡¡å¹¶æŠŠç»“æœå‘ä¸Šä¼ é€’ã€‚\n\n\n\næ‰¾æ‰€æœ‰è·¯å¾„\n\n\n\näºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„\né€’å½’ï¼šå‰åºéå†ã€‚æ¶‰åŠå›æº¯ã€‚\n\n\n\næ±‚å·¦å¶å­ä¹‹å’Œ\n\n\n\nå·¦å¶å­ä¹‹å’Œ\né€’å½’ï¼šååºéå†ã€‚\n\n\n\næ±‚å·¦ä¸‹è§’çš„å€¼ã€‚\n\n\n\næ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼\né€’å½’ï¼šé¡ºåºæ²¡æœ‰å…³ç³»ã€‚æ‰¾æ·±åº¦æœ€å¤§çš„å·¦å¶å­èŠ‚ç‚¹ï¼ˆä¼˜å…ˆå·¦éå†ï¼‰ã€‚\nè¿­ä»£ï¼šæ„Ÿè§‰å±‚åºéå†æ›´ç®€å•ä¸€ç‚¹ã€‚\n\n\n\næ±‚è·¯å¾„æ€»å’Œ\n\n\n\nè·¯å¾„æ€»å’Œã€è·¯å¾„æ€»å’Œii\né€’å½’ï¼šéœ€è¦å›æº¯ã€‚\n\näºŒå‰æ ‘çš„ä¿®æ”¹ä¸æ„é€ \n\n\nç¿»è½¬äºŒå‰æ ‘\n\n\n\nç¿»è½¬äºŒå‰æ ‘\né€’å½’ï¼šä¸­åºä¸è¡Œã€‚å·¦å³ä¸¤æ•°äº¤æ¢æŒ‡é’ˆã€‚\n\n\n\næ„é€ äºŒå‰æ ‘\n\n\n\nä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ã€ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘\næœ€å¤§äºŒå‰æ ‘\né€’å½’ï¼šæ€è·¯å°±æ˜¯æ ¹æ®ååº/å‰åºçš„éå†ç»“æœã€‚åˆ‡å‰²ä¸­åºï¼Œå†é€’å½’æ„é€ ã€‚\n\n\n\nåˆå¹¶äºŒå‰æ ‘\n\n\n\nåˆå¹¶äºŒå‰æ ‘\né€’å½’ï¼šå‰åºéå†ã€‚\n\næœ€è¿‘å…¬å…±ç¥–å…ˆ\n\näºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼šä»åº•å±‚å‘ä¸Šä¼ é€’ä¿¡æ¯ï¼ˆåªèƒ½ç”¨ååºï¼‰ã€‚æ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å­æ ‘å« pï¼Œå³å­æ ‘å« qï¼ˆå¯ä»¥å…ˆäº¤æ¢ä¸¤ä¸ªæ•°çš„å¤§å°é¡ºåºï¼‰\näºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼šéå†é¡ºåºéšä¾¿ã€‚é‡ç‚¹åœ¨å½“æˆ‘ä»¬ä»ä¸Šå‘ä¸‹å»é€’å½’éå†ï¼Œç¬¬ä¸€æ¬¡é‡åˆ° cur èŠ‚ç‚¹æ˜¯æ•°å€¼åœ¨ [q, p] åŒºé—´ä¸­ï¼Œé‚£ä¹ˆ cur å°±æ˜¯ q å’Œ p çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚\n\näºŒå‰æœç´¢æ ‘çš„å±æ€§\n\n\néå†\n\n\n\näºŒå‰æœç´¢æ ‘ä¸­çš„æœç´¢ï¼šäºŒå‰æœç´¢æ ‘çš„éå†æ˜¯æœ‰æ–¹å‘çš„ã€‚\n\n\n\nä¸­åºéå†ä¸‹ï¼Œè¾“å‡ºçš„äºŒå‰æœç´¢æ ‘èŠ‚ç‚¹çš„æ•°å€¼æ˜¯æœ‰åºåºåˆ—ã€‚\n\n\n\néªŒè¯äºŒå‰æœç´¢æ ‘\næ˜“é”™ç‚¹ï¼šå·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹å°äºä¸­é—´èŠ‚ç‚¹ï¼Œå³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹å¤§äºä¸­é—´èŠ‚ç‚¹\n\n\n\npre æ ‡è®°å‰èŠ‚ç‚¹çš„åŒæŒ‡é’ˆç”¨æ³•\n\n\n\néªŒè¯äºŒå‰æœç´¢æ ‘\näºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®\näºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°\næŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘\n\näºŒå‰æœç´¢æ ‘çš„ä¿®æ”¹ä¸æ„é€ \n\n\næ’å…¥æ“ä½œ\n\n\n\näºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œï¼šæ‰¾åˆ°ä½ç½®ç›´æ¥æ’å…¥\n\n\n\nåˆ é™¤æ“ä½œ\n\n\n\nåˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„èŠ‚ç‚¹ï¼šåˆ é™¤éå¶å­èŠ‚ç‚¹ï¼šç”¨å³å­æ ‘é¡¶ä½ï¼ˆæ¯”è¾ƒå¥½ç†è§£ï¼‰ã€‚\nä¿®å‰ªäºŒå‰æœç´¢æ ‘ï¼šéœ€è¦æ³¨æ„ä¿®å‰ªæƒ…å†µã€‚\n\n\n\næ„é€ äºŒå‰æ ‘\n\n\n\nå°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘ï¼šä¸æ„é€ äºŒå‰æ ‘åŸºæœ¬ä¸€è‡´ã€‚æ‰¾åˆ°ä¸­é—´èŠ‚ç‚¹ååˆ‡å‰²ã€‚\n\næ€»ç»“\n\n\næ¶‰åŠåˆ°äºŒå‰æ ‘çš„æ„é€ ï¼Œæ— è®ºæ™®é€šäºŒå‰æ ‘è¿˜æ˜¯äºŒå‰æœç´¢æ ‘ä¸€å®šå‰åºï¼Œéƒ½æ˜¯å…ˆæ„é€ ä¸­èŠ‚ç‚¹ã€‚\n\n\næ±‚æ™®é€šäºŒå‰æ ‘çš„å±æ€§ï¼Œä¸€èˆ¬æ˜¯ååºï¼Œä¸€èˆ¬è¦é€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›å€¼åšè®¡ç®—ã€‚\n\n\næ±‚äºŒå‰æœç´¢æ ‘çš„å±æ€§ï¼Œä¸€å®šæ˜¯ä¸­åºäº†ï¼Œè¦ä¸ç™½çäº†æœ‰åºæ€§äº†ã€‚\n\n\nç®—æ³•\nå›æº¯ç®—æ³•\nç†è®ºåŸºç¡€\n\nå›æº¯æ³•ä¹Ÿå¯ä»¥å«åšå›æº¯æœç´¢æ³•ï¼Œå®ƒæ˜¯ä¸€ç§æœç´¢çš„æ–¹å¼ã€‚\nå›æº¯æ³•è§£å†³çš„é—®é¢˜éƒ½å¯ä»¥æŠ½è±¡ä¸ºæ ‘å½¢ç»“æ„ã€‚å› ä¸ºå›æº¯æ³•è§£å†³çš„éƒ½æ˜¯åœ¨é›†åˆä¸­é€’å½’æŸ¥æ‰¾å­é›†ï¼Œé›†åˆçš„å¤§å°å°±æ„æˆäº†æ ‘çš„å®½åº¦ï¼Œé€’å½’çš„æ·±åº¦å°±æ„æˆäº†æ ‘çš„æ·±åº¦ã€‚\n\næ•ˆç‡ï¼šå›æº¯æ³•å¹¶ä¸æ˜¯ä»€ä¹ˆé«˜æ•ˆçš„ç®—æ³•ã€‚å› ä¸ºå›æº¯çš„æœ¬è´¨æ˜¯ç©·ä¸¾\nèƒ½è§£å†³çš„é—®é¢˜ï¼šç»„åˆé—®é¢˜ã€åˆ‡å‰²é—®é¢˜ã€å­é›†é—®é¢˜ã€æ’åˆ—é—®é¢˜ã€æ£‹ç›˜é—®é¢˜ã€‚\nå›æº¯æ³•æ¨¡æ¿\nfor å¾ªç¯æ¨ªå‘éå†ï¼Œé€’å½’çºµå‘éå†ï¼Œå›æº¯ä¸æ–­è°ƒæ•´ç»“æœé›†ã€‚\n\n\nå›æº¯å‡½æ•°æ¨¡æ¿è¿”å›å€¼ä»¥åŠå‚æ•°å›æº¯ç®—æ³•ä¸­å‡½æ•°è¿”å›å€¼ä¸€èˆ¬ä¸º voidã€‚\n\n\nå›æº¯å‡½æ•°ç»ˆæ­¢æ¡ä»¶\n\n\nå›æº¯æœç´¢çš„éå†è¿‡ç¨‹\n\n\nvoid backtracking(å‚æ•°) &#123;    if (ç»ˆæ­¢æ¡ä»¶) &#123;        å­˜æ”¾ç»“æœ;        return;    &#125;    for (é€‰æ‹©ï¼šæœ¬å±‚é›†åˆä¸­å…ƒç´ ï¼ˆæ ‘ä¸­èŠ‚ç‚¹å­©å­çš„æ•°é‡å°±æ˜¯é›†åˆçš„å¤§å°ï¼‰) &#123;        å¤„ç†èŠ‚ç‚¹;        backtracking(è·¯å¾„ï¼Œé€‰æ‹©åˆ—è¡¨); // é€’å½’        å›æº¯ï¼Œæ’¤é”€å¤„ç†ç»“æœ    &#125;&#125;\nâ—å‰ªæ\nå‰ªæç²¾é«“æ˜¯ï¼šfor å¾ªç¯åœ¨å¯»æ‰¾èµ·ç‚¹çš„æ—¶å€™è¦æœ‰ä¸€ä¸ªèŒƒå›´ï¼Œå¦‚æœè¿™ä¸ªèµ·ç‚¹åˆ°é›†åˆç»ˆæ­¢ä¹‹é—´çš„å…ƒç´ å·²ç»ä¸å¤Ÿ é¢˜ç›®è¦æ±‚çš„ k ä¸ªå…ƒç´ äº†ï¼Œå°±æ²¡æœ‰å¿…è¦æœç´¢äº†ã€‚\nâ—å»é‡\n\nå»é‡åŒ…æ‹¬ â€œæ ‘æå»é‡â€å’Œâ€œæ ‘å±‚å»é‡â€ã€‚å¦‚å›¾æ‰€ç¤ºï¼šåœ¨ candidates[i] == candidates[i - 1] ç›¸åŒçš„æƒ…å†µä¸‹ï¼š\n\n\nused[i - 1] == trueï¼Œè¯´æ˜åŒä¸€æ ‘æ candidates[i - 1] ä½¿ç”¨è¿‡\n\n\nused[i - 1] == falseï¼Œè¯´æ˜åŒä¸€æ ‘å±‚ candidates[i - 1] ä½¿ç”¨è¿‡\n\n\nç»å…¸é¢˜ç›®\nå›æº¯ç®—æ³•èƒ½è§£å†³å¦‚ä¸‹é¢˜ç›®ï¼š\n\n\nç»„åˆé—®é¢˜ï¼šN ä¸ªæ•°é‡Œé¢æŒ‰ä¸€å®šè§„åˆ™æ‰¾å‡º k ä¸ªæ•°çš„é›†åˆ\n\n\næ’åˆ—é—®é¢˜ï¼šN ä¸ªæ•°æŒ‰ä¸€å®šè§„åˆ™å…¨æ’åˆ—ï¼Œæœ‰å‡ ç§æ’åˆ—æ–¹å¼\n\n\nåˆ‡å‰²é—®é¢˜ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æŒ‰ä¸€å®šè§„åˆ™æœ‰å‡ ç§åˆ‡å‰²æ–¹å¼\n\n\nå­é›†é—®é¢˜ï¼šä¸€ä¸ª N ä¸ªæ•°çš„é›†åˆé‡Œæœ‰å¤šå°‘ç¬¦åˆæ¡ä»¶çš„å­é›†\n\n\næ£‹ç›˜é—®é¢˜ï¼šN çš‡åï¼Œè§£æ•°ç‹¬ç­‰ç­‰\n\n\nç»„åˆé—®é¢˜\nå›æº¯ç®—æ³•çš„ç²¾é«“åœ¨äºï¼šfor å¾ªç¯æ¨ªå‘éå†ï¼Œé€’å½’çºµå‘éå†ï¼Œå›æº¯ä¸æ–­è°ƒæ•´ç»“æœé›†ï¼Œä¼˜åŒ–å›æº¯ç®—æ³•åªæœ‰å‰ªæä¸€ç§æ–¹æ³•ã€‚åšé¢˜å‰å¯ä»¥å…ˆæŠŠé¢˜ç›®æŠ½è±¡æˆæ ‘ï¼Œè¿™æ ·å‰ªææ“ä½œä¹Ÿæ¯”è¾ƒå¥½ç†è§£ã€‚\n\nç»„åˆ\nç»„åˆæ€»å’ŒIIIï¼šç›¸å½“äºç»„åˆé—®é¢˜åŠ äº†ä¸€ä¸ªå…ƒç´ æ€»å’Œçš„é™åˆ¶ã€‚ï¼ˆå¤§äºå…ƒç´ æ€»å’Œéœ€è¦å‰ªæï¼‰\nç»„åˆæ€»å’Œï¼šç»™å‡ºçš„é›†åˆæ˜¯ä¸é‡å¤çš„ï¼Œä½†æ˜¯å…ƒç´ å¯ä»¥ã€‚\nç»„åˆæ€»å’ŒIIï¼šç»™å‡ºçš„é›†åˆå…ƒç´ æ˜¯æœ‰é‡å¤çš„ï¼Œä½†æ˜¯è¦æ±‚è§£é›†ä¸é‡å¤ã€‚éš¾ç‚¹åœ¨å»é‡\nç”µè¯å·ç çš„å­—æ¯ç»„åˆï¼šå¤šä¸ªé›†åˆæ±‚ç»„åˆçš„é—®é¢˜ã€‚\n\nåˆ‡å‰²é—®é¢˜\n\nåˆ†å‰²å›æ–‡ä¸²ï¼šç±»ä¼¼ç»„åˆé—®é¢˜ï¼Œä½†æ˜¯æ±‚å€¼å¤„ä¸ºä¸€ä¸ªèŒƒå›´æˆªå–ã€‚\nå¤åŸIPåœ°å€\n\nå­é›†é—®é¢˜\n\nå­é›†ï¼šæ ‘å½¢ç»“æ„ä¸­å­é›†é—®é¢˜æ˜¯è¦æ”¶é›†æ‰€æœ‰èŠ‚ç‚¹çš„ç»“æœï¼Œè€Œç»„åˆé—®é¢˜æ˜¯æ”¶é›†å¶å­èŠ‚ç‚¹çš„ç»“æœã€‚\nå­é›†IIï¼šåœ¨å­é›†é—®é¢˜çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†å»é‡ã€‚\né€’å¢å­åºåˆ—ï¼šå±‚å»é‡ã€‚\n\næ’åˆ—é—®é¢˜\n\nå…¨æ’åˆ—ï¼šæ’åˆ—æ¯å±‚éƒ½éœ€è¦ä» 0 å¼€å§‹æœç´¢ã€‚\n[å…¨æ’åˆ— II]ï¼šåœ¨æ’åˆ—çš„åŸºç¡€ä¸ŠåŠ ä¸Šå»é‡ã€‚\n\nå›¾è®ºé¢å¤–æ‹“å±•\n\né‡æ–°å®‰æ’è¡Œç¨‹\n\næ£‹ç›˜é—®é¢˜\n\nNçš‡å\nè§£æ•°ç‹¬\n\næ€§èƒ½åˆ†æ\nè¿™æ®µç›´æ¥æŠ„çš„ (https://programmercarl.com/å›æº¯æ€»ç»“.html)\nå­é›†é—®é¢˜åˆ†æï¼š\n\n\næ—¶é—´å¤æ‚åº¦ï¼šO(2^n)ï¼Œå› ä¸ºæ¯ä¸€ä¸ªå…ƒç´ çš„çŠ¶æ€æ— å¤–ä¹å–ä¸ä¸å–ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸º O(2^n)\n\n\nç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œé€’å½’æ·±åº¦ä¸º nï¼Œæ‰€ä»¥ç³»ç»Ÿæ ˆæ‰€ç”¨ç©ºé—´ä¸º O(n)ï¼Œæ¯ä¸€å±‚é€’å½’æ‰€ç”¨çš„ç©ºé—´éƒ½æ˜¯å¸¸æ•°çº§åˆ«ï¼Œæ³¨æ„ä»£ç é‡Œçš„ result å’Œ path éƒ½æ˜¯å…¨å±€å˜é‡ï¼Œå°±ç®—æ˜¯æ”¾åœ¨å‚æ•°é‡Œï¼Œä¼ çš„ä¹Ÿæ˜¯å¼•ç”¨ï¼Œå¹¶ä¸ä¼šæ–°ç”³è¯·å†…å­˜ç©ºé—´ï¼Œæœ€ç»ˆç©ºé—´å¤æ‚åº¦ä¸º O(n)\næ’åˆ—é—®é¢˜åˆ†æï¼š\n\n\næ—¶é—´å¤æ‚åº¦ï¼šO(n!)ï¼Œè¿™ä¸ªå¯ä»¥ä»æ’åˆ—çš„æ ‘å½¢å›¾ä¸­å¾ˆæ˜æ˜¾å‘ç°ï¼Œæ¯ä¸€å±‚èŠ‚ç‚¹ä¸º nï¼Œç¬¬äºŒå±‚æ¯ä¸€ä¸ªåˆ†æ”¯éƒ½å»¶ä¼¸äº† n-1 ä¸ªåˆ†æ”¯ï¼Œå†å¾€ä¸‹åˆæ˜¯ n-2 ä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥ä¸€ç›´åˆ°å¶å­èŠ‚ç‚¹ä¸€å…±å°±æ˜¯ n * n-1 * n-2 * â€¦â€¦ 1 = n!ã€‚\n\n\nç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå’Œå­é›†é—®é¢˜åŒç†ã€‚ç»„åˆé—®é¢˜åˆ†æï¼š\n\n\næ—¶é—´å¤æ‚åº¦ï¼šO(2^n)ï¼Œç»„åˆé—®é¢˜å…¶å®å°±æ˜¯ä¸€ç§å­é›†çš„é—®é¢˜ï¼Œæ‰€ä»¥ç»„åˆé—®é¢˜æœ€åçš„æƒ…å†µï¼Œä¹Ÿä¸ä¼šè¶…è¿‡å­é›†é—®é¢˜çš„æ—¶é—´å¤æ‚åº¦ã€‚\n\n\nç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå’Œå­é›†é—®é¢˜åŒç†ã€‚\nN çš‡åé—®é¢˜åˆ†æï¼š\n\n\næ—¶é—´å¤æ‚åº¦ï¼šO(n!) ï¼Œå…¶å®å¦‚æœçœ‹æ ‘å½¢å›¾çš„è¯ï¼Œç›´è§‰ä¸Šæ˜¯ O(n^n)ï¼Œä½†çš‡åä¹‹é—´ä¸èƒ½è§é¢æ‰€ä»¥åœ¨æœç´¢çš„è¿‡ç¨‹ä¸­æ˜¯æœ‰å‰ªæçš„ï¼Œæœ€å·®ä¹Ÿå°±æ˜¯ Oï¼ˆn!ï¼‰ï¼Œn!è¡¨ç¤º n * (n-1) * â€¦. * 1ã€‚\n\n\nç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå’Œå­é›†é—®é¢˜åŒç†ã€‚è§£æ•°ç‹¬é—®é¢˜åˆ†æï¼š\n\n\næ—¶é—´å¤æ‚åº¦ï¼šO(9^m) , m æ˜¯ â€˜.â€™ çš„æ•°ç›®ã€‚\n\n\nç©ºé—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œé€’å½’çš„æ·±åº¦æ˜¯ n^2\n\n\nè´ªå¿ƒç®—æ³•\nè´ªå¿ƒçš„æœ¬è´¨æ˜¯é€‰æ‹©æ¯ä¸€é˜¶æ®µçš„å±€éƒ¨æœ€ä¼˜ï¼Œä»è€Œè¾¾åˆ°å…¨å±€æœ€ä¼˜ã€‚\nä¸€èˆ¬è§£é¢˜æ­¥éª¤ï¼ˆä¸ä¸€å®šèƒ½ç”¨ï¼‰\n\n\nå°†é—®é¢˜åˆ†è§£ä¸ºè‹¥å¹²ä¸ªå­é—®é¢˜\n\n\næ‰¾å‡ºé€‚åˆçš„è´ªå¿ƒç­–ç•¥\n\n\næ±‚è§£æ¯ä¸€ä¸ªå­é—®é¢˜çš„æœ€ä¼˜è§£\n\n\nå°†å±€éƒ¨æœ€ä¼˜è§£å †å æˆå…¨å±€æœ€ä¼˜è§£\n\n\nç»å…¸é¢˜ç›®\nå› ä¸ºè´ªå¿ƒç®—æ³•æ²¡æœ‰ä»€ä¹ˆå¥—è·¯ï¼Œæ‰€ä»¥åˆ·é¢˜å¾ˆéš¾åˆ†ç±»ã€‚\nç®€å•é¢˜\n\nåˆ†å‘é¥¼å¹²\nKæ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ\næŸ æª¬æ°´æ‰¾é›¶\n\nä¸­ç­‰é¢˜\n\næ‘†åŠ¨åºåˆ—\nå•è°ƒé€’å¢çš„æ•°å­—\nè´ªå¿ƒè§£å†³è‚¡ç¥¨é—®é¢˜\nä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII\nä¸¤ä¸ªç»´åº¦æƒè¡¡é—®é¢˜\nåˆ†å‘ç³–æœ\næ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—\n\néš¾é¢˜\n\nåŒºé—´é—®é¢˜\nè·³è·ƒæ¸¸æˆ\nè·³è·ƒæ¸¸æˆII\nç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ\næ— é‡å åŒºé—´\nåˆ’åˆ†å­—æ¯åŒºé—´\nåˆå¹¶åŒºé—´\nå…¶ä»–éš¾é¢˜\næœ€å¤§å­åºå’Œ\nåŠ æ²¹ç«™\nç›‘æ§äºŒå‰æ ‘\n\nåŠ¨æ€è§„åˆ’\n\nåŠ¨æ€è§„åˆ’ï¼Œè‹±æ–‡ï¼šDynamic Programmingï¼Œç®€ç§° DPï¼Œå¦‚æœæŸä¸€é—®é¢˜æœ‰å¾ˆå¤šé‡å å­é—®é¢˜ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’æ˜¯æœ€æœ‰æ•ˆçš„ã€‚\n\nè§£é¢˜æ­¥éª¤\n\n\nç¡®å®š dp æ•°ç»„ï¼ˆdp tableï¼‰ä»¥åŠä¸‹æ ‡çš„å«ä¹‰\n\n\nç¡®å®šé€’æ¨å…¬å¼\n\n\ndp æ•°ç»„å¦‚ä½•åˆå§‹åŒ–\n\n\nç¡®å®šéå†é¡ºåº\n\n\nä¸¾ä¾‹æ¨å¯¼ dp æ•°ç»„\nå¦‚ä½• Debug : æ‰¾é—®é¢˜çš„æœ€å¥½æ–¹å¼å°±æ˜¯æŠŠ dp æ•°ç»„æ‰“å°å‡ºæ¥ï¼Œçœ‹çœ‹ç©¶ç«Ÿæ˜¯ä¸æ˜¯æŒ‰ç…§è‡ªå·±æ€è·¯æ¨å¯¼çš„ï¼\n\n\nç»å…¸é¢˜ç›®\nåŠ¨æ€è§„åˆ’åŸºç¡€\n\næ–æ³¢é‚£å¥‘æ•°\nçˆ¬æ¥¼æ¢¯\nä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯\nä¸åŒè·¯å¾„\nä¸åŒè·¯å¾„ II\næ•´æ•°æ‹†åˆ†\n\nèƒŒåŒ…é—®é¢˜\n\n\né—®èƒ½å¦èƒ½è£…æ»¡èƒŒåŒ…ï¼ˆæˆ–è€…æœ€å¤šè£…å¤šå°‘ï¼‰ï¼šdp[j] = max(dp[j], dp[j - nums[i]] + nums[i])\n\nåˆ†å‰²ç­‰å’Œå­é›†ï¼š01 èƒŒåŒ…\næœ€åä¸€å—çŸ³å¤´çš„é‡é‡ IIï¼š01 èƒŒåŒ…\n\né—®è£…æ»¡èƒŒåŒ…æœ‰å‡ ç§æ–¹æ³•ï¼šdp[j] += dp[j - nums[i]]\n\nç›®æ ‡å’Œï¼š01 èƒŒåŒ…\né›¶é’±å…‘æ¢ IIï¼šå®Œå…¨èƒŒåŒ…ã€ç»„åˆ\nç»„åˆæ€»å’Œ â…£ï¼šå®Œå…¨èƒŒåŒ…ã€æ’åˆ—\nçˆ¬æ¥¼æ¢¯ ï¼ˆè¿›é˜¶ï¼‰ï¼šå®Œå…¨èƒŒåŒ…ã€æ’åˆ—\n\né—®èƒŒåŒ…è£…æ»¡æœ€å¤§ä»·å€¼ï¼šdp[j] = max(dp[j], dp[j - weight[i]] + value[i])\n\nä¸€å’Œé›¶ï¼š01 èƒŒåŒ…\n\né—®è£…æ»¡èƒŒåŒ…æ‰€æœ‰ç‰©å“çš„æœ€å°ä¸ªæ•°ï¼šdp[j] = min(dp[j - coins[i]] + 1, dp[j])\n\né›¶é’±å…‘æ¢ï¼šå®Œå…¨èƒŒåŒ…ã€‚æ±‚æœ€å°æ•°ï¼ˆfor å¾ªç¯å…ˆåé¡ºåºæ— æ‰€è°“ï¼‰\nå®Œå…¨å¹³æ–¹æ•°ï¼šå®Œå…¨èƒŒåŒ…ã€‚æ±‚æœ€å°æ•°ï¼ˆfor å¾ªç¯å…ˆåé¡ºåºæ— æ‰€è°“ï¼‰\n\n\néå†é¡ºåº\n\n\n01 èƒŒåŒ…\n\näºŒç»´ dp æ•°ç»„ï¼šå…ˆéå†èƒŒåŒ…/å…ˆéå†ç‰©å“éƒ½å¯ä»¥\nä¸€ç»´ dp æ•°ç»„ï¼šåªèƒ½å…ˆéå†ç‰©å“å†éå†èƒŒåŒ…å®¹é‡ï¼Œç¬¬äºŒå±‚ for å¾ªç¯éœ€è¦ä»å¤§åˆ°å°éå†\n\n\n\nå®Œå…¨èƒŒåŒ…\n\nä¸€ç»´ dp æ•°ç»„ï¼šç¬¬äºŒå±‚ for å¾ªç¯ä»å°åˆ°å¤§éå†ã€‚å¦‚æœæ±‚ç»„åˆæ•°å°±æ˜¯å¤–å±‚ for å¾ªç¯éå†ç‰©å“ï¼Œå†…å±‚ for éå†èƒŒåŒ…ã€‚å¦‚æœæ±‚æ’åˆ—æ•°å°±æ˜¯å¤–å±‚ for éå†èƒŒåŒ…ï¼Œå†…å±‚ for å¾ªç¯éå†ç‰©å“ã€‚å¦‚æœæ˜¯æ±‚æœ€å°æ•°ï¼Œé‚£ä¹ˆä¸¤å±‚ for å¾ªç¯æ’åˆ—çš„å…ˆåé¡ºåºæ— æ‰€è°“ã€‚\n\n\n\næ‰“å®¶åŠ«èˆ\n\næ‰“å®¶åŠ«èˆ\næ‰“å®¶åŠ«èˆ II\næ‰“å®¶åŠ«èˆ III\n\né€’æ¨å…¬å¼\nä¸€èˆ¬éƒ½æ˜¯è¦æ±‚ç›¸é‚»æ ¼å­è¦è·³è¿‡ï¼Œæ‰€ä»¥å…¬å¼ä»å‰å‰ä¸ªè·å–ï¼ˆå› æ­¤åˆå§‹åŒ–æ•°ç»„éœ€è¦ 0ï¼Œ1 ä½ç½®ï¼‰ï¼šdp[i] = Math.max(dp[i - 1], dp[i - 2] + nums[i])\nè‚¡ç¥¨é—®é¢˜\n\nä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº\nä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II\nä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III\nä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV\næœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ\nä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹\n\né€’æ¨å…¬å¼\ndp æ•°ç»„çš„å®šä¹‰ä¸ºäºŒç»´æ•°ç»„ï¼ˆå¯ä»¥å¡Œç¼©ï¼Œä½†æ˜¯äºŒç»´æ¯”è¾ƒå¥½ç†è§£ï¼‰ï¼šä¸åŒçŠ¶æ€è®¡å…¥æ•°ç»„ã€‚å½“å¤©çŠ¶æ€ä¸€èˆ¬ä¸ºæŒæœ‰/ä¸æŒæœ‰ä¸¤ç§ï¼›å¦‚æœåŠ å…¥å¤©æ•°ï¼ŒçŠ¶æ€éœ€è¦å¢åŠ ç¬¬ä¸€å¤©æŒæœ‰/ä¸æŒæœ‰ï¼Œç¬¬äºŒå¤©æŒæœ‰/ä¸æŒæœ‰â€¦â€¦ã€‚æŒæœ‰çš„çŠ¶æ€é€’æ¨ä¸ºä¸Šä¸€æ¬¡ä¸æŒæœ‰ - å½“å¤©ä¹°å…¥è‚¡ç¥¨ä»·æ ¼ï¼›ä¸æŒæœ‰çš„çŠ¶æ€é€’æ¨ä¸ºä¸Šä¸€æ¬¡æŒæœ‰ + å½“å¤©å–å‡ºè‚¡ç¥¨çš„ä»·æ ¼ã€‚\nif (j % 2 == 0) &#123;        // å¶æ•°ä¹°å…¥        dp[i][j] = Math.max(dp[i - 1][j], dp[i - 1][j - 1] - prices[i]);    &#125; else &#123;        // å¥‡æ•°å–å‡º        dp[i][j] = Math.max(dp[i - 1][j], dp[i - 1][j - 1] + prices[i]);    &#125;\nç¼–è¾‘è·ç¦»\n\nåˆ¤æ–­å­åºåˆ—\nä¸åŒçš„å­åºåˆ—\nä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ\nç¼–è¾‘è·ç¦»\n\né€’æ¨å…¬å¼\ndp æ•°ç»„çš„å®šä¹‰ä¸ºäºŒç»´æ•°ç»„ï¼Œå¯ä»¥å¡Œç¼©ã€‚å®šä¹‰ï¼šç¬¬ä¸€ä¸ªå‚æ•°åˆ° i - 1ï¼›ç¬¬äºŒä¸ªå‚æ•°åˆ° j - 1 ä½ç½®çš„æ‰€æ±‚é‡ï¼ˆä¸ºä»€ä¹ˆè®°ä¸º i - 1ï¼Ÿï¼šä¸ºäº†åˆå§‹åŒ–æ–¹ä¾¿ï¼‰ã€‚å¾ªç¯ä»å·¦å‘å³ä»ä¸Šåˆ°ä¸‹ï¼ˆæ­¤æ­¥å¯ä»¥ç”»å›¾æ¨¡æ‹Ÿï¼‰ã€‚æ ¹æ®ä¸¤ä¸ªæ•°ç»„å½“å‰ä½ç½®çš„å­—ç¬¦æ˜¯å¦ç›¸åŒï¼Œåˆ†åˆ«å†™å‡º dp å…¬å¼ã€‚\nfor (int i = 1; i &lt;= word1.length(); i++) &#123;        for (int j = 1; j &lt;= word2.length(); j++) &#123;            // å½“å‰æŒ‡é’ˆä½ç½®ç›¸åŒï¼Œdp[i][j] = dp[i - 1][j - 1] + 1            if (word1.charAt(i - 1) == word2.charAt(j - 1)) &#123;    \t        // æ­¤å¤„éœ€è¦å…·ä½“å…¬å¼å…·ä½“åˆ†æï¼Œä¸€èˆ¬ç›¸åŒæ—¶ï¼ŒçŠ¶æ€ç”±å·¦ä¸Šè§’æ¨å‡ºã€‚            dp[i][j] = dp[i - 1][j - 1];            &#125; else &#123; \t        // æ­¤å¤„éœ€è¦å…·ä½“å…¬å¼å…·ä½“åˆ†æï¼Œæ ¹æ®æ•°ç»„å…ƒç´ æ˜¯å¦èƒ½æ”¹å˜ï¼Œå¯ä»¥æœ‰ä¸‰ç§ä¸åŒçš„æƒ…å†µã€‚            dp[i][j] = Math.min(dp[i - 1][j] + 1, dp[i][j - 1] + 1);            &#125;        &#125;    &#125;\nå­åºåˆ—\n\nè¿ç»­ï¼š\n\næœ€é•¿é€’å¢å­åºåˆ—\næœ€é•¿å…¬å…±å­åºåˆ—\nä¸ç›¸äº¤çš„çº¿\n\nä¸è¿ç»­ï¼š\n\næœ€é•¿è¿ç»­é€’å¢åºåˆ—\næœ€é•¿é‡å¤å­æ•°ç»„\næœ€å¤§å­åºå’Œ\n\nç¼–è¾‘è·ç¦»ï¼šè¯¦è§ ç¼–è¾‘è·ç¦»æ¨¡å—\nå›æ–‡ï¼š\n\nå›æ–‡å­ä¸²\næœ€é•¿å›æ–‡å­åºåˆ—\n\n\nå•è°ƒæ ˆ\n\nä¸€ç»´æ•°ç»„ï¼Œè¦å¯»æ‰¾ä»»ä¸€ä¸ªå…ƒç´ çš„å³è¾¹æˆ–è€…å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”è‡ªå·±å¤§æˆ–è€…å°çš„å…ƒç´ çš„ä½ç½®ï¼Œæ­¤æ—¶å¯ä»¥ç”¨å•è°ƒæ ˆã€‚\n\nä½¿ç”¨å•è°ƒæ ˆä¸»è¦æœ‰ä¸‰ä¸ªåˆ¤æ–­æ¡ä»¶ã€‚\n\n\nå½“å‰éå†çš„å…ƒç´  T[i] å°äºæ ˆé¡¶å…ƒç´  T[st.top()] çš„æƒ…å†µ\n\n\nå½“å‰éå†çš„å…ƒç´  T[i] ç­‰äºæ ˆé¡¶å…ƒç´  T[st.top()] çš„æƒ…å†µ\n\n\nå½“å‰éå†çš„å…ƒç´  T[i] å¤§äºæ ˆé¡¶å…ƒç´  T[st.top()] çš„æƒ…å†µ\n\n\n\næ¯æ—¥æ¸©åº¦\nä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I\nä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II\næ¥é›¨æ°´\næŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢\n\n","categories":["é¢è¯•"],"tags":["é¢è¯•","åŒæŒ‡é’ˆ","æ•°ç»„","æ»‘åŠ¨çª—å£","é“¾è¡¨","å“ˆå¸Œè¡¨","å­—ç¬¦ä¸²","äºŒå‰æ ‘","äºŒå‰æœç´¢æ ‘","è´ªå¿ƒç®—æ³•","åŠ¨æ€è§„åˆ’","KMP"]},{"title":"æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰å‹ä¸ä¼˜ç¼ºç‚¹","url":"/posts/359ee88a/","content":"\n\nå‰è¨€é’ˆå¯¹æ¶ˆæ¯é˜Ÿåˆ—åšå‡ºçš„æ€»ç»“ã€‚\n\n\nå‚è€ƒæ–‡ç« \n\n\n\nRabbitMQè¶…è¯¦ç»†å®‰è£…æ•™ç¨‹ï¼ˆLinuxï¼‰\n\n\næ›´æ–°\n\n24-07-23 åˆå§‹è®°å½•24-08-09 è¡¥å…… RabbitMQ çš„å»¶è¿Ÿæ¶ˆæ¯\n\n\nMQ å…¨ç§°ä¸º Message Queueã€‚\nMQ ä¹Ÿè¢«ç§°ä¸ºæ¶ˆæ¯ä¸­é—´ä»¶ã€‚\nMQ ä¹Ÿæ˜¯å¾®æœåŠ¡ä¹‹é—´çš„é€šä¿¡çš„ä¸€ç§æ–¹å¼ã€‚\n\nä¸ºä»€ä¹ˆä½¿ç”¨ MQ\n\n\nä»»åŠ¡å¼‚æ­¥å¤„ç†å°†ä¸éœ€è¦åŒæ­¥å¤„ç†çš„å¹¶ä¸”è€—æ—¶é•¿çš„æ“ä½œç”±æ¶ˆæ¯é˜Ÿåˆ—é€šçŸ¥æ¶ˆæ¯æ¥æ”¶æ–¹è¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚æé«˜äº†åº”ç”¨ç¨‹åºçš„å“åº”æ—¶é—´ã€‚\n\n\nåº”ç”¨ç¨‹åºè§£è€¦åˆ\nMQ ç›¸å½“äºä¸€ä¸ªä¸­ä»‹ï¼Œç”Ÿäº§æ–¹é€šè¿‡ MQ ä¸æ¶ˆè´¹æ–¹äº¤äº’ï¼Œå®ƒå°†åº”ç”¨ç¨‹åºè¿›è¡Œè§£è€¦åˆã€‚\n\n\nå‰Šå³°å¡«è°·\n\n\næŠ€æœ¯é€‰å‹å¯¹æ¯”\n\nå¸‚é¢ä¸Šæœ‰å“ªäº›æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ\nActiveMQï¼ŒRabbitMQï¼ŒZeroMQï¼ŒKafkaï¼ŒMetaMQï¼ŒRedisã€‚\n\n\n\n\næ¶ˆæ¯é˜Ÿåˆ—\nä¼˜ç‚¹\nç¼ºç‚¹\n\n\n\n\nRabbitMQ\n1.æ”¯æŒ AMQP åè®®2.åŸºäº erlang è¯­è¨€å¼€å‘ï¼Œé«˜å¹¶å‘æ€§èƒ½è¾ƒå¥½3.å·¥ä½œæ¨¡å¼è¾ƒä¸ºçµæ´» 4.æ”¯æŒå»¶è¿Ÿæ¶ˆæ¯ 5.æä¾›è¾ƒä¸ºå‹å¥½çš„åå°ç®¡ç†é¡µé¢6.å•æœºéƒ¨ç½²ï¼Œ1~2WTPS\n1.ä¸æ”¯æŒæ°´å¹³æ‰©å®¹ 2.ä¸æ”¯æŒäº‹åŠ¡ 3.æ¶ˆæ¯ååé‡ä¸‰è€…æœ€å·® 4.å½“äº§ç”Ÿæ¶ˆæ¯å †ç§¯ï¼Œæ€§èƒ½ä¸‹é™æ˜æ˜¾ 5.æ¶ˆæ¯é‡å‘æœºåˆ¶éœ€è¦æ‰‹åŠ¨è®¾ç½® 6.ä¸æ”¯æŒæ¶ˆæ¯é‡å¤æ¶ˆè´¹\n\n\nRocketMQ\n1.é«˜å¯ç”¨ï¼Œé«˜ååé‡ï¼Œæµ·é‡æ¶ˆæ¯å †ç§¯ï¼Œä½å»¶è¿Ÿæ€§èƒ½ä¸Šï¼Œéƒ½è¡¨ç°å‡ºè‰² 2.api ä¸æ¶æ„è®¾è®¡æ›´åŠ è´´åˆ‡ä¸šåŠ¡åœºæ™¯ 3.æ”¯æŒé¡ºåºæ¶ˆæ¯ 4.æ”¯æŒäº‹åŠ¡æ¶ˆæ¯ 5.æ”¯æŒæ¶ˆæ¯è¿‡æ»¤ 6.æ”¯æŒé‡å¤æ¶ˆè´¹ 7.æ”¯æŒå»¶è¿Ÿæ¶ˆæ¯ 8.æ”¯æŒæ¶ˆæ¯è·Ÿè¸ª 9.å¤©ç„¶æ”¯æŒé›†ç¾¤ã€è´Ÿè½½å‡è¡¡ 10.æ”¯æŒæŒ‡å®šæ¬¡æ•°å’Œæ—¶é—´é—´éš”çš„å¤±è´¥æ¶ˆæ¯é‡å‘ 11.å•æœºéƒ¨ç½²ï¼Œ5~10WTPS\n1.ç”Ÿæ€åœˆç›¸è¾ƒ Kafka æœ‰æ‰€ä¸å¦‚ 2.æ¶ˆæ¯ååé‡ä¸æ¶ˆæ¯å †ç§¯èƒ½åŠ›ä¹Ÿä¸å¦‚ Kafka 3.ä¸æ”¯æŒä¸»ä»è‡ªåŠ¨åˆ‡æ¢ 4.åªæ”¯æŒ Java\n\n\nKafka\n1.é«˜å¯ç”¨ï¼Œé«˜ååé‡ï¼Œä½å»¶è¿Ÿæ€§èƒ½ä¸Šï¼Œéƒ½è¡¨ç°å‡ºè‰² 2.ä½¿ç”¨äººæ•°å¤šï¼ŒæŠ€æœ¯ç”Ÿæ€åœˆå®Œå–„ 3.æ”¯æŒé¡ºåºæ¶ˆæ¯ 4.æ”¯æŒå¤šç§å®¢æˆ·ç«¯ 5.æ”¯æŒé‡å¤æ¶ˆè´¹\n1.ä¾èµ–åˆ†åŒºï¼Œæ¶ˆè´¹è€…æ•°é‡å—é™äºåˆ†åŒºæ•° 2.å•æœºæ¶ˆæ¯è¿‡å¤šæ—¶ï¼Œæ€§èƒ½ä¸‹é™æ˜æ˜¾ 3.ä¸æ”¯æŒäº‹åŠ¡æ¶ˆæ¯ 4.ä¸æ”¯æŒæŒ‡å®šæ¬¡æ•°å’Œæ—¶é—´é—´éš”çš„å¤±è´¥æ¶ˆæ¯é‡å‘\n\n\n\næ¶ˆæ¯ä¸­é—´ä»¶å¯¹æ¯” - é€‰æ‹©å»ºè®®\n\n\n\næ¶ˆæ¯ä¸­é—´ä»¶\nå»ºè®®\n\n\n\n\nKafka\nè¿½æ±‚é«˜ååé‡ï¼Œé€‚åˆäº§ç”Ÿå¤§é‡æ•°æ®çš„äº’è”ç½‘æœåŠ¡çš„æ•°æ®æ”¶é›†ä¸šåŠ¡\n\n\nRocketMQ\nå¯é æ€§è¦æ±‚å¾ˆé«˜çš„é‡‘èäº’è”ç½‘é¢†åŸŸï¼Œç¨³å®šæ€§é«˜ï¼Œç»å†äº†å¤šæ¬¡é˜¿é‡ŒåŒ 11 è€ƒéªŒ\n\n\nRabbitMQ\næ€§èƒ½è¾ƒå¥½ï¼Œç¤¾åŒºæ´»è·ƒåº¦é«˜ï¼Œæ•°æ®é‡æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œä¼˜å…ˆé€‰æ‹©åŠŸèƒ½æ¯”è¾ƒå®Œå¤‡çš„ RabbitMQ\n\n\n\nRabbitMQ\nåŸºç¡€\n\nå®‰è£…\nWindows\n\n\nä¸‹è½½ RabbitMQï¼ˆhttps://www.rabbitmq.com/docs/downloadï¼‰\n\n\nä¸‹è½½ Erlangï¼ˆhttps://packagecloud.io/rabbitmq/erlangï¼‰ï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡\nErlang å’Œ RabbitMQ ç‰ˆæœ¬å¯¹ç…§ï¼šhttps://www.rabbitmq.com/which-erlang.html\n\n\nè¿è¡Œ RabbitMQ\n\n\n# å¼€å¯ç®¡ç†æ’ä»¶rabbitmq-plugins enable rabbitmq_management# å¯åŠ¨rabbitmq systemctl start rabbitmq-server # æŸ¥çœ‹rabbitmqçŠ¶æ€ systemctl status rabbitmq-server# è®¾ç½®rabbitmqæœåŠ¡å¼€æœºè‡ªå¯åŠ¨systemctl enable rabbitmq-server# å…³é—­rabbitmqæœåŠ¡systemctl stop rabbitmq-server# é‡å¯rabbitmqæœåŠ¡systemctl restart rabbitmq-server\nLinux\ndocker å®‰è£…\n# 1.yumåŒ…æ›´æ–°åˆ°æœ€æ–°yum update# 2.å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…(yum-utilsæä¾›yum-config-managerçš„åŠŸèƒ½,ï¼Œå¹¶ä¸”device mapperå­˜å‚¨é©±åŠ¨ç¨‹åºéœ€è¦device-mapper-persistent-dataå’Œlvm2)yum install -y yum-utils device-mapper-persistent-data lvm2# 3.è®¾ç½®yumæºä¸ºé˜¿é‡Œäº‘yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo# 4.å®‰è£…dockeryum install docker-ce -y# 5.å®‰è£…åæŸ¥çœ‹dockerç‰ˆæœ¬docker -v# 6.é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿsudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;&#123;  &quot;registry-mirrors&quot;: [&quot;https://73z5h6yb.mirror.aliyuncs.com&quot;]&#125;EOFsudo systemctl daemon-reloadsudo systemctl restart docker# å®‰è£…å¯åŠ¨rabbitmqå®¹å™¨docker run -d --name å®¹å™¨åç§° -e RABBITMQ_DEFAULT_USER=xxx -e RABBITMQ_DEFAULT_PASS=123456 -p 15672:15672 -p 5672:5672 rabbitmq:3.8.14-management\ndocker å¸¸ç”¨å‘½ä»¤\n# å¯åŠ¨dockersystemctl start docker# åœæ­¢dockersystemctl stop docker# é‡å¯dockersystemctl restart docker# æŸ¥çœ‹dockerçŠ¶æ€systemctl status docker# å¼€æœºå¯åŠ¨systemctl enable dockersystemctl unenable docker # æŸ¥çœ‹dockeræ¦‚è¦ä¿¡æ¯docker info # æŸ¥çœ‹dockerå¸®åŠ©æ–‡æ¡£docker --help\nä¸ä½¿ç”¨ docker\n\n\nä¸‹è½½ RabbitMQï¼ˆhttps://www.rabbitmq.com/docs/downloadï¼‰\n\n\nä¸‹è½½ Erlangï¼ˆhttps://packagecloud.io/rabbitmq/erlangï¼‰\nErlang å’Œ RabbitMQ ç‰ˆæœ¬å¯¹ç…§ï¼šhttps://www.rabbitmq.com/which-erlang.html\n\n\nå®‰è£… Erlang å’Œ RabbitMQ\n\n\n# å®‰è£… Erlang## è§£å‹rpm -Uvh erlang-23.2.7-2.el7.x86_64.rpm## å®‰è£…yum install -y erlang## å®‰è£…å®Œæˆåè¾“å…¥å¦‚ä¸‹æŒ‡ä»¤æŸ¥çœ‹ç‰ˆæœ¬å·erl -v# å®‰è£… RabbitMQ## åœ¨ RabiitMQ å®‰è£…è¿‡ç¨‹ä¸­éœ€è¦ä¾èµ– socat æ’ä»¶ï¼Œé¦–å…ˆå®‰è£…è¯¥æ’ä»¶yum install -y socat## è§£å‹ rpm -Uvh rabbitmq-server-3.8.14-1.el7.noarch.rpm ## å®‰è£… yum install -y rabbitmq-server## å¯åŠ¨rabbitmq systemctl start rabbitmq-server ## æŸ¥çœ‹rabbitmqçŠ¶æ€ systemctl status rabbitmq-server# å…¶ä»–å‘½ä»¤## è®¾ç½®rabbitmqæœåŠ¡å¼€æœºè‡ªå¯åŠ¨systemctl enable rabbitmq-server## å…³é—­rabbitmqæœåŠ¡systemctl stop rabbitmq-server## é‡å¯rabbitmqæœåŠ¡systemctl restart rabbitmq-server\n\n\nRabbitMQWeb ç®¡ç†ç•Œé¢åŠæˆæƒæ“ä½œ\n\n\n# æ‰“å¼€RabbitMQWebç®¡ç†ç•Œé¢æ’ä»¶ï¼Œç„¶åè®¿é—®æœåŠ¡å™¨å…¬ç½‘ip:15672ã€‚é»˜è®¤è´¦å·å¯†ç  guestï¼Œguestrabbitmq-plugins enable rabbitmq_management\n\n\næ·»åŠ è¿œç¨‹è´¦æˆ·\n\n\n# æ·»åŠ ç”¨æˆ·rabbitmqctl add_user ç”¨æˆ·å å¯†ç # è®¾ç½®ç”¨æˆ·è§’è‰²,åˆ†é…æ“ä½œæƒé™rabbitmqctl set_user_tags ç”¨æˆ·å è§’è‰²# ä¸ºç”¨æˆ·æ·»åŠ èµ„æºæƒé™(æˆäºˆè®¿é—®è™šæ‹Ÿæœºæ ¹èŠ‚ç‚¹çš„æ‰€æœ‰æƒé™)rabbitmqctl set_permissions -p / ç”¨æˆ·å &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;# ä¿®æ”¹å¯†ç rabbitmqctl change_ password ç”¨æˆ·å æ–°å¯†ç # åˆ é™¤ç”¨æˆ·rabbitmqctl delete_user ç”¨æˆ·å# æŸ¥çœ‹ç”¨æˆ·æ¸…å•rabbitmqctl list_users\nè§’è‰²æœ‰å››ç§ï¼š\n\n\nadministratorï¼šå¯ä»¥ç™»å½•æ§åˆ¶å°ã€æŸ¥çœ‹æ‰€æœ‰ä¿¡æ¯ã€å¹¶å¯¹ rabbitMQ è¿›è¡Œç®¡ç†\n\n\nmonToringï¼šç›‘æ§è€…ï¼›ç™»å½•æ§åˆ¶å°ï¼ŒæŸ¥çœ‹æ‰€æœ‰ä¿¡æ¯\n\n\npolicymakerï¼šç­–ç•¥åˆ¶å®šè€…ï¼›ç™»å½•æ§åˆ¶å°æŒ‡å®šç­–ç•¥\n\n\nmanagmentï¼šæ™®é€šç®¡ç†å‘˜ï¼›ç™»å½•æ§åˆ¶\n\n\nåŸºæœ¬ä½¿ç”¨\n\n\næ·»åŠ ä¾èµ–\n\n\n&lt;dependency&gt;      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;      &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;  &lt;/dependency&gt;\n\n\né…ç½®ä¿¡æ¯\n\n\nspring:  rabbitmq:      rabbitmq:    port: 5673    host: localhost    username: swsk33    password: 123456\näº”ç§æ¨¡å‹\nBasic Queue\n\nï¼ˆç®€å•é˜Ÿåˆ—æ¨¡å‹ï¼‰ï¼šä¸€ä¸ªç”Ÿäº§è€…ã€ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œä¸éœ€è¦è®¾ç½®äº¤æ¢æœºï¼ˆä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼‰\n\n// å‘é€æ¶ˆæ¯@Component  @Slf4j  public class RabbitMqSend &#123;      @Autowired      private AmqpTemplate amqpTemplate;      public void sendQueryOrderMessage(Object msg) &#123;          amqpTemplate.convertAndSend(&quot;xxx&quot;, msg);      &#125;  &#125;// æ¥æ”¶æ¶ˆæ¯@Component  @Slf4j  public class RabbitMQListener &#123;        @RabbitListener(queues = &quot;xxx&quot;)      public void handlerOrderQueryMsg(String msg) &#123;          log.info(&quot;xxxæ¥æ”¶åˆ°ä¿¡æ¯ï¼š&quot; + msg);          // é€»è¾‘å¤„ç†ä»£ç         return;    &#125;  &#125;\nWork Queue\n\nï¼ˆå·¥ä½œé˜Ÿåˆ—æ¨¡å¼ï¼‰ï¼šä¸€ä¸ªç”Ÿäº§è€…ã€å¤šä¸ªæ¶ˆè´¹è€…ï¼ˆç«äº‰å…³ç³»ï¼‰ï¼Œä¸éœ€è¦è®¾ç½®äº¤æ¢æœºï¼ˆä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼‰\n\n// å‘é€æ¶ˆæ¯@Component  @Slf4j  public class RabbitMqSend &#123;      @Autowired      private AmqpTemplate amqpTemplate;      public void sendQueryOrderMessage(Object msg) &#123;          // é˜Ÿåˆ—åç§°  \t    String queueName = &quot;simple.queue&quot;;  \t    for (int i = 0; i &lt; 50; i++) &#123;  \t        // å‘é€æ¶ˆæ¯ å‘é˜Ÿåˆ—ä¸­ä¸åœå‘é€æ¶ˆæ¯ï¼Œæ¨¡æ‹Ÿæ¶ˆæ¯å †ç§¯ã€‚ \t        rabbitTemplate.convertAndSend(queueName, msg + i);  \t        Thread.sleep(20);  \t    &#125;      &#125;  &#125;// æ¥æ”¶æ¶ˆæ¯@RabbitListener(queues = &quot;simple.queue&quot;)  public void listenWorkQueue1(String msg) throws InterruptedException &#123;      System.out.println(&quot;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€&quot; + msg + &quot;ã€‘&quot; + LocalTime.now());      Thread.sleep(20);  &#125;    @RabbitListener(queues = &quot;simple.queue&quot;)  public void listenWorkQueue2(String msg) throws InterruptedException &#123;      System.err.println(&quot;æ¶ˆè´¹è€…2........æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€&quot; + msg + &quot;ã€‘&quot; + LocalTime.now());      Thread.sleep(200);  &#125;\nåœ¨ä¸æ·»åŠ é¢å¤–é…ç½®çš„æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªæ¶ˆè´¹è€…ä¼šå¹³åˆ†æ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥å¤šåŠ ä¸€ä¸ªé…ç½®ã€‚prefetch è¿™ä¸ªé…ç½®å¯ä»¥æ§åˆ¶æ¶ˆè´¹è€…é¢„å–çš„æ¶ˆæ¯æ•°é‡ã€‚\nspring:  rabbitmq:    listener:      simple:        prefetch: 1 # æ¯æ¬¡åªèƒ½è·å–ä¸€æ¡æ¶ˆæ¯ï¼Œå¤„ç†å®Œæˆæ‰èƒ½è·å–ä¸‹ä¸€ä¸ªæ¶ˆæ¯\nFanout\n\nï¼ˆå‘å¸ƒè®¢é˜…æ¨¡å¼ç¾¤å‘ï¼‰ï¼šéœ€è¦è®¾ç½®ç±»å‹ä¸º fanout çš„äº¤æ¢æœºï¼Œå¹¶ä¸”äº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šå°†æ¶ˆæ¯å‘é€åˆ°ç»‘å®šçš„é˜Ÿåˆ—ã€‚\n\n//  äº¤æ¢æœºä¸é˜Ÿåˆ—ç»‘å®š@Configurationpublic class FanoutConfig &#123;    /**     * å£°æ˜äº¤æ¢æœº     * @return Fanoutç±»å‹äº¤æ¢æœº     */    @Bean    public FanoutExchange fanoutExchange()&#123;        return new FanoutExchange(&quot;xxx.fanout&quot;);    &#125;    /**     * ç¬¬1ä¸ªé˜Ÿåˆ—     */    @Bean    public Queue fanoutQueue1()&#123;        return new Queue(&quot;fanout.queue1&quot;);    &#125;    /**     * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº     */    @Bean    public Binding bindingQueue1(Queue fanoutQueue1, FanoutExchange fanoutExchange)&#123;        return BindingBuilder.bind(fanoutQueue1).to(fanoutExchange);    &#125;    /**     * ç¬¬2ä¸ªé˜Ÿåˆ—     */    @Bean    public Queue fanoutQueue2()&#123;        return new Queue(&quot;fanout.queue2&quot;);    &#125;    /**     * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº     */    @Bean    public Binding bindingQueue2(Queue fanoutQueue2, FanoutExchange fanoutExchange)&#123;        return BindingBuilder.bind(fanoutQueue2).to(fanoutExchange);    &#125;&#125;// å‘é€æ¶ˆæ¯@Component  @Slf4j  public class RabbitMqSend &#123;      @Autowired      private AmqpTemplate amqpTemplate;      public void sendQueryOrderMessage(Object msg) &#123;          // é˜Ÿåˆ—åç§°  \t    String exchangeName = &quot;xxx.fanout&quot;;  \t    for (int i = 0; i &lt; 50; i++) &#123;  \t        rabbitTemplate.convertAndSend(exchangeName, &quot;&quot;, msg);\t        Thread.sleep(20);  \t    &#125;      &#125;  &#125;// æ¥æ”¶æ¶ˆæ¯@RabbitListener(queues = &quot;simple.queue&quot;)  public void listenWorkQueue1(String msg) throws InterruptedException &#123;      System.out.println(&quot;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€&quot; + msg + &quot;ã€‘&quot; + LocalTime.now());      Thread.sleep(20);  &#125;    @RabbitListener(queues = &quot;simple.queue&quot;)  public void listenWorkQueue2(String msg) throws InterruptedException &#123;      System.err.println(&quot;æ¶ˆè´¹è€…2........æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€&quot; + msg + &quot;ã€‘&quot; + LocalTime.now());      Thread.sleep(200);  &#125;\nDirect\n\nï¼ˆè·¯ç”±æ¨¡å¼ï¼‰ï¼šéœ€è¦è®¾ç½®ç±»å‹ä¸º direct çš„äº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”æŒ‡å®š routing keyï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šæ ¹æ® routing key å°†æ¶ˆæ¯å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—\n\n// å‘é€æ¶ˆæ¯@Component  @Slf4j  public class RabbitMqSend &#123;      @Autowired      private AmqpTemplate amqpTemplate;      public void sendQueryOrderMessage(Object msg) &#123;  \t    String exchangeName = &quot;xxx.direct&quot;;    \t    rabbitTemplate.convertAndSend(exchangeName, &quot;red&quot;, message);    &#125;  &#125;// æ¥æ”¶æ¶ˆæ¯// åŸºäºæ³¨è§£å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº@RabbitListener(bindings = @QueueBinding(    value = @Queue(name = &quot;direct.queue1&quot;),    exchange = @Exchange(name = &quot;xxx.direct&quot;, type = ExchangeTypes.DIRECT),    key = &#123;&quot;red&quot;, &quot;blue&quot;&#125;))public void listenDirectQueue1(String msg)&#123;    System.out.println(&quot;æ¶ˆè´¹è€…æ¥æ”¶åˆ°direct.queue1çš„æ¶ˆæ¯ï¼šã€&quot; + msg + &quot;ã€‘&quot;);&#125;@RabbitListener(bindings = @QueueBinding(    value = @Queue(name = &quot;direct.queue2&quot;),    exchange = @Exchange(name = &quot;xxx.direct&quot;, type = ExchangeTypes.DIRECT),    key = &#123;&quot;red&quot;, &quot;yellow&quot;&#125;))public void listenDirectQueue2(String msg)&#123;    System.out.println(&quot;æ¶ˆè´¹è€…æ¥æ”¶åˆ°direct.queue2çš„æ¶ˆæ¯ï¼šã€&quot; + msg + &quot;ã€‘&quot;);&#125;\nTopic\n\nï¼ˆé€šé…ç¬¦æ¨¡å¼ï¼‰ï¼šéœ€è¦è®¾ç½®ç±»å‹ä¸º topic çš„äº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”æŒ‡å®šé€šé… ç¬¦æ–¹å¼çš„ routing keyï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šæ ¹æ® routing key å°†æ¶ˆæ¯å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—ã€‚Topic ç±»å‹çš„ Exchange ä¸ Direct ç›¸æ¯”ï¼Œéƒ½æ˜¯å¯ä»¥æ ¹æ® RoutingKey æŠŠæ¶ˆæ¯è·¯ç”±åˆ°ä¸åŒçš„é˜Ÿåˆ—ã€‚åªä¸è¿‡ Topic ç±»å‹ Exchange å¯ä»¥è®©é˜Ÿåˆ—åœ¨ç»‘å®š Routing key çš„æ—¶å€™ä½¿ç”¨é€šé…ç¬¦ã€‚\n\né€šé…ç¬¦è§„åˆ™ï¼š#ï¼šåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯*ï¼šåŒ¹é…ä¸å¤šä¸å°‘æ°å¥½ 1 ä¸ªè¯\n// å‘é€æ¶ˆæ¯@Component  @Slf4j  public class RabbitMqSend &#123;      @Autowired      private AmqpTemplate amqpTemplate;      public void sendQueryOrderMessage(Object msg) &#123;  \t    String exchangeName = &quot;xxx.topic&quot;;    \t    rabbitTemplate.convertAndSend(exchangeName, &quot;china.news&quot;, message);    &#125;  &#125;// æ¥æ”¶æ¶ˆæ¯@RabbitListener(bindings = @QueueBinding(    value = @Queue(name = &quot;topic.queue1&quot;),    exchange = @Exchange(name = &quot;xxx.topic&quot;, type = ExchangeTypes.TOPIC),    key = &quot;china.#&quot;))public void listenTopicQueue1(String msg)&#123;    System.out.println(&quot;æ¶ˆè´¹è€…æ¥æ”¶åˆ°topic.queue1çš„æ¶ˆæ¯ï¼šã€&quot; + msg + &quot;ã€‘&quot;);&#125;@RabbitListener(bindings = @QueueBinding(    value = @Queue(name = &quot;topic.queue2&quot;),    exchange = @Exchange(name = &quot;xxx.topic&quot;, type = ExchangeTypes.TOPIC),    key = &quot;#.news&quot;))public void listenTopicQueue2(String msg)&#123;    System.out.println(&quot;æ¶ˆè´¹è€…æ¥æ”¶åˆ°topic.queue2çš„æ¶ˆæ¯ï¼šã€&quot; + msg + &quot;ã€‘&quot;);&#125;\næ¶ˆæ¯è½¬æ¢å™¨\n\nSpring ä¼šæŠŠä½ å‘é€çš„æ¶ˆæ¯åºåˆ—åŒ–ä¸ºå­—èŠ‚å‘é€ç»™ MQï¼Œæ¥æ”¶æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¿˜ä¼šæŠŠå­—èŠ‚ååºåˆ—åŒ–ä¸º Java å¯¹è±¡ã€‚é»˜è®¤æƒ…å†µä¸‹ Spring é‡‡ç”¨çš„åºåˆ—åŒ–æ–¹å¼æ˜¯ JDK åºåˆ—åŒ–ï¼šæ•°æ®ä½“ç§¯è¿‡å¤§ã€æœ‰å®‰å…¨æ¼æ´ã€å¯è¯»æ€§å·®ã€‚\n\n\n\nåœ¨ publisher å’Œ consumer ä¸¤ä¸ªæœåŠ¡ä¸­éƒ½å¼•å…¥ä¾èµ–\n\n\n&lt;dependency&gt;    &lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;    &lt;artifactId&gt;jackson-dataformat-xml&lt;/artifactId&gt;    &lt;version&gt;2.9.10&lt;/version&gt;&lt;/dependency&gt;\n\n\nåœ¨å¯åŠ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ª Bean\n\n\n@Beanpublic MessageConverter jsonMessageConverter()&#123;    return new Jackson2JsonMessageConverter();&#125;\nå»¶è¿Ÿæ¶ˆæ¯\n\nRbbitMQ å®ç°å»¶æ—¶æ¶ˆæ¯ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š\n\næ­»ä¿¡æ¶ˆæ¯ï¼ˆé˜Ÿåˆ— ttl+ æ­»ä¿¡ exchangeï¼‰\n2. å»¶æ—¶æ’ä»¶ (rabbitmq-delayed-message-exchange)\n\n\næ­»ä¿¡æ¶ˆæ¯\n\nRabbitMQ ä¸ºæ¯ä¸ªé˜Ÿåˆ—è®¾ç½®æ¶ˆæ¯çš„è¶…æ—¶æ—¶é—´ã€‚åªè¦ç»™é˜Ÿåˆ—è®¾ç½® x-message-ttlÂ å‚æ•°ï¼ˆä¹Ÿå¯ä»¥ç»™å•æ¡æ¶ˆæ¯è®¾ç½®å­˜æ´»æ—¶é—´ï¼‰ï¼Œå°±è®¾å®šäº†è¯¥é˜Ÿåˆ—æ‰€æœ‰æ¶ˆæ¯çš„å­˜æ´»æ—¶é—´ï¼Œæ—¶é—´å•ä½æ˜¯æ¯«ç§’ã€‚å¦‚æœå£°æ˜é˜Ÿåˆ—æ—¶æŒ‡å®šäº†æ­»ä¿¡äº¤æ¢å™¨ï¼Œåˆ™è¿‡æœŸæ¶ˆæ¯ä¼šæˆä¸ºæ­»ä¿¡æ¶ˆæ¯ã€‚\n\n\nå»¶æ—¶æ’ä»¶\n\n\nè¿›å…¥ rabbitmq çš„ docker å®¹å™¨\n\n\ndocker exec -it mq bash\n\n\nä¸‹è½½æ’ä»¶å¹¶ä¸Šä¼ æœåŠ¡å™¨ï¼ˆä¸‹è½½åœ°å€ï¼š[https://github.com/rabbitmq/rabbitmq-delayed-message-exchange/releases][https://github.com/rabbitmq/rabbitmq-delayed-message-exchange/releases]ï¼‰\n\n\n# å°†ä¸‹è½½å¥½çš„æ’ä»¶æ‹·è´åˆ°dockerå®¹å™¨ä¸­docker cp ./rabbitmq_delayed_message_exchange-3.9.0.ez rabbit:/plugins# è¿›å…¥RabbitMQå®¹å™¨docker exec -it rabbit /bin/bash# å¯åŠ¨æ’ä»¶rabbitmq-plugins enable rabbitmq_delayed_message_exchange# å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰å®‰è£…è¿‡çš„æ’ä»¶rabbitmq-plugins list# ç„¶åæ‰§è¡Œ exit å‘½ä»¤é€€å‡º docker å®¹å™¨\n\n\npom æ–‡ä»¶å¼•å…¥ä¾èµ–\n\n\n&lt;dependency&gt;      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;      &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;  &lt;/dependency&gt;\n\n\nåœ¨ä»£ç ä¸­é…ç½®å»¶è¿Ÿé˜Ÿåˆ—\n\n\n@Configuration  public class RabbitMqConfig &#123;        public static final String ORDER_DELAY_KEY = &quot;order_delay&quot;;        /**       * å»¶æ—¶äº¤æ¢æœºï¼Œäº¤æ¢æœºç±»å‹ä¸ºx-delayed-message       */    @Bean      public CustomExchange customExchange() &#123;          Map&lt;String, Object&gt; args = new HashMap&lt;&gt;();          //å»¶æ—¶äº¤æ¢æœºä¸€å®šè¦è®¾ç½®x-delayed-typeå±æ€§          args.put(&quot;x-delayed-type&quot;, &quot;direct&quot;);          //ç¬¬äºŒä¸ªå‚æ•°typeéœ€è¦è®¾ç½®æˆx-delayed-message          return new CustomExchange(&quot;order_delay_exchange&quot;, &quot;x-delayed-message&quot;, true, false, args);      &#125;        /**       * è®¢å•å»¶æ—¶é˜Ÿåˆ—       *       * @return å»¶æ—¶é˜Ÿåˆ—       */      @Bean      public Queue delayOrderQueue() &#123;          return new Queue(&quot;order_delay_queue&quot;, true);      &#125;        /**       * è®¢å•å»¶æ—¶é˜Ÿåˆ—ç»‘å®šäº¤æ¢æœº       *       * @return å»¶æ—¶é˜Ÿåˆ—ç»‘å®šäº¤æ¢æœº       */      @Bean      public Binding delayOrderBinding() &#123;          return BindingBuilder.bind(delayOrderQueue()).to(customExchange()).with(ORDER_DELAY_KEY).noargs();      &#125;&#125;\n\n\nç¼–å†™æ–¹æ³•å‘é˜Ÿåˆ—å‘é€æ¶ˆæ¯\n\n\n/**   * å‘é€è®¢å•å»¶æ—¶æ¶ˆæ¯   * delayTime å»¶è¿Ÿçš„æ—¶é—´ å•ä½æ˜¯æ¯«ç§’   *   * @param msg å‘é€çš„ä¿¡æ¯   */  public void sendDelayOrderMessage(Object msg, String routingKey, Long delayTime) &#123;      amqpTemplate.convertAndSend(&quot;order_delay_exchange&quot;, routingKey, msg,              message -&gt; &#123;                  //è®¾ç½®å»¶è¿Ÿæ—¶é—´                  message.getMessageProperties().setDelay(delayTime.intValue());                  return message;              &#125;);  &#125;\n\n\nç›‘å¬é˜Ÿåˆ—\n\n\n@RabbitListener(queues = &quot;order_delay_queue&quot;)  public void handlerOrderDelayMsg(String msg) &#123;      log.info(&quot;order_delay_queueæ¥æ”¶åˆ°ä¿¡æ¯ï¼š&quot; + msg);      val jsonObject = JSONUtil.parseObj(msg);    // é€»è¾‘å¤„ç† ...&#125;\næ¶ˆæ¯é‡è¯•\næ·»åŠ å¦‚ä¸‹é…ç½®å®ç°æ¶ˆæ¯é‡è¯•ï¼š\nspring:    listener:        simple:          retry:            # å¼€å¯é‡è¯•æœºåˆ¶            enabled: true            # æœ€å¤šé‡è¯•            max-attempts: 10            # ç¬¬ä¸€æ¬¡é—´éš”            initial-interval: 3000ms            # æœ€å¤šé—´éš”æ—¶é—´            max-interval: 86400000ms            # é—´éš”é—´ä¹˜æ•°            multiplier: 2\nç‰¹åˆ«æ³¨æ„ï¼š å¦‚æœåœ¨æ¶ˆæ¯æ¥æ”¶ç«¯çš„ application.yml é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰æ·»åŠ Â RabbitMQ é‡è¯•æœºåˆ¶çš„ç›¸å…³é…ç½®ï¼Œå½“æ¥æ”¶ç«¯æ”¶åˆ°æ¶ˆæ¯åç¨‹åºæŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆå‘é€ç«¯å°†å¾—ä¸åˆ°æ¶ˆæ¯ç¡®è®¤ï¼ˆACKï¼‰ï¼Œæ­¤æ—¶å‘é€ç«¯å°†ä¼šå¾ªç¯çš„å‘é€æ¶ˆæ¯ï¼Œæœ€ç»ˆå¯¼è‡´å†…å­˜æº¢å‡ºã€‚\nRocketMQ\nåŸºç¡€\nRocketMQ ç»„æˆç»“æ„å›¾å¦‚ä¸‹ ï¼š\n\näº¤äº’è¿‡ç¨‹å¦‚ä¸‹ï¼š\n\n\nBrokder å®šæ—¶å‘é€è‡ªèº«çŠ¶æ€ åˆ° NameServerã€‚\n\n\nProducer è¯·æ±‚ NameServer è·å– Broker çš„åœ°å€ã€‚\n\n\nProducer å°†æ¶ˆæ¯å‘é€åˆ° Broker ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\n\nConsumer è®¢é˜… Broker ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé€šè¿‡æ‹‰å–æ¶ˆæ¯ï¼Œæˆ–ç”± Broker å°†æ¶ˆæ¯æ¨é€è‡³ Consumerã€‚\n\n\nå…·ä½“ä»‹ç»ï¼š\n\n\nProducer Cluster æ¶ˆæ¯ç”Ÿäº§è€…ç¾¤\n\n\n\n\nè´Ÿè´£å‘é€æ¶ˆæ¯ï¼Œä¸€èˆ¬ç”±ä¸šåŠ¡ç³»ç»Ÿè´Ÿè´£äº§ç”Ÿæ¶ˆæ¯ã€‚\n\n\n\n\nConsumer Cluster æ¶ˆæ¯è´¹ç¾¤\n\n\n\n\nè´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼Œä¸€èˆ¬æ˜¯åå°ç³»ç»Ÿè´Ÿè´£å¼‚æ­¥æ¶ˆè´¹ã€‚\n\n\nä¸¤ç§æ¶ˆè´¹æ¨¡å¼ï¼š\n\nPush Consumerï¼ŒæœåŠ¡ç«¯å‘æ¶ˆè´¹è€…ç«¯æ¨é€æ¶ˆæ¯\nPull Consumerï¼Œæ¶ˆè´¹è€…ç«¯å‘æœåŠ¡å®šæ—¶æ‹‰å–æ¶ˆæ¯\n\n\n\n\n\nNameServer åç§°æœåŠ¡å™¨\n\n\n\n\né›†ç¾¤æ¶æ„ä¸­çš„ç»„ç»‡åè°ƒå‘˜ï¼Œç›¸å½“äºæ³¨å†Œä¸­å¿ƒï¼Œæ”¶é›† broker çš„å·¥ä½œæƒ…å†µï¼Œä¸è´Ÿè´£æ¶ˆæ¯çš„å¤„ç†\n\n\n\n\nBroker æ¶ˆæ¯æœåŠ¡å™¨\n\n\n\n\næ˜¯ RocketMQ çš„æ ¸å¿ƒï¼Œè´Ÿè´£æ¶ˆæ¯çš„æ¥å—ï¼Œå­˜å‚¨ï¼Œå‘é€ç­‰ã€‚\n\n\néœ€è¦å®šæ—¶å‘é€è‡ªèº«çŠ¶æ€ åˆ° NameServerï¼Œé»˜è®¤ 10 ç§’å‘é€ä¸€æ¬¡ï¼Œè¶…æ—¶ 2 åˆ†é’Ÿä¼šè®¤ä¸ºè¯¥ broker å¤±æ•ˆã€‚\n\n\nå®‰è£…\nWindows\n\n\nä¸‹è½½\n\n\n\nä¸‹è½½åœ°å€ï¼šhttps://archive.apache.org/dist/rocketmq/\nä¸‹è½½åè§£å‹åˆ°ä¸€ä¸ªæ²¡æœ‰ç©ºæ ¼å’Œä¸­æ–‡çš„ç›®å½•ã€‚å¹¶é…ç½®å®‰è£…ç›®å½•ä¸ºç¯å¢ƒå˜é‡ã€‚\n\n\n\nå¯åŠ¨\n\n\n\nBroker é»˜è®¤ç£ç›˜ç©ºé—´åˆ©ç”¨ç‡è¾¾åˆ° 85% å°±ä¸å†æ¥æ”¶ï¼Œè¿™é‡Œåœ¨å¼€å‘ç¯å¢ƒå¯ä»¥æé«˜ç£ç›˜ç©ºé—´åˆ©ç”¨ç‡æŠ¥è­¦é˜€å€¼ä¸º 98%ã€‚\n\n# è°ƒæ•´é»˜è®¤çš„å†…å­˜å¤§å°å‚æ•°ï¼ˆæŒ‰æœºå™¨çš„å¤§å°é…ç½®ï¼‰## ç¼–è¾‘runserver.cmdï¼Œä¿®æ”¹å¹¶ä¿å­˜&quot;JAVA_OPT=%JAVA_OPT% â€server â€Xms512m â€Xmx512m â€Xmn512m â€XX:MetaspaceSize=128m â€ XX:MaxMetaspaceSize=320m&quot; # è¿è¡Œbin/mqnamesrv.cmdcd bin/start mqnamesrv.cmd# å¯åŠ¨broker -nï¼šæŒ‡å®šNameServerçš„åœ°å€ï¼Œè¿è¡Œbin/mqbroker.cmd â€n 127.0.0.1:9876cd bin/start mqbroker.cmd -n 127.0.0.1:9876 autoCreateTopicEnable=true## å¯åŠ¨å¤±è´¥å¯ä»¥åˆ é™¤ C:/user/ç”¨æˆ·å/store è¿™ä¸ªç›®å½•åŠç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œç„¶åé‡æ–°æ‰§è¡Œå‘½ä»¤\n\n\næµ‹è¯•\n\n\n# å‘é€æ¶ˆæ¯cd bin/ set NAMESRV_ADDR=127.0.0.1:9876 tools.cmd org.apache.rocketmq.example.quickstart.Producer# æ¥æ”¶æ¶ˆæ¯set NAMESRV_ADDR=127.0.0.1:9876 tools.cmd org.apache.rocketmq.example.quickstart.Consumer\n\n\nå®‰è£…ç®¡ç†ç«¯\n\n\n\nRocketMQ æä¾›äº† UI ç®¡ç†å·¥å…·ï¼Œåä¸º rocketmq-consoleï¼Œé¡¹ç›®åœ°å€ï¼šhttps://github.com/apache/rocketmq-externals/tree/release-rocketmq-console-1.0.0\n\n# ä¸‹è½½æºæ–‡ä»¶ï¼Œå¹¶åˆ‡æ¢åˆ°consoleåˆ†æ”¯# ä¿®æ”¹é…ç½®## ä¿®æ”¹rocketmq-console\\src\\main\\resources\\application.propertiesserver.port=9877rocketmq.config.namesrvAddr=127.0.0.1:9876rocketmq.config.dataPath=/tmp/rocketmq-console/data# æ‰“åŒ…## è¿›å…¥ç›®å½•ä¸‹mvn clean package â€Dmaven.test.skip=true# å¯åŠ¨cd /rocketmq-console/targetjava -jar rocketmq-console-ng-1.0.0.jar --server.port=9877 --rocketmq.config.namesrvAddr=127.0.0.1:9876# è®¿é—® http://127.0.0.1:9877\nLinux\n\nç”±äº RocketMQ ç”± Java ç¼–å†™ï¼ŒåŸºæœ¬æ“ä½œä¸ Windows ä¸€è‡´ï¼Œä¸Šä¼ åŒ…åˆ°æœåŠ¡å™¨åè§£å‹è¿è¡Œå³å¯ï¼ˆè¿™é‡Œåªè®°å½•éƒ¨åˆ† Linux å‘½ä»¤ï¼‰ã€‚\n\n# ç¼–è¾‘æ–‡ä»¶vim runserver.cmd # æ–‡ä»¶ä½ç½®ä¸‹è¿è¡Œå‘½ä»¤ï¼ˆåå°è¿è¡Œï¼‰nohup java -jar rocketmq-console-ng-1.0.0.jar# æ§åˆ¶å°ç›¸å…³tail -100 nohup.outtail -f nohup.out cp /dev/null nohup.out\nåŸºæœ¬ä½¿ç”¨\nä¸‰ç§æ¶ˆæ¯å‘é€æ–¹å¼\n\n\nåŒæ­¥æ¶ˆæ¯ï¼ˆsync messageï¼‰\nproducer å‘ broker å‘é€æ¶ˆæ¯ï¼Œæ‰§è¡Œ API æ—¶åŒæ­¥ç­‰å¾…ï¼Œ ç›´åˆ° broker æœåŠ¡å™¨è¿”å›å‘é€ç»“æœ ã€‚\n\n\nå¼‚æ­¥æ¶ˆæ¯ï¼ˆasync messageï¼‰\nproducer å‘ broker å‘é€æ¶ˆæ¯æ—¶æŒ‡å®šæ¶ˆæ¯å‘é€æˆåŠŸåŠå‘é€å¼‚å¸¸çš„å›è°ƒæ–¹æ³•ï¼Œè°ƒç”¨ API åç«‹å³è¿”å›ï¼Œproducer å‘é€æ¶ˆ æ¯çº¿ç¨‹ä¸é˜»å¡ ï¼Œæ¶ˆæ¯å‘é€æˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒä»»åŠ¡åœ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œ ã€‚\n\n\nå•å‘æ¶ˆæ¯ï¼ˆoneway messageï¼‰\nproducer å‘ broker å‘é€æ¶ˆæ¯ï¼Œæ‰§è¡Œ API æ—¶ç›´æ¥è¿”å›ï¼Œä¸ç­‰å¾… broker æœåŠ¡å™¨çš„ç»“æœ ã€‚\n\n\næ¶ˆæ¯ç»“æ„\nRocketMQ çš„æ¶ˆæ¯åŒ…æ‹¬åŸºç¡€å±æ€§å’Œæ‰©å±•å±æ€§ä¸¤éƒ¨åˆ†ï¼š\n\n\nåŸºç¡€å±æ€§\n\ntopicï¼š ä¸»é¢˜ç›¸å½“äºæ¶ˆæ¯çš„ä¸€çº§åˆ†ç±»ï¼Œå…·æœ‰ç›¸åŒ topic çš„æ¶ˆæ¯å°†å‘é€è‡³è¯¥ topic ä¸‹çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œæ¯”æ–¹è¯´ä¸€ä¸ªç”µå•† ç³»ç»Ÿå¯ä»¥åˆ†ä¸ºå•†å“æ¶ˆæ¯ã€è®¢å•æ¶ˆæ¯ã€ç‰©æµæ¶ˆæ¯ç­‰ï¼Œå°±å¯ä»¥åœ¨ broker ä¸­åˆ›å»ºå•†å“ä¸»é¢˜ã€è®¢å•ä¸»é¢˜ç­‰ï¼Œæ‰€æœ‰å•†å“çš„æ¶ˆæ¯å‘é€è‡³è¯¥ä¸»é¢˜ä¸‹çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚\næ¶ˆæ¯ä½“ï¼šå³æ¶ˆæ¯çš„å†…å®¹ ï¼Œå¯ä»¥çš„å­—ç¬¦ä¸²ã€å¯¹è±¡ç­‰ç±»å‹ï¼ˆå¯ç³»åˆ—åŒ–ï¼‰ã€‚æ¶ˆæ¯çš„æœ€å¤§é•¿åº¦æ˜¯ 4Mã€‚\næ¶ˆæ¯ Flagï¼šæ¶ˆæ¯çš„ä¸€ä¸ªæ ‡è®°ï¼ŒRocketMQ ä¸å¤„ç†ï¼Œç•™ç»™ä¸šåŠ¡ç³»ç»Ÿä½¿ç”¨ã€‚\n\n\n\næ‰©å±•å±æ€§\n\ntagï¼šç›¸å½“äºæ¶ˆæ¯çš„äºŒçº§åˆ†ç±»ï¼Œç”¨äºæ¶ˆè´¹æ¶ˆæ¯æ—¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯ä¸ºç©º ã€‚\nkeysï¼šMessage ç´¢å¼•é”®ï¼Œåœ¨è¿ç»´ä¸­å¯ä»¥æ ¹æ®è¿™äº› key å¿«é€Ÿæ£€ç´¢åˆ°æ¶ˆæ¯ï¼Œ å¯ä¸ºç©º ã€‚\nwaitStoreMsgOKï¼šæ¶ˆæ¯ å‘é€æ—¶æ˜¯å¦ç­‰æ¶ˆæ¯å­˜å‚¨å®Œæˆåå†è¿”å› ã€‚\n\n\n\nMessage çš„åŸºç¡€å±æ€§ä¸»è¦åŒ…æ‹¬æ¶ˆæ¯æ‰€å±ä¸»é¢˜ topic ï¼Œ æ¶ˆæ¯ Flagï¼ˆRocketMQ ä¸åšå¤„ç†ï¼‰ã€ æ‰©å±•å±æ€§ã€æ¶ˆæ¯ä½“ ã€‚\nç”Ÿäº§è€…å·¥ç¨‹\n\n\næ·»åŠ ä¾èµ–\n\n\n&lt;dependency&gt;      &lt;groupId&gt;org.apache.rocketmq&lt;/groupId&gt;      &lt;artifactId&gt;rocketmq-spring-boot-starter&lt;/artifactId&gt;&lt;/dependency&gt;\n\n\næ·»åŠ é…ç½®\n\n\nrocketmq:  nameServer: 127.0.0.1:9876  producer:    group: PID_PAY_PRODUCER\n\n\nå‘é€åŒæ­¥æ¶ˆæ¯\n\n\n@Service  @Slf4j  public class PayChannelAgentServiceImpl implements PayChannelAgentService &#123;        @Resource      private PayProducer payProducer;        /**       * è°ƒç”¨æ”¯ä»˜å®æ‰‹æœºWAPä¸‹å•æ¥å£       * @param aliConfigParam æ”¯ä»˜æ¸ é“å‚æ•°       * @param alipayBean è¯·æ±‚æ”¯ä»˜å‚æ•°       * @return       * @throws BusinessException BusinessException       */        @Override      public PaymentResponseDTO createPayOrderByAliWAP(AliConfigParam aliConfigParam, AlipayBean alipayBean) throws BusinessException, UnsupportedEncodingException &#123;          // æ‹¼æ¥æ”¯ä»˜ä¿¡æ¯        ...        try &#123;              //å‘é€æ”¯ä»˜ç»“æœæŸ¥è¯¢å»¶è¿Ÿæ¶ˆæ¯              PaymentResponseDTO&lt;AliConfigParam&gt; notice = new PaymentResponseDTO&lt;AliConfigParam&gt;();              notice.setOutTradeNo(alipayBean.getOutTradeNo());              notice.setContent(aliConfigParam);              notice.setMsg(&quot;ALIPAY_WAP&quot;);              payProducer.payOrderNotice(notice);                // è°ƒç”¨SDKæäº¤è¡¨å•          &#125; catch (Exception e) &#123;              ...        &#125;      &#125;  &#125;\n\n\næµ‹è¯•ï¼ˆæ§åˆ¶å°å‡ºç° endâ€¦ è¡¨ç¤ºæ¶ˆæ¯å‘é€æˆåŠŸã€‚è¿›å…¥ç®¡ç†ç«¯ï¼ŒæŸ¥è¯¢æ¶ˆæ¯ã€‚ï¼‰\n\n\næ¶ˆè´¹è€…å·¥ç¨‹\n\n\né…ç½®æ–‡ä»¶\n\n\nrocketmq:  nameServer: 127.0.0.1:9876\n\n\næ¶ˆè´¹æ¶ˆæ¯ï¼ˆç›‘å¬æ¶ˆæ¯é˜Ÿåˆ—éœ€è¦æŒ‡å®š topic ä¸ consumerGroupï¼‰\n\n\n@Slf4j  @Service  @RocketMQMessageListener(topic = &quot;TP_PAYMENT_ORDER&quot;, consumerGroup = &quot;CID_PAYMENT_CONSUMER&quot;)  public class PayConsumer implements RocketMQListener&lt;MessageExt&gt; &#123;      @Resource      private PayChannelAgentService payAgentService;      @Override      public void onMessage(MessageExt messageExt) &#123;          log.info(&quot;å¼€å§‹æ¶ˆè´¹æ”¯ä»˜ç»“æœæŸ¥è¯¢æ¶ˆæ¯:&#123;&#125;&quot;, messageExt);          // å–å‡ºæ¶ˆæ¯å†…å®¹          String body = new String(messageExt.getBody(), StandardCharsets.UTF_8);          PaymentResponseDTO response = JSON.parseObject(body, PaymentResponseDTO.class);          String outTradeNo = response.getOutTradeNo();          String msg = response.getMsg();          String param = String.valueOf(response.getContent());          AliConfigParam aliConfigParam = JSON.parseObject(param, AliConfigParam.class);          // åˆ¤æ–­æ˜¯æ”¯ä»˜å®è¿˜æ˜¯å¾®ä¿¡          PaymentResponseDTO result = new PaymentResponseDTO();          if (&quot;ALIPAY_WAP&quot;.equals(msg)) &#123;              // æŸ¥è¯¢æ”¯ä»˜å®æ”¯ä»˜ç»“æœ              result = payAgentService.queryPayOrderByAli(aliConfigParam, outTradeNo);              //ä¸ç®¡æ”¯ä»˜æˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½éœ€è¦å‘é€æ”¯ä»˜ç»“æœæ¶ˆæ¯              ...        &#125; else if (&quot;WX_JSAPI&quot;.equals(msg)) &#123;              // æŸ¥è¯¢å¾®ä¿¡æ”¯ä»˜ç»“æœ              ...        &#125;            //è¿”å›æŸ¥è¯¢è·å¾—çš„æ”¯ä»˜çŠ¶æ€          if (TradeStatus.UNKNOWN.equals(result.getTradeState()) || TradeStatus.USERPAYING.equals(result.getTradeState())) &#123;          // åœ¨æ”¯ä»˜çŠ¶æ€æœªçŸ¥æˆ–æ”¯ä»˜ä¸­ï¼ŒæŠ›å‡ºå¼‚å¸¸ä¼šé‡æ–°æ¶ˆæ¯æ­¤æ¶ˆæ¯              log.info(&quot;æ”¯ä»˜ä»£ç†â€â€â€æ”¯ä»˜çŠ¶æ€æœªçŸ¥ï¼Œç­‰å¾…é‡è¯•&quot;);              throw new RuntimeException(&quot;æ”¯ä»˜çŠ¶æ€æœªçŸ¥ï¼Œç­‰å¾…é‡è¯•&quot;);          &#125;      &#125;  &#125;\næ¶ˆæ¯å‘é€è¿‡ç¨‹\n\næ¶ˆæ¯å‘é€æµç¨‹å¦‚ä¸‹ï¼š\n\n\nProducer ä» NameServer ä¸­è·å–ä¸»é¢˜è·¯ç”±ä¿¡æ¯\nBroker å°†è‡ªå·±çš„çŠ¶æ€ä¸ŠæŠ¥ç»™ NameServerï¼ŒNameServer ä¸­å­˜å‚¨äº†æ¯ä¸ª Broker åŠä¸»é¢˜ã€æ¶ˆæ¯é˜Ÿåˆ—çš„ä¿¡æ¯ã€‚\nProducer æ ¹æ® topic ä» NameServer æŸ¥è¯¢æ‰€æœ‰æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒæŸ¥è¯¢åˆ°çš„ç»“æœä¾‹å¦‚ï¼š\n\n\n[   &#123;&quot;brokerName&quot;:&quot;Brokerâ€1&quot;,&quot;queueId&quot;:0&#125;,   &#123;&quot;brokerName&quot;:&quot;Brokerâ€1&quot;,&quot;queueId&quot;:1&#125;,   &#123;&quot;brokerName&quot;:&quot;Brokerâ€2&quot;,&quot;queueId&quot;:0&#125;,   &#123;&quot;brokerName&quot;:&quot;Brokerâ€2&quot;,&quot;queueId&quot;:1&#125; ]\nProducer æŒ‰é€‰æ‹©ç®—æ³•ä»ä»¥ä¸Šé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªè¿›è¡Œæ¶ˆæ¯å‘é€ï¼Œå¦‚æœå‘é€æ¶ˆæ¯å¤±è´¥åˆ™åœ¨ä¸‹æ¬¡é€‰æ‹©çš„æ—¶å€™ ä¼šè§„é¿æ‰å¤±è´¥çš„ brokerã€‚\n\n\næ„å»ºæ¶ˆæ¯ï¼Œå‘é€æ¶ˆæ¯å‘é€æ¶ˆæ¯å‰è¿›è¡Œæ ¡éªŒï¼Œæ¯”å¦‚æ¶ˆæ¯çš„å†…å®¹é•¿åº¦ä¸èƒ½ä¸º 0ã€æ¶ˆæ¯æœ€å¤§é•¿åº¦ã€æ¶ˆæ¯å¿…è¦çš„å±æ€§æ˜¯å¦å…·å¤‡ç­‰ï¼ˆtopicã€æ¶ˆæ¯ä½“ï¼Œç”Ÿäº§ç»„ç­‰ï¼‰ã€‚å¦‚æœè¯¥ topic ä¸‹è¿˜æ²¡æœ‰é˜Ÿåˆ—åˆ™è‡ªåŠ¨åˆ›å»ºï¼Œé»˜è®¤ä¸€ä¸ª topic ä¸‹è‡ªåŠ¨åˆ›å»º 4 ä¸ªå†™é˜Ÿåˆ—ï¼Œ4 ä¸ªè¯»é˜Ÿåˆ— ã€‚\n\n\nä¸ºä»€ä¹ˆè¦å¤šä¸ªé˜Ÿåˆ—ï¼Ÿ\n\n\né«˜å¯ç”¨ï¼šå½“æŸä¸ªé˜Ÿåˆ—ä¸å¯ç”¨æ—¶å…¶å®ƒé˜Ÿåˆ—é¡¶ä¸Šã€‚\n\n\næé«˜å¹¶å‘ï¼šå‘é€æ¶ˆæ¯æ˜¯é€‰æ‹©é˜Ÿåˆ—è¿›è¡Œå‘é€ï¼Œæé«˜å‘é€æ¶ˆæ¯çš„å¹¶å‘èƒ½åŠ›ã€‚ æ¶ˆæ¯æ¶ˆè´¹æ—¶æ¯ä¸ªæ¶ˆè´¹è€…å¯ä»¥ç›‘å¬å¤šä¸ªé˜Ÿåˆ—ï¼Œæé«˜æ¶ˆè´¹æ¶ˆæ¯çš„å¹¶å‘èƒ½åŠ›ã€‚\nç”Ÿäº§ç»„æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\nåœ¨äº‹åŠ¡æ¶ˆæ¯ä¸­ broker éœ€è¦å›æŸ¥ producerï¼ŒåŒä¸€ä¸ªç”Ÿäº§ç»„çš„ producer ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œæé«˜å¹¶å‘èƒ½åŠ›ã€‚\n\n\n\n\nç›‘å¬é˜Ÿåˆ—ï¼Œæ¶ˆè´¹æ¶ˆæ¯ä¸€ä¸ªæ¶ˆè´¹ç»„å¯ä»¥åŒ…æ‹¬å¤šä¸ªæ¶ˆè´¹è€…ï¼Œä¸€ä¸ªæ¶ˆè´¹ç»„å¯ä»¥è®¢é˜…å¤šä¸ªä¸»é¢˜ã€‚ä¸€ä¸ªé˜Ÿåˆ—åŒæ—¶åªå…è®¸ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹å¤šä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ã€‚æ¶ˆè´¹ç»„æœ‰ä¸¤ç§æ¶ˆè´¹æ¨¡å¼ï¼š\n\né›†ç¾¤æ¨¡å¼ï¼šä¸€ä¸ªæ¶ˆè´¹ç»„å†…çš„æ¶ˆè´¹è€…ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œä¸»é¢˜ä¸‹çš„ä¸€æ¡æ¶ˆæ¯åªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ã€‚\nå¹¿æ’­æ¨¡å¼ï¼šä¸»é¢˜ä¸‹çš„ä¸€æ¡æ¶ˆæ¯èƒ½è¢«æ¶ˆè´¹ç»„ä¸‹çš„æ‰€æœ‰æ¶ˆè´¹è€…æ¶ˆè´¹ã€‚æ¶ˆè´¹è€…å’Œ broker ä¹‹é—´é€šè¿‡æ¨æ¨¡å¼å’Œæ‹‰æ¨¡å¼æ¥æ”¶æ¶ˆæ¯ï¼Œæ¨æ¨¡å¼å³ broker æ¨é€ç»™æ¶ˆè´¹è€…ï¼Œæ‹‰æ¨¡å¼æ˜¯æ¶ˆè´¹è€…ä¸»åŠ¨ä» broker æŸ¥è¯¢æ¶ˆæ¯ã€‚\n\n\n\nä¸‰ç§æ¶ˆæ¯å‘é€æ–¹å¼\nåŒæ­¥æ¶ˆæ¯\nè§åŸºæœ¬ä½¿ç”¨çš„ä¾‹å­ã€‚\nå¼‚æ­¥æ¶ˆæ¯\nproducer å‘ broker å‘é€æ¶ˆæ¯æ—¶æŒ‡å®šæ¶ˆæ¯å‘é€æˆåŠŸåŠå‘é€å¼‚å¸¸çš„å›è°ƒæ–¹æ³•ï¼Œè°ƒç”¨ API åç«‹å³è¿”å›ï¼Œproducer å‘é€æ¶ˆ æ¯çº¿ç¨‹ä¸é˜»å¡ ï¼Œæ¶ˆæ¯å‘é€æˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒä»»åŠ¡åœ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œ ã€‚\n/**   * å‘é€å¼‚æ­¥æ¶ˆæ¯   * @param topic   * @param msg   */  public void sendASyncMsg(String topic, String msg)&#123;      rocketMQTemplate.asyncSend(topic,msg,new SendCallback() &#123;          @Override          public void onSuccess(SendResult sendResult) &#123;              // æˆåŠŸå›è°ƒ              System.out.println(sendResult.getSendStatus());          &#125;          @Override          public void onException(Throwable e) &#123;              // å¼‚å¸¸å›è°ƒ              System.out.println(e.getMessage());          &#125;      &#125;);  &#125;// æµ‹è¯•@Test  public void testSendASyncMsg() throws InterruptedException &#123;      this.producerSimple.sendASyncMsg(&quot;myâ€topic&quot;, &quot;ç¬¬ä¸€æ¡å¼‚æ­¥æ­¥æ¶ˆæ¯&quot;);      System.out.println(&quot;end...&quot;);      // å¼‚æ­¥æ¶ˆæ¯ï¼Œä¸ºè·Ÿè¸ªå›è°ƒçº¿ç¨‹è¿™é‡ŒåŠ å…¥å»¶è¿Ÿ      Thread.sleep(3000);  &#125;\nå•å‘æ¶ˆæ¯\nproducer å‘ broker å‘é€æ¶ˆæ¯ï¼Œæ‰§è¡Œ API æ—¶ç›´æ¥è¿”å›ï¼Œä¸ç­‰å¾… broker æœåŠ¡å™¨çš„ç»“æœ ã€‚\n/**   * å‘é€å•å‘æ¶ˆæ¯   * @param topic   * @param msg   */  public void sendOneWayMsg(String topic, String msg)&#123;      this.rocketMQTemplate.sendOneWay(topic,msg);  &#125;\nè‡ªå®šä¹‰æ¶ˆæ¯æ ¼å¼\n\n\nä½¿ç”¨ String ä¼ é€’æ•°æ®\n\n\n// ç”Ÿäº§ç«¯public void sendMsgByJson(String topic, OrderExt orderExt) &#123;      // å‘é€åŒæ­¥æ¶ˆæ¯ï¼Œæ¶ˆæ¯å†…å®¹å°†orderExtè½¬ä¸ºjson      this.rocketMQTemplate.convertAndSend(topic, orderExt);      System.out.printf(&quot;send msg : %s&quot;, orderExt);  &#125;// æ¶ˆè´¹ç«¯ï¼šä½¿ç”¨ JSON å·¥å…·å°†å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡@Component  @RocketMQMessageListener(topic = &quot;myâ€topic&quot;, consumerGroup = &quot;demoâ€consumerâ€group&quot;)  public class ConsumerSimple implements RocketMQListener&lt;String&gt; &#123;      //æ¥æ‰‹åˆ°æ¶ˆæ¯è°ƒç”¨æ­¤æ–¹æ³•      @Override      public void onMessage(String s) &#123;          // å¦‚æœæ˜¯jsonæ•°æ®ï¼Œå¯ä»¥å°†jsonè½¬ä¸ºå¯¹è±¡          // OrderExt orderExt = JSON.parseObject(s, OrderExt.class);          System.out.println(s);      &#125;  &#125;\n\n\nä½¿ç”¨å¯¹è±¡æ¥æ”¶æ•°æ®\n\n\n@Component  @RocketMQMessageListener(topic = &quot;myâ€topicâ€obj&quot;, consumerGroup = &quot;demoâ€consumerâ€groupâ€obj&quot;)  // RocketMQListener æ³›å‹æŒ‡å®šè¦è½¬æ¢çš„å¯¹è±¡ç±»å‹public class ConsumerSimpleObj implements RocketMQListener&lt;OrderExt&gt; &#123;      // æ¥æ‰‹åˆ°æ¶ˆæ¯è°ƒç”¨æ­¤æ–¹æ³•      @Override      public void onMessage(OrderExt orderExt) &#123;          System.out.println(orderExt);      &#125;  &#125;\nå»¶è¿Ÿæ¶ˆæ¯\n\nRocketMQ çš„å»¶è¿Ÿæ¶ˆæ¯å®ç°éå¸¸ç®€å•ï¼Œåªéœ€è¦å‘é€æ¶ˆæ¯å‰è®¾ç½®å»¶è¿Ÿçš„æ—¶é—´ï¼Œå»¶è¿Ÿæ—¶é—´å­˜åœ¨åå…«ä¸ªç­‰çº§ ï¼ˆ1s/5s/10s/30s/1m/2m/3m/4m/5m/6m/7m/8m/9m/10m/20m/30m/1h/2hï¼‰ï¼Œè°ƒç”¨ setDelayTimeLevel() è®¾ç½®ä¸æ—¶é—´ç›¸å¯¹åº”çš„å»¶è¿Ÿçº§åˆ«å³å¯ã€‚\n\n\n\nåŒæ­¥æ¶ˆæ¯å»¶è¿Ÿ\n\n\n// ç”Ÿäº§ç«¯/**   * å‘é€å»¶è¿Ÿæ¶ˆæ¯   * æ¶ˆæ¯å†…å®¹ä¸ºjsonæ ¼å¼   */  public void sendMsgByJsonDelay(String topic, OrderExt orderExt) throws JsonProcessingException, InterruptedException, RemotingException, MQClientException, MQBrokerException &#123;      // å‘é€åŒæ­¥æ¶ˆæ¯ï¼Œæ¶ˆæ¯å†…å®¹å°†orderExtè½¬ä¸ºjson      Message&lt;OrderExt&gt; message = MessageBuilder.withPayload(orderExt).build();      // æŒ‡å®šå‘é€è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰å’Œå»¶è¿Ÿç­‰çº§      this.rocketMQTemplate.syncSend(topic, message, 1000, 3);      System.out.printf(&quot;send msg : %s&quot;, orderExt);  &#125;\n\n\nå¼‚æ­¥æ¶ˆæ¯å»¶è¿Ÿ\n\n\n/**   * å‘é€å¼‚æ­¥å»¶è¿Ÿæ¶ˆæ¯   * æ¶ˆæ¯å†…å®¹ä¸ºjsonæ ¼å¼   */  public void sendAsyncMsgByJsonDelay(String topic, OrderExt orderExt) throws JsonProcessingException, InterruptedException, RemotingException, MQClientException, MQBrokerException &#123;      // æ¶ˆæ¯å†…å®¹å°†orderExtè½¬ä¸ºjson      String json = this.rocketMQTemplate.getObjectMapper().writeValueAsString(orderExt);      org.apache.rocketmq.common.message.Message message = new org.apache.rocketmq.common.message.Message(topic, json.getBytes(Charset.forName(&quot;utfâ€8&quot;)));      // è®¾ç½®å»¶è¿Ÿç­‰çº§      message.setDelayTimeLevel(3);      // å‘é€å¼‚æ­¥æ¶ˆæ¯      this.rocketMQTemplate.getProducer().send(message, new SendCallback() &#123;          @Override          public void onSuccess(SendResult sendResult) &#123;              System.out.println(sendResult);          &#125;            @Override          public void onException(Throwable throwable) &#123;              System.out.println(throwable.getMessage());          &#125;      &#125;);      System.out.printf(&quot;send msg : %s&quot;, orderExt);  &#125;\næ¶ˆè´¹é‡è¯•\nå½“æ¶ˆæ¯å‘é€åˆ° Broker æˆåŠŸï¼Œåœ¨è¢«æ¶ˆè´¹è€…æ¶ˆè´¹æ—¶å¦‚æœæ¶ˆè´¹è€…æ²¡æœ‰æ­£å¸¸æ¶ˆè´¹ï¼Œæ­¤æ—¶æ¶ˆæ¯ä¼šé‡è¯•æ¶ˆè´¹ã€‚æ¶ˆè´¹é‡è¯•å­˜åœ¨ä¸¤ç§åœºæ™¯ï¼š\n\n\næ¶ˆæ¯æ²¡æœ‰è¢«æ¶ˆè´¹è€…æ¥æ”¶ï¼Œæ¯”å¦‚æ¶ˆè´¹è€…ä¸ broker å­˜åœ¨ç½‘ç»œå¼‚å¸¸ã€‚æ­¤ç§æƒ…å†µæ¶ˆæ¯ä¼šä¸€ç›´è¢«æ¶ˆè´¹é‡è¯•ã€‚\n\n\nå½“æ¶ˆæ¯å·²ç»è¢«æ¶ˆè´¹è€…æˆåŠŸæ¥æ”¶ï¼Œä½†æ˜¯åœ¨è¿›è¡Œæ¶ˆæ¯å¤„ç†æ—¶å‡ºç°å¼‚å¸¸ï¼Œæ¶ˆè´¹ç«¯æ— æ³•å‘ Broker è¿”å›æˆåŠŸï¼Œè¿™ç§æƒ…å†µä¸‹ RocketMQ ä¼šä¸æ–­é‡è¯•ã€‚borker æ˜¯æ€ä¹ˆçŸ¥é“é‡è¯•å‘¢ï¼Ÿ æ¶ˆè´¹è€…åœ¨æ¶ˆè´¹æ¶ˆæ¯æˆåŠŸä¼šå‘ broker è¿”å›æˆåŠŸçŠ¶æ€ï¼Œå¦åˆ™ä¼šä¸æ–­è¿›è¡Œæ¶ˆè´¹é‡è¯•ã€‚\n\n\nå¤„ç†ç­–ç•¥\n\næ¶ˆæ¯ä¼šæŒ‰ç…§å»¶è¿Ÿæ¶ˆæ¯çš„å»¶è¿Ÿæ—¶é—´ç­‰çº§ï¼ˆ1s 5s 10s 30s 1m 2m 3m 4m 5m 6m 7m 8m 9m 10m 20m 30m 1h 2hï¼‰ä»ç¬¬ 3 çº§å¼€å§‹é‡è¯•ï¼Œæ¯è¯•ä¸€æ¬¡å¦‚æœè¿˜ä¸æˆåŠŸåˆ™å»¶è¿Ÿç­‰çº§åŠ  1ã€‚é‡è¯•äº† 16 æ¬¡è¿˜æœªè¢«æˆåŠŸæ¶ˆè´¹å°†ä¼šæŠ•é€’åˆ°æ­»ä¿¡é˜Ÿåˆ—ï¼Œåˆ°è¾¾æ­»ä¿¡é˜Ÿåˆ—çš„æ¶ˆæ¯å°†ä¸å†è¢«æ¶ˆè´¹ã€‚\n\nå®é™…ç”Ÿäº§ä¸­ä¸ä¼šè®©æ¶ˆæ¯é‡è¯•è¿™ä¹ˆå¤šæ¬¡ï¼Œé€šå¸¸åœ¨é‡è¯•ä¸€å®šçš„æ¬¡æ•°åå°†æ¶ˆæ¯å†™å…¥æ•°æ®åº“ï¼Œç”±å¦å¤–å•ç‹¬çš„ç¨‹åºæˆ–äººå·¥å»å¤„ç†ã€‚\npublic class ConsumerSimple implements RocketMQListener&lt;MessageExt&gt; &#123;      @Override      public void onMessage(MessageExt messageExt) &#123;          // å–å‡ºå½“å‰é‡è¯•æ¬¡æ•°          int reconsumeTimes = messageExt.getReconsumeTimes();          // å½“å¤§äºä¸€å®šçš„æ¬¡æ•°åå°†æ¶ˆæ¯å†™å…¥æ•°æ®åº“ï¼Œç”±å•ç‹¬çš„ç¨‹åºæˆ–äººå·¥å»å¤„ç†          if (reconsumeTimes &gt;= 2) &#123;              // å°†æ¶ˆæ¯å†™å…¥æ•°æ®åº“ï¼Œä¹‹åæ­£å¸¸è¿”å›              return;          &#125;          throw new RuntimeException(String.format(&quot;ç¬¬%sæ¬¡å¤„ç†å¤±è´¥..&quot;, reconsumeTimes));      &#125;  &#125;\nKafka\nåŸºç¡€\nKafka æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„åŸºäºå¼€å‘/è®¢é˜…æ¨¡å¼çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼Œä¸»è¦åº”ç”¨äºå¤§æ•°æ®å®æ—¶å¤„ç†é¢†åŸŸã€‚\n\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["Java","RocketMQ","RabbitMQ","Kafka"]},{"title":"é¢è¯•-å¹¶å‘ğŸ¤•","url":"/posts/40294c75/","content":"\n\nå‰è¨€\nâ—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24-06-03 åˆå§‹è®°å½•24-06-04 AQS24-06-05 çº¿ç¨‹æ± 24-06-06 é«˜å¹¶å‘24-06-10 æ€»ç»“24-06-21 è¡¥å……éƒ¨åˆ†çŸ¥è¯†\n\né«˜å¹¶å‘ï¼ˆé”ï¼‰\nâ—Java å†…å­˜æ¨¡å‹çš„ç†è§£\nå¤§ç™½è¯ï¼šJava çš„å¯¹è±¡éƒ½æ˜¯å¤„äºä¸»å†…å­˜ä¹‹ä¸­ï¼Œè€Œçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼ˆCPU çº§åˆ«çš„ç¼“å­˜ï¼‰ã€‚æ“ä½œè¿‡ç¨‹ï¼Œ1) çº¿ç¨‹æŠŠä¸»å†…å­˜ä¸­çš„æ•°æ®è¯»å‡º readï¼Œ2) çº¿ç¨‹æŠŠå€¼åŠ è½½åˆ°å·¥ä½œå†…å­˜ä¸­ loadï¼Œ3) çº¿ç¨‹ä½¿ç”¨è¿™ä¸ªå€¼ useï¼Œ4) çº¿ç¨‹æŠŠç®—å¥½çš„å€¼è®¾ç½®åˆ°å·¥ä½œå†…å­˜ assignï¼Œ5) æŠŠå€¼å­˜å…¥ storeï¼Œ6) å†™å…¥ä¸»å†…å­˜ writeã€‚å¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¼šåŒæ—¶æ“ä½œï¼Œå³å¹¶å‘ï¼ˆæ“ä½œç»“æœå¯èƒ½åªæœ‰ä¸€æ¬¡çš„ç»“æœï¼‰ã€‚\n\né¦–å…ˆï¼ŒJAVA å†…å­˜æ¨¡å‹æ˜¯æŒ‡ JMMï¼Œè€Œä¸æ˜¯æŒ‡å†…å­˜ç»“æ„ï¼Œå†…å­˜ç»“æ„æ˜¯åœ¨ç‰©ç†ä¸Šçš„åŒºåŸŸåˆ’åˆ†ï¼Œè€Œ JMM åˆ™æ˜¯æŠ½è±¡æ¦‚å¿µä¸Šçš„åˆ’åˆ†ã€‚\nJMMï¼ˆå†…å­˜æ¨¡å‹ï¼‰ä¸»è¦åŒ…æ‹¬ä¸¤å—ï¼šä¸»å†…å­˜+å·¥ä½œå†…å­˜ã€‚\nä¸»å†…å­˜ï¼šå¤šä¸ªçº¿ç¨‹é—´é€šä¿¡çš„å…±äº«å†…å­˜ç§°ä¹‹ä¸ºä¸»å†…å­˜ï¼Œå³ï¼Œæ•°æ®æ˜¯å¤šä¸ªçº¿ç¨‹å…±äº«çš„ï¼Œåœ¨ç‰©ç†å†…å­˜ç»“æ„ä¸Šé€šå¸¸å¯¹åº”â€œå †â€ä¸­çš„çº¿ç¨‹å…±äº«æ•°æ®ã€‚\nå·¥ä½œå†…å­˜ï¼šå¤šä¸ªçº¿ç¨‹å„è‡ªå¯¹åº”è‡ªå·±çš„æœ¬åœ°å†…å­˜ï¼Œå³ï¼Œæ•°æ®åªå±äºè¯¥çº¿ç¨‹è‡ªå·±çš„ï¼Œåœ¨ç‰©ç†å†…å­˜ç»“æ„ä¸Šé€šå¸¸å¯¹åº”â€œæœ¬åœ°æ–¹æ³•æ ˆâ€ä¸­çš„çº¿ç¨‹ç§æœ‰æ•°æ®ã€‚\nJava å†…å­˜æ¨¡å‹è§„å®šäº†æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ (Main Memory) ä¸­ï¼Œæ¯æ¡çº¿ç¨‹è¿˜æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ (Working Memory)ï¼Œçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ä¿å­˜äº†è¢«è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬æ‹·è´ï¼Œçº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œ (è¯»å–ã€èµ‹å€¼ç­‰) éƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ï¼Œä¸åŒçš„çº¿ç¨‹ä¹‹é—´ä¹Ÿæ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œçº¿ç¨‹é—´å˜é‡å€¼å¾—ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®ç°ã€‚\n\nâ—Java å†…å­˜æ¨¡å‹ä¸­çš„åŸå­æ€§ã€æœ‰åºæ€§ã€å¯è§æ€§\nå¯è§æ€§ï¼šä¸€ä¸ªçº¿ç¨‹æ“ä½œå®Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¿…é¡»è¯»å–æ“ä½œåçš„æ•°æ®ã€‚\nåŸå­æ€§ï¼šåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ“ä½œã€‚ï¼ˆä¸åŠ æ“ä½œé»˜è®¤æƒ…å†µä¸‹å°±æ˜¯æ²¡æœ‰åŸå­æ€§çš„ï¼‰\n\n\nJava ä¸­çš„ç®€å•èµ‹å€¼æ“ä½œï¼ˆæ¯”å¦‚ int i=0ï¼‰æ˜¯åŸå­æ€§çš„ï¼Œä½†æ˜¯å¤æ‚çš„æ¯”å¦‚ i++ æ˜¯ä¸èƒ½ä¿è¯çš„ã€‚\n\n\nç‰¹ä¾‹ï¼š32 ä½è™šæ‹Ÿæœºçš„ long/double ç±»å‹çš„å˜é‡çš„ç®€å•èµ‹å€¼å†™æ“ä½œï¼Œä¸æ˜¯åŸå­çš„\n\nä¸ºä»€ä¹ˆï¼Ÿ å› ä¸º long/double æ˜¯ 64 ä½çš„ï¼Œé«˜ä½ 32 ä½ç”±ä¸¤ä¸ªçº¿ç¨‹æ“ä½œï¼Œå¯èƒ½ä¼šèµ‹å€¼é”™è¯¯ã€‚\nåŠ ä¸Š volatile long/double å¯ä»¥ä¿éšœæ˜¯åŸå­çš„ã€‚ï¼ˆvolatile åªæœ‰è¿™é‡Œå±•ç¤ºäº†åŸå­æ€§ï¼‰\n\n\n\næœ‰åºæ€§ï¼šç¼–è¯‘ä¹‹åï¼Œå¯èƒ½ä¼šæŒ‡ä»¤é‡æ’ã€‚å¦‚æœå…·å¤‡æœ‰åºæ€§ï¼Œå°±ä¸ä¼šå‘ç”ŸæŒ‡ä»¤é‡æ’ã€‚\næœ‰å“ªäº›æ“ä½œåœ¨ Java è§„èŒƒä¸­ä¸èƒ½ä¿éšœåŸå­æ€§ï¼Ÿ\n\n\næ¯”å¦‚ï¼ši = x * yã€‚éœ€è¦å…ˆæŠŠ x å’Œ y åˆ†åˆ«ä»ä¸»å†…å­˜åŠ è½½åˆ°å·¥ä½œå†…å­˜é‡Œï¼Œç„¶åå†ä»å·¥ä½œå†…å­˜é‡ŒåŠ è½½å‡ºæ¥æ‰§è¡Œè®¡ç®—ï¼Œè®¡ç®—åçš„ç»“æœå†å†™å›åˆ°å·¥ä½œå†…å­˜é‡Œï¼Œæœ€åè¿˜è¦ä»å·¥ä½œå†…å­˜é‡ŒæŠŠ i çš„æœ€æ–°çš„å€¼åˆ·å›ä¸»å†…å­˜ã€‚\n\n\næœ‰å¤æ‚çš„ä»£ç é€»è¾‘çš„æ“ä½œä¸æ˜¯åŸå­çš„ã€‚è§£å†³ï¼šåŠ é”ï¼Œå¯¹å¯¹è±¡åŠ é”ã€‚\n\n\nå¯è§æ€§çš„ç¡¬ä»¶çº§åˆ«çš„è¯´æ˜\næ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„å¯„å­˜å™¨ã€‚å¤šä¸ªå¤„ç†å™¨å„è‡ªè¿è¡Œä¸€ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œå¯¼è‡´æŸä¸ªå˜é‡æ”¾åˆ°å¯„å­˜å™¨é‡Œï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•çœ‹åˆ°ã€‚ï¼ˆç¬¬ä¸€ä¸ªé—®é¢˜ï¼‰\nå¤„ç†å™¨è¿è¡Œçš„çº¿ç¨‹å¯¹å˜é‡çš„å†™æ“ä½œéƒ½æ˜¯é’ˆå¯¹å†™ç¼“å†²æ¥çš„ï¼Œå¹¶ä¸æ˜¯ç›´æ¥æ›´æ–°ä¸»å†…å­˜ï¼Œå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹æ›´æ–°äº†å˜é‡ï¼Œä½†æ˜¯ä»…ä»…åœ¨å†™ç¼“å†²å™¨é‡Œé¢ã€‚ï¼ˆç¬¬äºŒä¸ªé—®é¢˜ï¼‰\næ¯ä¸ªå¤„ç†å™¨æœ‰ä¸ªè‡ªå·±çš„é«˜é€Ÿç¼“å­˜ï¼Œéœ€è¦æŠŠæ•°æ®å†™åˆ°é«˜é€Ÿç¼“å­˜/ä¸»å†…å­˜ï¼Œä½†æ˜¯å…¶ä»–å¤„ç†å™¨è¿˜æ˜¯ä»è‡ªå·±çš„é«˜é€Ÿç¼“å­˜è¯»å–æ•°æ®ã€‚ï¼ˆç¬¬ä¸‰ä¸ªé—®é¢˜ï¼‰\nâ—ä» Java åº•å±‚è§’åº¦èŠèŠ volatile å…³é”®å­—çš„åŸç†\n\nvolatile å…³é”®å­—ä¸å¯è§æ€§çš„å…³ç³»\n\nvolatile å…³é”®å­—æ˜¯ç”¨æ¥è§£å†³å¯è§æ€§å’Œæœ‰åºæ€§ã€‚ç»™æ•°æ®åŠ ä¸Š volatile å…³é”®å­—ï¼Œåœ¨çº¿ç¨‹æ›´æ–°æ•°æ®æ—¶ï¼Œä¼šæŠŠå…¶ä»–çº¿ç¨‹å†…ç¼“å­˜çš„æ•°æ®å€¼å¤±æ•ˆï¼Œè¿™æ—¶å…¶ä»–çº¿ç¨‹ä¼šå¼ºåˆ¶é‡æ–°ä»ä¸»å†…å­˜åŠ è½½æ•°æ®å€¼ï¼ˆå˜æˆæ–°çš„ç¼“å­˜ï¼‰ã€‚\nåœ¨å¾ˆå¤šå¼€æºä¸­é—´ä»¶ç³»ç»Ÿä¸­ï¼Œå¤§é‡ä½¿ç”¨ volatileã€‚ä¾‹å­ï¼šåœ¨ main æ–¹æ³•ä¸­ï¼Œä¼šæœ‰ä¸€æ®µé€»è¾‘ï¼Œå¦‚æœä¸»çº¿ç¨‹åœ¨æ‰§è¡Œï¼Œä¸å¯ä»¥åå°é€€å‡ºï¼ˆè¿™é‡Œçš„æ‰§è¡ŒçŠ¶æ€ç”¨ä¸€ä¸ªå€¼è¡¨ç¤ºï¼Œæ ¹æ®å€¼åˆ¤æ–­ç³»ç»Ÿæ˜¯å¦åœ¨è¿è¡Œï¼‰ã€‚å¦‚æœæä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼Œéœ€è¦å…³é—­ä¸»çº¿ç¨‹ï¼Œå¦‚æœä¸åŠ  volatile å…³é”®å­—ï¼Œå…¶ä»–çº¿ç¨‹æ›´æ–°çŠ¶æ€ï¼Œä¸»çº¿ç¨‹æ²¡æœ‰åŒæ­¥ï¼Œå°±ä¼šå‡ºé—®é¢˜ã€‚ï¼ˆè¿™ä¸ªç±»ä¼¼çš„ç”¨æ³•ä¼šåœ¨å¤šå¤„ä½¿ç”¨ï¼‰\nâ—æŒ‡ä»¤é‡æ’ä»¥åŠ happens-before åŸåˆ™\n\nvolatile å…³é”®å­—ä¸æœ‰åºæ€§çš„å…³ç³»ã€è¿å¸¦é—®é¢˜\n\nâ”happens-before åŸåˆ™ï¼š\n\n\nç¨‹åºæ¬¡åºè§„åˆ™ï¼šä¸€ä¸ªçº¿ç¨‹å†…ï¼Œä»£ç æŒ‰å†™çš„é¡ºåºæ‰§è¡Œ\n\n\né”å®šè§„åˆ™ï¼šä¸€ä¸ª unLock æ“ä½œå…ˆè¡Œä¸åä¸€ä¸ª Lock çš„æ“ä½œï¼ˆå…ˆè§£é”ï¼ŒååŠ é”ï¼‰\n\n\nvolatile å˜é‡è§„åˆ™ï¼šåŠ äº† volatile å…³é”®å­—ï¼Œå†™æ“ä½œå…ˆï¼Œè¯»æ“ä½œå\n\n\nä¼ é€’è§„åˆ™ï¼šå¦‚æœ A å…ˆäº Bï¼ŒB å…ˆäº Cï¼Œé‚£ä¹ˆ A ä¸€å®šå…ˆäº C\n\n\nçº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼šçº¿ç¨‹çš„å¯åŠ¨ start() æ–¹æ³•å…ˆäºæ­¤çº¿ç¨‹çš„æ¯ä¸ªæ“ä½œ\n\n\nçº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼šå¯¹çº¿ç¨‹çš„ interrupt() è°ƒç”¨ï¼Œå…ˆäºæ£€æµ‹åˆ°ç»ˆç«¯çš„å‘ç”Ÿ\n\n\nçº¿ç¨‹ç»ˆç»“è§„åˆ™ï¼šçº¿ç¨‹çš„æ‰€æœ‰æ“ä½œéƒ½å…ˆäºçº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹æ“ä½œ\n\n\nå¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šå¯¹è±¡çš„åˆå§‹åŒ–åœ¨ finalize() ä¹‹å‰\n\n\nè¿™ä¸ªè§„åˆ™åˆ¶å®šäº†åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä¸å…è®¸æŒ‡ä»¤é‡æ’ã€‚è€Œå› ä¸ºè¿™ä¸ªè§„åˆ™ï¼Œvolatile å…³é”®å­—æœ‰ä¸€å®šçš„é˜²æ­¢æŒ‡ä»¤é‡æ’çš„æ•ˆæœï¼ˆåªèƒ½å…ˆå†™åè¯»ï¼‰ã€‚\nåŒæ—¶ï¼Œvolatile å…³é”®å­—æœ¬èº«ï¼Œå°±æœ‰å…¶ä»–é¿å…æŒ‡ä»¤é‡æ’çš„è§„åˆ™ï¼ˆå°±æ˜¯åº•å±‚ã€‚ã€‚ã€‚æœ€å¥½ä¸è¦é—®è¿™ä¸ªï¼Œè°è®°å¾—ä½å•Šï¼‰ã€‚\nâ—volatile åº•å±‚æ˜¯å¦‚ä½•åŸºäºå†…å­˜å±éšœä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§çš„\nvolatile ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚ï¼ˆåªèƒ½åŠ é” synchronizedã€lockï¼‰ã€‚\nvolatile ä¿è¯å¯è§æ€§ï¼šå¯¹äº volatile ä¿®é¥°çš„å˜é‡ï¼Œæ‰§è¡Œå†™æ“ä½œï¼ŒJVM ä¼šå‘é€ä¸€æ¡ lock å‰ç¼€æŒ‡ä»¤ç»™ CPUï¼ŒCPU åœ¨è®¡ç®—å®Œä¹‹åå°†å€¼å¼ºåˆ¶åˆ·å›ä¸»å†…å­˜ã€‚å…¶ä»–çº¿ç¨‹æœ‰ä¸€ä¸ªå—…æ¢æœºåˆ¶ï¼ˆMESI ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼‰ï¼Œä¼šå»å¤±æ•ˆçº¿ç¨‹å†…çš„ç¼“å­˜ã€‚\nvolatile ä¿è¯æœ‰åºæ€§ï¼šåŠ å…¥å†…å­˜å±éšœï¼Œå¯ä»¥ç¦æ­¢æŒ‡ä»¤é‡æ’ã€‚\n\nå¯¹äº volatile ä¿®æ”¹å˜é‡çš„è¯»å†™æ“ä½œï¼Œéƒ½ä¼šåŠ å…¥å†…å­˜å±éšœã€‚æ¯ä¸ª volatile å†™æ“ä½œå‰é¢ï¼ŒåŠ  StoreStore å±éšœï¼Œç¦æ­¢ä¸Šé¢çš„æ™®é€šå†™å’Œä»–é‡æ’ï¼›æ¯ä¸ª volatile å†™æ“ä½œåé¢ï¼ŒåŠ  StoreLoad å±éšœï¼Œç¦æ­¢è·Ÿä¸‹é¢çš„ volatile è¯»/å†™é‡æ’ã€‚æ¯ä¸ª volatile è¯»æ“ä½œåé¢ï¼ŒåŠ  LoadLoad å±éšœï¼Œç¦æ­¢ä¸‹é¢çš„æ™®é€šè¯»å’Œ voaltile è¯»é‡æ’ï¼›æ¯ä¸ª volatile è¯»æ“ä½œåé¢ï¼ŒåŠ  LoadStore å±éšœï¼Œç¦æ­¢ä¸‹é¢çš„æ™®é€šå†™å’Œ volatile è¯»é‡æ’ã€‚\n\nsynchronized ä¸ºä»€ä¹ˆåˆå«å†…ç½®é”ï¼Ÿ\nsynchronized æ˜¯å†…ç½®äº JDK ä¸­çš„ï¼Œåº•å±‚å®ç°æ˜¯ nativeï¼Œç”± C/C++ è¯­è¨€å®ç°ï¼›åŒæ—¶ï¼ŒåŠ é”ã€è§£é”éƒ½æ˜¯ JDK è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·æ˜¾ç¤ºæ§åˆ¶ï¼Œéå¸¸æ–¹ä¾¿ã€‚\nâ—è¯´è¯´ synchronized å…³é”®å­—çš„åº•å±‚åŸç†\nå› ä¸º synchronized å¯ä»¥åŒæ—¶ä¿è¯åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œæ‰€ä»¥åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ç»å¸¸ä¼šç”¨åˆ°ä»–ï¼Œsynchronized ä¸»è¦æœ‰ä¸‰ç§ç”¨æ³•ï¼šä¿®é¥°å®ä¾‹æ–¹æ³•ã€ä¿®é¥°é™æ€æ–¹æ³•ã€ä¿®é¥°ä»£ç å—ã€‚\nsynchronized ä¿®é¥°ä»£ç å—æ—¶ï¼ŒJVM é‡‡ç”¨ monitorenter ã€monitorexit ä¸¤ä¸ªæŒ‡ä»¤æ¥å®ç°åŒæ­¥ï¼Œmonitorenter æŒ‡ä»¤æŒ‡å‘åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼Œ monitorexit æŒ‡ä»¤åˆ™æŒ‡å‘åŒæ­¥ä»£ç å—çš„ç»“æŸä½ç½®ã€‚\nsynchronized ä¿®é¥°åŒæ­¥æ–¹æ³•æ—¶ï¼ŒJVM é‡‡ç”¨ ACC_SYNCHRONIZED æ ‡è®°ç¬¦æ¥å®ç°åŒæ­¥ï¼Œè¿™ä¸ªæ ‡è®°äº†è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ã€‚\nâ—å¤§ç™½è¯ï¼ˆä¿®é¥°ä»£ç å—ï¼‰ï¼šæ¯ä¸ªå¯¹è±¡å®ä¾‹éƒ½ä¼šå…³è”ä¸€ä¸ª monitorï¼Œä¸€ä¸ªç±»çš„ class å¯¹è±¡ä¹Ÿä¼šå…³è”ä¸€ä¸ª monitorã€‚ä¸€ä¸ªçº¿ç¨‹è¿‡æ¥ï¼ŒæŠŠ monitor ç½® 1ï¼ˆå¯ä»¥é‡å¤åŠ é”ï¼ŒäºŒæ¬¡åŠ  monitor å˜æˆ 2ã€3â€¦ï¼‰ã€‚å½“çº¿ç¨‹èµ°å‡º synchronizedï¼Œæ‰§è¡Œ monitorexitï¼Œåº•å±‚è·å–å¯¹åº”çš„ monitor è¿›è¡Œé‡Šæ”¾ã€‚çº¿ç¨‹ 2 åŠ é”å¤±è´¥ï¼Œé™·å…¥ä¸€ä¸ªé˜»å¡ç­‰å¾…çš„çŠ¶æ€ã€‚\nSyncrhronized æ€ä¹ˆä¿è¯å¯è§æ€§ï¼Ÿ\nJMM ä¸­ä½¿ç”¨ happens-before è¯­ä¹‰ï¼š\n\n\nçº¿ç¨‹è§£é”å‰ï¼Œå¿…é¡»æŠŠå…±äº«å˜é‡çš„æœ€æ–°å€¼åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­ã€‚\n\n\nçº¿ç¨‹åŠ é”æ—¶ï¼Œå°†æ¸…ç©ºå·¥ä½œå†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼ï¼Œä»è€Œä½¿ç”¨å…±äº«å˜é‡æ—¶éœ€è¦ä»ä¸»å†…å­˜ä¸­é‡æ–°è·å–æœ€æ–°çš„å€¼ã€‚ï¼ˆæ³¨æ„ï¼šåŠ é”ä¸è§£é”éœ€è¦æ˜¯åŒä¸€æŠŠé”ï¼‰\n\n\nSynchronized æ€ä¹ˆä¿è¯åŸå­æ€§ï¼Ÿ\nä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ª monitorexit å‘¢ï¼Ÿ\nè¿™ä¸ªä¸»è¦æ˜¯é˜²æ­¢åœ¨åŒæ­¥ä»£ç å—ä¸­çº¿ç¨‹å› å¼‚å¸¸é€€å‡ºï¼Œè€Œé”æ²¡æœ‰å¾—åˆ°é‡Šæ”¾ï¼Œè¿™å¿…ç„¶ä¼šé€ æˆæ­»é”ï¼ˆç­‰å¾…çš„çº¿ç¨‹æ°¸è¿œè·å–ä¸åˆ°é”ï¼‰ã€‚å› æ­¤æœ€åä¸€ä¸ª monitorexit æ˜¯ä¿è¯åœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼Œé”ä¹Ÿå¯ä»¥å¾—åˆ°é‡Šæ”¾ï¼Œé¿å…æ­»é”ï¼Œå®ƒç”±ç¼–è¯‘å™¨è‡ªåŠ¨äº§ç”Ÿçš„ä¸€ä¸ªå¼‚å¸¸å¤„ç†å™¨æ¥æ‰§è¡Œã€‚\nSynchronized å¯é‡å…¥çš„åŸç†\né‡å…¥é”æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°è¯¥é”ä¹‹åï¼Œè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å¾—è¯¥é”ï¼Œä¸”ä¸å†è¢«é˜»å¡ã€‚åº•å±‚åŸç†ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“çº¿ç¨‹è·å–è¯¥é”æ—¶ï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼Œå†æ¬¡è·å¾—è¯¥é”æ—¶ç»§ç»­åŠ ä¸€ï¼Œé‡Šæ”¾é”æ—¶ï¼Œè®¡æ•°å™¨å‡ä¸€ï¼Œå½“è®¡æ•°å™¨å€¼ä¸º 0 æ—¶ï¼Œè¡¨æ˜è¯¥é”æœªè¢«ä»»ä½•çº¿ç¨‹æ‰€æŒæœ‰ï¼Œå…¶å®ƒçº¿ç¨‹å¯ä»¥ç«äº‰è·å–é”ã€‚\nSynchronized æ€ä¹ˆä¿è¯æœ‰åºæ€§ï¼Ÿ\né¦–å…ˆï¼ŒSynchronized ä¿è¯æœ‰åºæ€§ï¼Œä½†ä¸è¡¨ç¤ºä»–èƒ½ç¦æ­¢æŒ‡ä»¤é‡æ’ã€‚\nè€Œä¹‹æ‰€ä»¥ä¼šæœ‰åºæ€§é—®é¢˜ï¼Œæ˜¯å› ä¸ºç¡¬ä»¶å±‚é¢åšäº†å¾ˆå¤šä¼˜åŒ–ï¼Œæ¯”å¦‚å¤„ç†å™¨åšå¼ºåŒ–å’ŒæŒ‡ä»¤é‡æ’ç­‰ï¼Œè¿™äº›æŠ€æœ¯å¼•å…¥ä¼šå¯¼è‡´æœ‰åºæ€§é—®é¢˜ã€‚è¿™æœ‰åºæ€§é—®é¢˜ä¸»è¦å‡ºåœ¨å¤šçº¿ç¨‹ä¸­ï¼Œå› ä¸ºå•çº¿ç¨‹ä¸­æ˜¯éµå¾ª JMM çš„ as-if-serial è¯­ä¹‰çš„ï¼Œèƒ½ä¿è¯æ•°æ®é—´çš„ä¾èµ–å…³ç³»çš„ï¼Œæ¯”å¦‚ A ä¾èµ–äº Bï¼ŒB ä¾èµ–äº Cï¼Œé‚£ A çš„å®ç°ä¹‹å‰ï¼Œå¿…é¡»ä¼šå…ˆæ‰§è¡Œ Cã€‚as-if-serial è¯­ä¹‰çš„æ„æ€æ˜¯ï¼šä¸ç®¡æ€ä¹ˆé‡æ’åºï¼Œå•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œç»“æœä¸èƒ½è¢«æ”¹å˜ã€‚ç¼–è¯‘å™¨ã€runtime å’Œå¤„ç†å™¨éƒ½å¿…é¡»éµå®ˆ as-if-serial è¯­ä¹‰ã€‚\nä½†æ˜¯å¤šçº¿ç¨‹å°±å¯èƒ½å› ä¸ºæŒ‡ä»¤é‡æ’å¯¼è‡´åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­å…ˆæ‰§è¡Œåˆ°äº† Cï¼Œå¤šçº¿ç¨‹ç¨‹åºçš„è¯­ä¹‰å°±è¢«é‡æ’åºç ´åäº†ï¼Synchronized åŒæ­¥ä»£ç å—å¯ä»¥é”ä½å½“å‰çº¿ç¨‹ï¼Œè¿™æ ·æ¯ä¸ªçº¿ç¨‹å•ç‹¬æ‰§è¡Œï¼Œå°±å¯ä»¥ä¿è¯æœ‰åºæ€§äº†ã€‚\nSynchronized å’Œç›‘è§†å™¨ï¼ˆmonitorï¼‰æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿä¸ºä»€ä¹ˆ Synchronized å¯ä»¥ä½¿ç”¨ä»»æ„å¯¹è±¡ï¼Ÿ\né¦–å…ˆï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªâ€œç›‘è§†å™¨ monitorâ€ï¼Œè¿™ä¸ªç›‘è§†å™¨ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šç‹¬å é”ã€å…¥å£é˜Ÿåˆ—ï¼Œç­‰å¾…é˜Ÿåˆ—ã€‚\næ³¨æ„ï¼šä¸€ä¸ªå¯¹è±¡åªèƒ½æœ‰ä¸€ä¸ªç‹¬å é”ï¼Œä½†æ˜¯ä»»æ„çº¿ç¨‹éƒ½å¯ä»¥æ‹¥æœ‰è¿™ä¸ªç‹¬å é”ï¼ˆè¯´ç™½äº†ï¼Œç‹¬å é”å°±æ˜¯ä¸€ä¸ªæ ‡è®°ï¼‰ã€‚\nSynchronized éœ€è¦è·å–å¯¹è±¡é”ï¼Œå®é™…ä¸Šå°±æ˜¯è·å–çš„æ˜¯å¯¹è±¡ä¸­çš„ç‹¬å é”ï¼Œé€šè¿‡è¿™ä¸ªæ ‡è®°æ¥åˆ¤æ–­æ˜¯å¦å·²æœ‰çº¿ç¨‹è¿›å…¥å ç”¨ï¼ˆæ‰€ä»¥ synchronized æ— è®ºä½¿ç”¨ä»€ä¹ˆå¯¹è±¡éƒ½å¯ä»¥ï¼Œæ¯ä¸ªå¯¹è±¡åœ¨å †ä¸­éƒ½æœ‰ç‹¬å é”ï¼‰ã€‚\nè€Œå…¥å£é˜Ÿåˆ—ä¸­æ”¾çš„åˆ™æ˜¯è¦ç«äº‰é”èµ„æºçš„å…¶ä»–çº¿ç¨‹ï¼Œå¦‚æœçº¿ç¨‹ä½¿ç”¨äº† wait æ–¹æ³•ï¼Œåˆ™è¿›å…¥å¯¹è±¡çš„ç­‰å¾…åˆ—é˜Ÿä¸­ã€‚\nSynchronized ä¸­çš„é”ä¸­ä»€ä¹ˆæ˜¯é‡é‡é”ï¼ˆå¯¹è±¡é”ï¼‰ï¼Œè‡ªæ—‹é”ï¼Œè‡ªé€‚åº”è‡ªæ—‹é”ï¼Œè½»é‡é”ï¼Œåå‘é”ï¼Œé”æ¶ˆé™¤ï¼Œé”ç²—åŒ–ï¼Ÿ\nçº¿ç¨‹çš„é˜»å¡å’Œå”¤é†’éœ€è¦ CPU ä»ç”¨æˆ·æ€è½¬ä¸ºæ ¸å¿ƒæ€ï¼Œé¢‘ç¹çš„é˜»å¡å’Œå”¤é†’å¯¹ CPU æ¥è¯´æ˜¯ä¸€ä»¶è´Ÿæ‹…å¾ˆé‡çš„å·¥ä½œï¼ŒåŠ¿å¿…ä¼šç»™ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½å¸¦æ¥å¾ˆå¤§çš„å‹åŠ›ã€‚åŒæ—¶æˆ‘ä»¬å‘ç°åœ¨è®¸å¤šåº”ç”¨ä¸Šé¢ï¼Œå¯¹è±¡é”çš„é”çŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­ä¸€æ®µæ—¶é—´ï¼Œä¸ºäº†è¿™ä¸€æ®µå¾ˆçŸ­çš„æ—¶é—´é¢‘ç¹åœ°é˜»å¡å’Œå”¤é†’çº¿ç¨‹æ˜¯éå¸¸ä¸å€¼å¾—çš„ï¼Œæ‰€ä»¥å¼•å…¥è‡ªæ—‹é”ã€‚\nå°±æ˜¯ç­‰å¾…é”çš„çº¿ç¨‹å¹¶ä¸è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯æ‰§è¡Œä¸€ä¸ªæ— æ„ä¹‰çš„å¾ªç¯ã€‚åœ¨å¾ªç¯ç»“æŸåæŸ¥çœ‹é”æ˜¯å¦å·²ç»è¢«é‡Šæ”¾ï¼Œè‹¥å·²ç»é‡Šæ”¾åˆ™ç›´æ¥è¿›å…¥æ‰§è¡ŒçŠ¶æ€ã€‚å› ä¸ºé•¿æ—¶é—´æ— æ„ä¹‰å¾ªç¯ä¹Ÿä¼šå¤§é‡æµªè´¹ç³»ç»Ÿèµ„æºï¼Œå› æ­¤è‡ªæ—‹é”é€‚ç”¨äºé—´éš”æ—¶é—´çŸ­çš„åŠ é”åœºæ™¯ã€‚\nè‡ªé€‚åº”è‡ªæ—‹é”ï¼š\n\n\nè‡ªé€‚åº”å°±æ„å‘³ç€è‡ªæ—‹çš„æ¬¡æ•°ä¸å†æ˜¯å›ºå®šçš„ï¼Œå®ƒæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šã€‚çº¿ç¨‹å¦‚æœè‡ªæ—‹æˆåŠŸäº†ï¼Œé‚£ä¹ˆä¸‹æ¬¡è‡ªæ—‹çš„æ¬¡æ•°ä¼šæ›´åŠ å¤šï¼Œå› ä¸ºè™šæ‹Ÿæœºè®¤ä¸ºæ—¢ç„¶ä¸Šæ¬¡æˆåŠŸäº†ï¼Œé‚£ä¹ˆæ­¤æ¬¡è‡ªæ—‹ä¹Ÿå¾ˆæœ‰å¯èƒ½ä¼šå†æ¬¡æˆåŠŸï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå…è®¸è‡ªæ—‹ç­‰å¾…æŒç»­çš„æ¬¡æ•°æ›´å¤šã€‚åä¹‹ï¼Œå¦‚æœå¯¹äºæŸä¸ªé”ï¼Œå¾ˆå°‘æœ‰è‡ªæ—‹èƒ½å¤ŸæˆåŠŸçš„ï¼Œé‚£ä¹ˆåœ¨ä»¥åè¦æˆ–è€…è¿™ä¸ªé”çš„æ—¶å€™è‡ªæ—‹çš„æ¬¡æ•°ä¼šå‡å°‘ç”šè‡³çœç•¥æ‰è‡ªæ—‹è¿‡ç¨‹ï¼Œä»¥å…æµªè´¹å¤„ç†å™¨èµ„æºã€‚\n\n\nåå‘é”ï¼š\n\n\nåå‘äºç¬¬ä¸€ä¸ªè·å¾—å®ƒçš„çº¿ç¨‹ã€‚å½“çº¿ç¨‹è®¿é—®åŒæ­¥å—å¹¶è·å–é”æ—¶ï¼Œä¼šåœ¨å¯¹è±¡å¤´å’Œæ ˆå¸§ä¸­çš„é”è®°å½•é‡Œå­˜å‚¨é”åå‘çš„çº¿ç¨‹ IDï¼Œä»¥åè¯¥çº¿ç¨‹åœ¨è¿›å…¥å’Œé€€å‡ºåŒæ­¥å—æ—¶ä¸éœ€è¦è¿›è¡Œ CAS åŠ é”å’Œè§£é”æ“ä½œã€‚é€‚ç”¨äºåªæœ‰ 1 ä¸ªçº¿ç¨‹çš„æƒ…å†µã€‚æ— æ³•ä»£æ›¿é‡é‡é”ã€‚\n\n\nè½»é‡é”ï¼š\n\n\nå¦‚æœæœ‰ç¬¬äºŒçº¿ç¨‹è¿‡æ¥ç«äº‰ï¼Œåˆ™ä»åå‘é”å‡çº§ä¸ºè½»é‡é”ï¼Œçº¿ç¨‹å°è¯•ä½¿ç”¨ CAS å°†å¯¹è±¡å¤´ä¸­çš„ Mark Word æ›¿æ¢ä¸ºæŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆã€‚å¦‚æœæˆåŠŸï¼Œå½“å‰çº¿ç¨‹è·å¾—é”ã€‚é€‚ç”¨äºåªæœ‰ 2 ä¸ªçº¿ç¨‹æƒ…å†µã€‚æ— æ³•ä»£æ›¿é‡é‡é”ã€‚\n\n\né‡é‡é”ï¼š\n\n\nå½“æœ‰ 3 ä¸ªåŠä»¥ä¸Šçš„çº¿ç¨‹ç«äº‰æ—¶ï¼Œå‡çº§ä¸ºé‡é‡é”ï¼Œè·å¾—é”çš„æ‰§è¡Œï¼Œæ²¡è·å¾—é”çš„é˜»å¡æŒ‚èµ·ï¼Œç›´åˆ°æŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œå®ŒåŒæ­¥å—å”¤é†’å®ƒä»¬ã€‚é‡é‡çº§é”é€šè¿‡å¯¹è±¡å†…éƒ¨çš„ç›‘è§†å™¨ï¼ˆmonitorï¼‰å®ç°ï¼Œå…¶ä¸­ monitor çš„æœ¬è´¨æ˜¯ä¾èµ–äºåº•å±‚æ“ä½œç³»ç»Ÿçš„å®ç°ï¼Œæ“ä½œç³»ç»Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢éœ€è¦ä»ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢ï¼Œåˆ‡æ¢æˆæœ¬éå¸¸é«˜ã€‚\n\n\né”æ¶ˆé™¤ï¼š\n\n\nJVM æ£€æµ‹åˆ°ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰ï¼Œè¿™æ—¶ JVM ä¼šå¯¹è¿™äº›åŒæ­¥é”è¿›è¡Œé”æ¶ˆé™¤ã€‚æ¯”å¦‚ä¸€ä¸ªæ–¹æ³•ä¸­ä½¿ç”¨å˜é‡æ˜¯å±äºè‡ªå·±æ–¹æ³•ä¸­çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡æ˜¯åªå±äºè¯¥çº¿ç¨‹è‡ªå·±çš„ï¼Œå…¶ä»–çº¿ç¨‹æŠ¢ä¸èµ°ï¼Œè¿™æ—¶å€™è¿™ä¸ªæ–¹æ³•ä¸­çš„å˜é‡å°±æ²¡å¿…è¦åŠ é”äº†ã€‚é”æ¶ˆé™¤çš„ä¾æ®æ˜¯é€ƒé€¸åˆ†æï¼ˆåº•å±‚åˆ¤æ–­è¯¥æ•°æ®æ˜¯å¦æœ‰è¢«å…¨å±€å¼•ç”¨æˆ–è€…ç¨‹åºæŒ‡å‘æ— æ³•è¢«è®¿é—®åˆ°çš„åœ°æ–¹ç­‰ï¼‰çš„æ•°æ®æ”¯æŒã€‚\n\n\né”ç²—åŒ–ï¼š\n\n\né”ç²—åŒ–å°±æ˜¯å°†å¤šä¸ªè¿ç»­çš„åŠ é”ã€è§£é”æ“ä½œè¿æ¥åœ¨ä¸€èµ·ï¼Œæ‰©å±•æˆä¸€ä¸ªèŒƒå›´æ›´å¤§çš„é”ã€‚å¦‚ä¸Šé¢å®ä¾‹ï¼švector æ¯æ¬¡ add çš„æ—¶å€™éƒ½éœ€è¦åŠ é”æ“ä½œï¼ŒJVM æ£€æµ‹åˆ°å¯¹åŒä¸€ä¸ªå¯¹è±¡ï¼ˆvectorï¼‰è¿ç»­åŠ é”ã€è§£é”æ“ä½œï¼Œä¼šåˆå¹¶ä¸€ä¸ªæ›´å¤§èŒƒå›´çš„åŠ é”ã€è§£é”æ“ä½œï¼Œå³åŠ é”è§£é”æ“ä½œä¼šç§»åˆ° for å¾ªç¯ä¹‹å¤–ã€‚\n\n\nå¤šçº¿ç¨‹ä¸­ synchronized é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\nåå‘æ‰€é”ï¼Œè½»é‡çº§é”éƒ½æ˜¯ä¹è§‚é”ï¼Œé‡é‡çº§é”æ˜¯æ‚²è§‚é”ã€‚\nä¸€ä¸ªå¯¹è±¡åˆšå¼€å§‹å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œæ²¡æœ‰ä»»ä½•çº¿ç¨‹æ¥è®¿é—®å®ƒçš„æ—¶å€™ã€‚å®ƒæ˜¯å¯åå‘çš„ï¼Œæ„å‘³ç€ï¼Œå®ƒç°åœ¨è®¤ä¸ºåªå¯èƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ¥è®¿é—®å®ƒï¼Œæ‰€ä»¥å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹æ¥è®¿é—®å®ƒçš„æ—¶å€™ï¼Œå®ƒä¼šåå‘è¿™ä¸ªçº¿ç¨‹ï¼Œæ­¤æ—¶ï¼Œå¯¹è±¡æŒæœ‰åå‘é”ã€‚åå‘ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹åœ¨ä¿®æ”¹å¯¹è±¡å¤´æˆä¸ºåå‘é”çš„æ—¶å€™ä½¿ç”¨ CAS æ“ä½œï¼Œå¹¶å°†å¯¹è±¡å¤´ä¸­çš„ ThreadID æ”¹æˆè‡ªå·±çš„ IDï¼Œä¹‹åå†æ¬¡è®¿é—®è¿™ä¸ªå¯¹è±¡æ—¶ï¼Œåªéœ€è¦å¯¹æ¯” IDï¼Œä¸éœ€è¦å†ä½¿ç”¨ CAS åœ¨è¿›è¡Œæ“ä½œã€‚\nä¸€æ—¦æœ‰ç¬¬äºŒä¸ªçº¿ç¨‹è®¿é—®è¿™ä¸ªå¯¹è±¡ï¼Œå› ä¸ºåå‘é”ä¸ä¼šä¸»åŠ¨é‡Šæ”¾ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªçº¿ç¨‹å¯ä»¥çœ‹åˆ°å¯¹è±¡çš„åå‘çŠ¶æ€ï¼Œè¿™æ—¶è¡¨æ˜åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šå·²ç»å­˜åœ¨ç«äº‰äº†ï¼Œæ£€æŸ¥åŸæ¥æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹æ˜¯å¦ä¾ç„¶å­˜æ´»ï¼Œå¦‚æœæŒ‚äº†ï¼Œåˆ™å¯ä»¥å°†å¯¹è±¡å˜ä¸ºæ— é”çŠ¶æ€ï¼Œç„¶åé‡æ–°åå‘æ–°çš„çº¿ç¨‹ï¼Œå¦‚æœåŸæ¥çš„çº¿ç¨‹ä¾ç„¶å­˜æ´»ï¼Œåˆ™é©¬ä¸Šæ‰§è¡Œé‚£ä¸ªçº¿ç¨‹çš„æ“ä½œæ ˆï¼Œæ£€æŸ¥è¯¥å¯¹è±¡çš„ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœä»ç„¶éœ€è¦æŒæœ‰åå‘é”ï¼Œåˆ™åå‘é”å‡çº§ä¸ºè½»é‡çº§é”ï¼Œï¼ˆåå‘é”å°±æ˜¯è¿™ä¸ªæ—¶å€™å‡çº§ä¸ºè½»é‡çº§é”çš„ï¼‰ã€‚å¦‚æœä¸å­˜åœ¨ä½¿ç”¨äº†ï¼Œåˆ™å¯ä»¥å°†å¯¹è±¡å›å¤æˆæ— é”çŠ¶æ€ï¼Œç„¶åé‡æ–°åå‘ã€‚\nè½»é‡çº§é”è®¤ä¸ºç«äº‰å­˜åœ¨ï¼Œä½†æ˜¯ç«äº‰çš„ç¨‹åº¦å¾ˆè½»ï¼Œä¸€èˆ¬ä¸¤ä¸ªçº¿ç¨‹å¯¹äºåŒä¸€ä¸ªé”çš„æ“ä½œéƒ½ä¼šé”™å¼€ï¼Œæˆ–è€…è¯´ç¨å¾®ç­‰å¾…ä¸€ä¸‹ï¼ˆè‡ªæ—‹ï¼‰ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°±ä¼šé‡Šæ”¾é”ã€‚ ä½†æ˜¯å½“è‡ªæ—‹è¶…è¿‡ä¸€å®šçš„æ¬¡æ•°ï¼Œæˆ–è€…ä¸€ä¸ªçº¿ç¨‹åœ¨æŒæœ‰é”ï¼Œä¸€ä¸ªåœ¨è‡ªæ—‹ï¼Œåˆæœ‰ç¬¬ä¸‰ä¸ªæ¥è®¿æ—¶ï¼Œè½»é‡çº§é”è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œé‡é‡çº§é”ä½¿é™¤äº†æ‹¥æœ‰é”çš„çº¿ç¨‹ä»¥å¤–çš„çº¿ç¨‹éƒ½é˜»å¡ï¼Œé˜²æ­¢ CPU ç©ºè½¬ã€‚\nSynchronized é”åªä¼šè‡ªåŠ¨å‡çº§ï¼Œä¸ä¼šé™çº§ï¼ˆReentrantReadWriteLock è¯»å†™é”å¯ä»¥é™çº§ï¼‰ã€‚\nsynchronized å’Œ volatile çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\nsynchronized è¡¨ç¤ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–ä½œç”¨å¯¹è±¡çš„é”ï¼Œæ‰§è¡Œä»£ç ï¼Œé˜»å¡å…¶ä»–çº¿ç¨‹ã€‚\nvolatile è¡¨ç¤ºå˜é‡åœ¨ CPU çš„å¯„å­˜å™¨ä¸­æ˜¯ä¸ç¡®å®šçš„ï¼Œå¿…é¡»ä»ä¸»å­˜ä¸­è¯»å–ã€‚ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å˜é‡çš„å¯è§æ€§ï¼›ç¦æ­¢æŒ‡ä»¤é‡æ’åºã€‚\nåŒºåˆ«ï¼š\n\n\nvolatile æ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼›synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ã€‚\n\n\nvolatile ä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼›è€Œ synchronized åˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’ŒåŸå­æ€§ã€‚\n\n\nvolatile ä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronized å¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ã€‚\n\n\nvolatile æ ‡è®°çš„å˜é‡ä¸ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼›synchronized æ ‡è®°çš„å˜é‡å¯ä»¥è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚\n\n\nâ—å¯¹ CAS çš„ç†è§£åŠå…¶åº•å±‚å®ç°åŸç†\nCAS å«åšæ¯”è¾ƒå¹¶äº¤æ¢ï¼ŒCAS æŒ‡ä»¤åŒ…å« 3 ä¸ªå‚æ•°ï¼šæ–°å€¼ï¼Œæ—§å€¼ï¼Œå†…å­˜å€¼ï¼ˆå†…å­˜ä½ç½®ï¼‰ï¼Œçº¿ç¨‹ä¼šå…ˆè·å–å†…å­˜å€¼ï¼Œç„¶åå¤åˆ¶åˆ°å˜é‡å‰¯æœ¬ï¼Œç”Ÿæˆæ—§å€¼ï¼Œæ—§å€¼åœ¨ä¸€ç³»åˆ—æ“ä½œåç”Ÿæˆæ–°å€¼ã€‚\nè‹¥æ—§å€¼=å†…å­˜å€¼ï¼Œè¯´æ˜æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹æŠ¢å…ˆå æœ‰ï¼Œåˆ™ä¿®æ”¹å†…å­˜å€¼ä¸ºæ–°å€¼ï¼›\nè‹¥æ—§å€¼â‰ å†…å­˜å€¼ï¼Œè¯´æ˜å†…å­˜å€¼å·²ç»è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹ï¼Œåˆ™è‡ªæ—‹è·å–æ–°çš„å†…å­˜å€¼ï¼Œç„¶åé‡æ–°æ“ä½œã€‚\nå¤§ç™½è¯ï¼šæ¯”å¦‚è¯´ä½¿ç”¨ synchronized å¯¹äºä»£ç å—è¿›è¡ŒåŠ é”ï¼Œè¿™ä¸ªæ—¶å€™å¤šä¸ªçº¿ç¨‹çš„æ‰§è¡Œæ˜¯ä¸²è¡Œçš„ã€‚æ¯”å¦‚ä¸€ä¸ªç´¯åŠ çš„è®¡æ•°å™¨ï¼Œä¼˜åŒ–å¯ä»¥æŠŠ int ç±»å‹çš„ç´¯åŠ å­—æ®µæ”¹æˆAtomicIntegerç±»å‹ï¼ˆåŸå­ç±»ï¼‰ï¼Œæ–¹æ³•æ”¹ä¸º incrementAndGetï¼Œæ­¤æ—¶ä¸ç”¨ synchronized ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚è¿™ä¸ªåŸå­ç±»åº•å±‚å°±æ˜¯ CASï¼ˆCompare and Setï¼‰ã€‚åœ¨çº¿ç¨‹æ‰§è¡Œ incrementAndGet æ—¶ï¼Œä¼šå…ˆè¯»å–ï¼Œå†å°è¯•è®¾ç½®ï¼šå½“ä¸€ä¸ªçº¿ç¨‹æˆåŠŸæ‰§è¡Œ CAS æ“ä½œï¼ˆå°±æ˜¯å¯¹æ¯”æ—§å€¼æ˜¯å¦æ˜¯åŸæ¥çš„å€¼ï¼‰ï¼Œå¦ä¸€ä¸ªå°±ä¼šå¤±è´¥ï¼Œå¤±è´¥å°±ä¼šé‡æ–°è¯»å–ï¼Œå†æ¬¡è®¾ç½®ã€‚\nâ—CAS ä¼šå‡ºç°ç»å…¸çš„ ABA é—®é¢˜\nåŸå› ï¼šç¬¬ä¸€ä¸ªçº¿ç¨‹åˆšè·å¾— Aï¼Œç¬¬äºŒä¸ªçº¿ç¨‹å°±æŠ¢èµ°ä¹Ÿè·å¾— Aï¼Œç„¶åæ”¹æˆ B ååˆæ”¹æˆ Aï¼Œè¿™æ—¶å€™ç¬¬ä¸€ä¸ªçº¿ç¨‹å‘ç°å˜é‡æ˜¯ Aï¼Œå°±ç»§ç»­æ‰§è¡Œã€‚ä½†æ˜¯è¿™æ ·ä¼šå‡ºç°æ½œè—çš„é—®é¢˜ï¼Œæ¯”å¦‚ä¿®æ”¹çš„æ˜¯é‡‘é¢ï¼Œå­˜ä¸€ç¬”å’Œå­˜ä¸¤ç¬”æ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚\nè§£å†³ï¼šåŠ å…¥ç‰ˆæœ¬å·è§£å†³ã€‚\nâ—å¯¹ JDK ä¸­çš„ AQS çš„ç†è§£ï¼ŒAQS çš„å®ç°åŸç†\nå¤šçº¿ç¨‹è®¿é—®æ•°æ®é™¤äº† synchronizedï¼ŒCASï¼ŒConcurrentHashMapï¼Œè¿˜æœ‰ Lockã€‚ReentrantLock çš„åº•å±‚å°±æ˜¯ AQSï¼ˆAbstract Queue Synchronizerï¼‰ã€‚\nReentrantLock lock = new ReentrantLock(); // é»˜è®¤ä½¿ç”¨éå…¬å¹³é”// ä¼ å…¥å‚æ•°trueï¼Œå°±ä½¿ç”¨å…¬å¹³é”ReentrantLock lock = new ReentrantLock(true);lock.lock();look.unlock();\nå¤§ç™½è¯ï¼šAQS åº•å±‚æœ‰ä¸ª stateï¼Œå¤šä¸ªçº¿ç¨‹æ‰§è¡Œ CAS æ›´æ–° stateï¼›è¿˜æœ‰ä¸€ä¸ªå˜é‡è®°å½•åŠ é”çº¿ç¨‹ã€‚AQS ä¸­ä¼šæœ‰ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—çš„æ¦‚å¿µã€‚å½“å‰ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾äº†é”ï¼Œä¼šå»å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„é˜Ÿé¦–å…ƒç´ ã€‚\néå…¬å¹³é”ï¼šåœ¨å”¤é†’ç­‰å¾…é˜Ÿåˆ—çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰å¦ä¸€ä¸ªçº¿ç¨‹æŠ¢å é”ï¼Œæ˜¯å¯ä»¥æˆåŠŸçš„ã€‚\nå…¬å¹³é”ï¼šåœ¨å”¤é†’ç­‰å¾…é˜Ÿåˆ—çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœéœ€è¦æŠ¢å é”ï¼Œéœ€è¦åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—å†…ï¼Œè¿›è¡Œç­‰å¾…ã€‚\nReetrantReadWriteLock è¯»å†™é”å’Œ RenntrantLock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nReentrantLock æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå®ƒçš„è¯»é”ä¸è¯»é”é—´ä¹Ÿä¼šäº’æ–¥ï¼Œä½†è¯»æ•°æ®å¹¶ä¸ä¼šæ”¹åŠ¨æ•°æ®ï¼Œæ²¡æœ‰å¿…è¦åŠ é”ä¿æŠ¤ï¼Œè¿™å°±é™ä½äº†ç¨‹åºçš„æ€§èƒ½ã€‚\nå› ä»¥ä¸Šé—®é¢˜ï¼Œè¯ç”Ÿäº†è¯»å†™é”ï¼Œè¯»å†™é”ä¸€ç§è¯»å†™åˆ†ç¦»æŠ€æœ¯ï¼Œå®ƒçš„è¯»é”æ˜¯å…±äº«çš„ï¼Œå†™é”æ˜¯ç‹¬å çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šä¸ªçº¿ç¨‹æ˜¯å¯ä»¥ä¸€èµ·è¯»æ•°æ®çš„ï¼Œåªæœ‰å†™æ•°æ®çš„æ—¶å€™ï¼Œæ‰ä¼šåŒæ­¥çº¿ç¨‹ã€‚\nè¯»å†™é” ReentrantReadWriteLock æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\n\n\nå…¬å¹³æ€§å¯ä»¥é€‰æ‹©ï¼šæ”¯æŒéå…¬å¹³ (é»˜è®¤) å’Œå…¬å¹³çš„é”è·å–ï¼Œååé‡éå…¬å¹³ä¼˜äºå…¬å¹³ã€‚\n\n\né‡è¿›å…¥ï¼šè¯»é”å’Œå†™é”éƒ½æ”¯æŒçº¿ç¨‹é‡è¿›å…¥ã€‚\n\n\né”é™çº§ï¼šè·å–å†™é”ï¼Œå†è·å–è¯»é”ï¼Œç„¶åé‡Šæ”¾å†™é”ï¼Œè¿™æ ·å†™é”å°±é™çº§ä¸ºäº†è¯»é”ã€‚ï¼ˆæ³¨ï¼šSynchronized æ˜¯ä¸èƒ½è¿›è¡Œé”é™çº§çš„ï¼Œæ„ä¹‰ä¸ä¸€æ ·ï¼‰ã€‚\n\n\nReentrantLock ä¸ Synchronized çš„åŒºåˆ«\n\n\näºŒè€…çš„æœ¬è´¨åŒºåˆ«ï¼šsynchronized æ˜¯å…³é”®å­—ï¼ŒReentrantLock æ˜¯ä¸€ä¸ªç±» ç›¸åŒç‚¹ï¼šè¿™ä¸¤ä¸ªéƒ½æ˜¯å¯é‡å…¥é”ã€‚\n\n\nReentrantLock å¿…é¡»æ‰‹åŠ¨è·å–ä¸é‡Šæ”¾é”ï¼Œè€Œ synchronized ä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å’Œå¼€å¯é”\n\n\nReentrantLock åªé€‚ç”¨äºä»£ç å—é”ï¼Œè€Œ synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰ã€‚\n\n\nä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\nA éœ€è¦ B è§£é”ï¼ŒB éœ€è¦ A è§£é”ï¼Œä¸¤ä¸ªéƒ½åœ¨ä¸­é—´äº’ç›¸ç­‰å¾…ï¼Œå´è°ä¹Ÿæ— æ³•æ»¡è¶³æ¡ä»¶ï¼Œä»è€Œå‘ç”Ÿé˜»å¡ï¼Œå°±æ˜¯æ­»é”ã€‚\næ€ä¹ˆé˜²æ­¢æ­»é”ï¼Ÿ\n\n\nä¸è¦å†™åµŒå¥—é”ï¼Œå®¹æ˜“æ­»é”ï¼›\n\n\nå°½é‡å°‘ç”¨åŒæ­¥ä»£ç å— (Synchronized);\n\n\nå°½é‡ä½¿ç”¨ ReentrantLock çš„ tryLock æ–¹æ³•è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œè¶…æ—¶å¯ä»¥é€€å‡ºï¼Œé˜²æ­¢æ­»é”ï¼›\n\n\nå°½é‡é™ä½é”ç²’åº¦ï¼Œå°½é‡ä¸è¦å‡ ä¸ªåŠŸèƒ½ä¸€æŠŠé”ï¼›\n\n\nå°½é‡ä½¿ç”¨ JUC åŒ…ï¼›\n\n\nâ—ConcurrentHashMap å®ç°çº¿ç¨‹å®‰å…¨çš„åº•å±‚åŸç†\nJDK1.8 ä»¥å‰ï¼Œå¤šä¸ªæ•°ç»„ï¼Œåˆ†æ®µåŠ é”ï¼Œä¸€ä¸ªæ•°ç»„ä¸€ä¸ªé”ã€‚ä»–å°†ä¸€ä¸ªå¤§çš„ ConcurrentHashMap åˆ†æˆ 16 ä¸ªå°çš„ Segmentã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åŒæ—¶æ‰¿å— 16 ä¸ªçº¿ç¨‹çš„å¹¶å‘ã€‚\nJDK1.8 ä»¥åï¼Œæ•°ç»„é‡Œæ¯ä¸ªå…ƒç´ è¿›è¡Œ put æ“ä½œï¼Œéƒ½æ˜¯æœ‰ä¸€ä¸ªä¸åŒçš„é”ï¼Œå¯¹å½“ä¸ªä½ç½®è¿›è¡Œ put æ“ä½œæ—¶ï¼Œé‡‡å–çš„æ˜¯ CAS çš„ç­–ç•¥ã€‚å¦‚æœ CAS æ“ä½œå¤±è´¥ï¼Œå°±ä½¿ç”¨ synchronized å¯¹è¿™ä¸ªä½ç½®çš„å¯¹è±¡è¿›è¡Œé”å®šï¼Œç„¶ååŸºäºé“¾è¡¨æˆ–çº¢é»‘æ ‘ï¼Œå¯¹æ•°ç»„å…ƒç´ è¿›è¡Œå†™å…¥ã€‚\nå¤šçº¿ç¨‹\nâ—åˆ›å»ºçº¿ç¨‹çš„ 4 ç§æ–¹æ³•\n\n\nç»§æ‰¿ Thread ç±»ã€‚é€šè¿‡ç»§æ‰¿ Thread ç±»ï¼Œå¹¶é‡å†™å®ƒçš„ run æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚\n\n\n\n\né¦–å…ˆå®šä¹‰ä¸€ä¸ªç±»æ¥ç»§æ‰¿ Thread ç±»ï¼Œé‡å†™ run æ–¹æ³•ã€‚\n\n\nç„¶ååˆ›å»ºè¿™ä¸ªå­ç±»å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ start æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚\n\n\npublic class MyThread extends Thread &#123;      private int count = 5;        /**       * é‡å†™çˆ¶ç±»ä¸­çš„run()ï¼Œ æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘       */      @Override      public void run() &#123;          count--;          System.out.println(count);      &#125;        public static void main(String[] args) &#123;          //1. åˆ›å»ºçº¿ç¨‹å¯¹è±¡çš„å®ä¾‹ï¼Œ è¯¥å¯¹è±¡å¿…é¡»ç»§æ‰¿Threadç±»åŠé‡å†™äº†run()          MyThread my = new MyThread();            //2. åˆ›å»ºå¤šä¸ªçº¿ç¨‹çš„å®ä¾‹ï¼Œ è¿›å…¥çº¿ç¨‹çš„åˆå§‹åŒ–çŠ¶æ€          Thread t1 = new Thread(my);          Thread t2 = new Thread(my);          Thread t3 = new Thread(my);          /*3. å¯åŠ¨çº¿ç¨‹ï¼Œ çº¿ç¨‹åªæœ‰æ‰§è¡Œstart()ä¹‹åæ‰ç®—æ˜¯çœŸæ­£çš„å¯åŠ¨, æ‰ä¼šæ‰§è¡Œrun()æ–¹æ³•é‡Œé¢çš„å…·ä½“é€»è¾‘           çº¿ç¨‹å¯åŠ¨åä¼šè¿›å…¥çº¿ç¨‹çš„å°±ç»ªçŠ¶æ€ï¼Œç­‰å¾…CPUçš„è°ƒç”¨*/          t1.start();          t2.start();          t3.start();      &#125;  &#125;\n\n\nå®ç° Runnable æ¥å£ã€‚é€šè¿‡å®ç° Runnable ï¼Œå¹¶å®ç° run æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚\n\n\n\n\né¦–å…ˆå®šä¹‰ä¸€ä¸ªç±»å®ç° Runnable æ¥å£ï¼Œå¹¶å®ç° run æ–¹æ³•ã€‚\n\n\nç„¶ååˆ›å»º Runnable å®ç°ç±»å¯¹è±¡ï¼Œå¹¶æŠŠå®ƒä½œä¸º target ä¼ å…¥ Thread çš„æ„é€ å‡½æ•°ä¸­\n\n\næœ€åè°ƒç”¨ start æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚\n\n\npublic class RunnableThread implements Runnable &#123;      @Override      public void run() &#123;          System.out.println(&quot;thread run ......&quot;);      &#125;        public static void main(String[] args) &#123;          new Thread(new RunnableThread()).run();      &#125;  &#125;\n\n\nå®ç° Callable æ¥å£ï¼Œå¹¶ç»“åˆ Future å®ç°\n\n\n\n\né¦–å…ˆå®šä¹‰ä¸€ä¸ª Callable çš„å®ç°ç±»ï¼Œå¹¶å®ç° call æ–¹æ³•ã€‚call æ–¹æ³•æ˜¯å¸¦è¿”å›å€¼çš„ã€‚\n\n\nç„¶åé€šè¿‡ FutureTask çš„æ„é€ æ–¹æ³•ï¼ŒæŠŠè¿™ä¸ª Callable å®ç°ç±»ä¼ è¿›å»ã€‚\n\n\næŠŠ FutureTask ä½œä¸º Thread ç±»çš„ target ï¼Œåˆ›å»º Thread çº¿ç¨‹å¯¹è±¡ã€‚\n\n\né€šè¿‡ FutureTask çš„ get æ–¹æ³•è·å–çº¿ç¨‹çš„æ‰§è¡Œç»“æœã€‚\n\n\npublic class TestFuture &#123;      public static void main(String[] args) throws ExecutionException, InterruptedException &#123;         FutureTask futureTask = new FutureTask&lt;&gt;(new CallableThread());          new Thread(futureTask).start();          Object o = futureTask.get();          System.out.println(o);      &#125;  &#125;    class CallableThread implements Callable &#123;      @Override      public Object call() throws Exception &#123;          System.out.println(&quot;callä¸€ä¸‹&quot;);          return 1;      &#125;  &#125;\n\n\né€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹æ­¤å¤„ç”¨ JDK è‡ªå¸¦çš„ Executors æ¥åˆ›å»ºçº¿ç¨‹æ± å¯¹è±¡ã€‚\n\n\n\n\né¦–å…ˆï¼Œå®šä¸€ä¸ª Runnable çš„å®ç°ç±»ï¼Œé‡å†™ run æ–¹æ³•ã€‚\n\n\nç„¶ååˆ›å»ºä¸€ä¸ªæ‹¥æœ‰å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ã€‚\n\n\næœ€åé€šè¿‡ ExecutorService å¯¹è±¡çš„ execute æ–¹æ³•ï¼ˆè¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ª Runnable å®ä¾‹ï¼‰ä¼ å…¥çº¿ç¨‹å¯¹è±¡ã€‚\n\n\npublic class ExecutorThread implements Runnable&#123;      @Override      public void run() &#123;          System.out.println(&quot;runä¸€ä¸‹&quot;);      &#125;        public static void main(String[] args) &#123;          ExecutorService executorService = Executors.newFixedThreadPool(10);          executorService.execute(new ExecutorThread());          executorService.shutdown();      &#125;  &#125;\nè¯´ä¸€ä¸‹ Runnable å’Œ Callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nç›¸åŒç‚¹ï¼š\n\n\néƒ½æ˜¯æ¥å£\n\n\néƒ½å¯ä»¥ç¼–å†™å¤šçº¿ç¨‹ç¨‹åº\n\n\néƒ½é‡‡ç”¨ Thread.start() å¯åŠ¨çº¿ç¨‹\n\n\nä¸»è¦åŒºåˆ«ï¼š\n\n\nRunnable æ¥å£ run æ–¹æ³•æ— è¿”å›å€¼ï¼›Callable æ¥å£ call æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œæ˜¯ä¸ªæ³›å‹ï¼Œå’Œ Futureã€FutureTask é…åˆå¯ä»¥ç”¨æ¥è·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœã€‚\n\n\nRunnable æ¥å£ run æ–¹æ³•åªèƒ½æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸”æ— æ³•æ•è·å¤„ç†ï¼›Callable æ¥å£ call æ–¹æ³•å…è®¸æŠ›å‡ºå¼‚å¸¸ï¼Œå¯ä»¥è·å–å¼‚å¸¸ä¿¡æ¯ã€‚\n\n\næ³¨ï¼šCallalbe æ¥å£æ”¯æŒè¿”å›æ‰§è¡Œç»“æœï¼Œéœ€è¦è°ƒç”¨ FutureTask.get() å¾—åˆ°ï¼Œæ­¤æ–¹æ³•ä¼šé˜»å¡ä¸»è¿›ç¨‹çš„ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œå¦‚æœä¸è°ƒç”¨ä¸ä¼šé˜»å¡ã€‚\nçº¿ç¨‹çš„ run() å’Œ start() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\næ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯é€šè¿‡æŸä¸ªç‰¹å®š Thread å¯¹è±¡æ‰€å¯¹åº”çš„æ–¹æ³• run() æ¥å®Œæˆå…¶æ“ä½œçš„ï¼Œrun() æ–¹æ³•ç§°ä¸ºçº¿ç¨‹ä½“ã€‚é€šè¿‡è°ƒç”¨ Thread ç±»çš„ start() æ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ã€‚\nstart() æ–¹æ³•ç”¨äºå¯åŠ¨çº¿ç¨‹ï¼Œrun() æ–¹æ³•ç”¨äºæ‰§è¡Œçº¿ç¨‹çš„è¿è¡Œæ—¶ä»£ç ã€‚run() å¯ä»¥é‡å¤è°ƒç”¨ï¼Œè€Œ start() åªèƒ½è°ƒç”¨ä¸€æ¬¡ã€‚\nstart() æ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼ŒçœŸæ­£å®ç°äº†å¤šçº¿ç¨‹è¿è¡Œã€‚è°ƒç”¨ start() æ–¹æ³•æ— éœ€ç­‰å¾… run æ–¹æ³•ä½“ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥ç›´æ¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»£ç ï¼› æ­¤æ—¶çº¿ç¨‹æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå¹¶æ²¡æœ‰è¿è¡Œã€‚ ç„¶åé€šè¿‡æ­¤ Thread ç±»è°ƒç”¨æ–¹æ³• run() æ¥å®Œæˆå…¶è¿è¡ŒçŠ¶æ€ï¼Œ run() æ–¹æ³•è¿è¡Œç»“æŸï¼Œ æ­¤çº¿ç¨‹ç»ˆæ­¢ã€‚ç„¶å CPU å†è°ƒåº¦å…¶å®ƒçº¿ç¨‹ã€‚\nrun() æ–¹æ³•æ˜¯åœ¨æœ¬çº¿ç¨‹é‡Œçš„ï¼Œåªæ˜¯çº¿ç¨‹é‡Œçš„ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯å¤šçº¿ç¨‹çš„ã€‚ å¦‚æœç›´æ¥è°ƒç”¨ run()ï¼Œå…¶å®å°±ç›¸å½“äºæ˜¯è°ƒç”¨äº†ä¸€ä¸ªæ™®é€šå‡½æ•°è€Œå·²ï¼Œç›´æ¥è°ƒç”¨ run() æ–¹æ³•å¿…é¡»ç­‰å¾… run() æ–¹æ³•æ‰§è¡Œå®Œæ¯•æ‰èƒ½æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œæ‰€ä»¥æ‰§è¡Œè·¯å¾„è¿˜æ˜¯åªæœ‰ä¸€æ¡ï¼Œæ ¹æœ¬å°±æ²¡æœ‰çº¿ç¨‹çš„ç‰¹å¾ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹æ‰§è¡Œæ—¶è¦ä½¿ç”¨ start() æ–¹æ³•è€Œä¸æ˜¯ run() æ–¹æ³•ã€‚\nä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒç”¨ start() æ–¹æ³•æ—¶ä¼šæ‰§è¡Œ run() æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨ run() æ–¹æ³•ï¼Ÿ\nnew ä¸€ä¸ª Threadï¼Œçº¿ç¨‹è¿›å…¥äº†æ–°å»ºçŠ¶æ€ã€‚è°ƒç”¨ start() æ–¹æ³•ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥äº†å°±ç»ªçŠ¶æ€ï¼Œå½“åˆ†é…åˆ°æ—¶é—´ç‰‡åå°±å¯ä»¥å¼€å§‹è¿è¡Œäº†ã€‚ start() ä¼šæ‰§è¡Œçº¿ç¨‹çš„ç›¸åº”å‡†å¤‡å·¥ä½œï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œ run() æ–¹æ³•çš„å†…å®¹ï¼Œè¿™æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹å·¥ä½œã€‚\nè€Œç›´æ¥æ‰§è¡Œ run() æ–¹æ³•ï¼Œä¼šæŠŠ run æ–¹æ³•å½“æˆä¸€ä¸ª main çº¿ç¨‹ä¸‹çš„æ™®é€šæ–¹æ³•å»æ‰§è¡Œï¼Œå¹¶ä¸ä¼šåœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®ƒï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯å¤šçº¿ç¨‹å·¥ä½œã€‚\næ€»ç»“ï¼š è°ƒç”¨ start æ–¹æ³•æ–¹å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œè€Œ run æ–¹æ³•åªæ˜¯ thread çš„ä¸€ä¸ªæ™®é€šæ–¹æ³•è°ƒç”¨ï¼Œè¿˜æ˜¯åœ¨ä¸»çº¿ç¨‹é‡Œæ‰§è¡Œã€‚\nstart() æ–¹æ³•ä¸ºä»€ä¹ˆèƒ½å¼€å¯å¤šçº¿ç¨‹ï¼Ÿ\nçœŸæ­£å®ç°å¼€å¯å¤šçº¿ç¨‹çš„æ˜¯ start() æ–¹æ³•ä¸­çš„ start0() æ–¹æ³•ã€‚\nè°ƒç”¨ start0() æ–¹æ³•åï¼Œè¯¥çº¿ç¨‹å¹¶ä¸ä¸€å®šä¼šç«‹é©¬æ‰§è¡Œï¼Œåªæ˜¯å°†çº¿ç¨‹å˜æˆäº†å¯è¿è¡ŒçŠ¶æ€ï¼ˆNEW â€”&gt; RUNNABLEï¼‰ï¼›å…·ä½“ä»€ä¹ˆæ—¶å€™æ‰§è¡Œï¼Œå–å†³äº CPU ï¼Œç”± CPU ç»Ÿä¸€è°ƒåº¦ï¼›æˆ‘ä»¬åˆçŸ¥é“ Java æ˜¯è·¨å¹³å°çš„ï¼Œå¯ä»¥åœ¨ä¸åŒç³»ç»Ÿä¸Šè¿è¡Œï¼Œæ¯ä¸ªç³»ç»Ÿçš„ CPU è°ƒåº¦ç®—æ³•ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å°±éœ€è¦åšä¸åŒçš„å¤„ç†ï¼Œè¿™ä»¶äº‹æƒ…å°±åªèƒ½äº¤ç»™ JVM æ¥å®ç°äº†ï¼Œstart0() æ–¹æ³•è‡ªç„¶å°±è¡¨æ ‡è®°æˆäº† nativeã€‚\nçº¿ç¨‹çš„ 6 ç§çŠ¶æ€æ˜¯ä»€ä¹ˆï¼Ÿ\n\n\næ–°å»ºçŠ¶æ€ï¼ˆnewï¼‰ï¼šåˆ›å»ºçº¿ç¨‹å¯¹è±¡ã€‚\n\n\nå°±ç»ªçŠ¶æ€ï¼ˆrunnableï¼‰ï¼šstart æ–¹æ³•ã€‚\n\n\né˜»å¡çŠ¶æ€ï¼ˆblockedï¼‰ï¼šæ— æ³•è·å¾—é”å¯¹è±¡ï¼ˆçº¿ç¨‹æ²¡æŠ¢åˆ°ï¼‰ã€‚\n\n\nç­‰å¾…çŠ¶æ€ï¼ˆwaitingï¼‰ï¼šwait æ–¹æ³•ã€‚\n\n\nè®¡æ—¶çŠ¶æ€ï¼ˆtimed_waitingï¼‰ï¼šsleep æ–¹æ³•ã€‚\n\n\næ­»äº¡çŠ¶æ€ï¼ˆterminatedï¼‰ï¼šå…¨éƒ¨ä»£ç è¿è¡Œå®Œæ¯•ã€‚\n\n\nçº¿ç¨‹çš„è°ƒåº¦æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ\nåˆ†æ—¶è°ƒåº¦ï¼šè½®æµè·å– CPU ä½¿ç”¨æƒã€‚\næŠ¢å å¼è°ƒåº¦ï¼šä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹å ç”¨ CPUã€‚\nè¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•\n\n\nwait()ï¼šä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…ï¼ˆé˜»å¡ï¼‰çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›\n\n\nsleep()ï¼šä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•è¦å¤„ç† InterruptedException å¼‚å¸¸ï¼›\n\n\nnotify()ï¼šå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œå½“ç„¶åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”± JVM ç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸ä¼˜å…ˆçº§æ— å…³ï¼›\n\n\nnotityAll()ï¼šå”¤é†’æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè¯¥æ–¹æ³•å¹¶ä¸æ˜¯å°†å¯¹è±¡çš„é”ç»™æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ï¼Œåªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ï¼›\n\n\nsleep() å’Œ wait() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nç›¸åŒç‚¹ï¼šä¸¤è€…éƒ½å¯ä»¥æš‚åœçº¿ç¨‹çš„æ‰§è¡Œã€‚\nä¸åŒç‚¹ï¼š\n\n\nsleep æ–¹æ³•ï¼Œä¸ä¼šé‡Šæ”¾èµ„æºï¼ˆæœ¬è´¨æ˜¯å ç”¨çº¿ç¨‹ï¼‰ï¼Œå¦‚æœå å…·é”èµ„æºï¼Œåˆ™å…¶ä»–çº¿ç¨‹ä¸å¯è¿›ï¼›wait æ–¹æ³•ä¼šé‡Šæ”¾é”èµ„æºï¼Œå³å…¶ä»–çº¿ç¨‹å¯è¿›æ¥ã€‚\n\n\nwait() æ–¹æ³•è¢«è°ƒç”¨åï¼Œçº¿ç¨‹ä¸ä¼šè‡ªåŠ¨è‹é†’ï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šçš„ notify() æˆ–è€… notifyAll() æ–¹æ³•ã€‚sleep() æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚æˆ–è€…å¯ä»¥ä½¿ç”¨ wait(long timeout) è¶…æ—¶åçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚\n\n\nJava ä¸­ä½ æ€æ ·å”¤é†’ä¸€ä¸ªé˜»å¡çš„çº¿ç¨‹ï¼Ÿ\né¦–å…ˆ ï¼Œwait()ã€notify() æ–¹æ³•æ˜¯é’ˆå¯¹å¯¹è±¡çš„ï¼Œè°ƒç”¨ä»»æ„å¯¹è±¡çš„ wait() æ–¹æ³•éƒ½å°†å¯¼è‡´çº¿ç¨‹é˜»å¡ï¼Œé˜»å¡çš„åŒæ—¶ä¹Ÿå°†é‡Šæ”¾è¯¥å¯¹è±¡çš„é”ï¼Œç›¸åº”åœ°ï¼Œè°ƒç”¨ä»»æ„å¯¹è±¡çš„ notify() æ–¹æ³•åˆ™å°†éšæœºè§£é™¤è¯¥å¯¹è±¡é˜»å¡çš„çº¿ç¨‹ï¼Œä½†å®ƒéœ€è¦é‡æ–°è·å–è¯¥å¯¹è±¡çš„é”ï¼Œç›´åˆ°è·å–æˆåŠŸæ‰èƒ½å¾€ä¸‹æ‰§è¡Œï¼›\nå…¶æ¬¡ï¼Œwaitã€notify æ–¹æ³•å¿…é¡»åœ¨ synchronized å—æˆ–æ–¹æ³•ä¸­è¢«è°ƒç”¨ï¼Œå¹¶ä¸”è¦ä¿è¯åŒæ­¥å—æˆ–æ–¹æ³•çš„é”å¯¹è±¡ä¸è°ƒç”¨ waitã€notify æ–¹æ³•çš„å¯¹è±¡æ˜¯åŒä¸€ä¸ªï¼Œå¦‚æ­¤ä¸€æ¥åœ¨è°ƒç”¨ wait ä¹‹å‰å½“å‰çº¿ç¨‹å°±å·²ç»æˆåŠŸè·å–æŸå¯¹è±¡çš„é”ï¼Œæ‰§è¡Œ wait é˜»å¡åå½“å‰çº¿ç¨‹å°±å°†ä¹‹å‰è·å–çš„å¯¹è±¡é”é‡Šæ”¾ã€‚\nnotify() å’Œ notifyAll() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nå¦‚æœçº¿ç¨‹è°ƒç”¨äº†å¯¹è±¡çš„ wait() æ–¹æ³•ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¾¿ä¼šå¤„äºè¯¥å¯¹è±¡çš„ç­‰å¾…æ± ä¸­ï¼Œç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ä¸ä¼šå»ç«äº‰è¯¥å¯¹è±¡çš„é”ã€‚\nnotifyAll() ä¼šå”¤é†’æ‰€æœ‰çš„çº¿ç¨‹ï¼Œnotify() åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚\nnotifyAll() è°ƒç”¨åï¼Œä¼šå°†å…¨éƒ¨çº¿ç¨‹ç”±ç­‰å¾…æ± ç§»åˆ°é”æ± ï¼Œç„¶åå‚ä¸é”çš„ç«äº‰ï¼Œç«äº‰æˆåŠŸåˆ™ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœä¸æˆåŠŸåˆ™ç•™åœ¨é”æ± ç­‰å¾…é”è¢«é‡Šæ”¾åå†æ¬¡å‚ä¸ç«äº‰ã€‚è€Œ notify() åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œå…·ä½“å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹ç”±è™šæ‹Ÿæœºæ§åˆ¶ã€‚\nä¸ºä»€ä¹ˆ wait(), notify() å’Œ notifyAll() å¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨ï¼Ÿ\nè¿™æ˜¯Â JDK å¼ºåˆ¶çš„ï¼Œwait() æ–¹æ³•å’Œ notify()/notifyAll() æ–¹æ³•åœ¨è°ƒç”¨å‰éƒ½å¿…é¡»å…ˆè·å¾—å¯¹è±¡çš„é”ï¼Œä¹Ÿå°±æ˜¯ synchronized å¯¹è±¡é”ã€‚\nJava çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆå¼‚å¸¸ï¼Ÿ\n\n\nçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå¼€é”€éå¸¸é«˜\n\n\næ¶ˆè€—è¿‡å¤šçš„ CPU èµ„æºå¦‚æœå¯è¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤šäºå¯ç”¨å¤„ç†å™¨çš„æ•°é‡ï¼Œé‚£ä¹ˆæœ‰çº¿ç¨‹å°†ä¼šè¢«é—²ç½®ã€‚å¤§é‡ç©ºé—²çš„çº¿ç¨‹ä¼šå ç”¨è®¸å¤šå†…å­˜ï¼Œç»™åƒåœ¾å›æ”¶å™¨å¸¦æ¥å‹åŠ›ï¼Œè€Œä¸”å¤§é‡çš„çº¿ç¨‹åœ¨ç«äº‰ CPU èµ„æºæ—¶è¿˜å°†äº§ç”Ÿå…¶ä»–æ€§èƒ½çš„å¼€é”€ã€‚\n\n\né™ä½ç¨³å®šæ€§ã€‚JVM åœ¨å¯åˆ›å»ºçº¿ç¨‹çš„æ•°é‡ä¸Šå­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶å€¼å°†éšç€å¹³å°çš„ä¸åŒè€Œä¸åŒï¼Œå¹¶ä¸”æ‰¿å—ç€å¤šä¸ªå› ç´ åˆ¶çº¦ï¼ŒåŒ…æ‹¬ JVM çš„å¯åŠ¨å‚æ•°ã€Thread æ„é€ å‡½æ•°ä¸­è¯·æ±‚æ ˆçš„å¤§å°ï¼Œä»¥åŠåº•å±‚æ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹çš„é™åˆ¶ç­‰ã€‚å¦‚æœç ´åäº†è¿™äº›é™åˆ¶ï¼Œé‚£ä¹ˆå¯èƒ½æŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚\n\n\nThreadLocal\nThreadlocal æ˜¯ä¸€ä¸ªçº¿ç¨‹å†…éƒ¨çš„å­˜å‚¨ç±»ï¼Œæä¾›äº†çº¿ç¨‹å†…å­˜å‚¨å˜é‡çš„èƒ½åŠ›,å¯ä»¥åœ¨æŒ‡å®šçº¿ç¨‹å†…å­˜å‚¨æ•°æ®ï¼Œæ•°æ®å­˜å‚¨ä»¥åï¼Œåªæœ‰æŒ‡å®šçº¿ç¨‹å¯ä»¥å¾—åˆ°å­˜å‚¨æ•°æ®ã€‚è¿™äº›å˜é‡ä¸åŒä¹‹å¤„åœ¨äºæ¯ä¸€ä¸ªçº¿ç¨‹è¯»å–çš„å˜é‡æ˜¯å¯¹åº”çš„äº’ç›¸ç‹¬ç«‹çš„ã€‚\nå…¶å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª ThreadLocalMapï¼Œè¯¥ Map ç”¨äºå­˜å‚¨æ¯ä¸€ä¸ªçº¿ç¨‹çš„å˜é‡å‰¯æœ¬ã€‚å¹¶ä¸” key ä¸ºçº¿ç¨‹å¯¹è±¡ï¼Œvalue ä¸ºå¯¹åº”çº¿ç¨‹çš„å˜é‡å‰¯æœ¬ã€‚\nä¸ºä»€ä¹ˆ ThreadLocal ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ï¼Ÿ\nå› ä¸º ThreadLocal ä¸­çš„ key æ˜¯å¼±å¼•ç”¨ï¼Œè€Œ value æ˜¯å¼ºå¼•ç”¨ã€‚å½“ ThreadLocal æ²¡æœ‰è¢«å¼ºå¼•ç”¨æ—¶ï¼Œåœ¨è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œkey ä¼šè¢«æ¸…ç†æ‰ï¼Œè€Œ value ä¸ä¼šè¢«æ¸…ç†æ‰ï¼Œè¿™æ—¶å¦‚æœä¸åšä»»ä½•å¤„ç†ï¼Œvalue å°†æ°¸è¿œä¸ä¼šè¢«å›æ”¶ï¼Œäº§ç”Ÿå†…å­˜æ³„æ¼ã€‚\nå¦‚ä½•è§£å†³ ThreadLocal çš„å†…å­˜æ³„æ¼ï¼Ÿ\nå…¶å®åœ¨ ThreadLocal åœ¨è®¾è®¡çš„æ—¶å€™å·²ç»è€ƒè™‘åˆ°äº†è¿™ç§æƒ…å†µï¼Œåœ¨è°ƒç”¨ set()ã€get()Â ã€remove() ç­‰æ–¹æ³•æ—¶å°±ä¼šæ¸…ç†æ‰ key ä¸º nullÂ çš„è®°å½•ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨å®Œ ThreadLocal åæœ€å¥½æ‰‹åŠ¨è°ƒç”¨ remove() æ–¹æ³•ã€‚\nä¸ºä»€ä¹ˆè¦å°† key è®¾è®¡æˆ ThreadLocal çš„å¼±å¼•ç”¨ï¼Ÿ\nå¦‚æœ ThreadLocal çš„ key æ˜¯å¼ºå¼•ç”¨ï¼Œæ˜¯ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼çš„ã€‚å¦‚æœ ThreadLocal çš„ key æ˜¯å¼ºå¼•ç”¨ï¼Œå¼•ç”¨çš„ ThreadLocal çš„å¯¹è±¡è¢«å›æ”¶äº†ï¼Œä½†æ˜¯ ThreadLocalMap è¿˜æŒæœ‰ ThreadLocal çš„å¼ºå¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨åˆ é™¤ï¼ŒThreadLocal ä¸ä¼šè¢«å›æ”¶ï¼Œå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚\nå¦‚æœæ˜¯å¼±å¼•ç”¨çš„è¯ï¼Œå¼•ç”¨çš„ ThreadLocal çš„å¯¹è±¡è¢«å›æ”¶äº†ï¼Œå³ä½¿æ²¡æœ‰æ‰‹åŠ¨åˆ é™¤ï¼ŒThreadLocal ä¹Ÿä¼šè¢«å›æ”¶ã€‚value ä¹Ÿä¼šåœ¨ ThreadLocalMap è°ƒç”¨ set() ã€get()ã€remove() çš„æ—¶å€™ä¼šè¢«æ¸…é™¤ã€‚\nçº¿ç¨‹æ± \nExecutors ç±»æœ‰å“ªå‡ ç§å¸¸è§çš„çº¿ç¨‹æ± ï¼Ÿ\n4 ç§ï¼šå•ä¾‹çº¿ç¨‹æ± ã€å›ºå®šå¤§å°çº¿ç¨‹æ± ã€å¯ç¼“å­˜çº¿ç¨‹æ± ã€å¤§å°æ— é™çº¿ç¨‹æ± ã€‚\nï¼ˆ1ï¼‰newSingleThreadExecutorï¼šåˆ›å»ºä¸€ä¸ªå•ä¾‹çº¿ç¨‹æ± ã€‚è¿™ä¸ªçº¿ç¨‹æ± åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å·¥ä½œï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºå•çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ã€‚å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹å› ä¸ºå¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ›¿ä»£å®ƒã€‚æ­¤çº¿ç¨‹æ± ä¿è¯æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºæŒ‰ç…§ä»»åŠ¡çš„æäº¤é¡ºåºæ‰§è¡Œã€‚åªæœ‰ 1 ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼Œæ— éæ ¸å¿ƒçº¿ç¨‹ï¼Œæ‰§è¡Œå®Œç«‹å³å›æ”¶ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¸ºé“¾è¡¨ç»“æ„çš„æœ‰ç•Œé˜Ÿåˆ—ã€‚\nï¼ˆ2ï¼‰newFixedThreadPoolï¼šåˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ã€‚æ¯æ¬¡æäº¤ä¸€ä¸ªä»»åŠ¡å°±åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç›´åˆ°çº¿ç¨‹è¾¾åˆ°çº¿ç¨‹æ± çš„æœ€å¤§å¤§å°ã€‚çº¿ç¨‹æ± çš„å¤§å°ä¸€æ—¦è¾¾åˆ°æœ€å¤§å€¼å°±ä¼šä¿æŒä¸å˜ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹å› ä¸ºæ‰§è¡Œå¼‚å¸¸è€Œç»“æŸï¼Œé‚£ä¹ˆçº¿ç¨‹æ± ä¼šè¡¥å……ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚å¦‚æœå¸Œæœ›åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨çº¿ç¨‹æ± ï¼Œå»ºè®®ä½¿ç”¨ newFixedThreadPool æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œè¿™æ ·èƒ½è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚åªæœ‰æ ¸å¿ƒçº¿ç¨‹ï¼Œçº¿ç¨‹æ•°é‡å›ºå®šï¼Œæ‰§è¡Œå®Œç«‹å³å›æ”¶ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¸ºé“¾è¡¨ç»“æ„çš„æœ‰ç•Œé˜Ÿåˆ—ã€‚\nï¼ˆ3ï¼‰ newCachedThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± ã€‚å¦‚æœçº¿ç¨‹æ± çš„å¤§å°è¶…è¿‡äº†å¤„ç†ä»»åŠ¡æ‰€éœ€è¦çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆå°±ä¼šå›æ”¶éƒ¨åˆ†ç©ºé—²ï¼ˆ60 ç§’ä¸æ‰§è¡Œä»»åŠ¡ï¼‰çš„çº¿ç¨‹ï¼Œå½“ä»»åŠ¡æ•°å¢åŠ æ—¶ï¼Œæ­¤çº¿ç¨‹æ± åˆå¯ä»¥æ™ºèƒ½çš„æ·»åŠ æ–°çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚æ­¤çº¿ç¨‹æ± ä¸ä¼šå¯¹çº¿ç¨‹æ± å¤§å°åšé™åˆ¶ï¼Œçº¿ç¨‹æ± å¤§å°å®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿï¼ˆæˆ–è€…è¯´ JVMï¼‰èƒ½å¤Ÿåˆ›å»ºçš„æœ€å¤§çº¿ç¨‹å¤§å°ã€‚æ— æ ¸å¿ƒçº¿ç¨‹ï¼Œéæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ— é™ï¼Œæ‰§è¡Œå®Œé—²ç½® 60s åå›æ”¶ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¸ºä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚\nï¼ˆ4ï¼‰newScheduledThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå¤§å°æ— é™çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚æ ¸å¿ƒçº¿ç¨‹æ•°é‡å›ºå®šï¼Œéæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ— é™ï¼Œæ‰§è¡Œå®Œé—²ç½® 10ms åå›æ”¶ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¸ºå»¶æ—¶é˜»å¡é˜Ÿåˆ—ã€‚\nâ—è¯´è¯´çº¿ç¨‹æ± çš„åº•å±‚å·¥ä½œåŸç†\né¿å…é¢‘ç¹çš„åˆ›å»ºçº¿ç¨‹ï¼Œé”€æ¯çº¿ç¨‹â€¦â€¦\nExecutorService threadPool = Executors.newFixedThreadPool(10) // corePoolSize\nå¦‚æœçº¿ç¨‹æ± å†…æ•°é‡å°äº corePoolSizeï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚çº¿ç¨‹æ± ä¸€èˆ¬ä¼šå¸¦ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå½“çº¿ç¨‹æ‰§è¡Œä»»åŠ¡å®Œæˆï¼Œä¼šç­‰å¾…é˜»å¡åœ¨é˜Ÿåˆ—ä¸Šï¼ˆé˜Ÿé¦–ï¼‰ï¼Œå°è¯•ä»é˜Ÿåˆ—ç»§ç»­è·å–ä»»åŠ¡ã€‚å¦‚æœä»»åŠ¡å¤šäº corePoolSizeï¼Œä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ã€‚å¦‚æœé˜»å¡é˜Ÿåˆ—æ»¡äº†ï¼Œå¯ä»¥æ ¹æ® maximumPoolSize åˆ›å»ºé¢å¤–çš„çº¿ç¨‹ã€‚é¢å¤–çº¿ç¨‹çš„ç©ºé—²æ—¶é—´æ ¹æ® keepAliveTime è¿›è¡Œè‡ªè¡Œé”€æ¯ã€‚\nå¦‚æœé¢å¤–çš„çº¿ç¨‹éƒ½åˆ›å»ºå®Œäº†ï¼Œé˜Ÿåˆ—è¿˜æ˜¯æ»¡çš„ï¼Œè¿˜æœ‰æ–°æ¥çš„ä»»åŠ¡ã€‚ä¼š reject æ‰ï¼Œæœ‰å‡ ç§ reject ç­–ç•¥ï¼Œå¯ä»¥ä¼ å…¥ RejectedExecutionHandlerã€‚\n\n\nAbortPolicyï¼šæŠ›å¼‚å¸¸\n\n\nDiscardPolicyï¼šæ‰”æ‰\n\n\nDiscardOldestPolicyï¼šåˆ é™¤æœ€æ—§çš„ä»»åŠ¡\n\n\nCallerRunsPolicyï¼šè¿”å›è°ƒç”¨è€…çº¿ç¨‹æ‰§è¡Œä»»åŠ¡\n\n\nè‡ªå®šä¹‰\n\n\nï¼ˆå¸¸ç”¨ï¼‰FixedThreadPool çš„é˜Ÿåˆ—æ˜¯ LinkedBlockingQueueï¼Œæ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œå³é˜Ÿåˆ—é•¿åº¦æ— çº¿å¤§ã€‚corePoolSize ä¸ maximumPoolSize ä¸€æ ·å¤§ã€‚\nâ—çº¿ç¨‹æ± çš„æ ¸å¿ƒé…ç½®å‚æ•°\nä»£è¡¨çº¿ç¨‹æ± çš„ç±»æ˜¯ ThreadPoolExecutorã€‚corePoolSizeï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°ï¼‰ï¼ŒmaximumPoolSizeï¼ˆçº¿ç¨‹æ± ï¼‰ï¼ŒkeepAliveTimeï¼ˆå¤šä½™çš„ç©ºé—²çº¿ç¨‹åœ¨ç»ˆæ­¢ä¹‹å‰ç­‰å¾…æ–°ä»»åŠ¡çš„æœ€é•¿æ—¶é—´ï¼‰ï¼ŒworkQueueï¼ˆé˜»å¡é˜Ÿåˆ—ï¼‰ã€‚\nä¸ƒä¸ªæ ¸å¿ƒå‚æ•°ï¼š\n\n\nå‚æ•°ä¸€ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼ˆä¸èƒ½å°äº 0ï¼‰\n\n\nå‚æ•°äºŒï¼šæœ€å¤§çº¿ç¨‹æ•°ï¼ˆ&gt;=æ ¸å¿ƒçº¿ç¨‹æ•°ï¼‰\n\n\nå‚æ•°ä¸‰ï¼šä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆä¸èƒ½å°äº 0ï¼‰\n\n\nå‚æ•°å››ï¼šæ—¶é—´å•ä½ï¼ˆå‚æ•°ä¸‰çš„å•ä½ï¼‰\n\n\nå‚æ•°äº”ï¼šç­‰å¾…åˆ—é˜Ÿï¼ˆä¸èƒ½ä¸º nullï¼‰\n\n\nå‚æ•°å…­ï¼šåˆ›å»ºçº¿ç¨‹å·¥å‚ï¼ˆä¸èƒ½ä¸º nullï¼Œä¸€èˆ¬ç”¨é»˜è®¤çº¿ç¨‹å·¥å‚ï¼‰\n\n\nå‚æ•°ä¸ƒï¼šä»»åŠ¡çš„æ‹’ç»ç­–ç•¥ï¼ˆä¸èƒ½ä¸º nullï¼‰\n\n\næ‹’ç»ç­–ç•¥æœ‰å“ªäº›\n\n\nThreadPoolExecutor.AbortPolicyï¼šä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡ºå¼‚å¸¸ï¼ˆé»˜è®¤ï¼‰ï¼›\n\n\nThreadPoolExecutor.DiscardPolicyï¼šä¸¢å¼ƒä»»åŠ¡ï¼Œä¸æŠ›å¼‚å¸¸ï¼ˆä¸æ¨èï¼‰ï¼›\n\n\nThreadPoolExecutor.DiscardOldestPolicyï¼šä¸¢å¼ƒç­‰å¾…æœ€ä¹…çš„ä»»åŠ¡ï¼›\n\n\nThreadPoolExecutor.CallerRunsPolicyï¼šè°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹ï¼ˆmainï¼‰è¿è¡Œ run æ–¹æ³•ã€‚\n\n\nâ—å¦‚æœåœ¨çº¿ç¨‹æ± ä¸­ä½¿ç”¨æ— ç•Œé˜»å¡é˜Ÿåˆ—ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\né¢è¯•é¢˜ï¼šåœ¨è¿œç¨‹æœåŠ¡å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œæ˜¯å¦ä¼šå¯¼è‡´å†…å­˜å¼‚å¸¸é£™å‡ï¼Ÿ\nè°ƒç”¨è¶…æ—¶ï¼Œé˜Ÿåˆ—å˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œä¼šå¯¼è‡´å†…å­˜é£™å‡ï¼Œå¯èƒ½è¿˜ä¼šå¯¼è‡´ OOM\n\nâ—çº¿ç¨‹æ± é˜Ÿåˆ—æ»¡äº†ä¹‹åï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…\næ— ç•Œé˜Ÿåˆ—ï¼Œå†…å­˜æº¢å‡ºã€‚\næœ‰ç•Œé˜Ÿåˆ—ï¼Œä½†æ˜¯å¦‚æœ maximumPoolSize æ•°é‡å¾ˆå¤§ï¼Œå¯ä»¥æ— é™åˆ¶åˆ›å»ºçº¿ç¨‹ï¼Œä½†æ˜¯æ¯ä¸ªçº¿ç¨‹å ç”¨æ ˆå†…å­˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´å†…å­˜èµ„æºè€—å°½ï¼Œæˆ–è€…çº¿ç¨‹å¤ªå¤šï¼ŒCPU è´Ÿè½½å¤ªé«˜ã€‚\næœ‰ç•Œé˜Ÿåˆ—ï¼ŒmaximumPoolSize æ•°é‡å›ºå®šï¼Œå¤šä½™çš„ä»»åŠ¡ä¼šè¢«æ‹’ç»ã€‚\nå»ºè®®ï¼šè‡ªå®šä¹‰ä¸€ä¸ª reject ç­–ç•¥ï¼Œå¦‚æœçº¿ç¨‹æ± æ— æ³•æ‰§è¡Œæ›´å¤šä»»åŠ¡ï¼Œå¯ä»¥æŠŠä»»åŠ¡ä¿¡æ¯æŒä¹…åŒ–å†™å…¥ç£ç›˜ã€‚ç­‰è´Ÿè½½é™ä½é‡æ–°æ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚\nâ—å¦‚æœçº¿ä¸Šæœºå™¨çªç„¶å®•æœºï¼Œçº¿ç¨‹æ± çš„é˜»å¡é˜Ÿåˆ—ä¸­çš„è¯·æ±‚æ€ä¹ˆåŠï¼Ÿ\nçº¿ç¨‹æ± å†…ç§¯å‹çš„ä»»åŠ¡ä¸¢å¤±ã€‚\nè§£å†³ï¼šåœ¨æäº¤ä»»åŠ¡å‰ï¼Œåœ¨æ•°æ®åº“å†…æ’å…¥ä»»åŠ¡ä¿¡æ¯ï¼Œå¹¶æ›´æ–°ä»–çš„çŠ¶æ€ï¼šå·²æäº¤ã€æœªæäº¤ã€å·²å®Œæˆâ€¦â€¦ã€‚ç³»ç»Ÿé‡å¯åæŠŠä»»åŠ¡çŠ¶æ€é‡æ–°æäº¤ã€‚\nâ—å¦‚ä½•åˆç†è®¾ç½®çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Ÿ\n\n\nCPU å¯†é›†å‹ä»»åŠ¡ï¼šå¦‚æœåº”ç”¨ç¨‹åºæ‰§è¡Œçš„æ˜¯ CPU å¯†é›†å‹ä»»åŠ¡ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°åº”è¯¥è®¾ç½®ä¸ºç­‰äº CPU æ ¸å¿ƒæ•°ã€‚è¿™å¯ä»¥å……åˆ†åˆ©ç”¨ CPU èµ„æºã€‚\n\næ ¸å¿ƒçº¿ç¨‹æ•°=CPU æ ¸å¿ƒæ•°\næ ¸å¿ƒçº¿ç¨‹æ•°=CPU æ ¸å¿ƒæ•° +1\n\n\n\nIO å¯†é›†å‹ä»»åŠ¡ï¼šå¦‚æœåº”ç”¨ç¨‹åºæ‰§è¡Œçš„æ˜¯ IO å¯†é›†å‹ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å¯ä»¥è®¾ç½®ä¸ºå¤§äº CPU æ ¸å¿ƒæ•°ï¼Œä»¥å……åˆ†åˆ©ç”¨ç­‰å¾… IO æ“ä½œæ—¶çš„çº¿ç¨‹ç©ºé—²æ—¶é—´ã€‚\n\næ ¸å¿ƒçº¿ç¨‹æ•°=2 * CPU æ ¸å¿ƒæ•°\næ ¸å¿ƒçº¿ç¨‹æ•°=CPU æ ¸å¿ƒæ•° / (1- é˜»å¡ç³»æ•°)\n\n\n\næ··åˆå‹ä»»åŠ¡ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°=(çº¿ç¨‹ç­‰å¾…æ—¶é—´/çº¿ç¨‹ CPU æ—¶é—´ +1) * CPU æ ¸å¿ƒæ•°\n\n\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡","å¤šçº¿ç¨‹","çº¿ç¨‹æ± "]},{"title":"é¢è¯• Redis","url":"/posts/25de1bd9/","content":"\n\nå‰è¨€\nâ—è¡¨ç¤ºå¿…æŒæ¡ï¼Œâ”è¡¨ç¤ºåŸºæœ¬ä¸ä¼šé—®\n\n\næ›´æ–°\n\n\n24-06-24 åˆå§‹è®°å½•\n\nä»€ä¹ˆæ˜¯ Redis\nRedis(Remote Dictionary Server) æ˜¯ä¸€ä¸ªä½¿ç”¨ C è¯­è¨€ç¼–å†™çš„ï¼Œå¼€æºçš„ï¼ˆBSD è®¸å¯ï¼‰é«˜æ€§èƒ½éå…³ç³»å‹ï¼ˆNoSQLï¼‰çš„é”®å€¼å¯¹æ•°æ®åº“ã€‚\nRedis å¯ä»¥å­˜å‚¨é”®å’Œäº”ç§ä¸åŒç±»å‹çš„å€¼ä¹‹é—´çš„æ˜ å°„ã€‚é”®çš„ç±»å‹åªèƒ½ä¸ºå­—ç¬¦ä¸²ï¼Œå€¼æ”¯æŒäº”ç§æ•°æ®ç±»å‹ï¼šå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€é›†åˆã€æ•£åˆ—è¡¨ã€æœ‰åºé›†åˆã€‚\nä»€ä¹ˆæ˜¯ NoSQLï¼Ÿ\nNoSQL çš„å…¨ç§°æ˜¯ Not-Only SQLï¼ŒæŒ‡çš„æ˜¯éå…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒæ˜¯å…³ç³»å‹æ•°æ®åº“çš„è¡¥å……ï¼Œæ²¡æœ‰è¡¨ä¸è¡¨ä¹‹é—´çš„å…³ç³»ï¼Œä¸»è¦ç”¨äºæµ·é‡æ•°æ®çš„å¤„ç†é—®é¢˜ã€‚\né™¤äº† Redisï¼Œä½ è¿˜äº†è§£å…¶å®ƒçš„ NoSQL å—?\nnosql æ•°æ®åº“æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ HBaseã€MongoDBã€Memcached ç­‰ï¼ŒRedis ç›¸æ¯”äºå…¶ä»–çš„ nosql è€Œè¨€ï¼Œæ•ˆç‡é«˜ï¼Œæ•°æ®ç»“æ„æ¯”è¾ƒä¸°å¯Œã€‚\n\n\nMongoDB\n\né«˜æ€§èƒ½ã€æ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“ (ä¸€ä¸ªæ–‡æ¡£ç›¸å½“äºå…³ç³»æ•°æ®åº“ä¸­çš„ä¸€æ¡è®°å½•ï¼Œæ ¼å¼æ˜¯ xml æˆ–è€… json ç­‰)ï¼Œæ”¯æŒäºŒçº§ç´¢å¼•ï¼Œéå¸¸é€‚åˆæ–‡æ¡£åŒ–æ ¼å¼çš„å­˜å‚¨åŠæŸ¥è¯¢ã€‚MongoDB çš„å®˜æ–¹å®šä½æ˜¯é€šç”¨æ•°æ®åº“ï¼Œç¡®å®å’Œ MySQL æœ‰äº›åƒï¼Œç°åœ¨ä¹Ÿå¾ˆæµè¡Œï¼Œä½†å®ƒè¿˜æ˜¯æœ‰äº‹åŠ¡ã€join ç­‰çŸ­æ¿ï¼Œåœ¨äº‹åŠ¡ã€å¤æ‚æŸ¥è¯¢åº”ç”¨ä¸‹æ— æ³•å–ä»£å…³ç³»å‹æ•°æ®åº“ã€‚ä½† MongoDB æ›´æ³¨é‡åºå¤§æ•°æ®çš„å­˜å‚¨å’Œæ“ä½œï¼Œä½†ä¸é€‚åˆç”¨äºä¸´æ—¶å­˜å‚¨çš„ç¼“å­˜ï¼Œå¦‚æœå°†æ•°æ®åšç¼“å­˜ä½¿ç”¨ï¼Œè¿˜æ˜¯ Redis æ€§èƒ½æ›´é«˜ã€‚\n\n\n\nRedis\n\nå†…å­˜å‹ Key/Value ç³»ç»Ÿï¼Œè¯»å†™æ€§èƒ½éå¸¸å¥½ï¼Œæ”¯æŒæ“ä½œåŸå­æ€§ï¼Œå¾ˆé€‚åˆç”¨æ¥åšé«˜é€Ÿç¼“å­˜ã€‚\n\n\n\nHBase\n\nå­˜å‚¨å®¹é‡å¤§ï¼Œä¸€ä¸ªè¡¨å¯ä»¥å®¹çº³ä¸Šäº¿è¡Œã€ä¸Šç™¾ä¸‡åˆ—ï¼Œå¯åº”å¯¹è¶…å¤§æ•°æ®é‡è¦æ±‚æ‰©å±•ç®€å•çš„éœ€æ±‚ã€‚\n\n\n\nRedis æœ‰å“ªäº›ä¼˜ç¼ºç‚¹ï¼Ÿ\nä¼˜ç‚¹\n\n\nè¯»å†™æ€§èƒ½ä¼˜å¼‚ã€‚Redis èƒ½è¯»çš„é€Ÿåº¦æ˜¯ 110000 æ¬¡/sï¼Œå†™çš„é€Ÿåº¦æ˜¯ 81000 æ¬¡/sã€‚\n\n\næ”¯æŒæ•°æ®æŒä¹…åŒ–ã€‚æ”¯æŒ AOF å’Œ RDB ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ã€‚\n\n\næ”¯æŒäº‹åŠ¡ã€‚Redis çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼ŒåŒæ—¶ Redis è¿˜æ”¯æŒå¯¹å‡ ä¸ªæ“ä½œåˆå¹¶åçš„åŸå­æ€§æ‰§è¡Œã€‚\n\n\næ•°æ®ç»“æ„ä¸°å¯Œã€‚é™¤äº†æ”¯æŒ string ç±»å‹çš„ value å¤–è¿˜æ”¯æŒ hashã€setã€zsetã€list ç­‰æ•°æ®ç»“æ„ã€‚\n\n\næ”¯æŒä¸»ä»å¤åˆ¶ã€‚ä¸»æœºä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°ä»æœºï¼Œå¯ä»¥è¿›è¡Œè¯»å†™åˆ†ç¦»ã€‚\n\n\nç¼ºç‚¹\n\n\næ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™ã€‚å› æ­¤ Redis é€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚\n\n\nRedis ä¸å…·å¤‡è‡ªåŠ¨å®¹é”™å’Œæ¢å¤åŠŸèƒ½ã€‚ä¸»æœºä»æœºçš„å®•æœºéƒ½ä¼šå¯¼è‡´å‰ç«¯éƒ¨åˆ†è¯»å†™è¯·æ±‚å¤±è´¥ï¼Œéœ€è¦ç­‰å¾…æœºå™¨é‡å¯æˆ–è€…æ‰‹åŠ¨åˆ‡æ¢å‰ç«¯çš„ IP æ‰èƒ½æ¢å¤ã€‚\n\n\næ•°æ®ä¸åŒæ­¥ã€‚ä¸»æœºå®•æœºï¼Œå®•æœºå‰æœ‰éƒ¨åˆ†æ•°æ®æœªèƒ½åŠæ—¶åŒæ­¥åˆ°ä»æœºï¼Œåˆ‡æ¢ IP åè¿˜ä¼šå¼•å…¥æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œé™ä½äº†ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚\n\n\nRedis è¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—å¾ˆå¤æ‚ã€‚ä¸ºé¿å…è¿™ä¸€é—®é¢˜ï¼Œè¿ç»´äººå‘˜åœ¨ç³»ç»Ÿä¸Šçº¿æ—¶å¿…é¡»ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œè¿™å¯¹èµ„æºé€ æˆäº†å¾ˆå¤§çš„æµªè´¹ã€‚\n\n\nä¸ºä»€ä¹ˆè¦ç”¨ Redis/ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜ï¼Ÿ\né«˜æ€§èƒ½\nå‡å¦‚ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æ•°æ®åº“ä¸­çš„æŸäº›æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºæ˜¯ä»ç¡¬ç›˜ä¸Šè¯»å–çš„ã€‚å°†è¯¥ç”¨æˆ·è®¿é—®çš„æ•°æ®å­˜åœ¨æ•°ç¼“ç¼“å­˜ä¸­ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡å†è®¿é—®è¿™äº›æ•°æ®çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–äº†ã€‚æ“ä½œç¼“å­˜å°±æ˜¯ç›´æ¥æ“ä½œå†…å­˜ï¼Œæ‰€ä»¥é€Ÿåº¦ç›¸å½“å¿«ã€‚å¦‚æœæ•°æ®åº“ä¸­çš„å¯¹åº”æ•°æ®æ”¹å˜çš„ä¹‹åï¼ŒåŒæ­¥æ”¹å˜ç¼“å­˜ä¸­ç›¸åº”çš„æ•°æ®å³å¯ï¼\né«˜å¹¶å‘\nç›´æ¥æ“ä½œç¼“å­˜èƒ½å¤Ÿæ‰¿å—çš„è¯·æ±‚æ˜¯è¿œè¿œå¤§äºç›´æ¥è®¿é—®æ•°æ®åº“çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠæ•°æ®åº“ä¸­çš„éƒ¨åˆ†æ•°æ®è½¬ç§»åˆ°ç¼“å­˜ä¸­å»ï¼Œè¿™æ ·ç”¨æˆ·çš„ä¸€éƒ¨åˆ†è¯·æ±‚ä¼šç›´æ¥åˆ°ç¼“å­˜è¿™é‡Œè€Œä¸ç”¨ç»è¿‡æ•°æ®åº“ã€‚\nä¸ºä»€ä¹ˆè¦ç”¨ Redis è€Œä¸ç”¨ map/guava åšç¼“å­˜?\nç¼“å­˜åˆ†ä¸ºæœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜ã€‚ä»¥ Java ä¸ºä¾‹ï¼Œä½¿ç”¨è‡ªå¸¦çš„ map æˆ–è€… guava å®ç°çš„æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œæœ€ä¸»è¦çš„ç‰¹ç‚¹æ˜¯è½»é‡ä»¥åŠå¿«é€Ÿï¼Œç”Ÿå‘½å‘¨æœŸéšç€ jvm çš„é”€æ¯è€Œç»“æŸï¼Œå¹¶ä¸”åœ¨å¤šå®ä¾‹çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå®ä¾‹éƒ½éœ€è¦å„è‡ªä¿å­˜ä¸€ä»½ç¼“å­˜ï¼Œç¼“å­˜ä¸å…·æœ‰ä¸€è‡´æ€§ã€‚\nä½¿ç”¨ redis æˆ– memcached ä¹‹ç±»çš„ç§°ä¸ºåˆ†å¸ƒå¼ç¼“å­˜ï¼Œåœ¨å¤šå®ä¾‹çš„æƒ…å†µä¸‹ï¼Œå„å®ä¾‹å…±ç”¨ä¸€ä»½ç¼“å­˜æ•°æ®ï¼Œç¼“å­˜å…·æœ‰ä¸€è‡´æ€§ã€‚ç¼ºç‚¹æ˜¯éœ€è¦ä¿æŒ redis æˆ– memcached æœåŠ¡çš„é«˜å¯ç”¨ï¼Œæ•´ä¸ªç¨‹åºæ¶æ„ä¸Šè¾ƒä¸ºå¤æ‚ã€‚\nRedis ä¸ Memcached çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸é€‰ Memcached?\n\n\nmemcached æ‰€æœ‰çš„å€¼å‡æ˜¯ç®€å•çš„å­—ç¬¦ä¸²ï¼Œä¸”åªæ”¯æŒ k/v ç±»å‹ï¼Œredis ä½œä¸ºå…¶æ›¿ä»£è€…ï¼Œæ”¯æŒæ›´ä¸ºä¸°å¯Œçš„æ•°æ®ç±»å‹ã€‚\n\n\nredis å¯ä»¥æŒä¹…åŒ–å…¶æ•°æ®ï¼Œmemcached åªç”¨åšç¼“å­˜æå‡æ€§èƒ½ï¼Œä¸èƒ½åšæŒä¹…åŒ–ã€‚\n\n\nmemcached å­˜å‚¨æ•°æ®æœ‰é™åˆ¶ï¼š1M ã€å¤§äº 1Mï¼Œè®¤ä¸ºå°±è¡Œåˆ†å‰²ã€‘ï¼ˆå†…å­˜ç¢ç‰‡ï¼‰\n\n\nmemcached é›†ç¾¤æ•°æ®æ²¡æœ‰å¤åˆ¶å’ŒåŒæ­¥æœºåˆ¶ï¼ˆå´©æºƒä¸ä¼šå½±å“ç¨‹åºï¼Œä¼šä»æ•°æ®åº“ä¸­å–æ•°æ®ï¼‰ã€‚\n\n\nmemcached å†…å­˜ä¸èƒ½åŠæ—¶å›æ”¶ï¼Œå®ƒåªæœ‰Â LRU(ç®—æ³•) è¿™ä¸€ç§æ–¹å¼ï¼Œè€Œ redis æœ‰å¤šç§å†…å­˜å›æ”¶æ–¹å¼ã€‚\n\n\nRedis ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ\n\n\nå®Œå…¨åŸºäºå†…å­˜ï¼Œç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼Œéå¸¸å¿«é€Ÿã€‚æ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œç±»ä¼¼äº HashMapï¼ŒHashMap çš„ä¼˜åŠ¿å°±æ˜¯æŸ¥æ‰¾å’Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)ï¼›\n\n\næ•°æ®ç»“æ„ç®€å•ï¼Œå¯¹æ•°æ®æ“ä½œä¹Ÿç®€å•ï¼ŒRedis ä¸­çš„æ•°æ®ç»“æ„æ˜¯ä¸“é—¨è¿›è¡Œè®¾è®¡çš„ï¼›\n\n\né‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶ï¼Œä¹Ÿä¸å­˜åœ¨å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹å¯¼è‡´çš„åˆ‡æ¢è€Œæ¶ˆè€— CPUï¼Œä¸ç”¨å»è€ƒè™‘å„ç§é”çš„é—®é¢˜ï¼Œä¸å­˜åœ¨åŠ é”é‡Šæ”¾é”æ“ä½œï¼Œæ²¡æœ‰å› ä¸ºå¯èƒ½å‡ºç°æ­»é”è€Œå¯¼è‡´çš„æ€§èƒ½æ¶ˆè€—ï¼›\n\n\nä½¿ç”¨å¤šè·¯ I/O å¤ç”¨æ¨¡å‹ï¼Œéé˜»å¡ IOï¼›\n\n\nä½¿ç”¨åº•å±‚æ¨¡å‹ä¸åŒï¼Œå®ƒä»¬ä¹‹é—´åº•å±‚å®ç°æ–¹å¼ä»¥åŠä¸å®¢æˆ·ç«¯ä¹‹é—´é€šä¿¡çš„åº”ç”¨åè®®ä¸ä¸€æ ·ï¼ŒRedis ç›´æ¥è‡ªå·±æ„å»ºäº† VM æœºåˆ¶ ï¼Œå› ä¸ºä¸€èˆ¬çš„ç³»ç»Ÿè°ƒç”¨ç³»ç»Ÿå‡½æ•°çš„è¯ï¼Œä¼šæµªè´¹ä¸€å®šçš„æ—¶é—´å»ç§»åŠ¨å’Œè¯·æ±‚ï¼›\n\n\nRedis çš„ä¸»è¦ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\n\n\nå†…é“¾ï¼š[[é¢è¯•-08 Redis#åœ¨å·¥ä½œä¸­ï¼Œå¦‚æœæ•°æ®åº“ä¿®æ”¹äº†æ•°æ®ï¼Œé‚£å°±è·Ÿ redis æ•°æ®ä¸åŒæ­¥äº†ï¼Œæ­¤æ—¶è¯¥åŠï¼Ÿï¼ˆç¼“å­˜åŒå†™ä¸€è‡´æ€§é—®é¢˜ï¼‰|ç¼“å­˜åŒå†™ä¸€è‡´æ€§é—®é¢˜]]\nå¤–é“¾ï¼šç¼“å­˜åŒå†™ä¸€è‡´æ€§é—®é¢˜\n\n\nå†…é“¾ï¼š[[é¢è¯•-08 Redis#ç¼“å­˜é›ªå´©|ç¼“å­˜é›ªå´©é—®é¢˜]]\nå¤–é“¾ï¼šç¼“å­˜é›ªå´©é—®é¢˜\n\n\nå†…é“¾ï¼š[[é¢è¯•-08 Redis#ç¼“å­˜ç©¿é€|ç¼“å­˜ç©¿é€é—®é¢˜]]\nå¤–é“¾ï¼šç¼“å­˜ç©¿é€é—®é¢˜\n\n\nå†…é“¾ï¼š[[é¢è¯•-08 Redis#é‚£æ€ä¹ˆè§£å†³ç¼“å­˜çš„å¹¶å‘ç«äº‰é—®é¢˜ï¼Ÿæ¯”å¦‚å¤šä¸ªå­ç³»ç»Ÿå»setä¸€ä¸ªkeyä½†æœ€åæ‰§è¡Œé¡ºåºå’Œæˆ‘ä»¬æœŸæœ›é¡ºåºä¸ä¸€æ ·ã€‚|ç¼“å­˜çš„å¹¶å‘ç«äº‰é—®é¢˜]]\nå¤–é“¾ï¼šç¼“å­˜çš„å¹¶å‘ç«äº‰é—®é¢˜\n\n\næ•°æ®ç±»å‹\nRedis çš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿå®ƒçš„æ•°æ®æ“ä½œæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ\n\n\næ•°æ®ç±»å‹\n\nstringã€hashã€list(æœ‰åºã€å¯é‡å¤)ã€set(æ— åºã€ä¸å¯é‡å¤)ã€zset(ä¸å¯é‡å¤ï¼ŒåŸºäº score å®ç°æ’åº)\n\n\n\næ•°æ®æ“ä½œ\n\nRedis ä¸­çš„æ•°æ®å­˜å‚¨æ–¹å¼æ˜¯ key-value å½¢å¼\nRedis ä¸èƒ½ä¿å­˜ JAVA å¯¹è±¡ï¼Œéœ€è¦è½¬ä¸º JSON å¯¹è±¡åå­˜å…¥ Redis\n\n\n\n\n\n\næ•°æ®ç±»å‹\nå¯ä»¥å­˜å‚¨çš„å€¼\næ“ä½œ\nåº”ç”¨åœºæ™¯\n\n\n\n\nString\nå­—ç¬¦ä¸²ã€æ•´æ•°æˆ–æµ®ç‚¹æ•°\n1.å¯¹æ•´ä¸ªå­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦ä¸²çš„å…¶ä¸­ä¸€éƒ¨åˆ†æ‰§è¡Œæ“ä½œ 2.å¯¹æ•´æ•°å’Œæµ®ç‚¹æ•°æ‰§è¡Œè‡ªå¢æˆ–è‡ªå‡æ“ä½œ\nåšç®€å•çš„é”®å€¼å¯¹ç¼“å­˜\n\n\nList\nåˆ—è¡¨\n1.ä»ä¸¤ç«¯å‹å…¥æˆ–å¼¹å‡ºå…ƒç´  2.å¯¹å•ä¸ªæˆ–å¤šä¸ªå…ƒç´ è¿›è¡Œä¿®å‰ªï¼Œåªä¿ç•™ä¸€ä¸ªèŒƒå›´å†…çš„å…ƒç´ \nå­˜å‚¨ä¸€äº›åˆ—è¡¨å‹çš„æ•°æ®ç»“æ„ï¼Œç±»ä¼¼ç²‰ä¸åˆ—è¡¨ã€æ–‡ç« çš„è¯„è®ºåˆ—è¡¨ä¹‹ç±»çš„æ•°æ®\n\n\nSet\næ— åºé›†åˆ\n1.æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªå…ƒç´  2.æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ 3.è®¡ç®—äº¤é›†ã€å¹¶é›†ã€å·®é›† ä»é›†åˆé‡Œé¢éšæœºè·å–å…ƒç´ \näº¤é›†ã€å¹¶é›†ã€å·®é›†çš„æ“ä½œï¼Œæ¯”å¦‚ä¸¤äººçš„ç²‰ä¸åˆ—è¡¨åšäº¤é›†\n\n\nHash\nåŒ…å«é”®å€¼å¯¹çš„æ— åºæ•£åˆ—è¡¨\n1.æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªé”®å€¼å¯¹ 2.è·å–æ‰€æœ‰é”®å€¼å¯¹ 3.æ£€æŸ¥æŸä¸ªé”®æ˜¯å¦å­˜åœ¨\nç»“æ„åŒ–çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸€ä¸ªå¯¹è±¡\n\n\nZSet\næœ‰åºé›†åˆ\n1.æ·»åŠ ã€è·å–ã€ç§»é™¤å…ƒç´  2.æ ¹æ®åˆ†å€¼èŒƒå›´æˆ–æˆå‘˜æ¥è·å–å…ƒç´  3.è®¡ç®—ä¸€ä¸ªé”®çš„æ’å\nå»é‡ï¼Œä½†å¯ä»¥æ’åºï¼Œå¦‚è·å–å‰å‡ åç”¨æˆ·\n\n\n\nRedis çš„åº”ç”¨åœºæ™¯\n\n\nè®¡æ•°å™¨\n\n\n\n\nå¯ä»¥å¯¹ String è¿›è¡Œè‡ªå¢è‡ªå‡è¿ç®—ï¼Œä»è€Œå®ç°è®¡æ•°å™¨åŠŸèƒ½ã€‚Redis è¿™ç§å†…å­˜å‹æ•°æ®åº“çš„è¯»å†™æ€§èƒ½éå¸¸é«˜ï¼Œå¾ˆé€‚åˆå­˜å‚¨é¢‘ç¹è¯»å†™çš„è®¡æ•°é‡ã€‚\n\n\n\n\nç¼“å­˜\n\n\n\n\nå°†çƒ­ç‚¹æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Œè®¾ç½®å†…å­˜çš„æœ€å¤§ä½¿ç”¨é‡ä»¥åŠæ·˜æ±°ç­–ç•¥æ¥ä¿è¯ç¼“å­˜çš„å‘½ä¸­ç‡ã€‚\n\n\n\n\nä¼šè¯ç¼“å­˜\n\n\n\n\nå¯ä»¥ä½¿ç”¨ Redis æ¥ç»Ÿä¸€å­˜å‚¨å¤šå°åº”ç”¨æœåŠ¡å™¨çš„ä¼šè¯ä¿¡æ¯ã€‚å½“åº”ç”¨æœåŠ¡å™¨ä¸å†å­˜å‚¨ç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ï¼Œä¹Ÿå°±ä¸å†å…·æœ‰çŠ¶æ€ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥è¯·æ±‚ä»»æ„ä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œä»è€Œæ›´å®¹æ˜“å®ç°é«˜å¯ç”¨æ€§ä»¥åŠå¯ä¼¸ç¼©æ€§ã€‚\n\n\n\n\nå…¨é¡µç¼“å­˜ï¼ˆFPCï¼‰\n\n\n\n\né™¤åŸºæœ¬çš„ä¼šè¯ token ä¹‹å¤–ï¼ŒRedis è¿˜æä¾›å¾ˆç®€ä¾¿çš„ FPC å¹³å°ã€‚ä»¥ Magento ä¸ºä¾‹ï¼ŒMagento æä¾›ä¸€ä¸ªæ’ä»¶æ¥ä½¿ç”¨ Redis ä½œä¸ºå…¨é¡µç¼“å­˜åç«¯ã€‚æ­¤å¤–ï¼Œå¯¹ WordPress çš„ç”¨æˆ·æ¥è¯´ï¼ŒPantheon æœ‰ä¸€ä¸ªéå¸¸å¥½çš„æ’ä»¶ wp-redisï¼Œè¿™ä¸ªæ’ä»¶èƒ½å¸®åŠ©ä½ ä»¥æœ€å¿«é€Ÿåº¦åŠ è½½ä½ æ›¾æµè§ˆè¿‡çš„é¡µé¢ã€‚\n\n\n\n\næŸ¥æ‰¾è¡¨\n\n\n\n\nä¾‹å¦‚ DNS è®°å½•å°±å¾ˆé€‚åˆä½¿ç”¨ Redis è¿›è¡Œå­˜å‚¨ã€‚æŸ¥æ‰¾è¡¨å’Œç¼“å­˜ç±»ä¼¼ï¼Œä¹Ÿæ˜¯åˆ©ç”¨äº† Redis å¿«é€Ÿçš„æŸ¥æ‰¾ç‰¹æ€§ã€‚ä½†æ˜¯æŸ¥æ‰¾è¡¨çš„å†…å®¹ä¸èƒ½å¤±æ•ˆï¼Œè€Œç¼“å­˜çš„å†…å®¹å¯ä»¥å¤±æ•ˆï¼Œå› ä¸ºç¼“å­˜ä¸ä½œä¸ºå¯é çš„æ•°æ®æ¥æºã€‚\n\n\n\n\næ¶ˆæ¯é˜Ÿåˆ— (å‘å¸ƒ/è®¢é˜…åŠŸèƒ½)\n\n\n\n\nList æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œå¯ä»¥é€šè¿‡ lpush å’Œ rpop å†™å…¥å’Œè¯»å–æ¶ˆæ¯ã€‚ä¸è¿‡æœ€å¥½ä½¿ç”¨ Kafkaã€RabbitMQ ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ã€‚\n\n\n\n\nåˆ†å¸ƒå¼é”å®ç°\n\n\n\n\nåœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œæ— æ³•ä½¿ç”¨å•æœºç¯å¢ƒä¸‹çš„é”æ¥å¯¹å¤šä¸ªèŠ‚ç‚¹ä¸Šçš„è¿›ç¨‹è¿›è¡ŒåŒæ­¥ã€‚å¯ä»¥ä½¿ç”¨ Redis è‡ªå¸¦çš„ SETNX å‘½ä»¤å®ç°åˆ†å¸ƒå¼é”ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ RedLock åˆ†å¸ƒå¼é”å®ç°ã€‚\n\n\n\n\nå…¶å®ƒ\n\n\n\n\nSet å¯ä»¥å®ç°äº¤é›†ã€å¹¶é›†ç­‰æ“ä½œï¼Œä»è€Œå®ç°å…±åŒå¥½å‹ç­‰åŠŸèƒ½ã€‚ZSet å¯ä»¥å®ç°æœ‰åºæ€§æ“ä½œï¼Œä»è€Œå®ç°æ’è¡Œæ¦œç­‰åŠŸèƒ½ã€‚\n\n\nRedis åº”ç”¨åœºæ™¯ï¼ˆæ ¹æ®ç±»å‹ï¼‰\n\n\nString\n\né€‚åˆæœ€ç®€å•çš„ k-v å­˜å‚¨ï¼Œç±»ä¼¼äº memcached çš„å­˜å‚¨ç»“æ„ï¼ŒçŸ­ä¿¡éªŒè¯ç ï¼Œé…ç½®ä¿¡æ¯ç­‰ï¼Œå°±ç”¨è¿™ç§ç±»å‹æ¥å­˜å‚¨ã€‚\n\n\n\nHash\n\nä¸€èˆ¬ key ä¸º ID æˆ–è€…å”¯ä¸€æ ‡ç¤ºï¼Œvalue å¯¹åº”çš„å°±æ˜¯è¯¦æƒ…äº†ã€‚å¦‚å•†å“è¯¦æƒ…ï¼Œä¸ªäººä¿¡æ¯è¯¦æƒ…ï¼Œæ–°é—»è¯¦æƒ…ç­‰ã€‚\n\n\n\nList\n\nå› ä¸º list æ˜¯æœ‰åºçš„ï¼Œæ¯”è¾ƒé€‚åˆå­˜å‚¨ä¸€äº›æœ‰åºä¸”æ•°æ®ç›¸å¯¹å›ºå®šçš„æ•°æ®ã€‚å¦‚çœå¸‚åŒºè¡¨ã€å­—å…¸è¡¨ç­‰ã€‚å› ä¸º list æ˜¯æœ‰åºçš„ï¼Œé€‚åˆæ ¹æ®å†™å…¥çš„æ—¶é—´æ¥æ’åºï¼Œå¦‚ï¼šæœ€æ–°çš„***ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚\n\n\n\nSet\n\nå¯ä»¥ç®€å•çš„ç†è§£ä¸º ID-List çš„æ¨¡å¼ï¼Œå¦‚å¾®åšä¸­ä¸€ä¸ªäººæœ‰å“ªäº›å¥½å‹ï¼Œset æœ€ç‰›çš„åœ°æ–¹åœ¨äºï¼Œå¯ä»¥å¯¹ä¸¤ä¸ª set æä¾›äº¤é›†ã€å¹¶é›†ã€å·®é›†æ“ä½œã€‚ä¾‹å¦‚ï¼šæŸ¥æ‰¾ä¸¤ä¸ªäººå…±åŒçš„å¥½å‹ç­‰ã€‚\n\n\n\nZSet\n\nè‡ªåŠ¨ä¼šæ ¹æ® score çš„å€¼è¿›è¡Œæ’åºã€‚æ¯”è¾ƒé€‚åˆç±»ä¼¼äº top 10 ç­‰ä¸æ ¹æ®æ’å…¥çš„æ—¶é—´æ¥æ’åºçš„æ•°æ®ã€‚\n\n\n\nRedis æŒä¹…åŒ–\nä»€ä¹ˆæ˜¯ Redis æŒä¹…åŒ–ï¼Ÿ\n\n\næŒä¹…åŒ–å°±æ˜¯æŠŠå†…å­˜çš„æ•°æ®å†™åˆ°ç£ç›˜ä¸­å»ï¼Œé˜²æ­¢æœåŠ¡å®•æœºäº†å†…å­˜æ•°æ®ä¸¢å¤±ã€‚\n\n\nRedis çš„æŒä¹…åŒ–æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿå„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Ÿ\nRDB\n\n\nç®€è¿°\n\nRDB æ˜¯äºŒè¿›åˆ¶å¿«ç…§å½¢å¼ï¼Œæ•°æ®ä½“é‡å°ï¼Œä¿å­˜æ•ˆç‡é«˜ï¼Œä½†ä¸¢å¤±é£é™©ä¹Ÿè¾ƒå¤§ï¼Œå› ä¸ºå®ƒæ˜¯å®šæ—¶å®šé‡æ›´æ”¹æ‰ä¼šè‡ªåŠ¨æŒä¹…åŒ–ï¼Œæ— æ³•å®æ—¶å­˜å‚¨ï¼Œå¦‚æœåœ¨å¿«ç…§ä¹‹å‰ä¸¢å¤±ï¼Œåˆ™æ— æ³•æ‰¾å›ã€‚\n\n\n\nä¼˜ç‚¹\n\nåªæœ‰ä¸€ä¸ªæ–‡ä»¶ dump.rdbï¼Œæ–¹ä¾¿æŒä¹…åŒ–ã€‚\nå®¹ç¾æ€§å¥½ï¼Œä¸€ä¸ªæ–‡ä»¶å¯ä»¥ä¿å­˜åˆ°å®‰å…¨çš„ç£ç›˜ã€‚\næ€§èƒ½æœ€å¤§åŒ–ï¼Œfork å­è¿›ç¨‹æ¥å®Œæˆå†™æ“ä½œï¼Œè®©ä¸»è¿›ç¨‹ç»§ç»­å¤„ç†å‘½ä»¤ï¼Œæ‰€ä»¥æ˜¯ IO æœ€å¤§åŒ–ã€‚ä½¿ç”¨å•ç‹¬å­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¸»è¿›ç¨‹ä¸ä¼šè¿›è¡Œä»»ä½• IO æ“ä½œï¼Œä¿è¯äº† redis çš„é«˜æ€§èƒ½\nç›¸å¯¹äºæ•°æ®é›†å¤§æ—¶ï¼Œæ¯” AOF çš„å¯åŠ¨æ•ˆç‡æ›´é«˜ã€‚\n\n\n\nç¼ºç‚¹\n\næ•°æ®å®‰å…¨æ€§ä½ã€‚RDB æ˜¯é—´éš”ä¸€æ®µæ—¶é—´è¿›è¡ŒæŒä¹…åŒ–ï¼Œå¦‚æœæŒä¹…åŒ–ä¹‹é—´ redis å‘ç”Ÿæ•…éšœï¼Œä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±ã€‚æ‰€ä»¥è¿™ç§æ–¹å¼æ›´é€‚åˆæ•°æ®è¦æ±‚ä¸ä¸¥è°¨çš„æ—¶å€™)\n\n\n\nAOF\n\n\nç®€è¿°\n\nAOF æ˜¯è¿‡ç¨‹å‘½ä»¤å½¢å¼ï¼Œæ•°æ®ä½“é‡å¤§ (å¯ä»¥ç”¨ AOF é‡å†™è§£å†³è¯¥é—®é¢˜)ï¼Œæ•ˆç‡ä½äº RDBï¼Œè®°å½•æ¯ä¸ªæ“ä½œï¼Œå­˜å‚¨æ ¼å¼ä¹Ÿæ›´å¤æ‚ï¼Œä½†æ•°æ®ç›¸å¯¹å®Œæ•´ (æœ€å¿«å¯ä»¥æ¯ç§’åŒæ­¥ä¸€æ¬¡)ï¼Œä¸”å¼¥è¡¥äº† RDB ä¸èƒ½å®æ—¶å­˜å‚¨çš„ç¼ºç‚¹ã€‚\n\n\n\nä¼˜ç‚¹\n\næ•°æ®å®‰å…¨ï¼ŒAOF æŒä¹…åŒ–å¯ä»¥é…ç½® appendfsync å±æ€§ï¼Œæœ‰ alwaysï¼Œæ¯è¿›è¡Œä¸€æ¬¡å‘½ä»¤æ“ä½œå°±è®°å½•åˆ° AOF æ–‡ä»¶ä¸­ä¸€æ¬¡ã€‚\né€šè¿‡ append æ¨¡å¼å†™æ–‡ä»¶ï¼Œå³ä½¿ä¸­é€”æœåŠ¡å™¨å®•æœºï¼Œå¯ä»¥é€šè¿‡ redis-check-aof å·¥å…·è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚\nAOF æœºåˆ¶çš„ rewrite æ¨¡å¼ã€‚AOF æ–‡ä»¶æ²¡è¢« rewrite ä¹‹å‰ï¼ˆæ–‡ä»¶è¿‡å¤§æ—¶ä¼šå¯¹å‘½ä»¤è¿›è¡Œåˆå¹¶é‡å†™ï¼‰ï¼Œå¯ä»¥åˆ é™¤å…¶ä¸­çš„æŸäº›å‘½ä»¤ï¼ˆæ¯”å¦‚è¯¯æ“ä½œçš„ flushallï¼‰)\n\n\n\nç¼ºç‚¹\n\nAOF æ–‡ä»¶æ¯” RDB æ–‡ä»¶å¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦æ…¢ã€‚\næ•°æ®é›†å¤§çš„æ—¶å€™ï¼Œæ¯” rdb å¯åŠ¨æ•ˆç‡ä½ã€‚\n\n\n\nAOF æ•°æ®ä½“é‡å¤§ï¼Œé‚£æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿ\n\n\nRedis ä¸­å¼•å…¥äº† AOF é‡å†™æœºåˆ¶å¯ä»¥å‹ç¼©æ–‡ä»¶ä½“ç§¯â€”â€”æ‰§è¡Œå‹ç¼©å‘½ä»¤å³å¯ã€‚\n\n\nAOF é‡å†™å¯ä»¥é™ä½ç£ç›˜å ç”¨é‡ï¼Œä¹Ÿèƒ½æé«˜æ•°æ®æ¢å¤æ•ˆç‡ï¼Œå®ƒä¼šå¯¹åŒä¸€æ•°æ®çš„å¤šæ¡å†™å‘½ä»¤åˆå¹¶ä¸ºä¸€æ¡å†™å‘½ä»¤ï¼Œä¸”ä¸ºäº†é˜²æ­¢æ•°æ®é‡è¿‡å¤§é€ æˆç¼“å†²åŒºæº¢å‡ºï¼Œæ¯æ¡æŒ‡ä»¤æœ€å¤šä¸º 64 ä¸ªå…ƒç´ ã€‚\n\n\nAOF é‡å†™å…¶å®æ˜¯ä¸€ä¸ªåŒæ­¥å¼€å¯çš„å­è¿›ç¨‹ï¼ŒRedis æ‰§è¡ŒæŒ‡ä»¤æ—¶ï¼Œå­è¿›ç¨‹ä¹Ÿä¼šå¼€å¯é‡å†™ï¼Œä¸»è¿›ç¨‹ä¼šå°†å†™å…¥çš„æ•°æ®åŒæ­¥åˆ°å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹åˆ™å¼€å§‹é‡å†™ AOF æ–‡ä»¶ï¼Œå†™å®Œåå†è¿”å›ç»™ä¸»è¿›ç¨‹ï¼Œå®Œæˆ AOF é‡å†™ã€‚\n\n\né€‰ç”¨\n\n\nAOF æ–‡ä»¶æ¯” RDB æ›´æ–°é¢‘ç‡é«˜ï¼Œä¼˜å…ˆä½¿ç”¨ AOF è¿˜åŸæ•°æ®ã€‚\n\n\nAOF æ¯” RDB æ›´å®‰å…¨ä¹Ÿæ›´å¤§\n\n\nRDB æ€§èƒ½æ¯” AOF å¥½\n\n\nå¦‚æœä¸¤ä¸ªéƒ½é…äº†ä¼˜å…ˆåŠ è½½ AOF\n\n\nå¦‚æœå¯¹æ•°æ®éå¸¸æ•æ„Ÿç”¨ AOFï¼Œå¦‚æœè¿½æ±‚å¤§æ•°æ®é›†çš„æ¢å¤é€Ÿåº¦é€‰ RDBã€‚\n\n\nRedis æŒä¹…åŒ–æ•°æ®å’Œç¼“å­˜æ€ä¹ˆåšæ‰©å®¹ï¼Ÿ\n\n\nå¦‚æœ Redis è¢«å½“åšç¼“å­˜ä½¿ç”¨ï¼Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œå®ç°åŠ¨æ€æ‰©å®¹ç¼©å®¹ã€‚\n\n\nå¦‚æœ Redis è¢«å½“åšä¸€ä¸ªæŒä¹…åŒ–å­˜å‚¨ä½¿ç”¨ï¼Œå¿…é¡»ä½¿ç”¨å›ºå®šçš„ keys-to-nodes æ˜ å°„å…³ç³»ï¼ŒèŠ‚ç‚¹çš„æ•°é‡ä¸€æ—¦ç¡®å®šä¸èƒ½å˜åŒ–ã€‚å¦åˆ™çš„è¯ (å³ Redis èŠ‚ç‚¹éœ€è¦åŠ¨æ€å˜åŒ–çš„æƒ…å†µï¼‰ï¼Œå¿…é¡»ä½¿ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œæ•°æ®å†å¹³è¡¡çš„ä¸€å¥—ç³»ç»Ÿï¼Œè€Œå½“å‰åªæœ‰ Redis é›†ç¾¤å¯ä»¥åšåˆ°è¿™æ ·ã€‚\n\n\næ•°æ®åˆ é™¤\nRedis æ˜¯æ€ä¹ˆè¿›è¡Œæ•°æ®åˆ é™¤çš„ï¼Ÿè¿‡æœŸåˆ é™¤ç­–ç•¥ï¼Ÿ\nä¸‰ç§è¿‡æœŸç­–ç•¥\nå®šæ—¶åˆ é™¤\nåˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œå½“ key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¸”è¿‡æœŸæ—¶é—´åˆ°è¾¾æ—¶ï¼Œç”±å®šæ—¶å™¨ä»»åŠ¡ç«‹å³æ‰§è¡Œå¯¹é”®çš„åˆ é™¤æ“ä½œã€‚\nè¿™æ ·çš„å¥½å¤„æ˜¯åŠæ—¶å¿«é€Ÿé‡Šæ”¾å†…å­˜ï¼Œåå¤„æ—¶ï¼Œæ¶ˆè€—è¿‡å¤šçš„å¤„ç†å™¨æ€§èƒ½ã€‚\næƒ°æ€§åˆ é™¤\nå®šæ—¶åˆ é™¤ç­–ç•¥ä¸­ï¼Œä»åˆ é™¤æ–¹æ³•æ¥çœ‹ï¼Œå¿…ç„¶ä¼šå¯¼è‡´æœ‰ key è¿‡æœŸäº†ä½†æœªä» redis ä¸­åˆ é™¤çš„æƒ…å†µã€‚\né¢å¯¹è¿™ç§æƒ…å†µï¼Œredis åœ¨æ“ä½œä¸€ä¸ª key æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­è¿™ä¸ªå€¼æ˜¯å¦è¿‡æœŸï¼Œè‹¥å·²è¿‡æœŸï¼Œåˆ™åˆ é™¤è¯¥ keyï¼›è‹¥æœªè¿‡æœŸï¼Œåˆ™è¿›è¡Œåç»­æ“ä½œã€‚\nå®šæœŸåˆ é™¤ï¼ˆå¸¸ç”¨ï¼‰\n\n\nRedis é»˜è®¤ä¼šæ¯ç§’è¿›è¡Œåæ¬¡è¿‡æœŸæ‰«æï¼Œè¿‡æœŸæ‰«æä¸ä¼šéå†è¿‡æœŸå­—å…¸ä¸­æ‰€æœ‰çš„ keyï¼Œè€Œæ˜¯é‡‡ç”¨äº†ä¸€ç§ç®€å•çš„è´ªå¿ƒç­–ç•¥ã€‚\n\nä»è¿‡æœŸå­—å…¸ä¸­éšæœº 20 ä¸ª keyï¼›\nåˆ é™¤è¿™ 20 ä¸ª key ä¸­å·²ç»è¿‡æœŸçš„ keyï¼›\nå¦‚æœè¿‡æœŸçš„ key æ¯”ç‡è¶…è¿‡ 1/4ï¼Œé‚£å°±é‡å¤æ­¥éª¤ 1ï¼›\nåŒæ—¶ï¼Œä¸ºäº†ä¿è¯è¿‡æœŸæ‰«æä¸ä¼šå‡ºç°å¾ªç¯è¿‡åº¦ï¼Œå¯¼è‡´çº¿ç¨‹å¡æ­»ç°è±¡ï¼Œç®—æ³•è¿˜å¢åŠ äº†æ‰«ææ—¶é—´çš„ä¸Šé™ï¼Œé»˜è®¤ä¸ä¼šè¶…è¿‡ 25msã€‚\nå¦‚æœæŸä¸€æ—¶åˆ»ï¼Œæœ‰å¤§é‡ key åŒæ—¶è¿‡æœŸï¼ŒRedis ä¼šæŒç»­æ‰«æè¿‡æœŸå­—å…¸ï¼Œé€ æˆå®¢æˆ·ç«¯å“åº”å¡é¡¿ï¼Œå› æ­¤è®¾ç½®è¿‡æœŸæ—¶é—´æ—¶ï¼Œå°±å°½é‡é¿å…è¿™ä¸ªé—®é¢˜ï¼Œåœ¨è®¾ç½®è¿‡æœŸæ—¶é—´æ—¶ï¼Œå¯ä»¥ç»™è¿‡æœŸæ—¶é—´è®¾ç½®ä¸€ä¸ªéšæœºèŒƒå›´ï¼Œé¿å…åŒä¸€æ—¶åˆ»è¿‡æœŸã€‚\n(expires å­—å…¸ä¼šä¿å­˜æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ key çš„è¿‡æœŸæ—¶é—´æ•°æ®ï¼Œå…¶ä¸­ï¼Œkey æ˜¯æŒ‡å‘é”®ç©ºé—´ä¸­çš„æŸä¸ªé”®çš„æŒ‡é’ˆï¼Œvalue æ˜¯è¯¥é”®çš„æ¯«ç§’ç²¾åº¦çš„ UNIX æ—¶é—´æˆ³è¡¨ç¤ºçš„è¿‡æœŸæ—¶é—´ã€‚é”®ç©ºé—´æ˜¯æŒ‡è¯¥ Redis é›†ç¾¤ä¸­ä¿å­˜çš„æ‰€æœ‰é”®ã€‚)\nRedis ä¸­åŒæ—¶ä½¿ç”¨äº†æƒ°æ€§è¿‡æœŸå’Œå®šæœŸè¿‡æœŸä¸¤ç§è¿‡æœŸç­–ç•¥ã€‚\n\n\n\næ€ä¹ˆåˆ¤æ–­ä¸€ä¸ª Key è¿˜æœ‰å¤šå°‘æ—¶é—´\n\n\nTTL å‘½ä»¤ï¼ˆå‘½ä»¤è¡Œï¼‰\n\næ­£æ•° -&gt; å‰©ä½™æ—¶é—´\n-1 -&gt; æ°¸ä¹… Key\n-2 -&gt; Key å·²ç»è¿‡æœŸæˆ–è€…ä¸å­˜åœ¨\n\n\n\nå¦‚ä½•é…ç½®å®šæœŸåˆ é™¤æ‰§è¡Œæ—¶é—´é—´éš”ï¼Ÿ\nredis çš„å®šæ—¶ä»»åŠ¡é»˜è®¤æ˜¯ 10s æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœè¦ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œå¯ä»¥åœ¨ redis.conf ä¸­ä¿®æ”¹ hz çš„å€¼ã€‚\nredis.conf ä¸­ï¼Œhz é»˜è®¤è®¾ä¸º 10ï¼Œæé«˜å®ƒçš„å€¼å°†ä¼šå ç”¨æ›´å¤šçš„ cpuï¼Œå½“ç„¶ç›¸åº”çš„ redis å°†ä¼šæ›´å¿«çš„å¤„ç†åŒæ—¶åˆ°æœŸçš„è®¸å¤š keyï¼Œä»¥åŠæ›´ç²¾ç¡®çš„å»å¤„ç†è¶…æ—¶ã€‚\nhz çš„å–å€¼èŒƒå›´æ˜¯ 1~500ï¼Œé€šå¸¸ä¸å»ºè®®è¶…è¿‡ 100ï¼Œåªæœ‰åœ¨è¯·æ±‚å»¶æ—¶éå¸¸ä½çš„æƒ…å†µä¸‹å¯ä»¥å°†å€¼æå‡åˆ° 100ã€‚\nå•çº¿ç¨‹çš„ redisï¼Œå¦‚ä½•çŸ¥é“è¦è¿è¡Œå®šæ—¶ä»»åŠ¡\n\nRedis æ˜¯å•çº¿ç¨‹çš„ï¼Œçº¿ç¨‹ä¸ä½†è¦å¤„ç†å®šæ—¶ä»»åŠ¡ï¼Œè¿˜è¦å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œçº¿ç¨‹ä¸èƒ½é˜»å¡åœ¨å®šæ—¶ä»»åŠ¡æˆ–å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ä¸Šï¼Œé‚£ä¹ˆï¼Œredis æ˜¯å¦‚ä½•çŸ¥é“ä½•æ—¶è¯¥è¿è¡Œå®šæ—¶ä»»åŠ¡çš„å‘¢ï¼Ÿ\n\nRedis çš„å®šæ—¶ä»»åŠ¡ä¼šè®°å½•åœ¨ä¸€ä¸ªç§°ä¸ºæœ€å°å †çš„æ•°æ®ç»“æ„ä¸­ã€‚åœ¨è¿™ä¸ªå †ä¸­ï¼Œæœ€å¿«è¦æ‰§è¡Œçš„ä»»åŠ¡æ’åœ¨å †çš„æœ€ä¸Šæ–¹ã€‚åœ¨æ¯ä¸ªå¾ªç¯å‘¨æœŸï¼ŒRedis éƒ½ä¼šå°†æœ€å°å †é‡Œé¢å·²ç»åˆ°ç‚¹çš„ä»»åŠ¡ç«‹å³è¿›è¡Œå¤„ç†ã€‚å¤„ç†å®Œæ¯•åï¼Œå°†æœ€å¿«è¦æ‰§è¡Œçš„ä»»åŠ¡è¿˜éœ€è¦çš„æ—¶é—´è®°å½•ä¸‹æ¥ï¼Œè¿™ä¸ªæ—¶é—´å°±æ˜¯æ¥ä¸‹æ¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§æ—¶é•¿ï¼Œè‹¥è¾¾åˆ°äº†è¯¥æ—¶é•¿ï¼Œåˆ™æš‚æ—¶ä¸å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚è€Œå»è¿è¡Œå®šæ—¶ä»»åŠ¡ã€‚\nRedis key çš„è¿‡æœŸæ—¶é—´å’Œæ°¸ä¹…æœ‰æ•ˆåˆ†åˆ«æ€ä¹ˆè®¾ç½®ï¼Ÿ\nEXPIRE å’Œ PERSIST å‘½ä»¤ã€‚\nå†…å­˜æ·˜æ±°\nRedis çš„å†…å­˜æ·˜æ±°ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ\nRedis çš„å†…å­˜æ·˜æ±°ç­–ç•¥æ˜¯æŒ‡åœ¨ Redis çš„ç”¨äºç¼“å­˜çš„å†…å­˜ä¸è¶³æ—¶ï¼Œæ€ä¹ˆå¤„ç†éœ€è¦æ–°å†™å…¥ä¸”éœ€è¦ç”³è¯·é¢å¤–ç©ºé—´çš„æ•°æ®ã€‚\n\n\n\næ“ä½œçš„æ•°æ®é›†\nå†…å­˜æ·˜æ±°ç­–ç•¥\nè¯´æ˜\n\n\n\n\nè®¾ç½®è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´é€‰æ‹©æ€§ç§»é™¤ï¼ˆå¯èƒ½ä¼šè¿‡æœŸçš„æ•°æ®é›† server.db[i].expiresï¼‰\nvolatile-lru\næ·˜æ±°æœ€è¿‘ä¸€æ¬¡ä½¿ç”¨æ—¶é—´è·ç°åœ¨æœ€ä¹…çš„æ•°æ®ï¼ˆLeast Recently Usedï¼‰æœ€å¸¸ç”¨\n\n\n\nvolatile-lfu\næ·˜æ±°ä½¿ç”¨æ¬¡æ•°æœ€å°‘çš„æ•°æ®ï¼ˆLeast Frequently Usedï¼‰\n\n\n\nvolatile-ttl\næ·˜æ±°è¿‡æœŸæ—¶é—´æœ€è¿‘çš„æ•°æ®\n\n\n\nvolatile-random\næ·˜æ±°éšæœºæ•°æ®\n\n\nå…¨å±€çš„é”®ç©ºé—´é€‰æ‹©æ€§ç§»é™¤ï¼ˆæ‰€æœ‰æ•°æ®é›†ï¼‰\nallkeys-lru\næ·˜æ±°æœ€è¿‘ä¸€æ¬¡ä½¿ç”¨æ—¶é—´è·ç°åœ¨æœ€ä¹…çš„æ•°æ®\n\n\n\nallkeys-lfu\næ·˜æ±°ä½¿ç”¨æ¬¡æ•°æœ€å°‘çš„æ•°æ®\n\n\n\nallkeys-random\næ·˜æ±°éšæœºæ•°æ®\n\n\næ”¾å¼ƒæ•°æ®é©±é€\nno-enviction\nç¦æ­¢é©±é€æ•°æ®ï¼ˆRedis4.0 ä¸­é»˜è®¤ç­–ç•¥ï¼‰ï¼Œä¼šå¼•å‘é”™è¯¯ OOM(Out Of Memory)\n\n\n\næ€»ç»“\nRedis çš„å†…å­˜æ·˜æ±°ç­–ç•¥çš„é€‰å–å¹¶ä¸ä¼šå½±å“è¿‡æœŸçš„ key çš„å¤„ç†ã€‚å†…å­˜æ·˜æ±°ç­–ç•¥ç”¨äºå¤„ç†å†…å­˜ä¸è¶³æ—¶éœ€è¦ç”³è¯·é¢å¤–ç©ºé—´çš„æ•°æ®ï¼›è¿‡æœŸç­–ç•¥ç”¨äºå¤„ç†è¿‡æœŸçš„ç¼“å­˜æ•°æ®ã€‚\nMySQL é‡Œæœ‰ 2000w æ•°æ®ï¼ŒRedis ä¸­åªå­˜ 20w çš„æ•°æ®ï¼Œå¦‚ä½•ä¿è¯ Redis ä¸­çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ï¼Ÿ\nRedis å†…å­˜æ•°æ®é›†å¤§å°ä¸Šå‡åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šæ–½è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥ (ä¸Šé¢çš„ allkeys-lruï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ key)ã€‚\nRedis ä¸»è¦æ¶ˆè€—ä»€ä¹ˆç‰©ç†èµ„æºï¼Ÿ\nå†…å­˜ã€‚\nRedis çš„å†…å­˜ç”¨å®Œäº†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\nå¦‚æœè¾¾åˆ°è®¾ç½®çš„ä¸Šé™ï¼ŒRedis çš„å†™å‘½ä»¤ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼ˆä½†æ˜¯è¯»å‘½ä»¤è¿˜å¯ä»¥æ­£å¸¸è¿”å›ã€‚ï¼‰æˆ–è€…ä½ å¯ä»¥é…ç½®å†…å­˜æ·˜æ±°æœºåˆ¶ï¼Œå½“ Redis è¾¾åˆ°å†…å­˜ä¸Šé™æ—¶ä¼šå†²åˆ·æ‰æ—§çš„å†…å®¹ã€‚\nRedis å¦‚ä½•åšå†…å­˜ä¼˜åŒ–ï¼Ÿ\nå¯ä»¥å¥½å¥½åˆ©ç”¨ Hashï¼Œlistï¼Œsorted setï¼Œset ç­‰é›†åˆç±»å‹æ•°æ®ï¼Œå› ä¸ºé€šå¸¸æƒ…å†µä¸‹å¾ˆå¤šå°çš„ Key-Value å¯ä»¥ç”¨æ›´ç´§å‡‘çš„æ–¹å¼å­˜æ”¾åˆ°ä¸€èµ·ã€‚å°½å¯èƒ½ä½¿ç”¨æ•£åˆ—è¡¨ï¼ˆhashesï¼‰ï¼Œæ•£åˆ—è¡¨ï¼ˆæ˜¯è¯´æ•£åˆ—è¡¨é‡Œé¢å­˜å‚¨çš„æ•°å°‘ï¼‰ä½¿ç”¨çš„å†…å­˜éå¸¸å°ï¼Œæ‰€ä»¥ä½ åº”è¯¥å°½å¯èƒ½çš„å°†ä½ çš„æ•°æ®æ¨¡å‹æŠ½è±¡åˆ°ä¸€ä¸ªæ•£åˆ—è¡¨é‡Œé¢ã€‚æ¯”å¦‚ä½ çš„ web ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œä¸è¦ä¸ºè¿™ä¸ªç”¨æˆ·çš„åç§°ï¼Œå§“æ°ï¼Œé‚®ç®±ï¼Œå¯†ç è®¾ç½®å•ç‹¬çš„ keyï¼Œè€Œæ˜¯åº”è¯¥æŠŠè¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰ä¿¡æ¯å­˜å‚¨åˆ°ä¸€å¼ æ•£åˆ—è¡¨é‡Œé¢\né›†ç¾¤æ–¹æ¡ˆ\nè¯´ä¸€è¯´ Redis çš„ä¸»ä»å¤åˆ¶\nå¯¹äºå¤§å‹ç½‘ç«™æ¥è¯´ï¼Œæ¯ç§’éœ€è¦è¯»å–çš„æ•°æ®è¿œè¿œè¶…è¿‡å•å° Redis æœåŠ¡æ‰€èƒ½æ‰¿å—çš„å‹åŠ›ï¼Œè€Œå†™å…¥çš„æ•°æ®ç›¸å¯¹æ¥è¯´è¾ƒå°‘ï¼Œè¿™æ—¶å€™ç”¨ Redis çš„ä¸»ä»å¤åˆ¶æ¨¡å¼å¯ä»¥å¾ˆå¥½çš„æå‡åŒä¸€ä¸ªå†…å®¹çš„è¯»å–é€Ÿåº¦ã€‚\nRedis ä¸»ä»å¤åˆ¶æ¨¡å¼å…¶å®æ˜¯ä¸€ä¸ªè¯»å†™åˆ†ç¦»æ¨¡å‹ï¼Œå°†ä¸»æœåŠ¡å™¨ç”¨æ¥å¤„ç†å†™æ“ä½œï¼Œä»æœåŠ¡å™¨åªæä¾›è¯»æ“ä½œï¼Œä¸è¿‡ä¸»ä»å¤åˆ¶æ˜¯æ‰€æœ‰å†…å®¹å®Œå…¨ä¸€è‡´çš„ï¼Œè€Œä¸æ˜¯åˆ†åº“åˆ†è¡¨çš„ï¼Œä¸¥æ ¼æ¥è¯´ä¸ç®—é›†ç¾¤ã€‚\nä¸»ä»å¤åˆ¶æ¨¡å¼æœ€å¤§çš„é—®é¢˜æ˜¯åªæœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œæ²¡æœ‰å®ç°é«˜å¯ç”¨ï¼Œæ‰€ä»¥è¿˜éœ€è¦å“¨å…µæœºåˆ¶æ¥å®ç°é«˜å¯ç”¨ã€‚\nä¸»ä»åŒæ­¥è¿‡ç¨‹\nå½“å¯åŠ¨ä¸€ä¸ª slave node çš„æ—¶å€™ï¼Œå®ƒä¼šå‘é€ä¸€ä¸ª PSYNC &lt;runid&gt; &lt;offset&gt; å‘½ä»¤ç»™ master nodeã€‚\nå¦‚æœè¿™æ˜¯ slave node åˆæ¬¡è¿æ¥åˆ° master nodeï¼Œé‚£ä¹ˆä¼šè§¦å‘ä¸€æ¬¡ full resynchronization å…¨é‡å¤åˆ¶ï¼ˆæ¥æ”¶å‘½ä»¤åˆ¤æ–­ runid æ˜¯å¦åŒ¹é…ï¼Œåˆ¤å®š offset æ˜¯å¦åœ¨å¤åˆ¶ç¼“å†²åŒºä¸­ï¼‰ã€‚æ­¤æ—¶ master ä¼šå¯åŠ¨ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œå¼€å§‹ç”Ÿæˆä¸€ä»½ RDB å¿«ç…§æ–‡ä»¶ï¼Œ\n\n\nåŒæ—¶è¿˜ä¼šå°†ä»å®¢æˆ·ç«¯ client æ–°æ”¶åˆ°çš„æ‰€æœ‰å†™å‘½ä»¤ç¼“å­˜åœ¨ replication bufferï¼ˆredis server ä¼šä¸ºæ¯ä¸€ä¸ªè¿æ¥åˆ°è‡ªå·±çš„å®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ª replication bufferï¼Œç”¨æ¥ç¼“å­˜ä¸»åº“æ‰§è¡Œçš„å‘½ä»¤ï¼‰ä¸­ã€‚RDB æ–‡ä»¶ç”Ÿæˆå®Œæ¯•åï¼Œ master ä¼šå°†è¿™ä¸ª RDB å‘é€ç»™ slaveï¼Œslave ä¼šå…ˆå†™å…¥æœ¬åœ°ç£ç›˜ï¼Œç„¶åå†ä»æœ¬åœ°ç£ç›˜åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¿‡ç¨‹ä¸­åŸºäºæ—§çš„æ•°æ®å¯¹å¤–æä¾›æœåŠ¡ã€‚\n\nå¦‚æœ replication buffer å†™æ»¡äº†ï¼ˆclient-output-buffer-limitï¼‰ï¼Œæ— è®ºå®¢æˆ·ç«¯æ˜¯æ™®é€šå®¢æˆ·ç«¯è¿˜æ˜¯ä»åº“ï¼Œåªèƒ½æ–­å¼€è·Ÿè¿™ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥äº†ã€‚è¿™æ ·ä»åº“å…¨é‡åŒæ­¥å¤±è´¥ï¼Œåªèƒ½å†æ¬¡å°è¯•å…¨é‡åŒæ­¥ã€‚\n\n\n\næ¥ç€ master ä¼šå°†å†…å­˜ä¸­ç¼“å­˜çš„å†™å‘½ä»¤å‘é€åˆ° slaveï¼Œslave ä¹Ÿä¼šåŒæ­¥è¿™äº›æ•°æ®ã€‚\n\nå¦‚æœ slave node å¼€å¯äº† AOFï¼Œé‚£ä¹ˆç«‹å³æ‰§è¡Œé‡å†™ AOF\n\n\n\nslave node å¦‚æœè·Ÿ master node æœ‰ç½‘ç»œæ•…éšœï¼Œæ–­å¼€äº†è¿æ¥ï¼Œä¼šè‡ªåŠ¨é‡è¿ï¼Œè¿æ¥ä¹‹å master node ä»…ä¼šå¤åˆ¶ç»™ slave éƒ¨åˆ†ç¼ºå°‘çš„æ•°æ®ã€‚ï¼ˆä¸»åº“çš„å†™å‘½ä»¤ï¼Œé™¤äº†ä¼ ç»™ä»åº“åï¼Œè¿˜ä¼šå†™å…¥ repl_backlog_bufferï¼‰\n\n\nå¦‚æœä»åº“ç»™çš„ runid å’Œ offset éƒ½æ˜¯å¯¹çš„ï¼Œé‚£ä¹ˆä¸»æœåŠ¡å™¨å°±ä¼šä»ä¸Šæ¬¡åŒæ­¥çš„ offset ä½ç½®å¼€å§‹è¿›è¡Œå¢é‡åŒæ­¥\n\n\nå¦‚æœ offset å·²ç»å°äºäº†ä¸»çš„å¤åˆ¶ç¼“å†²åŒºä¸­æœ€å°çš„é‚£ä¸ªåç§»é‡ï¼Œå°±ä¼šè¿›è¡Œå…¨é‡å¤åˆ¶\n\n\nåˆ‡æ¢äº†ä¸»æœåŠ¡å™¨ä¹Ÿä¼šè¿›è¡Œå…¨é‡å¤åˆ¶\n\n\n\nä»€ä¹ˆæ˜¯ Redis å“¨å…µï¼Ÿ\nsentinelï¼ˆå“¨å…µï¼‰æ˜¯ç”¨äºç›‘æ§ Redis é›†ç¾¤ä¸­ Master çŠ¶æ€çš„å·¥å…·ï¼Œå…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„è¿›ç¨‹ï¼Œæ˜¯ Redis çš„é«˜å¯ç”¨è§£å†³æ–¹æ¡ˆã€‚\nsentinel å¯ä»¥ç›‘è§†ä¸€ä¸ªæˆ–è€…å¤šä¸ª Redis master æœåŠ¡ï¼Œä»¥åŠè¿™äº› master æœåŠ¡çš„æ‰€æœ‰ä»æœåŠ¡ï¼›å½“æŸä¸ª master æœåŠ¡ä¸‹çº¿æ—¶ï¼Œè‡ªåŠ¨å°†è¯¥ master ä¸‹çš„æŸä¸ªä»æœåŠ¡å‡çº§ä¸º master æœåŠ¡æ›¿ä»£å·²ä¸‹çº¿çš„ master æœåŠ¡ç»§ç»­å¤„ç†è¯·æ±‚ï¼Œå¹¶ä¸”å…¶ä½™ä»èŠ‚ç‚¹å¼€å§‹ä»æ–°çš„ä¸»èŠ‚ç‚¹å¤åˆ¶æ•°æ®ã€‚ï¼ˆå®ƒä¼šç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ¥å®ç°ä¿®æ”¹ä¸»æœåŠ¡å™¨ï¼‰\nåœ¨ Redis å®‰è£…å®Œæˆåï¼Œä¼šæœ‰ä¸€ä¸ª redis-sentinel çš„æ–‡ä»¶ï¼Œè¿™å°±æ˜¯å¯åŠ¨ sentinel çš„è„šæœ¬æ–‡ä»¶ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ª sentinel.conf æ–‡ä»¶ï¼Œè¿™ä¸ªæ˜¯ sentinel çš„é…ç½®æ–‡ä»¶ã€‚\nä½†å“¨å…µä¹Ÿå¯èƒ½ä¼šæŒ‚ï¼Œæ‰€ä»¥éœ€è¦å¯¹å“¨å…µä¹Ÿå®ç°é«˜å¯ç”¨ï¼ˆé›†ç¾¤ï¼‰ã€‚\nå“¨å…µçš„æ ¸å¿ƒçŸ¥è¯†\nå“¨å…µè‡³å°‘éœ€è¦ 3 ä¸ªå®ä¾‹ï¼Œæ¥ä¿è¯è‡ªå·±çš„å¥å£®æ€§ã€‚\nå“¨å…µ + Redis ä¸»ä»çš„éƒ¨ç½²æ¶æ„ï¼Œæ˜¯ä¸ä¿è¯æ•°æ®é›¶ä¸¢å¤±çš„ï¼Œåªèƒ½ä¿è¯ Redis é›†ç¾¤çš„é«˜å¯ç”¨æ€§ã€‚\nå¯¹äºå“¨å…µ + Redis ä¸»ä»è¿™ç§å¤æ‚çš„éƒ¨ç½²æ¶æ„ï¼Œå°½é‡åœ¨æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼Œéƒ½è¿›è¡Œå……è¶³çš„æµ‹è¯•å’Œæ¼”ç»ƒã€‚\nä¸ºä»€ä¹ˆè¦æ­å»º Redis é›†ç¾¤ï¼Ÿ\nRedis æœ‰å†…ç½®é›†ç¾¤ clusterï¼ŒRedis cluster æ˜¯æ— ä¸­å¿ƒèŠ‚ç‚¹çš„é›†ç¾¤æ¶æ„ï¼Œæœ¬èº«å°±æ˜¯å»ä¸­å¿ƒåŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¿å­˜å„è‡ªçš„æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è¿æ¥ï¼Œè€Œä¸”è¿™äº›è¿æ¥ä¿æŒæ´»è·ƒï¼Œè¿™æ ·å°±ä¿è¯äº†æˆ‘ä»¬åªéœ€è¦è¿æ¥é›†ç¾¤ä¸­çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å¯ä»¥è·å–åˆ°å…¶ä»–èŠ‚ç‚¹çš„æ•°æ®ã€‚\ncluster é›†ç¾¤ä¸­å†…ç½®äº†å“¨å…µæœºåˆ¶ï¼Œä¸éœ€è¦å†é¢å¤–å¯åŠ¨å“¨å…µç¨‹åºã€‚\nRedis cluster ä¸ºäº†ä¿è¯æ•°æ®çš„é«˜å¯ç”¨ï¼ŒåŠ å…¥äº†ä¸»ä»æ¨¡å¼ï¼Œä¸»èŠ‚ç‚¹åªç”¨æ¥å­˜ï¼Œä»èŠ‚ç‚¹åªç”¨æ¥å–ï¼Œå¦‚æœä¸»èŠ‚ç‚¹æŒ‚æ‰äº†ï¼Œå°±ä¼šåœ¨ä»èŠ‚ç‚¹ä¸­é€‰å–ä¸€ä¸ªæ¥å……å½“ä¸»èŠ‚ç‚¹ã€‚å½“ç„¶ï¼Œå¦‚æœé€šè¿‡é›†ç¾¤å‘½ä»¤ï¼Œè¿˜å¯ä»¥å®ç°åœ¨ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å†™å…¥ã€‚\nRedis é›†ç¾¤å·¥ä½œæµç¨‹\n\n\né€šè¿‡å“ˆå¸Œçš„æ–¹å¼ï¼Œå°†æ•°æ®åˆ†ç‰‡ï¼Œæ¯ä¸ªèŠ‚ç‚¹å‡åˆ†å­˜å‚¨ä¸€å®šå“ˆå¸Œæ§½ (å“ˆå¸Œå€¼) åŒºé—´çš„æ•°æ®ï¼Œé»˜è®¤åˆ†é…äº† 16384 ä¸ªæ§½ä½\n\n\næ¯ä»½æ•°æ®åˆ†ç‰‡ä¼šå­˜å‚¨åœ¨å¤šä¸ªäº’ä¸ºä¸»ä»çš„å¤šèŠ‚ç‚¹ä¸Š\n\n\næ•°æ®å†™å…¥å…ˆå†™ä¸»èŠ‚ç‚¹ï¼Œå†åŒæ­¥åˆ°ä»èŠ‚ç‚¹ (æ”¯æŒé…ç½®ä¸ºé˜»å¡åŒæ­¥)\n\n\nåŒä¸€åˆ†ç‰‡å¤šä¸ªèŠ‚ç‚¹é—´çš„æ•°æ®ä¸ä¿æŒä¸€è‡´æ€§\n\n\nè¯»å–æ•°æ®æ—¶ï¼Œå½“å®¢æˆ·ç«¯æ“ä½œçš„ key æ²¡æœ‰åˆ†é…åœ¨è¯¥èŠ‚ç‚¹ä¸Šæ—¶ï¼Œredis ä¼šè¿”å›è½¬å‘æŒ‡ä»¤ï¼ŒæŒ‡å‘æ­£ç¡®çš„èŠ‚ç‚¹\n\n\næ‰©å®¹æ—¶æ—¶éœ€è¦éœ€è¦æŠŠæ—§èŠ‚ç‚¹çš„æ•°æ®è¿ç§»ä¸€éƒ¨åˆ†åˆ°æ–°èŠ‚ç‚¹\n\n\nåœ¨ redis cluster æ¶æ„ä¸‹ï¼Œæ¯ä¸ª redis è¦æ”¾å¼€ä¸¤ä¸ªç«¯å£å·ï¼Œæ¯”å¦‚ä¸€ä¸ªæ˜¯ 6379ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ åŠ  1w çš„ç«¯å£å·ï¼Œæ¯”å¦‚ 16379ã€‚\n16379 ç«¯å£å·æ˜¯ç”¨æ¥è¿›è¡ŒèŠ‚ç‚¹é—´é€šä¿¡çš„ï¼Œä¹Ÿå°±æ˜¯ cluster bus çš„ä¸œè¥¿ï¼Œcluster bus çš„é€šä¿¡ï¼Œç”¨æ¥è¿›è¡Œæ•…éšœæ£€æµ‹ã€é…ç½®æ›´æ–°ã€æ•…éšœè½¬ç§»æˆæƒã€‚cluster bus ç”¨äº†å¦å¤–ä¸€ç§äºŒè¿›åˆ¶çš„åè®®ï¼Œgossip åè®®ï¼Œç”¨äºèŠ‚ç‚¹é—´è¿›è¡Œé«˜æ•ˆçš„æ•°æ®äº¤æ¢ï¼Œå ç”¨æ›´å°‘çš„ç½‘ç»œå¸¦å®½å’Œå¤„ç†æ—¶é—´ã€‚\nä½ çŸ¥é“å“ªäº›åˆ†å¸ƒå¼å¯»å€æ³•ï¼Ÿ\nhash ç®—æ³•ï¼ˆå¤§é‡ç¼“å­˜é‡å»ºï¼‰\nä¸€è‡´æ€§ hash ç®—æ³•ï¼ˆè‡ªåŠ¨ç¼“å­˜è¿ç§»ï¼‰+ è™šæ‹ŸèŠ‚ç‚¹ï¼ˆè‡ªåŠ¨è´Ÿè½½å‡è¡¡ï¼‰\nredis cluster çš„ hash slot ï¼ˆæ§½ï¼‰ç®—æ³•\nä½ äº†è§£ä¸€è‡´æ€§å“ˆå¸Œå—ï¼Ÿ\nç®€å•æ¥è¯´ï¼Œä¸€è‡´æ€§ Hash ç®—æ³•å°†æ•´ä¸ªå“ˆå¸Œå€¼ç©ºé—´ç»„ç»‡æˆä¸€ä¸ªè™šæ‹Ÿçš„åœ†ç¯ï¼Œæ•´ä¸ªç©ºé—´åœ†æŒ‰é¡ºæ—¶é’ˆæ–¹å‘å¸ƒå±€ï¼Œæ­£ä¸Šæ–¹ç‚¹ä»£è¡¨ 0ï¼Œä¹Ÿä»£è¡¨ 2^32-1ï¼Œå³ä¸€å…± 2^32 ä¸ªç‚¹ç»„æˆçš„åœ†ç¯ç§°ä¸º Hash ç¯ã€‚\nä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å¯ç”¨äº Redis çš„é›†ç¾¤æ­å»ºï¼Œå½“ç„¶è¿™ç§ç”¨æ³•å·²ç»è¿‡æ—¶äº†ï¼Œç°åœ¨å¯ä»¥ç”¨ Redis cluster çš„å“ˆå¸Œæ§½æ¥æ›¿ä»£ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ï¼Œå®ç°é›†ç¾¤æ­å»ºã€‚\nä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ—¶ï¼Œå¤šä¸ªæœåŠ¡å™¨ä¹Ÿä¼šè½åœ¨è¿™ä¸ª Hash ç¯ä¸Šï¼Œå¹¶ä¸”èƒ½ç¡®å®šå„è‡ªçš„ä½ç½®ï¼Œè¿™æ ·ç”¨æˆ·è®¿é—®çš„æ—¶å€™ï¼Œä¼šæ ¹æ®ç”¨æˆ· IP è®¡ç®—å‡ºå“ˆå¸Œå€¼ï¼Œå¯¹åº”åˆ°å“ˆå¸Œç¯ä¸Šï¼Œå¹¶é¡ºæ—¶é’ˆè¡Œèµ°ï¼Œé‡åˆ°çš„ç¬¬ä¸€å°æœåŠ¡å™¨å°±æ˜¯è¯¥ç”¨æˆ·è¢«åˆ†é…åˆ°çš„æœåŠ¡å™¨ã€‚\nä½†æ˜¯ä¸€è‡´æ€§å“ˆå¸Œä¼šæœ‰æ•°æ®å€¾æ–œçš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½å¤šå°æœåŠ¡å™¨èšé›†åœ¨ç›¸è¿‘çš„åœ°æ–¹ï¼Œè¿™æ—¶å°±éœ€è¦å°†æœåŠ¡å™¨å¤šæ„å»ºå‡ ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œæ¥åˆ†æ•£åˆ° Hash ç¯ä¸Šçš„å„ä¸ªä½ç½®ï¼Œæ¥ä½¿æ•°æ®åˆ†é…çš„æœåŠ¡å™¨è¾ƒä¸ºå‡è¡¡ï¼Œè®¾ç½®çš„è™šæ‹ŸèŠ‚ç‚¹çº¦å¤šï¼Œæ•°æ®åˆ†é…çš„è¶Šæ˜¯ç›¸å¯¹å‡åŒ€ã€‚\nRedis é›†ç¾¤æ˜¯åŒæ­¥å¤åˆ¶è¿˜æ˜¯å¼‚æ­¥å¤åˆ¶ï¼Ÿæ˜¯å¦ä¼šæœ‰å†™æ“ä½œä¸¢å¤±æƒ…å†µï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\nå¼‚æ­¥å¤åˆ¶ã€‚\nRedis ä¸»èŠ‚ç‚¹ä¸ä»èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®å¤åˆ¶æ˜¯å¼‚æ­¥å¤åˆ¶çš„ï¼Œå½“å®¢æˆ·ç«¯å‘é€å†™è¯·æ±‚ç»™ master èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯ä¼šç›´æ¥è¿”å› OKï¼Œç„¶åä¸»èŠ‚ç‚¹åŒæ­¥åˆ°å„ä¸ªä»èŠ‚ç‚¹ä¸­ã€‚\nå¦‚æœä¸»èŠ‚ç‚¹æ²¡æ¥å¾—åŠåŒæ­¥ç»™ä»èŠ‚ç‚¹æ—¶å‘ç”Ÿå®•æœºï¼Œé‚£ä¹ˆä¸»èŠ‚ç‚¹å†…å­˜ä¸­çš„æ•°æ®å°±ä¼šä¸¢å¤±ã€‚\nå¦‚æœä¸»èŠ‚ç‚¹ä¸­å¼€å¯æŒä¹…åŒ–ï¼Œèƒ½ä¸èƒ½ä¿è¯æ•°æ®ä¸ä¸¢å¤±å‘¢ï¼Ÿ\nä¸èƒ½ã€‚\nä¸»èŠ‚ç‚¹å®•æœºåï¼ˆè„‘è£‚ä¹Ÿä¼šæœ‰ç›¸åŒçš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼‰ï¼Œä¼šè‡ªåŠ¨å¯åŠ¨å“¨å…µæœºåˆ¶ï¼Œé‡æ–°é€‰ä¸¾æ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¦‚æœè¿™æ—¶å€™æ—§çš„ä¸»èŠ‚ç‚¹æ¢å¤æ•…éšœé‡å¯äº†ï¼Œå®ƒå°±ä¼šå»åŒæ­¥æ–°çš„ä¸»èŠ‚ç‚¹æ•°æ®ï¼Œè€Œè¿™æ—¶æ–°çš„ä¸»èŠ‚ç‚¹å¹¶æ²¡æœ‰åŒæ­¥é‚£ä¹‹å‰ä¸¢å¤±çš„æ•°æ®ï¼Œæ—§çš„ä¸»èŠ‚ç‚¹çš„ä¸Šçš„æ•°æ®åˆ™ä¼šåœ¨åŒæ­¥æ–°ä¸»èŠ‚ç‚¹ä¸Šæ•°æ®æ—¶ï¼Œåˆ·æ–°æ‰ï¼Œæ­¤æ—¶æ•°æ®è¿˜æ˜¯ä¼šä¸¢å¤±ã€‚\næ€ä¹ˆæ‰èƒ½ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Ÿæˆ–è€…å¦‚ä¿è¯å°½é‡å°‘çš„æ•°æ®ä¸¢å¤±ï¼Ÿ\næ²¡åŠæ³•å®Œå…¨ä¿è¯æ•°æ®ä¸ä¸¢å¤±ã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡è®¾ç½®ä¸»ä»èŠ‚ç‚¹é—´çš„åŒæ­¥å¤åˆ¶å»¶è¿Ÿæ—¶é—´æ¥å°½é‡å°‘çš„æ•°æ®ä¸¢å¤±ã€‚\næ¯”å¦‚ï¼Œåœ¨ Redis é›†ç¾¤ä¸­ï¼Œåœ¨ redis é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹åŒæ­¥å¤åˆ¶å»¶è¿Ÿçš„æ—¶é—´ä¸è¶…è¿‡ 10sï¼Œä¸€ä½†å»¶è¿Ÿè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œè¯´æ˜ä¸»èŠ‚ç‚¹å¯èƒ½å‡ºäº†é—®é¢˜ï¼ˆä¸ä¸€å®šæ˜¯å®•æœºï¼‰ï¼Œé‚£ä¹ˆé…ç½®ç”Ÿæ•ˆï¼Œä¸»èŠ‚ç‚¹åªèƒ½è¯»ï¼Œä¸èƒ½å†å†™å…¥ã€‚\n\n\nmin-slaves-to-write 1\n\n\nmin-slaves-max-lag 10\n\n\nè¦æ±‚è‡³å°‘æœ‰ 1 ä¸ª slaveï¼Œæ•°æ®å¤åˆ¶å’ŒåŒæ­¥çš„å»¶è¿Ÿä¸èƒ½è¶…è¿‡ 10 ç§’ï¼ˆè¿™æ ·è„‘è£‚æœ€å¤šå°±ä¸¢å¤± 10s æ•°æ®ï¼‰\n\n\nåŒæ—¶åœ¨å®¢æˆ·ç«¯åšé™çº§å¤„ç†ï¼ŒæŠŠæ•°æ®å†™åˆ°æœ¬åœ°ç£ç›˜ã€‚\nä»€ä¹ˆæ˜¯ Redis è„‘è£‚ï¼Ÿä¼šå­˜åœ¨ä»€ä¹ˆé—®é¢˜ï¼Ÿ\nä¸€ä¸ªé›†ç¾¤ä¸­çš„ master æ°å¥½ç½‘ç»œæ•…éšœï¼Œå¯¼è‡´ä¸ sentinal è”ç³»ä¸ä¸Šäº†ï¼Œsentinal æŠŠå¦ä¸€ä¸ª slave æå‡ä¸ºäº† masterã€‚æ­¤æ—¶å°±å­˜åœ¨ä¸¤ä¸ª master äº†ã€‚\nå½“æˆ‘ä»¬å‘ç°çš„æ—¶å€™ï¼Œåœæ­¢æ‰å…¶ä¸­çš„ä¸€ä¸ª masterï¼Œæ‰‹åŠ¨åˆ‡æ¢æˆ slaveï¼Œå½“å®ƒè¿æ¥åˆ°æå‡åçš„ master çš„æ—¶å€™ï¼Œä¼šå¼€å§‹åŒæ­¥æ•°æ®ï¼Œé‚£ä¹ˆè‡ªå·±è„‘è£‚æœŸé—´æ¥æ”¶çš„å†™æ•°æ®å°±è¢«ä¸¢å¤±äº†ã€‚\nRedis é›†ç¾¤å¦‚ä½•é€‰æ‹©æ•°æ®åº“ï¼Ÿ\nRedis é›†ç¾¤ç›®å‰æ— æ³•åšæ•°æ®åº“é€‰æ‹©ï¼Œé»˜è®¤åœ¨ 0 æ•°æ®åº“ã€‚\nRedis é›†ç¾¤æœ€å¤§èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¤šå°‘ï¼Ÿ\n16384 ä¸ª\nç”Ÿäº§ç¯å¢ƒä¸­çš„ redis æ˜¯æ€ä¹ˆéƒ¨ç½²çš„ï¼Ÿ\nredis clusterï¼Œ10 å°æœºå™¨ï¼Œ5 å°æœºå™¨éƒ¨ç½²äº† redis ä¸»å®ä¾‹ï¼Œå¦å¤– 5 å°æœºå™¨éƒ¨ç½²äº† redis çš„ä»å®ä¾‹ï¼Œæ¯ä¸ªä¸»å®ä¾‹æŒ‚äº†ä¸€ä¸ªä»å®ä¾‹ï¼Œ5 ä¸ªèŠ‚ç‚¹å¯¹å¤–æä¾›è¯»å†™æœåŠ¡ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„è¯»å†™é«˜å³° qps å¯èƒ½å¯ä»¥è¾¾åˆ°æ¯ç§’ 5 ä¸‡ï¼Œ5 å°æœºå™¨æœ€å¤šæ˜¯ 25 ä¸‡è¯»å†™è¯·æ±‚/sã€‚\n\n\næœºå™¨æ˜¯ä»€ä¹ˆé…ç½®ï¼Ÿ32G å†…å­˜ + 8 æ ¸ CPU + 1T ç£ç›˜ï¼Œä½†æ˜¯åˆ†é…ç»™ redis è¿›ç¨‹çš„æ˜¯ 10g å†…å­˜ï¼Œä¸€èˆ¬çº¿ä¸Šç”Ÿäº§ç¯å¢ƒï¼Œredis çš„å†…å­˜å°½é‡ä¸è¦è¶…è¿‡ 10gï¼Œè¶…è¿‡ 10g å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚\n\n\n5 å°æœºå™¨å¯¹å¤–æä¾›è¯»å†™ï¼Œä¸€å…±æœ‰ 50g å†…å­˜ã€‚\n\n\nå› ä¸ºæ¯ä¸ªä¸»å®ä¾‹éƒ½æŒ‚äº†ä¸€ä¸ªä»å®ä¾‹ï¼Œæ‰€ä»¥æ˜¯é«˜å¯ç”¨çš„ï¼Œä»»ä½•ä¸€ä¸ªä¸»å®ä¾‹å®•æœºï¼Œéƒ½ä¼šè‡ªåŠ¨æ•…éšœè¿ç§»ï¼Œredis ä»å®ä¾‹ä¼šè‡ªåŠ¨å˜æˆä¸»å®ä¾‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ã€‚\n\n\nä½ å¾€å†…å­˜é‡Œå†™çš„æ˜¯ä»€ä¹ˆæ•°æ®ï¼Ÿæ¯æ¡æ•°æ®çš„å¤§å°æ˜¯å¤šå°‘ï¼Ÿå•†å“æ•°æ®ï¼Œæ¯æ¡æ•°æ®æ˜¯ 10kbã€‚100 æ¡æ•°æ®æ˜¯ 1mbï¼Œ10 ä¸‡æ¡æ•°æ®æ˜¯ 1gã€‚å¸¸é©»å†…å­˜çš„æ˜¯ 200 ä¸‡æ¡å•†å“æ•°æ®ï¼Œå ç”¨å†…å­˜æ˜¯ 20gï¼Œä»…ä»…ä¸åˆ°æ€»å†…å­˜çš„ 50%ã€‚ç›®å‰é«˜å³°æœŸæ¯ç§’å°±æ˜¯ 3500 å·¦å³çš„è¯·æ±‚é‡ã€‚å…¶å®å¤§å‹çš„å…¬å¸ï¼Œä¼šæœ‰åŸºç¡€æ¶æ„çš„ team è´Ÿè´£ç¼“å­˜é›†ç¾¤çš„è¿ç»´ã€‚\n\n\nç¼“å­˜å¼‚å¸¸\nç¼“å­˜é¢„çƒ­\nç³»ç»Ÿä¸Šçº¿åï¼Œå°†ç›¸å…³çš„ç¼“å­˜æ•°æ®ç›´æ¥åŠ è½½åˆ°ç¼“å­˜ç³»ç»Ÿã€‚è¿™æ ·å°±å¯ä»¥é¿å…åœ¨ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åå†å°†æ•°æ®ç¼“å­˜çš„é—®é¢˜ã€‚ç”¨æˆ·ç›´æ¥æŸ¥è¯¢äº‹å…ˆè¢«é¢„çƒ­çš„ç¼“å­˜æ•°æ®ã€‚\nè§£å†³æ–¹æ³•\n\n\nè‡ªåŠ¨ï¼šä½¿ç”¨ç›‘å¬å™¨ï¼ˆweb/Spring bootï¼‰ç›‘å¬æŸä¸ªäº‹ä»¶ï¼ˆé¡¹ç›®å¯åŠ¨/å®¹å™¨çš„åˆ›å»ºï¼‰ï¼Œåœ¨äº‹ä»¶è§¦å‘æ—¶æŸ¥è¯¢æ•°æ®åº“ï¼ŒæŠŠä¸€äº›çƒ­é—¨æ•°æ®æå‰ç¼“å­˜åˆ° Redis ä¸­\n\n\næ‰‹åŠ¨ï¼šä½¿ç”¨å•å…ƒæµ‹è¯•è„šæœ¬ åŠ¨æ€çš„å¾€ Redis ä¸­è¿›è¡Œæ•°æ®çš„æ·»åŠ \n\n\nç¼“å­˜é›ªå´©\nç¼“å­˜åŒä¸€æ—¶é—´å¤§é¢ç§¯çš„å¤±æ•ˆï¼Œæ‰€ä»¥ï¼Œåé¢çš„è¯·æ±‚éƒ½ä¼šè½åˆ°æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“çŸ­æ—¶é—´å†…æ‰¿å—å¤§é‡è¯·æ±‚è€Œå´©æ‰ã€‚\nè§£å†³æ–¹æ³•\n\n\nè®¾ç½®ç¼“å­˜çš„å¤±æ•ˆæ—¶é—´å°½é‡é”™å¼€ï¼ˆæ¯”å¦‚ 30 å¤© + éšæœºæ•° (s)ï¼‰ï¼Œçƒ­é—¨æ•°æ®æ—¶é—´é•¿ç‚¹ï¼Œä¸çƒ­é—¨çš„æ—¶é—´çŸ­ç‚¹ã€‚\n\n\nè®¾ç½®å¤šçº§ç¼“å­˜ï¼ŒNginx ç¼“å­˜ +redis ç¼“å­˜ +ehcache ç¼“å­˜â€¦â€¦æ¯ä¸€ä¸ªç¼“å­˜éƒ½æ˜¯ä¸€ä¸ªé›†ç¾¤ï¼Œç›¸åŒçš„æ•°æ®ä¼šåœ¨å¤šç§æœåŠ¡å™¨è¿›è¡Œç¼“å­˜ï¼Œå¯ä»¥ 100% è§£å†³ç¼“å­˜é›ªå´©ã€‚\n\n\nä¾§é¢è§£å†³ï¼šä¼˜åŒ–æ•°æ®åº“ï¼Œæå‡æ•ˆç‡ï¼Œä½¿ç”¨é¡µé¢é™æ€æŠ€æœ¯ï¼ˆå¤šçº§ç¼“å­˜ï¼‰ä»£æ›¿ä» redis ä¸­å–å€¼ã€‚\n\n\né™æµ/é™çº§\n\n\nè¶…çƒ­æ•°æ®ä½¿ç”¨æ°¸ä¹… Keyï¼ˆå®šæœŸç»´æŠ¤ï¼‰\n\n\nç¼“å­˜ç©¿é€\nå°±æ˜¯æŒ‡åå¤æŸ¥è¯¢ä¸€ä¸ªæ•°æ®åº“ä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬åªæœ‰æ¶æ„æ”»å‡»æ‰ä¼šå‡ºç°ã€‚\nè§£å†³æ–¹æ³•\n\n\næ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œå¦‚ç”¨æˆ·é‰´æƒæ ¡éªŒï¼Œid åšåŸºç¡€æ ¡éªŒï¼Œid&lt;=0 çš„ç›´æ¥æ‹¦æˆª\n\n\nä»ç¼“å­˜å–ä¸åˆ°çš„æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰å–åˆ°ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥å°† key-value å¯¹å†™ä¸º key-nullï¼Œç¼“å­˜æœ‰æ•ˆæ—¶é—´å¯ä»¥è®¾ç½®çŸ­ç‚¹ï¼Œå¦‚ 30 ç§’ï¼ˆè®¾ç½®å¤ªé•¿ä¼šå¯¼è‡´æ­£å¸¸æƒ…å†µä¹Ÿæ²¡æ³•ä½¿ç”¨ï¼‰ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ”»å‡»ç”¨æˆ·åå¤ç”¨åŒä¸€ä¸ª id æš´åŠ›æ”»å‡»\n\n\né‡‡ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆåœ¨æµ·é‡æ•°æ®ä¸­åˆ¤æ–­ä¸€ä¸ªæ•°æ®æ˜¯å¦å­˜åœ¨ï¼‰ï¼Œå°†æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„æ•°æ®å“ˆå¸Œåˆ°ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ bitmap ä¸­ï¼Œä¸€ä¸ªä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ä¼šè¢«è¿™ä¸ª bitmap æ‹¦æˆªæ‰ï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢å‹åŠ›ã€‚æ ¹æ® Hash åˆ¤æ–­ï¼Œå¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¸€å®šä¸å­˜åœ¨ã€‚\n\n\nåŠ å¯†å‚æ•°ï¼Œç¬¦åˆåŠ å¯†è§„åˆ™çš„å‚æ•°æ‰ä¼šè¢«æ¥æ”¶\n\n\nç¼“å­˜å‡»ç©¿\næ˜¯æŒ‡ä¸€ä¸ªçƒ­ç‚¹ key çš„ redis ç¼“å­˜å¤±æ•ˆï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚ç¬é—´é›†ä¸­åˆ°æ•°æ®åº“ã€‚å’Œç¼“å­˜é›ªå´©ä¸åŒçš„æ˜¯ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯ä¸åŒæ•°æ®éƒ½è¿‡æœŸäº†ï¼Œå¾ˆå¤šæ•°æ®éƒ½æŸ¥ä¸åˆ°ä»è€ŒæŸ¥æ•°æ®åº“ã€‚\nè§£å†³æ–¹æ³•\n\n\nå¤šçº§ç¼“å­˜\n\n\nå»¶é•¿çƒ­ç‚¹æ•°æ®æœ‰æ•ˆæœŸã€‚\n\n\né™æµ/é™çº§\n\n\nç¼“å­˜é™çº§\nå½“è®¿é—®é‡å‰§å¢ã€æœåŠ¡å‡ºç°é—®é¢˜ï¼ˆå¦‚å“åº”æ—¶é—´æ…¢æˆ–ä¸å“åº”ï¼‰æˆ–éæ ¸å¿ƒæœåŠ¡å½±å“åˆ°æ ¸å¿ƒæµç¨‹çš„æ€§èƒ½æ—¶ï¼Œä»ç„¶éœ€è¦ä¿è¯æœåŠ¡è¿˜æ˜¯å¯ç”¨çš„ï¼Œå³ä½¿æ˜¯æœ‰æŸæœåŠ¡ã€‚ç³»ç»Ÿå¯ä»¥æ ¹æ®ä¸€äº›å…³é”®æ•°æ®è¿›è¡Œè‡ªåŠ¨é™çº§ï¼Œä¹Ÿå¯ä»¥é…ç½®å¼€å…³å®ç°äººå·¥é™çº§ã€‚\nçƒ­ç‚¹æ•°æ®å’Œå†·æ•°æ®\n\n\nçƒ­ç‚¹æ•°æ®ï¼Œç¼“å­˜æ‰æœ‰ä»·å€¼\n\næŸ IM äº§å“ï¼Œç”Ÿæ—¥ç¥ç¦æ¨¡å—ï¼Œå½“å¤©çš„å¯¿æ˜Ÿåˆ—è¡¨ï¼Œç¼“å­˜ä»¥åå¯èƒ½è¯»å–æ•°åä¸‡æ¬¡ã€‚æŸå¯¼èˆªäº§å“ï¼Œæˆ‘ä»¬å°†å¯¼èˆªä¿¡æ¯ï¼Œç¼“å­˜ä»¥åå¯èƒ½è¯»å–æ•°ç™¾ä¸‡æ¬¡ã€‚\n\n\n\nå¯¹äºå†·æ•°æ®è€Œè¨€ï¼Œå¤§éƒ¨åˆ†æ•°æ®å¯èƒ½è¿˜æ²¡æœ‰å†æ¬¡è®¿é—®åˆ°å°±å·²ç»è¢«æŒ¤å‡ºå†…å­˜ï¼Œä¸ä»…å ç”¨å†…å­˜ï¼Œè€Œä¸”ä»·å€¼ä¸å¤§ã€‚\n\n\né¢‘ç¹ä¿®æ”¹çš„æ•°æ®ï¼Œçœ‹æƒ…å†µè€ƒè™‘ä½¿ç”¨ç¼“å­˜\n\nè¿™ä¸ªè¯»å–æ¥å£å¯¹æ•°æ®åº“çš„å‹åŠ›å¾ˆå¤§ï¼Œä½†æ˜¯åˆæ˜¯çƒ­ç‚¹æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è€ƒè™‘é€šè¿‡ç¼“å­˜æ‰‹æ®µï¼Œå‡å°‘æ•°æ®åº“çš„å‹åŠ›ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æŸåŠ©æ‰‹äº§å“çš„ï¼Œç‚¹èµæ•°ï¼Œæ”¶è—æ•°ï¼Œåˆ†äº«æ•°ç­‰æ˜¯éå¸¸å…¸å‹çš„çƒ­ç‚¹æ•°æ®ï¼Œä½†æ˜¯åˆä¸æ–­å˜åŒ–ï¼Œæ­¤æ—¶å°±éœ€è¦å°†æ•°æ®åŒæ­¥ä¿å­˜åˆ° Redis ç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“å‹åŠ›ã€‚\n\n\n\nçº¿ç¨‹æ¨¡å‹\nä¸ºä»€ä¹ˆ Redis æ˜¯å•çº¿ç¨‹çš„ï¼Ÿ\nRedis çš„åº•å±‚ä¸»è¦æ˜¯ä¸‰å¤§éƒ¨åˆ†ï¼šIO å¤šè·¯å¤ç”¨ç¨‹åº + é˜Ÿåˆ— + æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ã€‚è€Œæ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨å°±æ˜¯ç”¨æ¥åˆ†æ´¾æ‰§è¡Œä»»åŠ¡çš„ï¼Œä¸”å®ƒæ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥è¯´ Redis ä¹Ÿæ˜¯å•çº¿ç¨‹çš„ã€‚\næ­¤å¤–ï¼ŒRedis åº•å±‚æ˜¯åŸºäº C è¯­è¨€æ‰€å†™ï¼Œä¸”æ˜¯åŸºäºå†…å­˜è¿è¡Œï¼Œæ‰€ä»¥ä»–çš„ IO é€Ÿåº¦å¾ˆå¿«ï¼Œç›¸å¯¹æ¥è¯´ä¸»è¦è¦å ç”¨çš„æ˜¯ CPU çš„èµ„æºï¼Œå¦‚æœä½¿ç”¨å¤šçº¿ç¨‹åè€Œä¼šå› ä¸ºçº¿ç¨‹çš„åˆ‡æ¢å¢å¤§å¼€é”€ï¼Œé™ä½æ•ˆç‡ã€‚å¯¹äºä¸æ˜¯å¤„ç†æµ·é‡æ•°æ®ï¼Œå¤šç”¨äºç¼“å­˜ä½¿ç”¨çš„ Redis æ¥è¯´ï¼Œä½¿ç”¨å•çº¿ç¨‹æ˜¯æ•ˆç‡æœ€ä¼˜çš„ã€‚\nRedis æ˜¯å•çº¿ç¨‹çš„ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ç”¨å®ƒå®ç°åˆ†å¸ƒå¼é”ï¼Ÿ\nRedis å•çº¿ç¨‹ä¸åˆ†å¸ƒå¼é”æ²¡æœ‰å…³ç³»ã€‚Redis å•çº¿ç¨‹åªèƒ½ä¿è¯åœ¨ Redis ä¸­çš„è¯»å†™æ˜¯æŒ‰ä¸€å®šé¡ºåºæ‰§è¡Œï¼ˆRedis ä¸ä¿è¯åŸå­æ€§ï¼Œä¹Ÿä¸ä¼šå›æ»šï¼ŒæŸæ¡å‘½ä»¤è¿è¡Œå¤±è´¥ä¹Ÿä¼šç»§ç»­æ‰§è¡Œï¼‰ï¼Œä½†åœ¨åˆ†å¸ƒå¼ä¸­ï¼Œæ˜¯å¤šå°æœºå™¨é—´çš„å¤šè¿›ç¨‹è°ƒç”¨ï¼Œä¸ºäº†ä¿è¯æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸è¢«å…¶ä»–è¿›ç¨‹æŠ¢æ–­æ‰§è¡Œï¼Œéœ€è¦æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹ç»„ä»¶æ¥å®ç°åˆ†å¸ƒå¼é”ã€‚å³ä½¿æ•°æ®å°±åœ¨ Redis ä¸­ï¼Œä¹Ÿæ— æ³•ä¿è¯æ•°æ®åœ¨è¿›è¡Œå…¶ä»–æœåŠ¡å¤„ç†çš„æ—¶å€™ï¼Œè¢«å…¶ä»–è¿›ç¨‹æŠ¢èµ°ã€‚\nRedis æ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚ä½•æé«˜å¤šæ ¸ CPU çš„åˆ©ç”¨ç‡ï¼Ÿ\nå¯ä»¥åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨éƒ¨ç½²å¤šä¸ª Redis çš„å®ä¾‹ï¼Œå¹¶æŠŠä»–ä»¬å½“ä½œä¸åŒçš„æœåŠ¡å™¨æ¥ä½¿ç”¨ï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œæ— è®ºå¦‚ä½•ä¸€ä¸ªæœåŠ¡å™¨æ˜¯ä¸å¤Ÿçš„ï¼Œ æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨å¤šä¸ª CPUï¼Œä½ å¯ä»¥è€ƒè™‘ä¸€ä¸‹åˆ†åŒºã€‚\nRedis åˆ†åŒº\nä¸ºä»€ä¹ˆè¦åš Redis åˆ†åŒº\nåˆ†åŒºå¯ä»¥è®© Redis ç®¡ç†æ›´å¤§çš„å†…å­˜ï¼ŒRedis å°†å¯ä»¥ä½¿ç”¨æ‰€æœ‰æœºå™¨çš„å†…å­˜ï¼Œæå‡å†…å­˜å’Œè®¡ç®—èƒ½åŠ›ã€‚\næ€ä¹ˆå®ç° Redis åˆ†åŒºï¼Ÿ\nCluster é›†ç¾¤å°±å¾ˆå¥½çš„å®ç°äº† Redis åˆ†åŒºã€‚å®¢æˆ·ç«¯éšæœºåœ°è¯·æ±‚ä»»æ„ä¸€ä¸ª Redis å®ä¾‹ï¼Œç„¶åç”± Redis å°†è¯·æ±‚è½¬å‘ç»™æ­£ç¡®çš„ Redis èŠ‚ç‚¹ã€‚Redis Cluster å®ç°äº†ä¸€ç§æ··åˆå½¢å¼çš„æŸ¥è¯¢è·¯ç”±ï¼Œä½†å¹¶ä¸æ˜¯ç›´æ¥å°†è¯·æ±‚ä»ä¸€ä¸ª Redis èŠ‚ç‚¹è½¬å‘åˆ°å¦ä¸€ä¸ª Redis èŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨å®¢æˆ·ç«¯çš„å¸®åŠ©ä¸‹ç›´æ¥ redirected åˆ°æ­£ç¡®çš„ Redis èŠ‚ç‚¹ã€‚\nRedis åˆ†åŒºçš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\næ¶‰åŠå¤šä¸ª key çš„æ“ä½œæ—¶å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ä¸€ç‚¹ï¼šæ¯”å¦‚ä¸¤ä¸ªé›†åˆ key åœ¨ä¸åŒçš„æœºå­ä¸Šï¼Œé‚£å°±ä¸èƒ½ç›´æ¥åœ¨ Redis ä¸­åšäº¤é›†ã€‚\nRedis åˆ†åŒºå’Œé›†ç¾¤æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nåˆ†åŒºæ˜¯é€»è¾‘æ¦‚å¿µï¼Œå³ä¸€ä¸ª master å¯ä»¥åˆ†ä¸ºä¸€ä¸ª master+n ä¸ª slaveã€‚\né›†ç¾¤æ˜¯ç³»ç»Ÿç»“æ„ï¼Œé›†ç¾¤æ˜¯åˆ†åŒºæ¦‚å¿µçš„ä¸€ç§å®ç°æ–¹å¼ã€‚\nåˆ†å¸ƒå¼é—®é¢˜\né‚£æ€ä¹ˆè§£å†³ç¼“å­˜çš„å¹¶å‘ç«äº‰é—®é¢˜ï¼Ÿæ¯”å¦‚å¤šä¸ªå­ç³»ç»Ÿå» set ä¸€ä¸ª key ä½†æœ€åæ‰§è¡Œé¡ºåºå’Œæˆ‘ä»¬æœŸæœ›é¡ºåºä¸ä¸€æ ·\nå¯ä»¥é‡‡ç”¨åˆ†å¸ƒå¼é”ï¼ˆZookeeper å’Œ Redis éƒ½å¯ä»¥å®ç°åˆ†å¸ƒå¼é”ï¼‰çš„æ–¹æ¡ˆã€‚ï¼ˆå¦‚æœä¸å­˜åœ¨ Redis çš„å¹¶å‘ç«äº‰ Key é—®é¢˜ï¼Œä¸è¦ä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œè¿™æ ·ä¼šå½±å“æ€§èƒ½ï¼‰\nåŸºäº Zookeeper ä¸´æ—¶æœ‰åºèŠ‚ç‚¹å¯ä»¥å®ç°çš„åˆ†å¸ƒå¼é”ã€‚å¤§è‡´æ€æƒ³ä¸ºï¼šæ¯ä¸ªå®¢æˆ·ç«¯å¯¹æŸä¸ªæ–¹æ³•åŠ é”æ—¶ï¼Œåœ¨ Zookeeper ä¸Šçš„ä¸è¯¥æ–¹æ³•å¯¹åº”çš„æŒ‡å®šèŠ‚ç‚¹çš„ç›®å½•ä¸‹ï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ç¬æ—¶æœ‰åºèŠ‚ç‚¹ã€‚ åˆ¤æ–­æ˜¯å¦è·å–é”çš„æ–¹å¼å¾ˆç®€å•ï¼Œåªéœ€è¦åˆ¤æ–­æœ‰åºèŠ‚ç‚¹ä¸­åºå·æœ€å°çš„ä¸€ä¸ªã€‚ å½“é‡Šæ”¾é”çš„æ—¶å€™ï¼Œåªéœ€å°†è¿™ä¸ªç¬æ—¶èŠ‚ç‚¹åˆ é™¤å³å¯ã€‚åŒæ—¶ï¼Œå…¶å¯ä»¥é¿å…æœåŠ¡å®•æœºå¯¼è‡´çš„é”æ— æ³•é‡Šæ”¾ï¼Œè€Œäº§ç”Ÿçš„æ­»é”é—®é¢˜ã€‚å®Œæˆä¸šåŠ¡æµç¨‹åï¼Œåˆ é™¤å¯¹åº”çš„å­èŠ‚ç‚¹é‡Šæ”¾é”ã€‚\nåœ¨å®è·µä¸­ï¼Œå½“ç„¶æ˜¯ä»ä»¥å¯é æ€§ä¸ºä¸»ã€‚æ‰€ä»¥é¦–æ¨ Zookeeperã€‚\nè¯´ä¸€è¯´ Redis åˆ†å¸ƒå¼é”\né¦–å…ˆï¼Œåˆ†å¸ƒå¼é”æ˜¯ä¸€ç§æ€æƒ³ï¼Œæ˜¯ä¸ºäº†è§£å†³å¤šæœºå™¨å¤šè¿›ç¨‹ä¹‹é—´çš„åŒæ­¥é—®é¢˜ï¼Œéœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹æ¥åšé”å¤„ç†ã€‚\nRedis åˆ†å¸ƒå¼é”çš„åŠ é”ï¼Œå…¶å®å°±æ˜¯ç»™ Key é”®è®¾ç½®ä¸€ä¸ªå€¼ï¼ˆSET lock_key random_value NX PX 5000ï¼ŒNX è¡¨ç¤ºé”®ä¸å­˜åœ¨æ—¶æ‰è®¾ç½®ï¼‰ï¼Œå…¶ä»–è¿›ç¨‹æ‰§è¡Œå‰ä¼šåˆ¤æ–­ Redis ä¸­è¿™ä¸ª Key æ˜¯å¦æœ‰å€¼ï¼Œå¦‚æœå‘ç°è¿™ä¸ª Key æœ‰å€¼äº†ï¼Œå°±è¯´æ˜å·²æœ‰å…¶ä»–è¿›ç¨‹åœ¨æ‰§è¡Œï¼Œåˆ™å¾ªç¯ç­‰å¾…ï¼Œè¶…æ—¶åˆ™è·å–å¤±è´¥ã€‚\nè§£é”å°±æ˜¯å°† Key é”®åˆ é™¤ï¼Œä¸ºäº†ä¿è¯è§£é”çš„åŸå­æ€§æ“ä½œï¼Œç”¨ Redis è‡ªå¸¦çš„ LUA è„šæœ¬å®Œæˆæ“ä½œã€‚\nRedis åšä¸ºåˆ†å¸ƒå¼é”çš„ä¼˜ç‚¹æ˜¯æ€§èƒ½é«˜ï¼Œç¼ºç‚¹æ˜¯ä¸å¯é ï¼Œæ¯”å¦‚åœ¨ Redis é›†ç¾¤æ¶æ„ä¸­ï¼Œä¸€æ—¦ä¸»èŠ‚ç‚¹å®•æœºï¼Œæ–°çš„ä¸»èŠ‚ç‚¹ä¼šç»™æ–°è¿›ç¨‹ä¹ŸåŠ é”ã€‚\nä½†ä¸è®ºå¦‚ä½•ï¼Œåˆ†å¸ƒå¼é”ä¸€å®šä¼šå¸¦æ¥æ€§èƒ½æ¶ˆè€—é—®é¢˜ï¼Œä¸”å®é™…ä¸­ä½¿ç”¨æŸ¥è¯¢çš„æ¯”ä¾‹è¿œå¤§äºå†™çš„æ¯”ä¾‹ï¼Œé™¤éæ˜¯é‡è¦çš„æ•æ„Ÿæ•°æ®ï¼Œä¸ç„¶ä¸ºäº†æ›´é«˜çš„æ€§èƒ½ï¼Œä¸€èˆ¬ä¼šé€‰æ‹©èˆå¼ƒä½¿ç”¨åˆ†å¸ƒå¼é”ã€‚\nè¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ Lua è„šæœ¬æ¥å®Œæˆè§£é”æ“ä½œï¼Ÿ\nRedis åªèƒ½ä¿è¯å•ä¸ªæŒ‡ä»¤è¿›å…¥ Redis æ˜¯å•çº¿ç¨‹åŸå­æ€§çš„ï¼Œä½†ä¸èƒ½ä¿è¯å¤šä¸ªå‘½ä»¤ä¹‹é—´çš„é¡ºåºæ˜¯åŸå­æ€§çš„ï¼Œä½†æ˜¯ Lua æŒ‡ä»¤å¯ä»¥å°†è¿™ä¸ªå‘½ä»¤ç»‘å®šï¼Œç›¸å½“äºåªæœ‰ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤ï¼Œä¿è¯å®ƒä»¬æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚\nä¸ºä»€ä¹ˆ Redis åˆ†å¸ƒå¼è§£é”è¦ä¿è¯åŸå­æ€§ï¼Ÿ\nä¸»è¦æ˜¯æ€•è¯¯å°†å…¶ä»–å®¢æˆ·ç«¯çš„é”è§£å¼€ã€‚\næ¯”å¦‚å®¢æˆ·ç«¯ A åŠ é”ï¼Œä¸€æ®µæ—¶é—´ä¹‹åå®¢æˆ·ç«¯ A è§£é”ï¼Œåœ¨è¿›å…¥ unlock åæ‰§è¡Œ jedis.del() ä¹‹å‰ï¼Œé”çªç„¶è¿‡æœŸäº†ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯ B å°è¯•åŠ é”æˆåŠŸï¼Œç„¶åå®¢æˆ·ç«¯ A å†æ‰§è¡Œ del() æ–¹æ³•ï¼Œè¿™æ—¶å€™å®¢æˆ·ç«¯ A å·²ç»æ‰§è¡Œè¿‡ Random_Value çš„åˆ¤æ–­ï¼Œè™½ç„¶å’Œå®¢æˆ·ç«¯ B çš„ä¸ä¸€æ ·ï¼Œä½†æˆ‘ä»¬æ€»ä¸èƒ½æ¯ä¸€è¡Œä»£ç éƒ½åšä¸€ä¸ªå€¼åˆ¤æ–­å§ï¼Œè¿™æ—¶å€™å®¢æˆ·ç«¯ A å°±ä¼šå°†å®¢æˆ·ç«¯ B çš„é”ç»™è§£é™¤äº†ã€‚\nRedis åˆ†å¸ƒå¼é”åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ\nåŠ é”çš„æ—¶å€™ï¼Œåº”è€ƒè™‘åˆ°æ‰§è¡Œä¸€åŠå®•æœºæˆ–æ•…éšœå¯¼è‡´æ²¡èƒ½æ‰§è¡Œåˆ°è§£é”çš„å‘½ä»¤ï¼Œäº§ç”Ÿæ­»é”ï¼Œæ‰€ä»¥éœ€è¦ç»™å®šä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢æ­»é”ã€‚\nè§£é”è¦ä¿è¯åŸå­ä¸€è‡´æ€§ã€‚\nRedis çš„è§£é”å°±æ˜¯æŠŠ key åˆ é™¤å³å¯ï¼Œä½†æ˜¯åˆ é™¤çš„æ—¶å€™ä¸èƒ½éšä¾¿åˆ ï¼Œæ¯”å¦‚çº¿ç¨‹ A ä¸èƒ½åˆ é™¤çº¿ç¨‹ B çš„ keyï¼Œè¿™ä¸ªæ—¶å€™ value å°±èµ·åˆ°ä½œç”¨äº†ï¼Œrandom_value æˆ‘ä»¬è®¾ç½®ä¸ºéšæœºå€¼ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½ç”Ÿæˆä¸€ä¸ªéšæœºå€¼ä½œä¸º random_valueï¼Œåˆ é™¤ key çš„æ—¶å€™å…ˆåˆ¤æ–­éšæœºå€¼æ˜¯å¦å’Œæœ¬çº¿ç¨‹çš„ä¸€è‡´ï¼Œä¸€è‡´çš„æ‰å¯ä»¥åˆ é™¤ã€‚\nRedis äº‹åŠ¡\nRedis äº‹åŠ¡çš„æ¦‚å¿µ\nRedis äº‹åŠ¡çš„æœ¬è´¨æ˜¯é€šè¿‡ MULTIã€EXECã€WATCH ç­‰ä¸€ç»„å‘½ä»¤çš„é›†åˆã€‚äº‹åŠ¡æ”¯æŒä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ã€‚åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ï¼Œä¼šæŒ‰ç…§é¡ºåºä¸²è¡ŒåŒ–æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„å‘½ä»¤ï¼Œå…¶ä»–å®¢æˆ·ç«¯æäº¤çš„å‘½ä»¤è¯·æ±‚ä¸ä¼šæ’å…¥åˆ°äº‹åŠ¡æ‰§è¡Œå‘½ä»¤åºåˆ—ä¸­ã€‚\næ€»ç»“è¯´ï¼šRedis äº‹åŠ¡å°±æ˜¯ä¸€æ¬¡æ€§ã€é¡ºåºæ€§ã€æ’ä»–æ€§çš„æ‰§è¡Œä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„ä¸€ç³»åˆ—å‘½ä»¤ã€‚\nRedis äº‹åŠ¡çš„ä¸‰ä¸ªé˜¶æ®µ\n\n\näº‹åŠ¡å¼€å§‹ MULTI\n\n\nå‘½ä»¤å…¥é˜Ÿ\n\n\näº‹åŠ¡æ‰§è¡Œ EXEC\n\n\näº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœåŠ¡ç«¯æ”¶åˆ°æœ‰ EXECã€DISCARDã€WATCHã€MULTI ä¹‹å¤–çš„è¯·æ±‚ï¼Œå°†ä¼šæŠŠè¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ä¸­æ’é˜Ÿ\nRedis äº‹åŠ¡ç›¸å…³é—®é¢˜\nRedis äº‹åŠ¡åŠŸèƒ½æ˜¯é€šè¿‡ MULTIã€EXECã€DISCARD å’Œ WATCH å››ä¸ªåŸè¯­å®ç°çš„ã€‚ï¼ˆRedis äº‹åŠ¡å¾ˆé¸¡è‚‹ï¼‰\n\n\nRedis ä¼šå°†ä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤åºåˆ—åŒ–ï¼Œç„¶åæŒ‰é¡ºåºæ‰§è¡Œã€‚\n\n\nRedis ä¸æ”¯æŒå›æ»šï¼Œâ€œRedis åœ¨äº‹åŠ¡å¤±è´¥æ—¶ä¸è¿›è¡Œå›æ»šï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä½™ä¸‹çš„å‘½ä»¤â€ï¼Œ æ‰€ä»¥ Redis çš„å†…éƒ¨å¯ä»¥ä¿æŒç®€å•ä¸”å¿«é€Ÿã€‚\n\n\nå¦‚æœåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­çš„å‘½ä»¤å‡ºç°é”™è¯¯ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šæ‰§è¡Œï¼ˆå°±æ˜¯é™¤éä½ çš„å‘½ä»¤å†™é”™äº†ï¼Œå¯¼è‡´æ‰€æœ‰å‘½ä»¤ä¸æ‰§è¡Œï¼‰ï¼›\n\n\nå¦‚æœåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å‡ºç°è¿è¡Œé”™è¯¯ï¼Œé‚£ä¹ˆæ­£ç¡®çš„å‘½ä»¤ä¼šè¢«æ‰§è¡Œã€‚\n\n\nWATCH å‘½ä»¤æ˜¯ä¸€ä¸ªä¹è§‚é”ï¼Œå¯ä»¥ä¸º Redis äº‹åŠ¡æä¾› check-and-set ï¼ˆCASï¼‰è¡Œä¸ºã€‚ å¯ä»¥ç›‘æ§ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œä¸€æ—¦å…¶ä¸­æœ‰ä¸€ä¸ªé”®è¢«ä¿®æ”¹ï¼ˆæˆ–åˆ é™¤ï¼‰ï¼Œä¹‹åçš„äº‹åŠ¡å°±ä¸ä¼šæ‰§è¡Œï¼Œç›‘æ§ä¸€ç›´æŒç»­åˆ° EXEC å‘½ä»¤ã€‚\nMULTI å‘½ä»¤ç”¨äºå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå®ƒæ€»æ˜¯è¿”å› OKã€‚ MULTI æ‰§è¡Œä¹‹åï¼Œå®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘æœåŠ¡å™¨å‘é€ä»»æ„å¤šæ¡å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤ä¸ä¼šç«‹å³è¢«æ‰§è¡Œï¼Œè€Œæ˜¯è¢«æ”¾åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå½“ EXEC å‘½ä»¤è¢«è°ƒç”¨æ—¶ï¼Œæ‰€æœ‰é˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ‰ä¼šè¢«æ‰§è¡Œã€‚\nEXECï¼šæ‰§è¡Œæ‰€æœ‰äº‹åŠ¡å—å†…çš„å‘½ä»¤ã€‚è¿”å›äº‹åŠ¡å—å†…æ‰€æœ‰å‘½ä»¤çš„è¿”å›å€¼ï¼ŒæŒ‰å‘½ä»¤æ‰§è¡Œçš„å…ˆåé¡ºåºæ’åˆ—ã€‚ å½“æ“ä½œè¢«æ‰“æ–­æ—¶ï¼Œè¿”å›ç©ºå€¼ nil ã€‚\né€šè¿‡è°ƒç”¨ DISCARDï¼Œå®¢æˆ·ç«¯å¯ä»¥æ¸…ç©ºäº‹åŠ¡é˜Ÿåˆ—ï¼Œå¹¶æ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡ï¼Œ å¹¶ä¸”å®¢æˆ·ç«¯ä¼šä»äº‹åŠ¡çŠ¶æ€ä¸­é€€å‡ºã€‚\nUNWATCH å‘½ä»¤å¯ä»¥å–æ¶ˆ watch å¯¹æ‰€æœ‰ key çš„ç›‘æ§ã€‚\nRedis äº‹åŠ¡ä¿è¯åŸå­æ€§å—ï¼Ÿ\nRedis ä¸­ï¼Œå•æ¡å‘½ä»¤æ˜¯åŸå­æ€§æ‰§è¡Œçš„ï¼Œä½†äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§ï¼Œä¸”æ²¡æœ‰å›æ»šï¼Œäº‹åŠ¡è¿‡ç¨‹ä¸­ä»»æ„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶ä½™çš„å‘½ä»¤ä»ä¼šè¢«æ‰§è¡Œã€‚\nRedis äº‹åŠ¡ä¿è¯éš”ç¦»æ€§å—ï¼Ÿ\nRedis æ˜¯å•è¿›ç¨‹ç¨‹åºï¼Œå¹¶ä¸”å®ƒä¿è¯åœ¨æ‰§è¡Œäº‹åŠ¡æ—¶ï¼Œä¸ä¼šå¯¹äº‹åŠ¡è¿›è¡Œä¸­æ–­ï¼Œäº‹åŠ¡å¯ä»¥è¿è¡Œç›´åˆ°æ‰§è¡Œå®Œæ‰€æœ‰äº‹åŠ¡é˜Ÿåˆ—ä¸­çš„å‘½ä»¤ä¸ºæ­¢ã€‚å› æ­¤ï¼ŒRedis çš„äº‹åŠ¡æ˜¯æ€»æ˜¯å¸¦æœ‰éš”ç¦»æ€§çš„ã€‚\nåœºæ™¯\nåœ¨å·¥ä½œä¸­ï¼Œå¦‚æœæ•°æ®åº“ä¿®æ”¹äº†æ•°æ®ï¼Œé‚£å°±è·Ÿ Redis æ•°æ®ä¸åŒæ­¥äº†ï¼Œæ­¤æ—¶è¯¥åŠï¼Ÿï¼ˆç¼“å­˜åŒå†™ä¸€è‡´æ€§é—®é¢˜ï¼‰\nç¬¬ä¸€ç§æ˜¯ç¡¬ç¼–ç æ–¹å¼ï¼›\n\n\nè®©æœåŠ¡çš„æ›´æ–°å’ŒæŸ¥è¯¢åˆ†å…ˆåè¿›è¡Œæ‰§è¡Œï¼ŒæœåŠ¡å°†æ•°æ®åº“æ›´æ–°åï¼Œå†æŸ¥è¿”æ›´æ–°åçš„æ•°æ®ï¼ŒæŠŠæ›´æ–°åçš„æ•°æ®å†æ›´æ–°åˆ° Redisã€‚å¦‚æœæœ‰å¤šä¸ªæœåŠ¡åŒæ—¶è°ƒç”¨ï¼Œå°±ç”¨ MQ è·å– Mysql çš„ binlog ä¸­çš„ä¿®æ”¹é¡ºåºï¼Œä¾æ¬¡å‘é€æ¶ˆæ¯ç»™ redisï¼ŒMySQL çš„é¡ºåºè®°å½•å°±æ˜¯å…ˆåæ›´æ”¹çš„æ‰§è¡Œé¡ºåºï¼ŒMQ æ ¹æ®è¿™ä¸ªé¡ºåºå³å¯ä¿è¯å…ˆåçš„æ›´æ–°é¡ºåºï¼Œè®© Redis çš„æ›´æ–°é¡ºåºä¸å‡ºé—®é¢˜ã€‚\n\n\nç¬¬äºŒç§æ˜¯ Redis ç¼“å­˜äºŒæ¬¡å¼€å‘è§£å†³ï¼ˆMyBatisPlus+Redis æ•´åˆï¼šé¤é¥®é¡¹ç›®ä¸­ä½¿ç”¨åˆ°ï¼‰ã€‚\n\n\nç”¨ Mybatis äºŒçº§ç¼“å­˜å¯¹å¤–å¼€æ”¾çš„ cache æ¥å£è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼ŒCache æ”¯æŒ SPI æœºåˆ¶ï¼Œé€šè¿‡æ³¨è§£æ¥è°ƒåŠ¨ç›¸å…³é…ç½®ç±»ï¼Œé€šè¿‡å®ç° Mybatis äºŒçº§ç¼“å­˜æ¥å£ Cache é›†æˆ Redis ç¼“å­˜ï¼Œå¯ä»¥è‡ªåŠ¨æ›´æ–° MySQL æ•°æ®åˆ° Redis ç¼“å­˜ä¸­ã€‚\n\n\nä¸ºäº†é˜²æ­¢åœ¨è¯»å†™çš„è¿‡ç¨‹ä¸­å‡ºç°é«˜å¹¶å‘é—®é¢˜ï¼Œè¿˜éœ€è¦åŠ ä¸Š ReentrantReadWriteLock è¯»å†™é”ï¼ŒReentrantLock åªèƒ½è¿›å…¥ä¸€ä¸ªçº¿ç¨‹ï¼ŒReentrantReadWriteLock å…è®¸å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œæé«˜é«˜å¹¶å‘ï¼Œä½†åªæ”¯æŒå¤šä¸ªçº¿ç¨‹è¯»ï¼Œä¸æ”¯æŒåŒæ—¶è¯»å†™æˆ–å†™å†™ã€‚\n\n\nä½†æ˜¯ä»¥ä¸Šæ–¹å¼ä¹Ÿä¸èƒ½å®Œå…¨è§£å†³åŒæ­¥é—®é¢˜ï¼Œä»å­˜åœ¨åˆ†å¸ƒå¼çš„é«˜å¹¶å‘é—®é¢˜ï¼Œå¦‚æœéœ€è¦å®Œå…¨ä¿è¯ä¸€è‡´æ€§ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œå¯¹æ¯ä¸ªäº‹åŠ¡ä¸Šé”ã€‚ä½†è¿™æ ·å¯¹ç³»ç»Ÿèµ„æºæ¶ˆè€—è¿‡å¤§ï¼Œå¾—ä¸å¿å¤±ï¼Œæ¯•ç«Ÿè¯»å–çš„é‡æ˜¯è¿œå¤§äºå¢åˆ æ”¹çš„é‡çš„ã€‚\n\n\nå‡å¦‚ Redis é‡Œé¢æœ‰ 1 äº¿ä¸ª keyï¼Œå…¶ä¸­æœ‰ 10W ä¸ª key æ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ\nä½¿ç”¨ keys æŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ã€‚\nä½¿ç”¨ SCAN+MATCH å‚æ•°åŒ¹é…å‰ç¼€å‘½ä»¤è·å–æ‰€æœ‰ keyï¼ˆä¼šé‡å¤ï¼Œéœ€è¦è¿›è¡Œå»é‡å¤„ç†ï¼‰\nredis 127.0.0.1:6379&gt; KEYS PATTERNSCAN 0MATCH &quot;prefix:*&quot;\n\nåŒ¹é…æ¨¡å¼:\n\nh?lloÂ åŒ¹é…Â hello,Â halloÂ å’ŒÂ hxllo\nh*lloÂ åŒ¹é…Â hlloÂ å’ŒÂ heeeello\nh[ae]lloÂ åŒ¹é…Â helloÂ andÂ hallo,Â ä¸åŒ¹é…Â hillo\nh[^e]lloÂ åŒ¹é…Â hallo,Â hbllo, â€¦ ä¸åŒ¹é…Â hello\nh[a-b]lloÂ åŒ¹é…Â halloÂ å’ŒÂ hbllo\n\n\nä»¥ä¸Šæ˜¯åŸå…ˆçš„ç­”æ¡ˆï¼Œä½†æ˜¯å‚è€ƒåšå®¢ (https://cloud.tencent.com/developer/article/2408542)ï¼Œè¿™æ ·å›ç­”åè€Œæ˜¯é”™è¯¯çš„ã€‚\næ ¹æ®ä¸Šç¯‡åšå®¢çš„å†…å®¹ï¼Œå…·ä½“çš„æµ‹è¯•å†…å®¹ä¸æ”¾å‡ºäº†ã€‚æ€»ä¹‹è¿™é¢˜å¦‚æœé¢è¯•å®˜åªæ˜¯è¦è€ƒæŸ¥ä½  KEYS å‘½ä»¤å’Œ SCAN å‘½ä»¤çš„åŒºåˆ«ï¼Œå¹¶ä¸”æƒ³è¦çœ‹çœ‹ä½ çŸ¥ä¸çŸ¥é“ KEYS å‘½ä»¤çš„é˜»å¡é—®é¢˜ï¼Œé‚£ä¹ˆä½ å›ç­” SCAN å°±å·²ç»è¿‡äº†ã€‚è€Œå®é™…ä¸­ï¼Œå¦‚æœçœŸçš„æœ‰ç»éªŒï¼Œä½ å°±ä¼šå‘ç° SCAN çš„èƒ½åŠ›é˜ˆå€¼æ˜¯åœ¨é‚£é‡Œçš„ã€‚äºæ˜¯ä½ éœ€è¦ç»§ç»­åé—®é¢è¯•å®˜ï¼Œæ˜¯å¦æœ‰æ—¶é—´è¦æ±‚ã€‚\n\nè‡ªå·±è¿›è¡Œäº†ä¸€ä¸‹éªŒè¯ï¼Œå¦‚æœç›´æ¥ä¸€æ¬¡ scan ä¸€åƒä¸‡çš„è®°å½• è€—æ—¶ä¸º: 10.15 ç§’ã€‚\nç†è®ºä¸Š scan ä¸€ä¸ªé”®å€¼å¯¹çš„æ—¶é—´ä¸º 1 å¾®ç§’å·¦å³ã€‚\nå¦‚æœ Redis é‡Œé¢æœ‰ 1000 ä¸‡ä¸ª key çš„è¯ 60 å°æœåŠ¡å™¨å¦‚æœåŒæ—¶è¿›è¡Œä¸€æ¬¡æ‰€æœ‰çš„ scan é‚£ä¹ˆæä¸å¥½è‡³å°‘ä¼šæœ‰åœ¨ è¿è¡ŒæœŸé—´å†…äº§ç”Ÿæ€»è®¡ 600S çš„å»¶è¿Ÿæ—¶é—´.\n\nRedis redis æ­£ç»™çº¿ä¸Šçš„ä¸šåŠ¡æä¾›æœåŠ¡ï¼Œé‚£ä½¿ç”¨ keys æŒ‡ä»¤ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ\nç”±äº Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œè€Œ keys æ˜¯éå†æŸ¥è¯¢ï¼Œæ¯ä¸ªæ•°æ®éƒ½ä¼šéå†ä¸€æ¬¡ï¼Œæ‰€ä»¥ keys æŒ‡ä»¤å»æŸ¥æ‰¾å¤§é‡æ•°æ®ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚\nå¯æ›¿ä»£æ–¹å¼æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨ scan æŒ‡ä»¤ï¼Œscan æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨ keys æŒ‡ä»¤é•¿ã€‚\nä½†è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œscan æŒ‡ä»¤æœ‰ä¸€ä¸ªå‘ï¼Œä¸ä¼šè‡ªåŠ¨é‡Šæ”¾è¿æ¥ï¼Œéœ€è¦æ‰‹åŠ¨é‡Šæ”¾è¿æ¥ã€‚// todo è¿™ä¸ªéœ€è¦æŸ¥æ‰¾ å…·ä½“çš„è§£å†³æ–¹æ¡ˆæˆ‘æœ‰åšç¬”è®°ã€‚\nScan ä¸ºä»€ä¹ˆå¯ä»¥ä¸é˜»å¡æå– key åˆ—è¡¨ï¼Ÿä¸ºä»€ä¹ˆä¼šæœ‰é‡å¤é—®é¢˜ï¼Ÿ\nScan å‘½ä»¤å…¶å®æ˜¯è¿­ä»£å™¨æ–¹å¼å¯¹æ•°æ®è¿›è¡Œéå†è·å–ï¼Œä½†å®ƒæ˜¯åˆ†æ¬¡è¿›è¡Œçš„ï¼Œå¯ä»¥åœ¨ä¸­é€”è¿”å›æŸ¥åˆ°çš„æ•°æ®ï¼Œåšåˆ°ä¸é˜»å¡ï¼Œä¸”å› ä¸º Redis åº•å±‚æ˜¯ Hash å­—å…¸ï¼Œä¼šæœ‰æ‰©å®¹å’Œç¼©å®¹é—®é¢˜ï¼Œæ‰€ä»¥ scan æ¯æ¬¡éƒ½ä¼šå¾€å‰é€€ä¸€å®šæ•°æ®å¼€å§‹ç»§ç»­éå†ï¼Œæ‰€ä»¥ä¼šæœ‰é‡å¤é—®é¢˜ã€‚ï¼ˆå…·ä½“è§ç¬”è®°ï¼‰ã€‚\nä½¿ç”¨ Redis åšè¿‡å¼‚æ­¥é˜Ÿåˆ—å—ï¼Œæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ\nä½¿ç”¨ list ç±»å‹ä¿å­˜æ•°æ®ä¿¡æ¯ï¼Œrpush ç”Ÿäº§æ¶ˆæ¯ï¼Œlpop æ¶ˆè´¹æ¶ˆæ¯ï¼Œå½“ lpop æ²¡æœ‰æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥ sleep ä¸€æ®µæ—¶é—´ï¼Œç„¶åå†æ£€æŸ¥æœ‰æ²¡æœ‰ä¿¡æ¯ï¼Œå¦‚æœä¸æƒ³ sleep çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ blpop, åœ¨æ²¡æœ‰ä¿¡æ¯çš„æ—¶å€™ï¼Œä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°ä¿¡æ¯çš„åˆ°æ¥ã€‚Redis å¯ä»¥é€šè¿‡ pub/sub ä¸»é¢˜è®¢é˜…æ¨¡å¼å®ç°ä¸€ä¸ªç”Ÿäº§è€…ï¼Œå¤šä¸ªæ¶ˆè´¹è€…ï¼Œå½“ç„¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„ç¼ºç‚¹ï¼Œå½“æ¶ˆè´¹è€…ä¸‹çº¿æ—¶ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ã€‚\nRedis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—ï¼Ÿ\nä½¿ç”¨ sortedsetï¼Œä½¿ç”¨æ—¶é—´æˆ³åš scoreï¼Œæ¶ˆæ¯å†…å®¹ä½œä¸º keyï¼Œè°ƒç”¨ zadd æ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä½¿ç”¨ zrangbyscore è·å– n ç§’ä¹‹å‰çš„æ•°æ®åšè½®è¯¢å¤„ç†ã€‚\nRedis å›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œçš„ï¼Ÿ\n\n\nä¸€ä¸ªå®¢æˆ·ç«¯è¿è¡Œäº†æ–°çš„å‘½ä»¤ï¼Œæ·»åŠ äº†æ–°çš„æ•°æ®ã€‚\n\n\nRedis æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœå¤§äº maxmemory çš„é™åˆ¶ï¼Œ åˆ™æ ¹æ®è®¾å®šå¥½çš„ç­–ç•¥è¿›è¡Œå›æ”¶ã€‚\n\n\nä¸€ä¸ªæ–°çš„å‘½ä»¤è¢«æ‰§è¡Œï¼Œç­‰ç­‰ã€‚\n\n\næ‰€ä»¥æˆ‘ä»¬ä¸æ–­åœ°ç©¿è¶Šå†…å­˜é™åˆ¶çš„è¾¹ç•Œï¼Œé€šè¿‡ä¸æ–­è¾¾åˆ°è¾¹ç•Œç„¶åä¸æ–­åœ°å›æ”¶å›åˆ°è¾¹ç•Œä»¥ä¸‹ã€‚\n\n\nå¦‚æœä¸€ä¸ªå‘½ä»¤çš„ç»“æœå¯¼è‡´å¤§é‡å†…å­˜è¢«ä½¿ç”¨ï¼ˆä¾‹å¦‚å¾ˆå¤§çš„é›†åˆçš„äº¤é›†ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„é”®ï¼‰ï¼Œä¸ç”¨å¤šä¹…å†…å­˜é™åˆ¶å°±ä¼šè¢«è¿™ä¸ªå†…å­˜ä½¿ç”¨é‡è¶…è¶Šã€‚\n\n\nRedis å›æ”¶ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç®—æ³•ï¼Ÿ\nLRU ç®—æ³•ï¼ˆå°†æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚ï¼‰\nRedis å¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ\n\n\nMaster æœ€å¥½ä¸è¦åšä»»ä½•æŒä¹…åŒ–å·¥ä½œï¼ŒåŒ…æ‹¬å†…å­˜å¿«ç…§å’Œ AOF æ—¥å¿—æ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯ä¸è¦å¯ç”¨å†…å­˜å¿«ç…§åšæŒä¹…åŒ–ã€‚\n\n\nå¦‚æœæ•°æ®æ¯”è¾ƒå…³é”®ï¼ŒæŸä¸ª Slave å¼€å¯ AOF å¤‡ä»½æ•°æ®ï¼Œç­–ç•¥ä¸ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ã€‚\n\n\nä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼ŒSlave å’Œ Master æœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ã€‚\n\n\nå°½é‡é¿å…åœ¨å‹åŠ›è¾ƒå¤§çš„ä¸»åº“ä¸Šå¢åŠ ä»åº“\n\n\nMaster è°ƒç”¨ BGREWRITEAOF é‡å†™ AOF æ–‡ä»¶ï¼ŒAOF åœ¨é‡å†™çš„æ—¶å€™ä¼šå å¤§é‡çš„ CPU å’Œå†…å­˜èµ„æºï¼Œå¯¼è‡´æœåŠ¡ load è¿‡é«˜ï¼Œå‡ºç°çŸ­æš‚æœåŠ¡æš‚åœç°è±¡ã€‚\n\n\nä¸ºäº† Master çš„ç¨³å®šæ€§ï¼Œä¸»ä»å¤åˆ¶ä¸è¦ç”¨å›¾çŠ¶ç»“æ„ï¼Œç”¨å•å‘é“¾è¡¨ç»“æ„æ›´ç¨³å®šï¼Œå³ä¸»ä»å…³ç³»ä¸ºï¼šMaster&lt;â€“Slave1&lt;â€“Slave2&lt;â€“Slave3â€¦ï¼Œè¿™æ ·çš„ç»“æ„ä¹Ÿæ–¹ä¾¿è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå®ç° Slave å¯¹ Master çš„æ›¿æ¢ï¼Œä¹Ÿå³ï¼Œå¦‚æœ Master æŒ‚äº†ï¼Œå¯ä»¥ç«‹é©¬å¯ç”¨ Slave1 åš Masterï¼Œå…¶ä»–ä¸å˜ã€‚\n\n\nRedis å®˜æ–¹ä¸ºä»€ä¹ˆä¸æä¾› Windows ç‰ˆæœ¬ï¼Ÿ\nå› ä¸ºç›®å‰ Linux ç‰ˆæœ¬å·²ç»ç›¸å½“ç¨³å®šï¼Œè€Œä¸”ç”¨æˆ·é‡å¾ˆå¤§ï¼Œæ— éœ€å¼€å‘ windows ç‰ˆæœ¬ï¼Œåè€Œä¼šå¸¦æ¥å…¼å®¹æ€§ç­‰é—®é¢˜ã€‚\nä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼èƒ½å­˜å‚¨æœ€å¤§å®¹é‡æ˜¯å¤šå°‘ï¼Ÿ\n512M\nRedis å¦‚ä½•åšå¤§é‡æ•°æ®æ’å…¥ï¼Ÿ\nRedis2.6 å¼€å§‹ redis-cli æ”¯æŒä¸€ç§æ–°çš„è¢«ç§°ä¹‹ä¸º pipe mode çš„æ–°æ¨¡å¼ç”¨äºæ‰§è¡Œå¤§é‡æ•°æ®æ’å…¥å·¥ä½œã€‚\n","categories":["é¢è¯•","å…«è‚¡æ–‡"],"tags":["é¢è¯•","å…«è‚¡æ–‡"]},{"title":"Activiti7 + dynamic-datasource å¤šæ•°æ®æºé…ç½®","url":"/posts/2dbd20ab/","content":"\n\nå‰è¨€ä¹‹å‰æ•°æ®åº“ä¸æ¶‰åŠå¤šæ•°æ®æºçš„é—®é¢˜ï¼Œæœ¬æ¬¡å¼•å…¥ Activiti7 åéœ€è¦é…ç½®å•ç‹¬çš„æ•°æ®æºã€‚ç½‘ä¸Šçš„æ–¹æ³•éƒ½æ˜¯è‡ªå·±å†™ bean æ³¨å…¥ï¼Œç„¶ååœ¨ SpringProcessEngineConfiguration å†…è¿›è¡Œ set æ“ä½œï¼Œä½†æ˜¯å‡ºç°äº†å¾ˆå¤§çš„é—®é¢˜ã€‚ã€‚ã€‚\n\n\næ›´æ–°\n\n\n25-03-03 åˆå§‹è®°å½•\n\né—®é¢˜\nåŸå‚è€ƒæ–‡ç« å¦‚ä¸‹ï¼šSpringBoot ç»™ Activiti7 é…ç½®å•ç‹¬æ•°æ®æºã€‚\næ ¹æ®æ–‡ç« é…ç½®ï¼Œå‡ºç°äº†åŸæ¥é…ç½®çš„å…¶ä»–æ•°æ®æºå¤±æ•ˆï¼ŒåŸå…ˆçš„äº‹ç‰©æ³¨è§£ @Transactional å¤±æ•ˆç­‰é—®é¢˜ã€‚\nåŸå› \nå…·ä½“åŸå› ä¸æ¸…æ¥šï¼Œç›®å‰åªçŸ¥é“ @Bean é…ç½® PlatformTransactionManager å’Œ DataSource ä¼šå¯¼è‡´ dynamic-datasource é…ç½®çš„é»˜è®¤æ•°æ®æºå¤±æ•ˆã€‚\nè§£å†³\nä» DynamicDataSourceProvider è·å–æ•°æ®æºå¹¶æ„å»ºäº‹ç‰©ç®¡ç†ï¼Œå…·ä½“é…ç½®ä¿¡æ¯å¦‚ä¸‹ã€‚\n@Configuration  public class ActivitiDataSourceConfig extends AbstractProcessEngineAutoConfiguration &#123;        @Resource      private DynamicDataSourceProvider dynamicDataSourceProvider;        @Bean      public SpringProcessEngineConfiguration springProcessEngineConfiguration(ActivitiProperties activitiProperties) &#123;          SpringProcessEngineConfiguration conf = new SpringProcessEngineConfiguration();          DataSource dataSource = dynamicDataSourceProvider.loadDataSources().get(DBConstants.DATASOURCE_WORKFLOW);          conf.setDataSource(dataSource);          conf.setTransactionManager(new DataSourceTransactionManager(dataSource));          conf.setDeploymentName(activitiProperties.getDeploymentName());          conf.setDatabaseSchema(activitiProperties.getDatabaseSchema());          conf.setDatabaseSchemaUpdate(activitiProperties.getDatabaseSchemaUpdate());          conf.setDbHistoryUsed(activitiProperties.isDbHistoryUsed());          conf.setAsyncExecutorActivate(activitiProperties.isAsyncExecutorActivate());          if (!activitiProperties.isAsyncExecutorActivate()) &#123;              ValidatorSet springBootStarterValidatorSet = new ValidatorSet(&quot;activiti-spring-boot-starter&quot;);              springBootStarterValidatorSet.addValidator(new AsyncPropertyValidator());              if (conf.getProcessValidator() == null) &#123;                  ProcessValidatorImpl processValidator = new ProcessValidatorImpl();                  processValidator.addValidatorSet(springBootStarterValidatorSet);                  conf.setProcessValidator(processValidator);              &#125; else &#123;                  conf.getProcessValidator().getValidatorSets().add(springBootStarterValidatorSet);              &#125;          &#125;          conf.setMailServerHost(activitiProperties.getMailServerHost());          conf.setMailServerPort(activitiProperties.getMailServerPort());          conf.setMailServerUsername(activitiProperties.getMailServerUserName());          conf.setMailServerPassword(activitiProperties.getMailServerPassword());          conf.setMailServerDefaultFrom(activitiProperties.getMailServerDefaultFrom());          conf.setMailServerUseSSL(activitiProperties.isMailServerUseSsl());          conf.setMailServerUseTLS(activitiProperties.isMailServerUseTls());            conf.setHistoryLevel(activitiProperties.getHistoryLevel());          conf.setCopyVariablesToLocalForTasks(activitiProperties.isCopyVariablesToLocalForTasks());          conf.setSerializePOJOsInVariablesToJson(activitiProperties.isSerializePOJOsInVariablesToJson());          conf.setJavaClassFieldForJackson(activitiProperties.getJavaClassFieldForJackson());            if (activitiProperties.getCustomMybatisMappers() != null) &#123;              conf.setCustomMybatisMappers(getCustomMybatisMapperClasses(activitiProperties.getCustomMybatisMappers()));          &#125;            if (activitiProperties.getCustomMybatisXMLMappers() != null) &#123;              conf.setCustomMybatisXMLMappers(new HashSet&lt;&gt;(activitiProperties.getCustomMybatisXMLMappers()));          &#125;            if (activitiProperties.getCustomMybatisXMLMappers() != null) &#123;              conf.setCustomMybatisXMLMappers(new HashSet&lt;&gt;(activitiProperties.getCustomMybatisXMLMappers()));          &#125;            if (activitiProperties.isUseStrongUuids()) &#123;              conf.setIdGenerator(new StrongUuidGenerator());          &#125;            if (activitiProperties.getDeploymentMode() != null) &#123;              conf.setDeploymentMode(activitiProperties.getDeploymentMode());          &#125;          return conf;      &#125;  &#125;\n","categories":["bugè®°å½•","2025"],"tags":["Java"]},{"title":"èšåˆæ”¯ä»˜-åŠŸèƒ½å®ç°","url":"/posts/8582b8be/","content":"\n\nå‰è¨€ä¹‹å‰çš„é¡¹ç›®å·²ç»æ¥è§¦äº†æ”¯ä»˜å®ã€å¾®ä¿¡ã€é“¶è”ä¸‰ç§æ”¯ä»˜æ–¹å¼äº†ã€‚æ­£å¥½æŠŠè¿™ä¸ªé¡¹ç›®å†™ä¸€éï¼Œçœ‹äº†æŠ€æœ¯æ ˆæœ‰ä¸€äº›æ˜¯æ²¡æœ‰æ¥è§¦è¿‡çš„ï¼Œåº”è¯¥èƒ½å­¦åˆ°å¾ˆå¤šã€‚é¡¹ç›® git åœ°å€ï¼šhttps://gitee.com/kiml_rgb/shanjupay.git\nå‰ç«¯é¡¹ç›®åœ°å€ï¼šhttps://gitee.com/kiml_rgb/shanjupay_web\n\n\næ›´æ–°\n\n\n25-04-07 è¿ç§»åŸç¬”è®°\n\n\næ€»ç»“å…¶å®é™¤äº†ä¹‹å‰åšè¿‡çš„å†…å®¹ï¼Œè¿™ä¸ªé¡¹ç›®èµ„æ–™é‡Œåªæœ‰ä¸€ç‚¹é‡è¦ï¼šæ ¹æ®ä»£ç ï¼Œé¡¹ç›®ä¸­çš„èšåˆæ”¯ä»˜å®ç°ä¸»è¦ä¾é ==æ‰«ç æ¥å£çš„ request ä¸­çš„ user-agent ==æ¥åˆ¤æ–­æµè§ˆå™¨ç±»å‹ï¼Œä»è€Œåˆ¤æ–­æ”¯ä»˜æ¸ é“ï¼Œè¾¾åˆ°èšåˆæ”¯ä»˜çš„æ•ˆæœ\n\n\n\né¡¹ç›®æ¦‚è¿°\nèšåˆæ”¯ä»˜ç›®å‰ä¸»è¦çš„åšæ³•å°±æ˜¯çº¿ä¸Šèšåˆæ”¶é“¶å° (å¼€æ”¾ API)ï¼Œçº¿ä¸‹ C2B ä¸€ç å¤šä»˜ã€çº¿ä¸‹ B2C å•†å®¶æ‰«ç ã€‚å¹³å°åº”ä»¥ SaaS æœåŠ¡å½¢å¼æä¾›ç»™å„å•†æˆ·è®¢å•ç®¡ç†ã€é—¨åº—ç®¡ç†ã€è´¢åŠ¡æ•°æ®ç»Ÿè®¡ç­‰åŸºç¡€æœåŠ¡ï¼Œé—ªèšæ”¯ä»˜è¿˜ä»¥æ”¯ä»˜ä¸ºå…¥å£ï¼Œé€šè¿‡å¹¿å‘Šã€è¥é”€ã€é‡‘èç­‰æœåŠ¡ï¼Œæ„å»ºä¸€ä¸ªç§»åŠ¨æ”¯ä»˜çš„å…¨ç”Ÿæ€ç³»ç»Ÿã€‚\nåŠŸèƒ½æ¨¡å—\nå¹³å°ä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªæ¨¡å—ï¼šå®˜ç½‘&amp;å¼€æ”¾å¹³å°ã€å•†æˆ·å¹³å°ã€è¿è¥å¹³å°ï¼Œè¯¦ç»†åŠŸèƒ½å¦‚ä¸‹ï¼š\n\n\n\n\nåŠŸèƒ½æ¨¡å—åç§°\nåŠŸèƒ½è¯´æ˜\n\n\n\n\nå®˜ç½‘&amp;å¼€æ”¾å¹³å°\näº§å“å±•ç¤ºã€åŠŸèƒ½ä»‹ç»ã€å¸®åŠ©ä¸­å¿ƒå’Œå¼€å‘è€…ä¸­å¿ƒ\n\n\nå•†æˆ·å¹³å° - é¦–é¡µ\næä¾›å•†æˆ·æ³¨å†Œã€ç™»å½•ã€åŸºæœ¬ä¿¡æ¯æŸ¥çœ‹ã€æ•°æ®çœ‹æ¿\n\n\nå•†æˆ·å¹³å° - è´¦æˆ·ç®¡ç†\næä¾›å•†æˆ·ä¼ä¸šèµ„è´¨è®¤è¯ã€ä¼ä¸šä¿¡æ¯æŸ¥çœ‹å’Œå¥—é¤è´­ä¹°\n\n\nå•†æˆ·å¹³å° - æ”¯ä»˜ç®¡ç†\nä¸ºå•†æˆ·æä¾›åº”ç”¨åˆ›å»ºã€æ¸ é“å‚æ•°é…ç½®ã€äº¤æ˜“æ€»è§ˆå’Œå¼€å¯æ”¯ä»˜ (ç”ŸæˆäºŒç»´ç ) ç­‰\n\n\nå•†æˆ·å¹³å° - é—¨åº—ç®¡ç†\nä¸ºå•†æˆ·æä¾›æ–°å¢é—¨åº—ã€åº—é•¿åˆ†é…ã€é—¨åº—å¯¼å…¥ç­‰\n\n\nå•†æˆ·å¹³å° - å‘˜å·¥ç®¡ç†\nä¸ºå•†æˆ·æä¾›æ–°å¢å‘˜å·¥ã€å®šä¹‰è§’è‰²ã€åˆ†é…è§’è‰²ç­‰\n\n\nå•†æˆ·å¹³å° - ä¼˜æƒ ç®¡ç†\nä¸ºå•†æˆ·æä¾›ä¼˜æƒ åˆ¸ç®¡ç†ã€æ´»åŠ¨ç»Ÿè®¡ç­‰\n\n\nè¿è¥å¹³å° - å•†æˆ·ç®¡ç†\nå¯¹å•†æˆ·è¿›è¡Œæ£€ç´¢ã€å®¡æ ¸å’Œè®¢å•ç»Ÿè®¡\n\n\nè¿è¥å¹³å° - ä¼˜æƒ ç®¡ç†\nä¸ºå•†æˆ·è®¾ç½®ä¼˜æƒ ç­–ç•¥å’Œä¼˜æƒ åˆ¸å‘é€\n\n\nè¿è¥å¹³å° - ç®¡ç†å‘˜ç®¡ç†\nè¿è¥å¹³å° - ç®¡ç†å‘˜ç®¡ç†\n\n\n\nä¸šåŠ¡ä¸»ä½“æµç¨‹\n\né¡¹ç›®æŠ€æœ¯æ¶æ„\næŠ€æœ¯æ¶æ„\n\næŠ€æœ¯æ ˆ\n\né‡ç‚¹äº†è§£å¾®æœåŠ¡æŠ€æœ¯æ ˆï¼š\næœåŠ¡ç«¯åŸºäº Spring Boot æ„å»ºï¼Œé‡‡ç”¨ Spring Cloud Alibaba å¾®æœåŠ¡æ¶æ„ã€‚\n\n\nåŸºç¡€è®¾æ–½ä¸šåŠ¡æ•°æ®æŒä¹…åŒ–é‡‡ç”¨ MySQLï¼Œæ•°æ®ç¼“å­˜é‡‡ç”¨ Redisï¼Œé‡‡ç”¨ RocketMQ çš„äº‹åŠ¡æ¶ˆæ¯æœºåˆ¶å®Œæˆéƒ¨åˆ†åœºæ™¯ä¸‹çš„åˆ†å¸ƒå¼äº‹åŠ¡æ§åˆ¶ï¼Œé‡‡ç”¨ç¬¬ä¸‰æ–¹äº‘å¹³å°å®Œæˆæ–‡ä»¶ä¸Šä¼ ä¸åˆ†å¸ƒå¼å­˜å‚¨ã€‚\n\n\nç»„ä»¶ç³»ç»Ÿå¾®æœåŠ¡åŸºäº SpringBoot å¼€å‘ï¼Œæ•°æ®åº“è¿æ¥æ± é‡‡ç”¨ Druidï¼ŒPOJO æ„å»ºé‡‡ç”¨ Lombokï¼Œæ—¥å¿—ç³»ç»Ÿé‡‡ç”¨ Log4j2ï¼Œ Guava å·¥å…·ç±»åº“ï¼ŒMybatis Plus æŒä¹…å±‚æ¥å£å®ç°ï¼ŒSharding-jdbc åˆ†åº“åˆ†è¡¨ç»„ä»¶ï¼ŒSwagger æ¥å£è§„èŒƒç»„ä»¶ï¼ŒXXL-job åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç»„ä»¶ï¼ŒSentinel é™æµç»„ä»¶ç­‰ã€‚\n\n\næ¥å…¥ Zuul ç½‘å…³å®Œæˆå®¢æˆ·ç«¯è®¤è¯ã€è·¯ç”±è½¬å‘ç­‰åŠŸèƒ½ï¼ŒDubbo RPC å®Œæˆå¾®æœåŠ¡è¿œç¨‹è°ƒç”¨ï¼ŒJWT æä¾›å‰åç«¯ä»¤ç‰Œç®¡ç†æ–¹æ¡ˆã€‚\n\n\nè§†å›¾å¹³å°æ”¯æŒ H5ã€PC ç­‰å„ç§å‰ç«¯ã€‚\n\n\nå•†æˆ·æ³¨å†Œ&amp;èµ„è´¨ç”³è¯·\nç³»ç»Ÿäº¤äº’æµç¨‹\n\nå•†æˆ·æ³¨å†Œçš„æµç¨‹ç”±å•†æˆ·å¹³å°åº”ç”¨ã€å•†æˆ·æœåŠ¡ã€SaaS å¹³å°ã€éªŒè¯ç æœåŠ¡å››ä¸ªå¾®æœåŠ¡ä¹‹é—´è¿›è¡Œäº¤äº’å®Œæˆï¼Œå„å¾®æœåŠ¡çš„èŒè´£ä»‹ç»å¦‚ä¸‹ï¼š\n1ï¼‰å•†æˆ·å¹³å°åº”ç”¨ï¼šæ­¤åº”ç”¨ä¸»è¦ä¸ºå•†æˆ·æä¾›ä¸šåŠ¡åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼šå•†æˆ·èµ„è´¨ç”³è¯·ã€å‘˜å·¥ç®¡ç†ã€é—¨åº—ç®¡ç†ç­‰åŠŸèƒ½ã€‚\n2ï¼‰å•†æˆ·æœåŠ¡ï¼š æä¾›å•†æˆ·ç®¡ç†çš„ç›¸å…³æœåŠ¡æ¥å£ï¼Œä¾›å…¶å®ƒå¾®æœåŠ¡è°ƒç”¨ï¼Œä¸»è¦ä¸ºå•†æˆ·å¹³å°åº”ç”¨æä¾›æ¥å£æœåŠ¡ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼šå•†æˆ·åŸºæœ¬ä¿¡æ¯ç®¡ç†ã€èµ„è´¨ç”³è¯·ï¼ˆè¿™ä¸ªåŠŸèƒ½è›®è«åå…¶å¦™çš„ï¼Œå†™äº†ä½†æ˜¯æ²¡æœ‰åç»­çš„å®¡æ ¸æ“ä½œï¼Œä¸çŸ¥é“å¹²ä»€ä¹ˆç”¨çš„ğŸ˜¥ï¼‰ã€å•†æˆ·åº”ç”¨ç®¡ç†ã€æ¸ é“å‚æ•°é…ç½®ã€å•†æˆ·å‘˜å·¥ä¿¡æ¯ç®¡ç†ã€å•†æˆ·é—¨åº—ç®¡ç†ç­‰ã€‚\n3ï¼‰SaaS å¹³å°ï¼šé—ªèšæ”¯ä»˜é¡¹ç›®æ˜¯ä¸€ä¸ª SaaS å¹³å° ï¼Œæ‰€è°“ SaaS å¹³å°å³å¤šä¸ªç”¨æˆ·ç§Ÿç”¨å¹³å°çš„ä¸šåŠ¡åŠŸèƒ½ï¼Œè¿™æ ·ç”¨æˆ·å³å¯çœå»è½¯ä»¶ç³»ç»Ÿå¼€å‘çš„æˆæœ¬ï¼Œæ¯ä¸ªå•†æˆ·å°±æ˜¯ä¸€ä¸ªç§Ÿæˆ·ï¼Œæ‰€ä»¥åˆç§°ä¸ºå¤šç§Ÿæˆ·ç³»ç»Ÿã€‚ SaaS å¹³å°æä¾›ç§Ÿæˆ·ç®¡ç†ã€è´¦å·ç®¡ç†ã€æƒé™ç®¡ç†ã€èµ„æºç®¡ç†ã€å¥—é¤ç®¡ç†ã€ç³»ç»Ÿè®¤è¯æˆæƒç­‰åŠŸä¸šåŠ¡åŠŸèƒ½ã€‚åœ¨ä¸Šå›¾å•†æˆ·æ³¨å†Œçš„æµç¨‹ä¸­ï¼Œå•†æˆ·æ³¨å†Œçš„è´¦å·ç­‰ä¿¡æ¯éœ€è¦å†™å…¥ SaaS å¹³å°ï¼Œç”± SaaS å¹³å°ç»Ÿä¸€ç®¡ç†è´¦å·ï¼Œåˆ†é…æƒé™ï¼Œå•†æˆ·ç»Ÿä¸€é€šè¿‡ SaaS å¹³å°ç™»å½•é—ªèšæ”¯ä»˜ã€‚\n4ï¼‰éªŒè¯ç æœåŠ¡ï¼šæä¾›è·å–çŸ­ä¿¡éªŒè¯ç ã€æ ¡éªŒéªŒè¯ç çš„æ¥å£ã€‚ å•†æˆ·ä½¿ç”¨æ‰‹æœºå·è¿›è¡Œæ³¨å†Œï¼Œå¹³å°é€šè¿‡æ ¡éªŒæ‰‹æœºéªŒè¯ç æ¥ç¡®è®¤æ˜¯å¦æœ¬äººåœ¨æ³¨å†Œã€‚\n\nè·å–çŸ­ä¿¡éªŒè¯ç \nçŸ­ä¿¡éªŒè¯ç ä¸ºä¸€ä¸ªå¼€æºçš„æœåŠ¡ï¼Œå¯å•ç‹¬å¼€å¯ä½¿ç”¨ã€‚\nå¼€æº git åœ°å€ï¼š(https://github.com/fightingape/sailing)\n\nå¤§è‡´çœ‹äº†ä¸€ä¸‹è¿™ä¸ªå¼€æºé¡¹ç›®æ˜¯æ ¹æ®ä¼ å…¥çš„ä¸šåŠ¡åç§°ï¼Œè·å–é…ç½®å¥½çš„ code é•¿åº¦å’Œ Service å®ç°ã€‚åç»­åº”è¯¥è¿˜å¯ä»¥åŠ å…¥åˆ«çš„å®ç°ï¼ˆæ¯”å¦‚é˜¿é‡Œäº‘çš„çŸ­ä¿¡æœåŠ¡ç­‰ï¼‰\nå…¶ä¸­ç”ŸæˆéªŒè¯ä¿¡æ¯è¿™ä¸ªæ–¹æ³•ã€‚\n1.æ ¹æ®ä¸šåŠ¡åç§° + éšæœº UUID ç”Ÿæˆ key å­˜å…¥ redisã€‚è¿™ä¸ª key ä¼šè¿”å›ç»™æœåŠ¡è¯·æ±‚æ–¹ã€‚\n2.æ ¹æ®é…ç½®å¥½çš„ Map è·å–åç§°å¯¹åº”çš„ len å³ code ç é•¿åº¦ï¼Œå¦‚æœä¼ å…¥ä¸å­˜åœ¨çš„ nameï¼Œä¼šç›´æ¥æŠ¥é”™ã€‚\n3.éªŒè¯æœåŠ¡å°±æ˜¯æ ¹æ®è¿”å›ç»™æœåŠ¡è¯·æ±‚æ–¹çš„ keyï¼ŒæŸ¥è¯¢ Redis ç¼“å­˜æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨è¿”å› falseï¼Œå³éªŒè¯ç é”™è¯¯ã€‚\n\næœ¬é¡¹ç›®ä¸­æ²¡æœ‰ä½¿ç”¨ï¼Œåªæ˜¯ç®€å•æ§åˆ¶å°æ‰“å°äº†ä¸€ä¸‹ã€‚ä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¿™ä¸ªæœåŠ¡é‡Œå­˜å…¥ redisï¼ˆå› ä¸ºè¦ç”³è¯·å¼€é€šé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡æœ‰ç‚¹éº»çƒ¦ï¼Œåˆè¦å¤šéƒ¨ç½²ä¸€ä¸ªæœåŠ¡ï¼Œè€Œä¸”è¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒç®€å•ä¸æ‰“ç®—èŠ±æ—¶é—´å¼€é€šäº†ï¼‰ã€‚\nä¹‹å‰æœ‰å†™è¿‡é˜¿é‡Œäº‘çš„çŸ­ä¿¡ï¼Œå…³è”æ–‡ç« ï¼š\n\nå†…é“¾ï¼š[[ã€ä»£ç æ¨¡æ¿ã€‘é˜¿é‡Œäº‘æ¥å£å®ç°çŸ­ä¿¡å‘é€]]\nå¤–é“¾ï¼šã€ä»£ç æ¨¡æ¿ã€‘é˜¿é‡Œäº‘æ¥å£å®ç°çŸ­ä¿¡å‘é€\n\næ–‡ä»¶ä¸Šä¼ \nèµ„è´¨ç”³è¯·çš„æµç¨‹ä¸­æ¶‰åŠåˆ°äº†æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ã€‚ä¹‹å‰å·²ç»å†™è¿‡ä½¿ç”¨ Minio ä½œä¸ºæ–‡ä»¶æœåŠ¡å™¨å’Œç”¨é˜¿é‡Œäº‘ OSS ä½œä¸ºæ–‡ä»¶å­˜å‚¨ä¸¤ç§æ–¹å¼ã€‚è¿™é‡Œçš„ä¸Šä¼ ç›´æ¥æŠŠä¸ƒç‰›äº‘æ¢æˆäº† Minioã€‚é¡ºä¾¿æ•´ç†äº†ä¸€ä¸‹ä¹‹å‰å†™è¿‡çš„ä¸¤ç§æ–¹å¼ã€‚\næ–‡ä»¶ä¸Šä¼ ï¼š\n\nå†…é“¾ï¼š[[ã€ä»£ç æ¨¡æ¿ã€‘æ–‡ä»¶å­˜å‚¨]]\nå¤–é“¾ï¼šã€ä»£ç æ¨¡æ¿ã€‘æ–‡ä»¶å­˜å‚¨\n\næ”¯ä»˜å‚æ•°é…ç½®\n\nè¿™ä¸ªéƒ¨åˆ†æ˜¯é¡¹ç›®çš„æ ¸å¿ƒï¼Œä¹‹å‰åšåˆ«çš„é¡¹ç›®çš„æ—¶å€™ï¼Œæ¥è§¦äº†å¾®ä¿¡æ”¯ä»˜å’Œæ”¯ä»˜å®æ”¯ä»˜ã€‚å°±å’Œè¿™ä¸ªé¡¹ç›®ä¸­è¯´çš„ä¸€æ ·ï¼Œç”¨æˆ·åªèƒ½å…ˆé€‰æ‹©æ”¯ä»˜ç±»å‹ã€‚å†è°ƒç”¨å¯¹åº”çš„æ¥å£è·å–æ”¯ä»˜äºŒç»´ç ã€‚è€Œé€šè¿‡èšåˆæ”¯ä»˜è¿™ä¸ªå¹³å°ï¼Œå¯ä»¥åªç”Ÿæˆä¸€ä¸ªé“¾æ¥ï¼Œæ ¹æ®ç”¨æˆ·æ‰«ç ï¼Œè·³è½¬ä¸åŒçš„æ”¯ä»˜ã€‚\n\nå•†æˆ·åº”è¯¥é…ç½®å“ªäº›ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¸ é“çš„å‚æ•°\næœåŠ¡ç±»å‹æ˜¯é—ªèšæ”¯ä»˜å¹³å°ä¸ºå•†æˆ·æä¾›çš„èšåˆæ”¯ä»˜æœåŠ¡é€šé“ï¼Œå…±åˆ†ä¸ºçº¿ä¸Šå’Œçº¿ä¸‹ä¸¤å¤§ç±»ï¼š\nçº¿ä¸Šæ”¯ä»˜æœåŠ¡é€šé“ï¼š\n\n\næ‰‹æœº APP æ”¯ä»˜\n\n\nPC ç½‘é¡µæ”¯ä»˜\n\n\næ‰‹æœºç½‘é¡µæ”¯ä»˜\n\n\nå°ç¨‹åºæ”¯ä»˜\nçº¿ä¸‹æ”¯ä»˜æœåŠ¡é€šé“ï¼š\n\n\næ”¶æ¬¾ç æ”¯ä»˜ (C æ‰« B)ï¼šå³å•†æˆ·å‡ºç¤ºä»˜æ¬¾ç ï¼Œç”¨æˆ·æ‰«æ”¶æ¬¾ç å®Œæˆæ”¯ä»˜ã€‚\n\n\nB æ‰« Cï¼šå³é¡¾å®¢å‡ºç¤ºä»˜æ¬¾ç ï¼Œå•†æˆ·æ‰«æä»˜æ¬¾ç ã€‚\n\n\nç³»ç»Ÿäº¤äº’æµç¨‹\n\n\nå•†æˆ·åº”ç”¨åˆ›å»ºæµç¨‹\n\n\n\nå•†æˆ·æ¸ é“å‚æ•°é…ç½®äº¤äº’æµç¨‹\näº¤æ˜“æœåŠ¡èŒè´£ï¼šæä¾›æ”¯ä»˜æ¸ é“å‚æ•°é…ç½®ã€è®¢å•ã€å‘èµ·æ”¯ä»˜ã€è½¬è´¦ã€é€€æ¬¾ç­‰åŠŸèƒ½ã€‚\n\n\nC æ‰« B\n\n1ã€ä¸ºé—¨åº—ç”Ÿæˆç»Ÿä¸€çš„æ”¯ä»˜äºŒç»´ç ï¼Œç”¨æˆ·æ‰«ä¸€ä¸‹äºŒç»´ç å³å¯ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜ä¹Ÿå¯ä½¿ç”¨æ”¯ä»˜å®å®Œæˆæ”¯ä»˜ã€‚\n2ã€é—ªèšæ”¯ä»˜å¹³å°ä¸å¾®ä¿¡ã€æ”¯ä»˜å®å¯¹æ¥ï¼Œé—ªèšæ”¯ä»˜ä½œä¸ºä¸­ä»‹ï¼Œæœ€ç»ˆçš„æ”¯ä»˜åŠ¨ä½œï¼ˆé“¶è¡Œäº¤æ˜“ï¼‰ä»é€šè¿‡å¾®ä¿¡ã€æ”¯ä»˜å®è¿›è¡Œã€‚\n3ã€é—ªèšå¹³å°ä½œä¸ºä¸­ä»‹è°ƒç”¨å¾®ä¿¡ã€æ”¯ä»˜å®çš„ä¸‹å•æ¥å£ï¼Œå®Œæˆæ”¯ä»˜ã€‚\n\né‡ç‚¹ï¼šæ ¹æ®ä»£ç ï¼Œé¡¹ç›®ä¸­çš„èšåˆæ”¯ä»˜å®ç°ä¸»è¦ä¾é ==æ‰«ç æ¥å£çš„ request ä¸­çš„ user-agent ==æ¥åˆ¤æ–­æµè§ˆå™¨ç±»å‹\nä¸šåŠ¡æµç¨‹å¦‚ä¸‹ï¼š\n\nç”ŸæˆäºŒç»´ç çš„ç³»ç»Ÿäº¤äº’æµç¨‹å¦‚ä¸‹ï¼š\n\n\n\nå•†æˆ·ç™»å½•å•†æˆ·åº”ç”¨å¹³å° ï¼ŒæŸ¥è¯¢é—¨åº—åˆ—è¡¨\n\n\nå•†æˆ·å¹³å°è¯·æ±‚äº¤æ˜“æœåŠ¡è·å–é—¨åº—äºŒç»´ç  URL\n\n\nå•†æˆ·å¹³å°æ ¹æ® URL ç”ŸæˆäºŒç»´ç \n\n\näº¤æ˜“æœåŠ¡æ”¯ä»˜å…¥å£ï¼š\n\n\n\né¡¾å®¢æ‰«æäºŒç»´ç ï¼Œè¯·æ±‚äº¤æ˜“æœåŠ¡æ”¯ä»˜å…¥å£\n\n\näº¤æ˜“æœåŠ¡è§£æè¯·æ±‚ï¼Œç”Ÿæˆæ”¯ä»˜ç¡®è®¤é¡µé¢\n\n\näº¤æ˜“æœåŠ¡å‘æœåŠ¡å“åº”æ”¯ä»˜ç¡®è®¤é¡µé¢\n\n\næ”¯ä»˜å®ç»Ÿä¸€ä¸‹å•æ¥å£å¯¹æ¥ï¼š\n\n\n\né¡¾å®¢è¾“å…¥é‡‘é¢ï¼Œç‚¹å‡»ç«‹å³æ”¯ä»˜\n\n\nè¯·æ±‚äº¤æ˜“æœåŠ¡ï¼Œäº¤æ˜“æœåŠ¡ä¿å­˜è®¢å•\n\n\näº¤æ˜“æœåŠ¡è°ƒç”¨æ”¯ä»˜æ¸ é“ä»£ç†æœåŠ¡çš„æ”¯ä»˜å®ä¸‹å•æ¥å£\n\n\næ”¯ä»˜æ¸ é“ä»£ç†æœåŠ¡è°ƒç”¨æ”¯ä»˜å®çš„ç»Ÿä¸€ä¸‹å•æ¥å£ã€‚\n\n\næ”¯ä»˜å‡­è¯è¿”å›\n\n\n\næ”¯ä»˜å®æ”¯ä»˜ç›¸å…³å†…å®¹ï¼š\nå†…é“¾ï¼š[[ã€ä»£ç æ¨¡æ¿ã€‘æ”¯ä»˜å®æ”¯ä»˜æ¥å…¥]]\nå¤–é“¾ï¼šã€ä»£ç æ¨¡æ¿ã€‘æ”¯ä»˜å®æ”¯ä»˜æ¥å…¥\n\nå¾®ä¿¡æ”¯ä»˜æ¥å£å¯¹æ¥ï¼š\n\nå¾®ä¿¡æ”¯ä»˜ç›¸å…³å†…å®¹ï¼š\nå†…é“¾ï¼š[[ã€ä»£ç æ¨¡æ¿ã€‘å¾®ä¿¡æ”¯ä»˜æ¥å…¥]]\nå¤–é“¾ï¼šã€ä»£ç æ¨¡æ¿ã€‘å¾®ä¿¡æ”¯ä»˜æ¥å…¥\n\nè·å–æ”¯ä»˜ç»“æœï¼ˆRocketMQï¼‰\n\nå®Œæˆæ”¯ä»˜åç¬¬ä¸‰æ–¹æ”¯ä»˜ç³»ç»Ÿæä¾›ä¸¤ç§æ–¹å¼è·å–æ”¯ä»˜ç»“æœï¼š\n\n\nç¬¬ä¸‰æ–¹æ”¯ä»˜ç³»ç»Ÿä¸»åŠ¨é€šçŸ¥é—ªèšæ”¯ä»˜å¹³å°æ”¯ä»˜ç»“æœã€‚\n\n\né—ªèšæ”¯ä»˜å¹³å°ä¸»åŠ¨ä»ç¬¬ä¸‰æ–¹æ”¯ä»˜ç³»ç»ŸæŸ¥è¯¢æ”¯ä»˜ç»“æœã€‚\n\n\nä»¥ä¸Šä¸¤ç§æ–¹æ³•åœ¨å®é™…é¡¹ç›®ä¸­å¯ä»¥éƒ½ç”¨ï¼Œå…¶ä¸­ç¬¬äºŒç§æ˜¯å¿…é¡»ç”¨çš„ï¼Œå› ä¸ºç¬¬ä¸€ç§æ˜¯ç”±ç¬¬ä¸‰æ–¹æ”¯ä»˜ç³»ç»Ÿä¸»åŠ¨é€šçŸ¥é—ªèšæ”¯ä»˜å¹³å°ï¼Œå½“è°ƒç”¨é—ªèšå¹³å°æ¥å£æ— æ³•é€šä¿¡è¾¾åˆ°ä¸€å®šçš„æ¬¡æ•°åç¬¬ä¸‰æ–¹æ”¯ä»˜ç³»ç»Ÿå°†ä¸å†é€šçŸ¥ã€‚\n\nå¯¹æ¥ SAAS\nç³»ç»Ÿäº¤äº’æµç¨‹\nå•†æˆ·æ³¨å†Œæ—¶ä¸ SAAS çš„äº¤äº’æµç¨‹å·²ç»åœ¨å•†æˆ·æ³¨å†Œæ¨¡å—ç»™å‡ºã€‚\nåˆ†å¸ƒå¼è®¤è¯éœ€æ±‚\n\n\nç»Ÿä¸€è®¤è¯æˆæƒåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¯ä¸ªæœåŠ¡ï¼ˆç³»ç»Ÿï¼‰éƒ½ä¼šæœ‰è®¤è¯ã€æˆæƒçš„éœ€æ±‚ï¼Œå¦‚æœæ¯ä¸ªæœåŠ¡éƒ½å®ç°ä¸€å¥—è®¤è¯æˆæƒé€»è¾‘ä¼šéå¸¸å†—ä½™ï¼Œè€ƒè™‘åˆ†å¸ƒå¼ç³»ç»Ÿå…±äº«æ€§çš„ç‰¹ç‚¹ï¼Œéœ€è¦ç”±ç‹¬ç«‹çš„è®¤è¯æœåŠ¡æ¥å¤„ç†ç³»ç»Ÿè®¤è¯æˆæƒçš„è¯·æ±‚ã€‚å¦‚ä¸‹å›¾ï¼Œé—ªèšæ”¯ä»˜å¹³å°åŒ…æ‹¬ï¼šå•†æˆ·å¹³å°åº”ç”¨ã€è¿è¥å¹³å°åº”ç”¨ã€é—¨æˆ·åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½éœ€è¦èº«ä»½è®¤è¯ï¼Œé—ªèšæ”¯ä»˜å¹³å°ç»Ÿä¸€ç”± UAA è®¤è¯æœåŠ¡å®Œæˆè®¤è¯ã€‚\n\n\n\nå¼€æ”¾è®¤è¯ä½“ç³»è€ƒè™‘åˆ†å¸ƒå¼ç³»ç»Ÿå¼€æ”¾æ€§çš„ç‰¹ç‚¹ï¼ŒUAA è®¤è¯æœåŠ¡ä¸ä»…æœåŠ¡äºå¹³å°è‡ªèº«ï¼Œå¹¶ä¸”å¯¹ç¬¬ä¸‰æ–¹ç³»ç»Ÿä¹Ÿè¦æä¾›è®¤è¯ï¼Œå¹³å°åº”æä¾›æ‰©å±•å’Œå¼€æ”¾çš„è®¤è¯æœºåˆ¶ï¼Œä»¥å¼€æ”¾ API çš„æ–¹å¼ä¾›ç¬¬ä¸‰æ–¹åº”ç”¨æ¥å…¥ï¼Œä¸€æ–¹åº”ç”¨ï¼ˆå†…éƒ¨ç³»ç»ŸæœåŠ¡ï¼‰å’Œä¸‰æ–¹åº”ç”¨ï¼ˆç¬¬ä¸‰æ–¹åº”ç”¨ï¼‰å‡é‡‡ç”¨ç»Ÿä¸€æœºåˆ¶æ¥å…¥ã€‚\n\n\nåˆ†å¸ƒå¼ç³»ç»Ÿè®¤è¯æŠ€æœ¯æ–¹æ¡ˆè¯¦è§ä¸‹å›¾ï¼š\n\næµç¨‹æ‰€æ¶‰åŠåˆ°ç»Ÿä¸€è´¦å·æœåŠ¡ã€UAA æœåŠ¡ã€API ç½‘å…³è¿™ä¸‰ä¸ªç»„ä»¶èŒè´£å¦‚ä¸‹:\n1ï¼‰ ç»Ÿä¸€è´¦å·æœåŠ¡ï¼šæä¾›å•†æˆ·å’Œå¹³å°è¿è¥äººå‘˜çš„ç™»å½•è´¦å·ã€å¯†ç ã€è§’è‰²ã€æƒé™ã€èµ„æºç­‰ç³»ç»Ÿçº§ä¿¡æ¯çš„ç®¡ç†ï¼Œä¸åŒ…å«ç”¨æˆ·ä¸šåŠ¡ä¿¡æ¯ã€‚\n2ï¼‰ ç»Ÿä¸€è®¤è¯æœåŠ¡ï¼šå®ƒæ‰¿è½½äº† OAuth2.0 æ¥å…¥æ–¹è®¤è¯ã€ç™»å…¥ç”¨æˆ·çš„è®¤è¯ã€æˆæƒä»¥åŠç”Ÿæˆä»¤ç‰Œçš„èŒè´£ï¼Œå®Œæˆå®é™…çš„ç”¨æˆ·è®¤è¯ã€æˆæƒåŠŸèƒ½ã€‚\n3ï¼‰ API ç½‘å…³ï¼šä½œä¸ºç³»ç»Ÿçš„å”¯ä¸€å…¥å£ï¼ŒAPI ç½‘å…³ä¸ºæ¥å…¥æ–¹æä¾›å®šåˆ¶çš„ API é›†åˆï¼Œå®ƒå¯èƒ½è¿˜å…·æœ‰å…¶å®ƒèŒè´£ï¼Œå¦‚èº«ä»½éªŒè¯ã€ç›‘æ§ã€è´Ÿè½½ å‡è¡¡ã€ç¼“å­˜ç­‰ã€‚API ç½‘å…³æ–¹å¼çš„æ ¸å¿ƒè¦ç‚¹æ˜¯ï¼Œæ‰€æœ‰çš„æ¥å…¥æ–¹å’Œæ¶ˆè´¹ç«¯éƒ½é€šè¿‡ç»Ÿä¸€çš„ç½‘å…³æ¥å…¥å¾®æœåŠ¡ï¼Œåœ¨ç½‘å…³å±‚å¤„ç† æ‰€æœ‰çš„éä¸šåŠ¡åŠŸèƒ½ã€‚\nBUG è®°å½•\nRestTemplate ä½¿ç”¨ GET è¯·æ±‚ï¼Œè¿”å›ä¸­æ–‡ä¹±ç \n\nå†…é“¾ï¼š[[RestTemplateä½¿ç”¨GETè¯·æ±‚ï¼Œè¿”å›ä¸­æ–‡ä¹±ç ]]\nå¤–é“¾ï¼šRestTemplateä½¿ç”¨GETè¯·æ±‚ï¼Œè¿”å›ä¸­æ–‡ä¹±ç \n\né¡¹ç›®ä¸­è®¿é—® Swagger åœ°å€ï¼Œ404ï¼ˆæœªè§£å†³ï¼‰\nä¸ç®¡æ€ä¹ˆè®¿é—® swagger çš„é¡µé¢åœ°å€ï¼Œéƒ½è¿”å› 404ã€‚ä½†æ˜¯ç›´æ¥ç”¨ apifox çš„ URL å¯¼å…¥ï¼Œæ˜¯å¯ä»¥æˆåŠŸçš„ğŸ¥´ã€‚\nä½¿ç”¨ mapstruct è½¬æ¢å¯¹è±¡ï¼ŒæŠ¥é”™ Cannot find implementation forâ€¦â€¦\nè¿™ä¸ªé¡¹ç›®ä¸­æ˜¯å› ä¸º User å¾®æœåŠ¡æ²¡æœ‰ä¾èµ– mapstructã€‚ä½†æ˜¯ swagger ä¸­æœ‰è¿™ä¸ªä¾èµ–ï¼Œä»–ç›´æ¥ç”¨äº† swagger ä¸­çš„ä¾èµ–ã€‚ç½‘ä¸Šæœç´¢è¿˜æœ‰ä¸€ç§æƒ…å†µå¯èƒ½å‡ºç°è¿™ä¸ªé—®é¢˜ã€‚\n\nå†…é“¾ï¼š[[ä½¿ç”¨mapstructè½¬æ¢å¯¹è±¡ï¼ŒæŠ¥é”™Cannot find implementation forâ€¦â€¦]]\nå¤–é“¾ï¼šä½¿ç”¨mapstructè½¬æ¢å¯¹è±¡ï¼ŒæŠ¥é”™Cannot find implementation forâ€¦â€¦\n\nå‰ç«¯ JS åœ¨ Long é•¿åº¦å¤§äº 17 ä½æ—¶ï¼Œå‡ºç°ç²¾åº¦ä¸¢å¤±çš„é—®é¢˜\n\nå†…é“¾ï¼š[[Longé•¿åº¦å¤§äº17ä½æ—¶ï¼Œç²¾åº¦ä¸¢å¤±]]\nå¤–é“¾ï¼šLongé•¿åº¦å¤§äº17ä½æ—¶ï¼Œç²¾åº¦ä¸¢å¤±\n\nä½¿ç”¨ git æäº¤æŠ¥é”™ï¼šerror RPC failed; HTTP 413 curl 22 The requested URL returned error 413\n\nå†…é“¾ï¼š[[ä½¿ç”¨ git æäº¤æŠ¥é”™ï¼šerror RPC failed; HTTP 413 curl 22 The requested URL returned error 413]]\nå¤–é“¾ï¼šä½¿ç”¨ git æäº¤æŠ¥é”™ï¼šerror: RPC failed; HTTP 413 curl 22 The requested URL returned error: 413\n\n","categories":["åç«¯é¡¹ç›®","å…¶ä»–é¡¹ç›®"],"tags":["Java"]},{"title":"ç¤¾åŒºä¸­è€å¹´å¿—æ„¿è€…å¹³å°","url":"/posts/25cfff2e/","content":"\n\nå‰è¨€æœ¬é¡¹ç›®ä¸»è¦è®°å½•è‡ªæ¥å¤–åŒ…é¡¹ç›®éœ€è¦æ³¨æ„çš„ç‚¹ã€‚é¡¹ç›® git åœ°å€ï¼šhttps://gitee.com/kiml_rgb/silver-volunteer.git\n\n\næ›´æ–°\n\n\n25-02-02 åˆå§‹è®°å½•\n\né¡¹ç›®æ¦‚è¿°\nå•ä½“é¡¹ç›®ï¼Œåˆ†ä¸ºå°ç¨‹åºç«¯å’Œåå°ç®¡ç†éƒ¨åˆ†ã€‚æœ¬é¡¹ç›®ç›¸å…³ç¬”è®°ä¸»è¦ç”¨äºè®°å½•å¯¹æ¥å¤–åŒ…é¡¹ç›®éœ€è¦æ³¨æ„çš„è¦ç‚¹ã€‚\næŠ€æœ¯æ ˆ\n\n\n\nå±‚çº§\næŠ€æœ¯\n\n\n\n\nè§†å›¾\nå°ç¨‹åºã€Vue\n\n\nç»„ä»¶\nSpring bootã€Log4j2ã€Mybatis Plus\n\n\nåŸºç¡€è®¾æ–½\nMysqlã€Minio\n\n\nDevOps\nMavenã€Git\n\n\n\nå‡†å¤‡\næ”¶è´¹\n\n\n\né¡¹ç›®\nè®¡è´¹æ ‡å‡†\n\n\n\n\né˜¿é‡Œäº‘æœåŠ¡å™¨\næŒ‰é˜¿é‡Œäº‘æŠ¥ä»·ä¿¡æ¯ï¼ˆæ–°äººé¦–å¹´æœ‰æŠ˜æ‰£ï¼‰\n\n\nåŸŸå\nä¸€å¹´ä¸€ç»­è´¹\n\n\nå°ç¨‹åºè®¤è¯è´¹ç”¨\næ¯å¹´ 300\n\n\nå¼€å‘è´¹ç”¨\n\n\n\n\næ—¶é—´\n\n\n\né¡¹ç›®\næ—¶é—´\nå¤‡æ³¨\n\n\n\n\nå°ç¨‹åºå¤‡æ¡ˆ\n3 day\nä¼ä¸šèµ„è´¨\n\n\nå°ç¨‹åºåå°å¤‡æ¡ˆï¼ˆæœåŠ¡å™¨åŸŸåå¤‡æ¡ˆï¼‰\n3 day\nä¸ªäººèµ„è´¨ï¼Œä¸å°ç¨‹åºå¤‡æ¡ˆèµ„è´¨å¯ä»¥ä¸åŒï¼Œåªéœ€è¦åå°å¯ä»¥è®¿é—®\n\n\né˜¿é‡Œäº‘çŸ­ä¿¡èµ„è´¨å®¡æ ¸\n1 day\né˜¿é‡Œäº‘å®åä¸ºä¸ªäººï¼Œå®¡æ ¸èµ„è´¨ä¸ºè‡ªç”¨\n\n\né˜¿é‡Œäº‘çŸ­ä¿¡ç­¾åå®¡æ ¸ï¼ˆè¯•ç”¨ï¼‰\n2 hour\nè‡ªç”¨èµ„è´¨åœ¨æ²¡æœ‰å¤‡æ¡ˆç½‘ç«™/ä¸Šçº¿ App çš„æƒ…å†µä¸‹åªèƒ½é€‰æ‹©çº¿ä¸Šè¯•ç”¨ï¼Œçº¿ä¸Šè¯•ç”¨çŸ­ä¿¡æœ‰é™åˆ¶\n\n\né˜¿é‡Œäº‘çŸ­ä¿¡ç­¾åå®¡æ ¸ï¼ˆå·²å¤‡æ¡ˆç½‘ç«™ï¼‰\n7-10 day\nç›®å‰è¿è¥å•†å®åæŠ¥å¤‡æµç¨‹å¹³å‡éœ€è¦ 5-7 ä¸ªå·¥ä½œæ—¥ï¼Œéƒ¨åˆ†è¿è¥å•†å¯èƒ½å»¶é•¿è‡³7-10 ä¸ªå·¥ä½œæ—¥ã€‚\n\n\né˜¿é‡Œäº‘çŸ­ä¿¡æ¨¡æ¿å®¡æ ¸\n2 hour\n\n\n\nåŸŸåæ³¨å†Œ\n\nä¿¡æ¯æ¨¡æ¿ å®åè®¤è¯\n\n\n\næœåŠ¡å™¨\n\n\nå‰åç«¯é¡¹ç›®\n\n\nJava ç¯å¢ƒã€MySQL ç¯å¢ƒã€Redis ç¯å¢ƒ\n\n\næ–‡ä»¶å­˜å‚¨æœåŠ¡ï¼ˆä¾‹ï¼šMinioï¼‰ã€docker ç¯å¢ƒ\n\n\n\nå†…é“¾ï¼š[[è£…æœº-è½¯ä»¶å®‰è£…ï¼ˆLinuxï¼‰]]\nå¤–é“¾ï¼šè£…æœº-è½¯ä»¶å®‰è£…ï¼ˆLinuxï¼‰\n\n\n\nnginx\n\n\n\nå†…é“¾ï¼š[[ã€ä»£ç æ¨¡æ¿ã€‘Nginx]]\nå¤–é“¾ï¼šã€ä»£ç æ¨¡æ¿ã€‘Nginx\n\n\n\nssl è¯ä¹¦\n\n\n\nå†…é“¾ï¼š[[Letâ€™s Encrypt å…è´¹ç”³è¯·æ³›åŸŸå SSL è¯ä¹¦ï¼Œå¹¶å®ç°è‡ªåŠ¨ç»­æœŸ]]\nå¤–é“¾ï¼šLetâ€™s Encrypt å…è´¹ç”³è¯·æ³›åŸŸå SSL è¯ä¹¦ï¼Œå¹¶å®ç°è‡ªåŠ¨ç»­æœŸ\n\nBUG\nemoji è¡¨æƒ…ä¿å­˜æŠ¥é”™\n","categories":["åç«¯é¡¹ç›®","å…¶ä»–é¡¹ç›®"]},{"title":"ã€ä»£ç æ¨¡æ¿ã€‘Nginx","url":"/posts/bc551f67/","content":"\n\nå‰è¨€Nginx å¸¸ç”¨æ¨¡æ¿\n\n\næ›´æ–°\n\n\n25-03-24 åˆå§‹è®°å½•\n\nç®€å•é¡¹ç›®æ¨¡æ¿\nuser root;worker_processes  1;events &#123;    worker_connections  1024;&#125;http &#123;    include       mime.types;    default_type  application/octet-stream;    sendfile        on;    keepalive_timeout  65;    client_max_body_size 500M;    # HTTP server block, redirect to HTTPS æ­¤éƒ¨åˆ†å†…å®¹å¯ä»¥ç”±è¯ä¹¦ç½‘ç«™ç”Ÿæˆ    server &#123;        listen       80;        server_name  sxqxyyl.cn www.sxqxyyl.cn;        # Redirect HTTP to HTTPS        return 301 https://$host$request_uri;    &#125;    # HTTPS server block    server &#123;        listen       443 ssl;        server_name  sxqxyyl.cn www.sxqxyyl.cn;        # SSL certificate and key        # SSL ç›¸å…³å†…å®¹å¯ä»¥ç”±è¯ä¹¦ç½‘ç«™ç”Ÿæˆ        location / &#123;            root  /root/frontend/dist;            index   index.html index.htm;  # ç¡®ä¿è¿™æ˜¯æ‚¨çš„ç½‘ç«™æ ¹ç›®å½•            try_files $uri $uri/ /index.html;        &#125;\t\t# å‰ç«¯è®¿é—®è·¯å¾„é…ç½®ä¸º /api        location /api/ &#123;            rewrite ^/api/(.*)$ /$1 break;  # ç¡®ä¿è·¯å¾„è¢«é‡å†™ä¸ºåç«¯åº”ç”¨éœ€è¦çš„æ ¼å¼            proxy_pass http://127.0.0.1:8888/;  # å°†è¯·æ±‚è½¬å‘åˆ°åç«¯æœåŠ¡            proxy_redirect off;            proxy_set_header Host $host;            proxy_set_header X-Real-IP $remote_addr;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        &#125;        location /minio/ &#123;            proxy_pass http://127.0.0.1:9000/;  # MinIO è¿è¡Œåœ¨ HTTP 9000 ç«¯å£            proxy_set_header Host $host;            proxy_set_header X-Real-IP $remote_addr;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        &#125;        # Error pages for 500, 502, 503, 504        error_page   500 502 503 504  /50x.html;        location = /50x.html &#123;            root  /root/frontend/dist;        &#125;    &#125;&#125;\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["Nginx"]},{"title":"ã€ä»£ç æ¨¡æ¿ã€‘æ”¯ä»˜å®æ”¯ä»˜æ¥å…¥","url":"/posts/fc17a9b8/","content":"\n\nå‰è¨€æ”¯ä»˜å®æ”¯ä»˜æ¥å…¥æµç¨‹\n\n\næ›´æ–°\n\n\n24-07-19 åˆå§‹è®°å½•\n\næ”¯ä»˜äº§å“\næ”¯ä»˜å®ä¸ºæ™®é€šå•†æˆ·æä¾›å¦‚ä¸‹æ”¯ä»˜äº§å“ https://b.alipay.com/page/product-workspace/all-productï¼š\n\né…ç½®æ”¯ä»˜å®æ²™ç®±ç¯å¢ƒ\næ¥å…¥æ‰‹æœºç½‘ç«™æ”¯ä»˜éœ€è¦å…·å¤‡å¦‚ä¸‹æ¡ä»¶ï¼š\n\n\nç”³è¯·å‰å¿…é¡»æ‹¥æœ‰ç»è¿‡å®åè®¤è¯çš„æ”¯ä»˜å®è´¦æˆ·ï¼›\n\n\nä¼ä¸šæˆ–ä¸ªä½“å·¥å•†æˆ·å¯ç”³è¯·ï¼›\n\n\néœ€æä¾›çœŸå®æœ‰æ•ˆçš„è¥ä¸šæ‰§ç…§ï¼Œä¸”æ”¯ä»˜å®è´¦æˆ·åç§°éœ€ä¸è¥ä¸šæ‰§ç…§ä¸»ä½“ä¸€è‡´ï¼›\n\n\nç½‘ç«™èƒ½æ­£å¸¸è®¿é—®ä¸”é¡µé¢æ˜¾ç¤ºå®Œæ•´ï¼Œç½‘ç«™éœ€è¦æ˜ç¡®ç»è¥å†…å®¹ä¸”æœ‰å®Œæ•´çš„å•†å“ä¿¡æ¯ï¼›\n\n\nç½‘ç«™å¿…é¡»é€šè¿‡ ICP å¤‡æ¡ˆã€‚å¦‚ä¸ºä¸ªä½“å·¥å•†æˆ·ï¼Œç½‘ç«™å¤‡æ¡ˆä¸»ä½“éœ€è¦ä¸æ”¯ä»˜å®è´¦æˆ·ä¸»ä½“åç§°ä¸€è‡´ï¼›\n\n\nå¦‚ä¸ºä¸ªä½“å·¥å•†æˆ·ï¼Œåˆ™å›¢è´­ä¸å¼€æ”¾ï¼Œä¸”å¤ç©ã€ç å®ç­‰å¥¢ä¾ˆå“ã€æŠ•èµ„ç±»è¡Œä¸šæ— æ³•ç”³è¯·æœ¬äº§å“ã€‚å…·ä½“è§ï¼šhttps://opendocs.alipay.com/open/203\næ”¯ä»˜å®æ²™ç®±ç¯å¢ƒé…ç½®è§ï¼šæ²™ç®±ç¯å¢ƒ - æ”¯ä»˜å®æ–‡æ¡£ä¸­å¿ƒ (alipay.com)\n\n\næ³¨å†Œå¼€æ”¾å¹³å°è´¦å·\næ”¯ä»˜å®å¼€æ”¾å¹³å°åœ°å€ï¼šæ”¯ä»˜å®å¼€æ”¾å¹³å° (alipay.com)\né…ç½®å¯†é’¥\nè¿›å…¥æ²™ç®±é¡µé¢ï¼šhttps://open.alipay.com/develop/sandbox/app\n\nå¯ç”¨è¯ä¹¦æ¨¡å¼ï¼Œå¹¶æ ¹æ®æç¤ºå®Œæˆå¯¹åº”çš„é…ç½®ã€‚\næµ‹è¯•ç¯å¢ƒå‡†å¤‡\næˆ‘ä»¬åœ¨æµ‹è¯•æ”¯ä»˜å®ä¸‹å•æ¥å£æ—¶éœ€è¦ä½¿ç”¨æ”¯ä»˜å®æ‰«æäºŒç»´ç ï¼Œéœ€è¦åœ¨æ‰‹æœºå®‰è£…æ”¯ä»˜å®å®¢æˆ·ç«¯ï¼ˆæ²™ç®±ç‰ˆæœ¬ï¼‰ï¼Œç”¨æ²™ç®±è´¦å·ç™»å½•æ”¯ä»˜å®ï¼Œæ‰«äºŒç»´ç ï¼ŒäºŒç»´ç çš„åœ°å€å³ä¸ºä¸‹å•æ¥å£çš„åœ°å€ã€‚\næˆ–è€…ä½¿ç”¨æ¨¡æ‹Ÿå™¨è¿›è¡Œæµ‹è¯•ã€‚æ¨¡æ‹Ÿå™¨å®‰è£…åœ°å€ï¼šMuMuæ¨¡æ‹Ÿå™¨å®˜ç½‘_å®‰å“12æ¨¡æ‹Ÿå™¨_ç½‘æ˜“æ‰‹æ¸¸æ¨¡æ‹Ÿå™¨ (163.com)\nå®‰è£…å®Œæˆåè¿›è¡Œç™»å½•ã€‚\næ‰‹æœºç½‘ç«™æ”¯ä»˜æ¥å£ï¼ˆH5ï¼‰\n\nå°ç¨‹åºæ–‡æ¡£ - æ”¯ä»˜å®æ–‡æ¡£ä¸­å¿ƒ (alipay.com)\nå•†å®¶åœ¨ç½‘é¡µåº”ç”¨ä¸­è°ƒç”¨æ”¯ä»˜å®æä¾›çš„ç½‘é¡µæ”¯ä»˜æ¥å£ï¼Œæ¥å£ä¼šè°ƒèµ·æ”¯ä»˜å®å®¢æˆ·ç«¯å†…çš„æ”¯ä»˜æ¨¡å—ï¼Œæ­¤æ—¶ä¼šä»å•†å®¶ç½‘é¡µåº” ç”¨è·³è½¬åˆ°æ”¯ä»˜å®å®¢æˆ·ç«¯ä¸­å¹¶å¼€å§‹æ”¯ä»˜ï¼›æ”¯ä»˜å®Œæˆåä¼šè·³è½¬å›å•†å®¶ç½‘é¡µåº”ç”¨å†…ï¼Œæœ€åå•†å®¶å±•ç¤ºæ”¯ä»˜ç»“æœã€‚\n\næ¥å£äº¤äº’\næ‰‹æœºç½‘ç«™æ”¯ä»˜å¿«é€Ÿæ¥å…¥ - æ”¯ä»˜å®æ–‡æ¡£ä¸­å¿ƒ (alipay.com)\n\n\nç”¨æˆ·åœ¨å•†æˆ·çš„ H5 ç½‘ç«™ä¸‹å•æ”¯ä»˜åï¼Œå•†æˆ·ç³»ç»ŸæŒ‰ç…§æ‰‹æœºç½‘ç«™æ”¯ä»˜æ¥å£ alipay.trade.wap.payAPI çš„å‚æ•°è§„èŒƒç”Ÿæˆè®¢ å•æ•°æ®\n\n\nå‰ç«¯é¡µé¢é€šè¿‡ Form è¡¨å•çš„å½¢å¼è¯·æ±‚åˆ°æ”¯ä»˜å®ã€‚æ­¤æ—¶æ”¯ä»˜å®ä¼šè‡ªåŠ¨å°†é¡µé¢è·³è½¬è‡³æ”¯ä»˜å® H5 æ”¶é“¶å°é¡µé¢ï¼Œå¦‚æœç”¨æˆ·æ‰‹æœºä¸Šå®‰è£…äº†æ”¯ä»˜å® APPï¼Œåˆ™è‡ªåŠ¨å”¤èµ·æ”¯ä»˜å® APPã€‚\n\n\nè¾“å…¥æ”¯ä»˜å¯†ç å®Œæˆæ”¯ä»˜ã€‚\n\n\nç”¨æˆ·åœ¨æ”¯ä»˜å® APP æˆ– H5 æ”¶é“¶å°å®Œæˆæ”¯ä»˜åï¼Œä¼šæ ¹æ®å•†æˆ·åœ¨æ‰‹æœºç½‘ç«™æ”¯ä»˜ API ä¸­ä¼ å…¥çš„å‰å°å›è·³åœ°å€ return_url è‡ªåŠ¨è·³è½¬å›å•†æˆ·é¡µé¢ï¼ŒåŒæ—¶åœ¨ URL è¯·æ±‚ä¸­ä»¥ Query String çš„å½¢å¼é™„å¸¦ä¸Šæ”¯ä»˜ç»“æœå‚æ•°ï¼Œè¯¦ç»†å›è·³å‚æ•°è§â€œæ‰‹æœºç½‘ç«™æ”¯ä»˜æ¥å£ alipay.trade.wap.payâ€å‰å°å›è·³å‚æ•°ã€‚\n\n\næ”¯ä»˜å®è¿˜ä¼šæ ¹æ®åŸå§‹æ”¯ä»˜ API ä¸­ä¼ å…¥çš„å¼‚æ­¥é€šçŸ¥åœ°å€ notify_urlï¼Œé€šè¿‡ POST è¯·æ±‚çš„å½¢å¼å°†æ”¯ä»˜ç»“æœä½œä¸ºå‚æ•°é€šçŸ¥ åˆ°å•†æˆ·ç³»ç»Ÿï¼Œè¯¦æƒ…è§æ”¯ä»˜ç»“æœå¼‚æ­¥é€šçŸ¥ã€‚\n\n\nä¸‹å•æ¥å£å®šä¹‰\nè¯·æ±‚åœ°å€ï¼š\n\n\n\nç¯å¢ƒ\nHttps è¯·æ±‚åœ°å€\n\n\n\n\næ²™ç®±ç¯å¢ƒ\nhttps://openapi.alipaydev.com/gateway.do\n\n\næ­£å¼ç¯å¢ƒ\nhttps://openapi.alipay.com/gateway.do\n\n\n\nå…¬å…±è¯·æ±‚å‚æ•°ï¼šè¯·æ±‚å‚æ•°è¯´æ˜ - æ”¯ä»˜å®æ–‡æ¡£ä¸­å¿ƒ (alipay.com)\nä¸‹å•æ¥å£æµ‹è¯•\n\n\nmaven ä¾èµ–\n\n\n&lt;dependency&gt;      &lt;groupId&gt;com.alipay.sdk&lt;/groupId&gt;      &lt;artifactId&gt;alipay-sdk-java&lt;/artifactId&gt;      &lt;version&gt;å¯¹åº”çš„æœ€æ–°ç‰ˆæœ¬&lt;/version&gt;  &lt;/dependency&gt;\n\n\nä»£ç ç¼–å†™ï¼šå¯å‚è€ƒç¤ºä¾‹\n\n\n@Slf4j  @Controller  public class PayTestController &#123;      String APP_ID = &quot;XXX&quot;;      String APP_PRIVATE_KEY = &quot;XXX&quot;;      String ALIPAY_PUBLIC_KEY = &quot;XXX&quot;;      String CHARSET = &quot;utfâ€8&quot;;      String serverUrl = &quot;https://openapi.alipaydev.com/gateway.do&quot;;      // æ­£å¼ &quot;https://openapi.alipay.com/gateway.do&quot;@GetMapping(&quot;/alipaytest&quot;)      public void alipaytest(HttpServletRequest httpRequest, HttpServletResponse httpResponse) throws IOException &#123;         // è·å¾—åˆå§‹åŒ–çš„AlipayClient   AlipayClient alipayClient = new DefaultAlipayClient(serverUrl, APP_ID, APP_PRIVATE_KEY, &quot;json&quot;, CHARSET, ALIPAY_PUBLIC_KEY, &quot;RSA2&quot;);         // åˆ›å»ºAPIå¯¹åº”çš„ request               AlipayTradeWapPayRequest alipayRequest = new AlipayTradeWapPayRequest();         // å¡«å……ä¸šåŠ¡å‚æ•°          alipayRequest.setBizContent(&quot;&#123;&quot; + &quot; \\&quot;out_trade_no\\&quot;:\\&quot;20150320010101123\\&quot;,&quot; + &quot; \\&quot;total_amount\\&quot;:\\&quot;0.01\\&quot;,&quot; + &quot; \\&quot;subject\\&quot;:\\&quot;Iphone6 16G\\&quot;,&quot; + &quot; \\&quot;product_code\\&quot;:\\&quot;QUICK_WAP_PAY\\&quot;&quot; + &quot; &#125;&quot;);          String form = &quot;&quot;;          try &#123;              // è°ƒç”¨SDKç”Ÿæˆè¡¨å•              form = alipayClient.pageExecute(alipayRequest).getBody();          &#125; catch (AlipayApiException e) &#123;              e.printStackTrace();          &#125;          httpResponse.setContentType(&quot;text/html;charset=&quot; + CHARSET);         // ç›´æ¥å°†å®Œæ•´çš„è¡¨å•htmlè¾“å‡ºåˆ°é¡µé¢          httpResponse.getWriter().write(form);          httpResponse.getWriter().flush();          httpResponse.getWriter().close();      &#125;  &#125;\n\n\näºŒç»´ç ç”ŸæˆæŒ‡å®šäºŒç»´ç çš„ URLï¼Œæ¨¡æ‹Ÿå™¨/æ‰‹æœºå¿…é¡»å¯ä»¥è®¿é—®åˆ°æ­¤åœ°å€ã€‚ï¼ˆæœ¬æœºæµ‹è¯•éœ€è¦åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…å¹¶ä½¿ç”¨å±€åŸŸç½‘åœ°å€ï¼Œæˆ–è€…ä½¿ç”¨å†…ç½‘ç©¿é€çš„åœ°å€ï¼‰\n\n\nå®Œæ•´ä»£ç \n\n\nå·¥å…·ç±»\n\n\n@Slf4j  @Component  public class AlipayUtil &#123;        private static AlipayConfig alipayConfig;        public AlipayUtil(AlipayConfig alipayConfig)&#123;          AlipayUtil.alipayConfig = alipayConfig;      &#125;        /**       * åˆ›å»ºé˜¿é‡Œäº‘é“¾æ¥       * @param alipayConfig æ”¯ä»˜å®æ”¯ä»˜é…ç½®       * @return AlipayClient       */    public static AlipayClient createClient(AlipayConfig alipayConfig) &#123;          AlipayClient alipayClient = null;          try &#123;              alipayConfig.setAppCertContent(ResourceUtil.readUtf8Str(alipayConfig.getAppCertPath()));              alipayConfig.setAlipayPublicCertContent(ResourceUtil.readUtf8Str(alipayConfig.getAlipayPublicCertPath()));              alipayConfig.setRootCertContent(ResourceUtil.readUtf8Str(alipayConfig.getRootCertPath()));              alipayClient = new DefaultAlipayClient(alipayConfig);          &#125; catch (AlipayApiException e) &#123;              log.error(&quot;AlipayClientåˆ›å»ºå¤±è´¥:&quot; + e.getMessage());              // æ„å»ºå¼‚å¸¸æ—¥å¿—              val operLog = OperLog.builder().title(&quot;æ”¯ä»˜å®æ”¯ä»˜&quot;)                      .businessType(BusinessType.OTHER.ordinal())                      .operUrl(alipayConfig.getServerUrl())                      .operParam(JSONUtil.toJsonPrettyStr(alipayConfig))                      .status(BusinessStatus.FAIL.ordinal())                      .errorMsg(e.getErrMsg())                      .build();              AsyncManager.me().execute(AsyncFactory.recordOper(operLog));          &#125;          return alipayClient;      &#125;        /**       * é¢„æ”¯ä»˜æ¥å£è°ƒç”¨       * @param alipayTradePrecreateRequest æ”¯ä»˜å®é¢„æ”¯ä»˜æ¥å£è¯·æ±‚       * @return AlipayTradePrecreateResponse æ”¯ä»˜å®é¢„æ”¯ä»˜æ¥å£è¿”å›       */      public static AlipayTradePrecreateResponse alipayTradePrecreate(AlipayTradePrecreateRequest alipayTradePrecreateRequest) &#123;          alipayTradePrecreateRequest.setNotifyUrl(alipayConfig.getNotifyUrl());          AlipayTradePrecreateResponse alipayTradePrecreateResponse = new AlipayTradePrecreateResponse();          try &#123;              alipayTradePrecreateResponse = createClient(alipayConfig).certificateExecute(alipayTradePrecreateRequest);                log.info(&quot;[è¿”å›å‚æ•°]ï¼š\\n&quot; + JSONUtil.toJsonPrettyStr(alipayTradePrecreateResponse));                if(alipayTradePrecreateResponse.isSuccess())&#123;                  return alipayTradePrecreateResponse;              &#125; else &#123;                  log.error(alipayTradePrecreateResponse.getOutTradeNo() + &quot;æ”¯ä»˜å®æ”¯ä»˜å¤±è´¥:&quot; + alipayTradePrecreateResponse.getMsg());                  // æ„å»ºå¼‚å¸¸æ—¥å¿—                  val operLog = OperLog.builder().title(&quot;æ”¯ä»˜å®æ”¯ä»˜&quot;)                          .businessType(BusinessType.OTHER.ordinal())                          .operUrl(alipayConfig.getServerUrl())                          .requestMethod(alipayTradePrecreateRequest.getApiMethodName())                          .operParam(JSONUtil.toJsonPrettyStr(alipayTradePrecreateRequest))                          .status(BusinessStatus.FAIL.ordinal())                          .errorMsg(JSONUtil.toJsonPrettyStr(alipayTradePrecreateResponse))                          .build();                  AsyncManager.me().execute(AsyncFactory.recordOper(operLog));              &#125;          &#125; catch (AlipayApiException e) &#123;              log.error(alipayTradePrecreateResponse.getOutTradeNo() + &quot;æ”¯ä»˜å®æ”¯ä»˜å¤±è´¥:&quot; + e.getMessage());              // æ„å»ºå¼‚å¸¸æ—¥å¿—              val operLog = OperLog.builder().title(&quot;æ”¯ä»˜å®æ”¯ä»˜&quot;)                      .businessType(BusinessType.OTHER.ordinal())                      .operUrl(alipayConfig.getServerUrl())                      .operParam(JSONUtil.toJsonPrettyStr(alipayTradePrecreateRequest))                      .status(BusinessStatus.FAIL.ordinal())                      .errorMsg(e.getMessage())                      .build();              AsyncManager.me().execute(AsyncFactory.recordOper(operLog));          &#125;          return alipayTradePrecreateResponse;      &#125;        /**       * è®¢å•æŸ¥è¯¢æ¥å£è°ƒç”¨       * @param alipayTradeQueryRequest æ”¯ä»˜å®æŸ¥å•æ¥å£è¯·æ±‚       * @return AlipayTradeQueryResponse æ”¯ä»˜å®æŸ¥å•æ¥å£è¿”å›       */      public static AlipayTradeQueryResponse alipayTradeQuery(AlipayTradeQueryRequest alipayTradeQueryRequest) &#123;          AlipayTradeQueryResponse alipayTradeQueryResponse = new AlipayTradeQueryResponse();          try &#123;              alipayTradeQueryResponse = createClient(alipayConfig).certificateExecute(alipayTradeQueryRequest);              if(alipayTradeQueryResponse.isSuccess())&#123;                  log.info(&quot;æ”¯ä»˜å®æŸ¥å•è¿”å›ï¼š&quot; + JSONUtil.toJsonPrettyStr(alipayTradeQueryResponse));                  return alipayTradeQueryResponse;              &#125; else &#123;                  log.error(alipayTradeQueryResponse.getOutTradeNo() + &quot;æ”¯ä»˜å®æŸ¥å•å¤±è´¥:&quot; + alipayTradeQueryResponse.getMsg());                  // æ„å»ºå¼‚å¸¸æ—¥å¿—                  val operLog = OperLog.builder().title(&quot;æ”¯ä»˜å®æŸ¥å•&quot;)                          .businessType(BusinessType.OTHER.ordinal())                          .operUrl(alipayConfig.getServerUrl())                          .requestMethod(alipayTradeQueryRequest.getApiMethodName())                          .operParam(JSONUtil.toJsonPrettyStr(alipayTradeQueryRequest))                          .status(BusinessStatus.FAIL.ordinal())                          .errorMsg(alipayTradeQueryResponse.getMsg())                          .build();                  AsyncManager.me().execute(AsyncFactory.recordOper(operLog));              &#125;          &#125; catch (AlipayApiException e) &#123;              log.error(alipayTradeQueryResponse.getOutTradeNo() + &quot;æ”¯ä»˜å®æŸ¥å•å¤±è´¥:&quot; + e.getMessage());              // æ„å»ºå¼‚å¸¸æ—¥å¿—              val operLog = OperLog.builder().title(&quot;æ”¯ä»˜å®æŸ¥å•&quot;)                      .businessType(BusinessType.OTHER.ordinal())                      .operUrl(alipayConfig.getServerUrl())                      .operParam(JSONUtil.toJsonPrettyStr(alipayTradeQueryRequest))                      .status(BusinessStatus.FAIL.ordinal())                      .errorMsg(e.getMessage())                      .build();              AsyncManager.me().execute(AsyncFactory.recordOper(operLog));          &#125;          return alipayTradeQueryResponse;      &#125;        /**       * æ”¯ä»˜å®è®¢å•å…³é—­       * @param alipayTradeCloseRequest æ”¯ä»˜å®å…³å•æ¥å£è¯·æ±‚       * @return AlipayTradeCloseResponse æ”¯ä»˜å®å…³å•æ¥å£è¿”å›       */      public static AlipayTradeCloseResponse alipayTradeClose(AlipayTradeCloseRequest alipayTradeCloseRequest) &#123;          AlipayTradeCloseResponse alipayTradeQueryResponse = new AlipayTradeCloseResponse();          try &#123;              alipayTradeQueryResponse = createClient(alipayConfig).certificateExecute(alipayTradeCloseRequest);              if(alipayTradeQueryResponse.isSuccess())&#123;                  return alipayTradeQueryResponse;              &#125; else &#123;                  log.error(alipayTradeQueryResponse.getOutTradeNo() + &quot;æ”¯ä»˜å®å…³å•å¤±è´¥:&quot; + alipayTradeQueryResponse.getMsg());                  // æ„å»ºå¼‚å¸¸æ—¥å¿—                  val operLog = OperLog.builder().title(&quot;æ”¯ä»˜å®å…³å•&quot;)                          .businessType(BusinessType.OTHER.ordinal())                          .operUrl(alipayConfig.getServerUrl())                          .requestMethod(alipayTradeCloseRequest.getApiMethodName())                          .operParam(JSONUtil.toJsonPrettyStr(alipayTradeCloseRequest))                          .status(BusinessStatus.FAIL.ordinal())                          .errorMsg(alipayTradeQueryResponse.getSubMsg())                          .build();                  AsyncManager.me().execute(AsyncFactory.recordOper(operLog));              &#125;          &#125; catch (AlipayApiException e) &#123;              log.error(alipayTradeQueryResponse.getOutTradeNo() + &quot;æ”¯ä»˜å®å…³å•å¤±è´¥:&quot; + e.getMessage());              // æ„å»ºå¼‚å¸¸æ—¥å¿—              val operLog = OperLog.builder().title(&quot;æ”¯ä»˜å®å…³å•&quot;)                      .businessType(BusinessType.OTHER.ordinal())                      .operUrl(alipayConfig.getServerUrl())                      .operParam(JSONUtil.toJsonPrettyStr(alipayTradeCloseRequest))                      .status(BusinessStatus.FAIL.ordinal())                      .errorMsg(e.getMessage())                      .build();              AsyncManager.me().execute(AsyncFactory.recordOper(operLog));          &#125;          return alipayTradeQueryResponse;      &#125;  &#125;\n\n\nåˆ›å»ºæ”¯ä»˜å® V3 ç‰ˆæœ¬è¯·æ±‚å¯¹è±¡\n\n\nprivate AlipayTradePrecreateRequest createAlipayBeanV3ByOrder(Order order) &#123;      AlipayTradePrecreateRequest alipayTradePrecreateRequest = new AlipayTradePrecreateRequest();      JSONObject bizContent = new JSONObject();      bizContent.set(&quot;out_trade_no&quot;, order.getOrderNo());      // æ”¯ä»˜å®æ”¯ä»˜ è®¢å•æ€»é‡‘é¢ï¼Œå•ä½ä¸ºå…ƒï¼Œç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸¤ä½ï¼Œå–å€¼èŒƒå›´ä¸º [0.01,100000000]ï¼Œé‡‘é¢ä¸èƒ½ä¸º 0ã€‚      bizContent.set(&quot;total_amount&quot;, order.getTotal());  \t// æ ‡é¢˜éƒ¨åˆ†æ ¹æ®éœ€æ±‚ä¿®æ”¹    // String subject = order.getGoodName();      // if (ObjectUtil.isNotEmpty(order.getSize())) &#123;      //     subject = subject + &quot;[&quot; + order.getSize() + &quot;]&quot;;      // &#125;      // subject = &quot;x-designé£æ ¼åŒ–å®šåˆ¶å‘¨è¾¹è®¢å•_&quot; + subject;        bizContent.set(&quot;subject&quot;, subject);        alipayTradePrecreateRequest.setBizContent(bizContent.toString());      return alipayTradePrecreateRequest;  &#125;\n\n\næ”¯ä»˜å®æŸ¥å•\n\n\nprivate BaseResponse&lt;Integer&gt; getAlipayBaseResponse(Order order, HttpServletRequest request) &#123;      AlipayTradeQueryRequest alipayTradeQueryRequest = new AlipayTradeQueryRequest();      JSONConfig jsonConfig = new JSONConfig();      jsonConfig.setIgnoreNullValue(false);      JSONObject bizContent = new JSONObject(jsonConfig);      bizContent.set(&quot;out_trade_no&quot;, order.getOrderNo());      bizContent.set(&quot;trade_no&quot;, null);      alipayTradeQueryRequest.setBizContent(bizContent.toString());      log.info(&quot;è®¢å•ï¼š&quot; + order.getOrderNo() + &quot;æ”¯ä»˜å®æŸ¥å•ï¼š&quot; + JSONUtil.parse(alipayTradeQueryRequest));      AlipayTradeQueryResponse alipayTradeQueryResponse = AlipayUtil.alipayTradeQuery(alipayTradeQueryRequest);      log.info(&quot;è®¢å•ï¼š&quot; + order.getOrderNo() + &quot;æ”¯ä»˜å®æŸ¥å•ç»“æœï¼š&quot; + JSONUtil.parse(alipayTradeQueryResponse));      // æ”¯ä»˜å®è®¢å•å·      String tradeNo = alipayTradeQueryResponse.getTradeNo();      OtherPayInfo otherPayInfo = new OtherPayInfo();      otherPayInfo.setTradeNo(tradeNo);      // æ”¯ä»˜æ—¶é—´      LocalDateTime time = null;      if (ObjectUtil.isNotNull(alipayTradeQueryResponse.getSendPayDate())) &#123;          time =  LocalDateTime.ofInstant(alipayTradeQueryResponse.getSendPayDate().toInstant(), ZoneId.systemDefault());      &#125;        // å®¢æˆ·æœªæ‰«ç ç›´æ¥è°ƒç”¨ä¼šå‡ºç°è®¢å•ä¸å­˜åœ¨      if (ObjectUtil.isNull(alipayTradeQueryResponse.getTradeStatus())) &#123;          return new BaseResponse&lt;&gt;(VMSystem.ORDER_STATUS_CREATE);      &#125;        if (&quot;TRADE_SUCCESS&quot;.equals(alipayTradeQueryResponse.getTradeStatus())) &#123;  \t    // å…¶ä»–ä¸šåŠ¡éœ€æ±‚ ä¿®æ”¹è®¢å•ä¿¡æ¯ å‘é€æ‰“å°é‚®ä»¶ç­‰        // // ä¿®æ”¹è®¢å•ä¿¡æ¯          // val updateOrderByWx = this.updateOrderStatusByPay(order.getOrderNo(), time, VMSystem.ORDER_STATUS_PAYED, otherPayInfo);          // // å‘é€æ‰“å°é‚®ä»¶          // this.sendMailtoPrint(order);          // if (updateOrderByWx) &#123;          //     return new BaseResponse&lt;&gt;(VMSystem.ORDER_STATUS_PAYED);          // &#125; else &#123;          //     throw new LogicException(&quot;è®¢å•çŠ¶æ€æ›´æ–°å¼‚å¸¸&quot;);          // &#125;      &#125; else if (&quot;WAIT_BUYER_PAY&quot;.equals(alipayTradeQueryResponse.getTradeStatus())) &#123;          return new BaseResponse&lt;&gt;(VMSystem.ORDER_STATUS_CREATE);      &#125; else &#123;          log.error(order.getOrderNo() + &quot;æ”¯ä»˜å®æ”¯ä»˜å¤±è´¥:ç½‘å…³æè¿°ï¼š&quot; + alipayTradeQueryResponse.getMsg() + &quot;ä¸šåŠ¡æè¿°ï¼š&quot; + alipayTradeQueryResponse.getSubMsg());          // æ„å»ºå¼‚å¸¸æ—¥å¿—          OperLog operLog = OperLog.builder().title(&quot;æ”¯ä»˜å®æ”¯ä»˜&quot;)                  .businessType(BusinessType.OTHER.ordinal())                  .operIp(IpUtils.getIpAddr(request))                  .operParam(JSONUtil.toJsonPrettyStr(alipayTradeQueryRequest.getTextParams()))                  .status(BusinessStatus.FAIL.ordinal())                  .method(alipayTradeQueryRequest.getApiMethodName())                  .requestMethod(&quot;GET&quot;)                  .errorMsg(&quot;æ”¯ä»˜å®æ”¯ä»˜å¤±è´¥:ç½‘å…³æè¿°ï¼š&quot; + alipayTradeQueryResponse.getMsg() + &quot;ä¸šåŠ¡æè¿°ï¼š&quot; + alipayTradeQueryResponse.getSubMsg())                  .build();          AsyncManager.me().execute(AsyncFactory.recordOper(operLog));          // ä¿®æ”¹è®¢å•ä¿¡æ¯          this.updateOrderStatusByPay(order.getOrderNo(), time, VMSystem.ORDER_STATUS_FAILED, otherPayInfo);          val baseResponse = new BaseResponse&lt;&gt;(VMSystem.ORDER_STATUS_FAILED);          baseResponse.setMessage(&quot;æ”¯ä»˜å®æ”¯ä»˜å¤±è´¥:ç½‘å…³æè¿°ï¼š&quot; + alipayTradeQueryResponse.getMsg() + &quot;ä¸šåŠ¡æè¿°ï¼š&quot; + alipayTradeQueryResponse.getSubMsg());          return baseResponse;      &#125;  &#125;\n\n\nè®¢å•å…³é—­\n\n\n// æ”¯ä»˜å®è®¢å•å…³é—­  AlipayTradeCloseRequest alipayTradeCloseRequest = new AlipayTradeCloseRequest();  JSONConfig jsonConfig = new JSONConfig();  jsonConfig.setIgnoreNullValue(false);  JSONObject bizContent = new JSONObject();  bizContent.set(&quot;out_trade_no&quot;, order.getOrderNo());  bizContent.set(&quot;trade_no&quot;, order.getTradeNo());  alipayTradeCloseRequest.setBizContent(bizContent.toString());  AlipayUtil.alipayTradeClose(alipayTradeCloseRequest);\nBUG\néªŒç­¾å‡ºé”™ï¼Œå»ºè®®æ£€æŸ¥ç­¾åå­—ç¬¦ä¸²æˆ–ç­¾åç§é’¥ä¸åº”ç”¨å…¬é’¥æ˜¯å¦åŒ¹é…\n\næŠ€æœ¯æ–‡æ¡£ï¼šhttps://opendocs.alipay.com/support/01ravw\né—®é¢˜åŸå› \nå¯†é’¥ä¸åŒ¹é…ã€ç¼–ç æ ¼å¼ä¸ç»Ÿä¸€ï¼ˆæœ¬æ¬¡æµ‹è¯•åæ›´æ¢ä¸­æ–‡ç¼–ç æ ¼å¼ï¼‰ã€è¯·æ±‚å‚æ•°æ•°æ®æœ‰è¯¯ã€æ¥å£è°ƒç”¨åŠ ç­¾æ–¹å¼å’Œåº”ç”¨ä¸Šé€‰æ‹©çš„åŠ ç­¾æ–¹å¼ä¸å¯¹åº”ã€SDK è°ƒç”¨çš„æäº¤æ–¹æ³•æœ‰è¯¯ã€SDK è¿è¡Œç¯å¢ƒæœ‰è¯¯\n\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["Java","ä»£ç æ¨¡æ¿"]},{"title":"Letâ€™s Encrypt å…è´¹ç”³è¯·æ³›åŸŸå SSL è¯ä¹¦ï¼Œå¹¶å®ç°è‡ªåŠ¨ç»­æœŸ","url":"/posts/a1d28c6/","content":"\n\nå‰è¨€å‚è€ƒæ–‡ç« ï¼šä½¿ç”¨ Letâ€™s Encrypt å…è´¹ç”³è¯·æ³›åŸŸå SSL è¯ä¹¦ï¼Œå¹¶å®ç°è‡ªåŠ¨ç»­æœŸ\n\n\næ›´æ–°\n\n\n25-04-07 åˆå§‹è®°å½•\n\nç¯å¢ƒå‡†å¤‡\n\n\nä¸€å°å¯ä»¥è®¿é—®äº’è”ç½‘çš„æœåŠ¡å™¨ï¼ˆLinux ç¯å¢ƒï¼Œå¦‚ Ubuntu/CentOSï¼‰ã€‚\n\n\nRootÂ æƒé™æˆ–Â sudoÂ æƒé™ã€‚\n\n\nä¸€ä¸ªå·²è§£æçš„åŸŸåï¼ˆæœ¬æ–‡ä»¥Â example.comÂ ä¸ºä¾‹ï¼‰ã€‚\n\n\nCertbotÂ è‡ªåŠ¨å®‰è£…\n\n\né€‰æ‹©å®‰è£…ç¯å¢ƒ\n\n\n\nInstall system dependencies\nFor APT-based distributions (e.g. Debian, Ubuntu â€¦):\n\n\nsudo apt updatesudo apt install python3 python3-venv libaugeas0\nFor RPM-based distributions (e.g. Fedora, CentOS â€¦):\nsudo dnf install python3 augeas-libs\n\n\nRemove certbot-auto and any Certbot OS packages\n\n\nSet up a Python virtual environment\n\n\nsudo python3 -m venv /opt/certbot/sudo /opt/certbot/bin/pip install --upgrade pip\n\n\nInstall Certbot\n\n\nsudo /opt/certbot/bin/pip install certbot certbot-nginx\n\n\nPrepare the Certbot command\n\n\nsudo ln -s /opt/certbot/bin/certbot /usr/bin/certbot\nç”³è¯·å•åŸŸå SSL è¯ä¹¦\n\n\nChoose how youâ€™d like to run Certbot\n\n\nsudo certbot --nginx# æ‰‹åŠ¨é…ç½® nginxsudo certbot certonly --nginx\n\nè¿™é‡Œè·å– nginx é»˜è®¤çš„é…ç½®ä½ç½®åœ¨ /etc/nginxã€‚å¯ä»¥ä¸ºè‡ªå·±å®‰è£…å®Œæˆçš„ nginx åˆ›å»ºè½¯é“¾åˆ°æ­¤ç›®å½•ä¸‹\n\n\n\nsudo certbot certonly --nginx\n\n\necho &quot;0 0,12 * * * root /opt/certbot/bin/python -c &#x27;import random; import time; time.sleep(random.random() * 3600)&#x27; &amp;&amp; sudo certbot renew -q&quot; | sudo tee -a /etc/crontab &gt; /dev/null\n\n\nConfirm that Certbot worked\n\n\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"]},{"title":"SonarQubeä¸GitLabé›†æˆï¼ˆä¸€ï¼‰","url":"/posts/7d0e1c35/","content":"\n\nå‰è¨€æœ€è¿‘æ¯”è¾ƒé—²ï¼Œåˆ†é…äº†è¿™ä¸ªä»»åŠ¡ï¼Œé¡ºä¾¿åšä¸ªç¬”è®°ã€‚æ›´æ–°ç¬¬äºŒç‰ˆæ–¹æ¡ˆï¼Œæ›´é€‚åˆç”Ÿäº§ç¯å¢ƒã€‚\n\n\nå‚è€ƒæ–‡ç« åœ¨ gitlab ci/cd æµç¨‹ä¸­é›†æˆ sonar è¿›è¡Œè‡ªåŠ¨ Code Review\ngitlab Runner å®‰è£…ä¸éƒ¨ç½²\n\n\næ›´æ–°\n\n\n24-12-11 åˆå§‹è®°å½•24-12-12 å®ŒæˆSonarQubeä¸æ’ä»¶çš„å®‰è£…24-12-16 maven ä¸ å¤šæ¨¡å—é¡¹ç›®\n\nå‡†å¤‡å·¥ä½œ\n\n\nSonarQubeï¼šé€‰æ‹©é€‚åˆé¡¹ç›®çš„ SonarQube ç‰ˆæœ¬ã€‚~Java8 é€‚é…çš„ SonarQube ç‰ˆæœ¬æœ€é«˜ä¸º 7.8~ã€‚è¿™é‡Œéƒ¨ç½²çš„æ˜¯ï¼š docker æ–¹å¼çš„ 9.9 LTS ç‰ˆæœ¬å®˜æ–¹é•¿æœŸæ”¯æŒç‰ˆæœ¬ã€‚\n\n\nGitLabï¼š14.9.1 ç‰ˆæœ¬\n\n\n# å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹cat /opt/gitlab/embedded/service/gitlab-rails/VERSION\n\n\ndockerï¼šDocker version 20.10.17, build 100c701ã€‚å®˜æ–¹æ¨èç‰ˆæœ¬Â 20.10Â ä»¥ä¸Šã€‚\n\n\nGitlab CI\n\n\nSonarScanner/Maven + Java 11\n\n\nSonarQube å®‰è£…\n\n\ndocker-compose.yml\n\n\nversion: &quot;3&quot;services:  sonarqube:    image: sonarqube:9.9-community    depends_on:      - db    environment:      SONAR_JDBC_URL: jdbc:postgresql://db:5432/sonar      SONAR_JDBC_USERNAME: sonar      SONAR_JDBC_PASSWORD: sonar    volumes:      - sonarqube_data:/opt/sonarqube/data      - sonarqube_extensions:/opt/sonarqube/extensions      - sonarqube_logs:/opt/sonarqube/logs      - sonarqube_conf:/opt/sonarqube/conf    ports:      - &quot;9000:9000&quot;  db:    image: postgres:15.3    environment:      POSTGRES_USER: sonar      POSTGRES_PASSWORD: sonar    volumes:      - postgresql:/var/lib/postgresql      - postgresql_data:/var/lib/postgresql/datavolumes:  sonarqube_data:\texternal: true  sonarqube_extensions:\texternal: true  sonarqube_logs:\texternal: true  sonarqube_conf:\texternal: true  postgresql:  postgresql_data:\n\n\ndocker-compose å‘½ä»¤\n\n\n# å‰å°å¯åŠ¨, å¯åŠ¨é¡¹ç›®ä¸­çš„æ‰€æœ‰æœåŠ¡ã€‚docker-compose up# åå°å¯åŠ¨, å¯åŠ¨æ‰€æœ‰æœåŠ¡å¹¶åœ¨åå°è¿è¡Œã€‚ docker-compose up -d# -f æŒ‡å®šä½¿ç”¨çš„Composeæ¨¡æ¿æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºdocker-compose.ymlï¼Œå¯ä»¥å¤šæ¬¡æŒ‡å®šdocker-compose -f docker-compose.yml up -d# åˆ—å‡ºé¡¹ç›®ä¸­ç›®å‰çš„æ‰€æœ‰å®¹å™¨docker-compose ps # åœæ­¢æ‰€æœ‰æœåŠ¡ã€‚docker-compose stop# åœæ­¢å’Œåˆ é™¤å®¹å™¨ã€ç½‘ç»œã€å·ã€é•œåƒã€‚docker-compose down# åˆ é™¤å·²ç»åœ¨composeæ–‡ä»¶ä¸­å®šä¹‰çš„å’ŒåŒ¿åçš„é™„åœ¨å®¹å™¨ä¸Šçš„æ•°æ®å·docker-compose down -v\nSonarQube æ’ä»¶å®‰è£…\nSonarQube æœ‰ä¸¤ä¸ªæ’ä»¶ï¼š\n\n\nhttps://github.com/javamachr/sonar-gitlab-plugin\n\n\nhttps://github.com/mc1arke/sonarqube-community-branch-plugin\nç¬¬ä¸€ä¸ªæ’ä»¶å¯ä»¥å°†Â SonarQubeÂ çš„å®¡æŸ¥ç»“æœä»¥è¯„è®ºçš„è¯•å‘å¸ƒåˆ° gitlab ä¸Šé¢ã€‚æš‚æœªä½¿ç”¨ç¬¬äºŒä¸ªæ’ä»¶å¯ä»¥å®ç°å¢å¼ºÂ SonarQubeÂ å¤šåˆ†æ”¯åŒ…æ‹¬ MR çš„ä»£ç æ£€æµ‹ã€‚\n\n\n\n\nä¸‹è½½ sonar-gitlab-plugin å¯¹åº” 5.4 ç‰ˆæœ¬çš„ jar åŒ…\n\n\nä¸‹è½½ sonarqube-community-branch-plugin å¯¹åº” 1.14.0 çš„ jar åŒ…\n\n\nä¸Šä¼  jar åŒ…åˆ°æŒ‚è½½çš„ sonarqube_extensionsÂ ç›®å½•é‡Œé¢çš„Â pluginsÂ ç›®å½•é‡Œé¢ã€‚ä¸Šä¼ åˆ° JumpServer å¯ä»¥åœ¨ç›®å½•ä¸‹è¾“å…¥ï¼šrzï¼›ä¸‹è½½ä¸º sz\n\n\nä¿®æ”¹æŒ‚è½½çš„ sonarqube_conf ç›®å½•è·¯å¾„ä¸‹é¢çš„Â sonar.propertiesÂ é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®\n\n\nsonar.web.javaAdditionalOpts=-javaagent:./extensions/plugins/sonarqube-community-branch-plugin-1.14.0.jar=websonar.ce.javaAdditionalOpts=-javaagent:./extensions/plugins/sonarqube-community-branch-plugin-1.14.0.jar=ce\n\n\né‡å¯ SonarQube\n\n\nGitlab CI å®‰è£…ä¸æ³¨å†Œ\n\n\nç‰ˆæœ¬ç¡®è®¤\n\n\n\n\nå®‰è£…ä¸ Gitlab ä¸€è‡´çš„ Gitlab-Runner ç‰ˆæœ¬ã€‚\n\n\nwget https://mirrors.tuna.tsinghua.edu.cn/gitlab-runner/yum/el7/gitlab-runner-14.9.0-1.x86_64.rpm --no-check-certificatesudo rpm -ivh gitlab-runner-14.9.0-1.x86_64.rpm# æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸgitlab-runner -v\n\n\næŒ‡å®š gitlab-runner ç”¨æˆ·ä¸º root ç”¨æˆ·\n\n\nsudo gitlab-runner uninstall sudo gitlab-runner install --working-directory /home/zwadmin --user zwadmin\n\n\nå¯åŠ¨ gitlab æœåŠ¡\n\n\nsystemctl daemon-reload/bin/systemctl start gitlab-runner/bin/systemctl enable gitlab-runner/bin/systemctl restart gitlab-runner\n\n\nè®¾ç½®æƒé™\n\n\nchown -R zwadmin.zwadmin /home/gitlab-runner\n\n\næ³¨å†ŒæœåŠ¡\n\n\ngitlab-runner register#è¾“å…¥å…¬å¸çš„gitlabå…¬ç½‘åœ°å€ Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com/): https://gitlab.wuidm.com/#è¾“å…¥gitlabçš„token Please enter the gitlab-ci token for this runner:  #è¾“å…¥æè¿°è¿™ä¸ªrunneråç§° Please enter the gitlab-ci description for this runner: [k8s-node02]: test#è¾“å…¥runnerçš„æ ‡ç­¾ Please enter the gitlab-ci tags for this runner (comma separated): my-tag,another-tag Registering runner... succeeded runner=8sjydnrs #è¾“å…¥runneræ‰§è¡Œå™¨çš„ç¯å¢ƒ Please enter the executor: custom, docker-ssh, parallels, kubernetes, docker-ssh+machine, docker, shell, ssh, virtualbox, docker+machine: shell \n\nSonarScanner å®‰è£…\n\nå¤šæ¨¡å—é¡¹ç›®å»ºè®®ç”¨ Mavenï¼Œè¿™éƒ¨åˆ†å¯ä»¥ä¸çœ‹\n\n\n\nå®˜ç½‘ä¸‹è½½\n\n\nä¸Šä¼ æœåŠ¡å™¨åï¼Œè§£å‹\n\n\né…ç½®ç¯å¢ƒå˜é‡\n\n\nsudo vim /etc/profile# æ·»åŠ ä»¥ä¸‹è¯­å¥export SONARRUNNER_HOME=/home/zwadmin/soft/sonar-scanner/sonar-scanner-6.2.1.4610-linux-x64export PATH=$SONARRUNNER_HOME/bin:$PATHsudo source /etc/profile# æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸsonar-scanner -v\nMaven å®‰è£…\n\nMaven æ›´é€‚é…å¤šæ¨¡å—é¡¹ç›®\n\n\n\nå®˜ç½‘ä¸‹è½½\n\n\nä¸Šä¼ æœåŠ¡å™¨åï¼Œè§£å‹\n\n\né…ç½®ç¯å¢ƒå˜é‡\n\n\nsudo vim /etc/profile# æ·»åŠ ä»¥ä¸‹è¯­å¥export M2_HOME=/opt/maven export PATH=$M2_HOME/bin:$PATHsource /etc/profile# æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸmvn -v\nä¸ Gitlab é›†æˆ\n\n\nç™»å½• gitlab.comï¼Œåˆ›å»ºä¸€ä¸ªæµ‹è¯•ä»“åº“ï¼Œå¹¶åœ¨ç”¨æˆ·è®¾ç½®é‡Œé¢ï¼Œåˆ›å»ºä¸€ä¸ªä¸ªäººè®¿é—®ä»¤ç‰Œã€‚\n\n\n\nç™»å½• SonarQubeï¼Œåœ¨ project ç®¡ç†é‡Œé¢å³å¯é€šè¿‡è¿™ä¸ªä¸ªäººè®¿é—®ä»¤ç‰Œæ¥å¯¼å…¥ gitlab ä¸Šé¢çš„é¡¹ç›®\n\n\n\nå¯¼å…¥åï¼Œé€‰æ‹©ä»¥ gitlab ci çš„æ–¹å¼æ¥æ‰§è¡Œ ci æµç¨‹å‰æ gitlab ci å¼€å¯\n\n\n\næ ¹æ®æç¤ºï¼Œå®Œæˆæ‰€æœ‰æ­¥éª¤ã€‚\n\n\n\n\nåœ¨é¡¹ç›®ä¸­åˆ›å»º sonar-project.propertiesï¼Œ å¹¶ç²˜è´´æç¤ºå†…çš„å†…å®¹ã€‚å¤šåˆ†æ”¯æŒ‡å®šåˆ†æ”¯éœ€è¦ä¸‹è½½ sonarqube-community-branch-plugin æ’ä»¶ã€‚é¢å¤–æ·»åŠ  sonar.branch.name=XXX\n\n\n\nåœ¨ gitlab çš„è®¾ç½®ï¼Œ CI/CD è®¾ç½®é‡Œé¢ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡\n\n\nåœ¨é¡¹ç›®é‡Œé¢åˆ›å»ºä¸€ä¸ªÂ .gitlab-ci.ymlÂ æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§æç¤ºè´´å…¥æœ€å°åŒ–é…ç½®å†…å®¹\n\n\nsonarqube-check:    tags:      - test    variables:      SONAR_USER_HOME: &quot;$&#123;CI_PROJECT_DIR&#125;/.sonar&quot;  # Defines the location of the analysis task cache      GIT_DEPTH: &quot;0&quot;  # Tells git to fetch all the branches of the project, required by the analysis task    cache:      key: &quot;$&#123;CI_JOB_NAME&#125;&quot;      paths:        - .sonar/cache    script:      - sonar-scanner    allow_failure: true    only:      - master  #    - merge_requests  #    - develop\n\n\nåœ¨ SonarQube çš„é€šç”¨é…ç½®é‡Œé¢ï¼Œé…ç½®å¥½ base URLï¼Œ ä»¥æ–¹ä¾¿åœ¨ gitlab çš„è¯„è®ºé‡Œé¢èƒ½å¤Ÿæ­£ç¡®è¿æ¥åˆ° SonarQube å¹³å°ã€‚\n\n\n\nä½¿ç”¨ Maven ä¸ Gitlab é›†æˆ\n\nMaven æ›´é€‚é…å¤šæ¨¡å—é¡¹ç›®ï¼Œ1ã€2ã€3ã€5 æ­¥éª¤ç›¸åŒï¼Œ4 é…ç½®å¦‚ä¸‹\n\n\n\nåœ¨çˆ¶é¡¹ç›® pom.xml æ–‡ä»¶ä¸­æ·»åŠ é…ç½®\n\n\n&lt;properties&gt;    &lt;sonar.qualitygate.wait&gt;true&lt;/sonar.qualitygate.wait&gt;&lt;/properties&gt;&lt;build&gt;    &lt;pluginManagement&gt;        &lt;plugins&gt;            &lt;plugin&gt;                &lt;groupId&gt;org.sonarsource.scanner.maven&lt;/groupId&gt;                &lt;artifactId&gt;sonar-maven-plugin&lt;/artifactId&gt;                &lt;version&gt;3.11.0.3922&lt;/version&gt;            &lt;/plugin&gt;        &lt;/plugins&gt;    &lt;/pluginManagement&gt;&lt;/build&gt;\n\n\nåœ¨ gitlab çš„è®¾ç½®ï¼Œ CI/CD è®¾ç½®é‡Œé¢ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡\n\n\nåœ¨é¡¹ç›®é‡Œé¢åˆ›å»ºä¸€ä¸ªÂ .gitlab-ci.ymlÂ æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§æç¤ºè´´å…¥æœ€å°åŒ–é…ç½®å†…å®¹\n\n\nsonarqube-check:  tags:    - sonar  variables:    SONAR_USER_HOME: &quot;$&#123;CI_PROJECT_DIR&#125;/.sonar&quot;  # Defines the location of the analysis task cache    GIT_DEPTH: &quot;0&quot;  # Tells git to fetch all the branches of the project, required by the analysis task  cache:    key: &quot;$&#123;CI_JOB_NAME&#125;&quot;    paths:      - .sonar/cache  script:    - JAVA_HOME=/home/zwadmin/data/jdk-11/ &amp;&amp; export JAVA_HOME    - mvn verify sonar:sonar -Dsonar.projectKey=com.ydm:zw-ydm -Dsonar.branch.name=feature/sonar-1216  allow_failure: true  only:    - feature/sonar-1216#    - merge_requests\næ•´åˆ IDEA æ’ä»¶\n\nç”¨äºåŒæ­¥æœåŠ¡å™¨ä¸Šçš„è§„åˆ™ã€è´¨é‡é…ç½®æ–‡ä»¶å’Œæ–‡ä»¶æ’é™¤è®¾ç½®ã€‚\n\n\n\nåˆ›å»º token ç±»å‹ä¸ºç”¨æˆ·\n\n\n\nIDEA Plugins Marketplace ä¸‹è½½ SonarQube for IDEã€‚\n\n\nè¿æ¥åˆ° SonarQubeã€‚\n\n\n\n\né…ç½®é¡¹ç›®\n\n\n\nå®Œæ•´ç‰ˆ .gitlab-ci.yml\nstages:    - sonarqube    - notify    - noop  sonarqube-check:    stage: sonarqube    tags:      - sonar    variables:      SONAR_USER_HOME: &quot;$&#123;CI_PROJECT_DIR&#125;/.sonar&quot;  # Defines the location of the analysis task cache      GIT_DEPTH: &quot;0&quot;  # Tells git to fetch all the branches of the project, required by the analysis task    cache:      key: &quot;$&#123;CI_COMMIT_REF_NAME&#125;&quot; # ä½¿ç”¨åˆ†æ”¯åä½œä¸ºç¼“å­˜çš„ key    paths:        - .sonar/cache    script:      - JAVA_HOME=*** &amp;&amp; export JAVA_HOME      - export SONAR_JAVA_OPTS=&quot;-Xmx2G -Xms1G&quot;      - mvn verify sonar:sonar -T 10 -Dsonar.projectKey= -Dsonar.branch.name=master -Dmaven.test.skip=true -Dsonar.qualitygate.wait=false -Dsonar.ce.parallel=1 -Dmaven.repo.local=***  allow_failure: false    rules:      # å¦‚æœ SKIP_SONAR ä¸º &quot;true&quot;ï¼Œè·³è¿‡ä»»åŠ¡      - if: &#x27;$SKIP_SONAR == &quot;true&quot;&#x27;        when: never      # åœ¨åˆå¹¶è¯·æ±‚æ—¶è§¦å‘      - if: &#x27;$CI_PIPELINE_SOURCE == &quot;merge_request_event&quot;&#x27;    sonar_to_feishu:    stage: notify    tags:      - sonar    script:      - |        response=$(curl -u admin:123456Aa -s &quot;***/api/qualitygates/project_status?projectKey=com.ydm%3Azw-ydm&amp;branch=master&quot;)                echo &quot;$response&quot;                quality_gate_status=$(echo &quot;$response&quot; | grep -o &#x27;&quot;status&quot;:&quot;[^&quot;]*&quot;&#x27; | head -n 1 | sed &#x27;s/&quot;status&quot;:&quot;\\([^&quot;]*\\)&quot;/\\1/&#x27;)                echo &quot;$quality_gate_status&quot;                if [ &quot;$quality_gate_status&quot; == &quot;OK&quot; ]; then          status=&quot;é€šè¿‡ (OK)&quot;        else          status=&quot;æœªé€šè¿‡ (ERROR)&quot;        fi                echo &quot;è¯·æ±‚é£ä¹¦&quot;                curl -X POST -H &quot;Content-Type: application/json&quot; \\          -d &quot;&#123;              \\&quot;msg_type\\&quot;: \\&quot;post\\&quot;,              \\&quot;content\\&quot;: &#123;                \\&quot;post\\&quot;: &#123;                  \\&quot;zh_cn\\&quot;: &#123;                    \\&quot;title\\&quot;: \\&quot;SonarQube åˆ†æå®Œæˆ\\&quot;,                    \\&quot;content\\&quot;: [                      [&#123;                        \\&quot;tag\\&quot;: \\&quot;text\\&quot;,                        \\&quot;text\\&quot;: \\&quot;é¡¹ç›®ï¼šzw-ydm\\nåˆ†æ”¯ï¼šmaster\\nçŠ¶æ€ï¼š$status\\nä»ªè¡¨ç›˜ï¼š\\&quot;                      &#125;, &#123;                        \\&quot;tag\\&quot;: \\&quot;a\\&quot;,                        \\&quot;text\\&quot;: \\&quot;ç‚¹å‡»æŸ¥çœ‹\\&quot;,                        \\&quot;href\\&quot;: \\&quot;***/dashboard?id=com.ydm%3Azw-ydm&amp;branch=master\\&quot;                      &#125;]                    ]                  &#125;                &#125;              &#125;          &#125;&quot; \\        https://open.feishu.cn/open-apis/bot/v2/hook/***  needs:      - sonarqube-check    rules:      # å¦‚æœ SKIP_SONAR ä¸º &quot;true&quot;ï¼Œè·³è¿‡ä»»åŠ¡      - if: &#x27;$SKIP_SONAR == &quot;true&quot;&#x27;        when: never      # åœ¨åˆå¹¶è¯·æ±‚æ—¶è§¦å‘      - if: &#x27;$CI_PIPELINE_SOURCE == &quot;merge_request_event&quot;&#x27;    noop:    tags:      - sonar    stage: noop    script:      - echo &quot;Pipeline skipped all main jobs.&quot;    rules:      # åœ¨åˆå¹¶è¯·æ±‚æ—¶è§¦å‘      - if: &#x27;$CI_PIPELINE_SOURCE == &quot;merge_request_event&quot;&#x27;\nBUG è®°å½•\ndocker æ‹‰å–å¤±è´¥ (Client.Timeout exceeded while awaiting headers)\n\nå†…é“¾ï¼š[[Dockeræ‹‰å–å¤±è´¥ (Client.Timeout exceeded while awaiting headers)]]\nå¤–é“¾ï¼šDockeræ‹‰å–å¤±è´¥ (Client.Timeout exceeded while awaiting headers)\n\ndocker-compose åŠ è½½æŒ‚è½½å·ï¼ŒåªåŠ è½½é»˜è®¤\n\næœªå®Œå…¨è§£å†³ã€‚æœ‰ä¸€ä¸ªè¾ƒéº»çƒ¦çš„æ–¹æ³•ã€‚\n\n\n\næ‰‹åŠ¨æŒ‚è½½å·\n\n\nsudo docker volume create --driver local --opt type=none --opt device=/home/zwadmin/data/docker/sonarqube/data --opt o=bind sonarqube_datasudo docker volume create --driver local --opt type=none --opt device=/home/zwadmin/data/docker/sonarqube/extensions --opt o=bind sonarqube_extensionssudo docker volume create --driver local --opt type=none --opt device=/home/zwadmin/data/docker/sonarqube/logs --opt o=bind sonarqube_logssudo docker volume create --driver local --opt type=none --opt device=/home/zwadmin/data/docker/sonarqube/conf --opt o=bind sonarqube_conf\n\n\nåœ¨ docker-compose.ymlÂ ä¸­ä»å¤–éƒ¨åŠ è½½å·\n\n\nvolumes:  sonarqube_data:\texternal: true\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["GitLab","SonarQube"]},{"title":"SonarQube ä¸ GitLab é›†æˆï¼ˆäºŒï¼‰","url":"/posts/6041b6ab/","content":"\n\nå‰è¨€sonar è„šæœ¬ä¹‹å‰ä¸€ç›´åœ¨æµ‹è¯•åˆ†æ”¯ä¸Šè·‘ï¼Œè™½ç„¶æœ‰æ¯æ¬¡æ„å»ºæ‹‰å–äº‹ä»¶å¾ˆé•¿çš„æ¯›ç—…ï¼Œä½†å½±å“ä¸å¤§è¿˜èƒ½å¿å—ã€‚æœ€è¿‘æŠŠ sonar ä¸Šåˆ° master ç¯å¢ƒä¸­ï¼Œå‡ºç°äº†å¤§é—®é¢˜ã€‚ã€‚ã€‚\n\n\næ›´æ–°\n\n\n25-04-11 åˆå§‹è®°å½•\n\né—®é¢˜\n\n\ngitlab CI cancel ä¹‹åï¼Œåå° maven å­è¿›ç¨‹å¹¶æ²¡æœ‰è¢«æ€æ­»ï¼Œå¯¼è‡´ç¬¬äºŒä¸ª runner æœåŠ¡ä¾æ—§å¤„äº pedding çŠ¶æ€ã€‚å‰å°å¤šæ¬¡æ“ä½œ cancel å¹¶é‡å¯åï¼ŒæœåŠ¡å™¨èµ„æºç›´æ¥è€—å°½ï¼Œéœ€è¦é‡å¯ sonar æ‰€åœ¨çš„æœåŠ¡å™¨æ‰è¡Œã€‚æœªè§£å†³ï¼ˆåŠ äº†æ¯æ¬¡æœåŠ¡å¯åŠ¨å‰å…³é—­åˆ«çš„æ‰«ææœåŠ¡ï¼Œå¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼‰\n\n\nè™½ç„¶ä¹‹å‰æ·»åŠ äº†æ’ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰ä½¿ç”¨ sonar çš„ PR/MR æ‰«ææ¨¡å¼ï¼Œæ¯æ¬¡éƒ½æ˜¯å…¨é‡è¿›è¡Œæ‰«æï¼Œå¹¶ä¸”åŠ ä¸Šäº† merge é˜»æ–­ï¼Œå¯¼è‡´æ¯æ¬¡éƒ½éœ€è¦ merge å‰ç­‰å¾…ï¼Œè€—æ—¶è¾ƒä¹…ã€‚å·²è§£å†³\n\n\nsonar çš„ webhook è¦è½¬å‘åˆ°é£ä¹¦ï¼Œä¹‹å‰å·æ‡’æ²¡æœ‰å†™ä¸€ä¸ªæœåŠ¡è¿›è¡Œè½¬å‘ï¼Œå¯¼è‡´å¡ç‰‡æ ·å¼æ¯”è¾ƒéš¾çœ‹ã€‚å·²è§£å†³\n\n\nPR/MR æ‰«ææ¨¡å¼\n\næ·»åŠ äº†è¿™ç§æ‰«ææ¨¡å¼ä¹‹åï¼Œç”±äºæ–°ä»£ç æ˜¯ä¸ master åˆ†æ”¯è¿›è¡Œæ¯”è¾ƒï¼Œéœ€è¦å†™ä¸€ä¸ªå®šæ—¶çš„ ci å¯¹ master åˆ†æ”¯è¿›è¡Œå…¨é‡çš„æ‰«æ\n\n.gitlab-ci.yml\nstages:    - sonarqube    - noop  sonarqube-check:    stage: sonarqube    tags:      - sonar    variables:      SONAR_USER_HOME: &quot;$&#123;CI_PROJECT_DIR&#125;/.sonar&quot;  # Defines the location of the analysis task cache      GIT_DEPTH: &quot;0&quot;  # Tells git to fetch all the branches of the project, required by the analysis task    cache:      key: sonar-cache      paths:        - .sonar/cache    before_script:      - echo &quot;æ£€æŸ¥å¹¶ç»ˆæ­¢ä¹‹å‰çš„ Maven è¿›ç¨‹...&quot;      - |        # æŸ¥æ‰¾å¹¶ç»ˆæ­¢ä¹‹å‰çš„ Maven è¿›ç¨‹        maven_pids=$(pgrep -f &quot;gitlab_sonarci_run&quot; || true)        if [ -n &quot;$maven_pids&quot; ]; then            echo &quot;å‘ç°ä¹‹å‰çš„ Maven è¿›ç¨‹ï¼Œæ­£åœ¨ç»ˆæ­¢...&quot;            echo &quot;$maven_pids&quot; | xargs kill -TERM || true            echo &quot;$maven_pids &quot; | xargs wait || true        else            echo &quot;æœªå‘ç°ä¹‹å‰çš„ Maven è¿›ç¨‹ã€‚&quot;        fi    script:      - JAVA_HOME=ä½ çš„æœåŠ¡åœ°å€ &amp;&amp; export JAVA_HOME      - export SONAR_JAVA_OPTS=&quot;-Xmx2G -Xms1G&quot;      - |        echo &quot;å¯åŠ¨ SonarQube åˆ†æ...&quot;        run_scan() &#123;          mvn verify sonar:sonar -T 2 \\          -Dsonar.projectKey=ä½ çš„key \\          # è¿™éƒ¨åˆ†æ•°æ®ä¼šåœ¨ merge_request_event æ—¶ç”± gitlab è¿›è¡Œå¡«å……        -Dsonar.pullrequest.key=$CI_MERGE_REQUEST_IID \\          -Dsonar.pullrequest.branch=$CI_COMMIT_REF_NAME \\          -Dsonar.pullrequest.base=$CI_MERGE_REQUEST_TARGET_BRANCH_NAME \\          -Dmaven.test.skip=true \\          -Dsonar.qualitygate.wait=true \\          -Dsonar.ce.parallel=1 \\          -Dmaven.repo.local=ä½ çš„æœ¬åœ°ä»“åº“ \\          -s ä½ çš„mavené…ç½®åœ°å€ \\          -Dci.tag=gitlab_sonarci_run &amp;        &#125;        run_scan    allow_failure: false    rules:      # å¦‚æœ SKIP_SONAR ä¸º &quot;true&quot;ï¼Œè·³è¿‡ä»»åŠ¡      - if: &#x27;$SKIP_SONAR == &quot;true&quot;&#x27;        when: never      # åœ¨åˆå¹¶è¯·æ±‚æ—¶è§¦å‘      - if: &#x27;$CI_PIPELINE_SOURCE == &quot;merge_request_event&quot; &amp;&amp; $CI_MERGE_REQUEST_TARGET_BRANCH_NAME == &quot;master&quot;&#x27;    noop:    tags:      - sonar    stage: noop    script:      - echo &quot;Pipeline skipped all main jobs.&quot;    rules:      # åœ¨åˆå¹¶è¯·æ±‚æ—¶è§¦å‘      - if: &#x27;$CI_PIPELINE_SOURCE == &quot;merge_request_event&quot; &amp;&amp; $CI_MERGE_REQUEST_TARGET_BRANCH_NAME == &quot;master&quot;&#x27;  sonarqube-master-daily:    tags:      - sonar    stage: sonarqube    script:      - JAVA_HOME=ä½ çš„æœåŠ¡åœ°å€ &amp;&amp; export JAVA_HOME      - export SONAR_JAVA_OPTS=&quot;-Xmx2G -Xms1G&quot;      - |        echo &quot;å¯åŠ¨ SonarQube åˆ†æ...&quot;        run_scan() &#123;          mvn verify sonar:sonar -T 2 \\          -Dsonar.projectKey=ä½ çš„key \\          -Dsonar.branch.name=master \\          -Dmaven.test.skip=true \\          -Dsonar.qualitygate.wait=true \\          -Dsonar.ce.parallel=1 \\          -Dmaven.repo.local=ä½ çš„ä»“åº“åœ°å€ \\          -s ä½ çš„mavené…ç½®æ–‡ä»¶åœ°å€ \\          -Dci.tag=gitlab_sonarci_run &amp;        &#125;        run_scan    rules:      - if: &#x27;$CI_COMMIT_BRANCH == &quot;master&quot; &amp;&amp; $CI_PIPELINE_SOURCE == &quot;schedule&quot;&#x27;\nå®šæ—¶ ci æ·»åŠ \n\ngitlab å®šæ—¶ CI ä¼šå»æ‰« master ä¸‹çš„ .gitlab-ci.yml æ–‡ä»¶ï¼Œ\n\nwebhook è½¬å‘\n\nnode.js ä»£ç åœ°å€ï¼šhttps://github.com/kiml-rgb/sonar-feishu-webhook.git\n\n\n\nåˆ›å»ºä¸€ä¸ªä¸­é—´æœåŠ¡ï¼ˆå»ºè®®ä½¿ç”¨ Spring Boot æˆ– Node.jsï¼‰ç›‘å¬ SonarQube Webhookã€‚\n\n\næ¥æ”¶åˆ° Webhook åï¼Œè§£æ payloadï¼Œæ„é€ ä¸Šé¢çš„å¡ç‰‡æ ¼å¼ JSONã€‚\n\n\nå°†å¡ç‰‡æ ¼å¼æ¶ˆæ¯ POST åˆ°é£ä¹¦æœºå™¨äººåœ°å€\n\n\né¡¹ç›®ç»“æ„\nsonar-feishu-webhook/â”œâ”€â”€ app.jsâ”œâ”€â”€ feishu.jsâ”œâ”€â”€ Dockerfileâ”œâ”€â”€ package.jsonâ””â”€â”€ .env\néƒ¨ç½²\n\n\né¡¹ç›®æ–‡ä»¶å‡†å¤‡\n\n\næ„å»ºé•œåƒ\n\n\ndocker build -t sonar-webhook-feishu .\n\n\nè¿è¡Œå®¹å™¨\n\n\ndocker run -d --name sonar-feishu \\  -p 9999:3000 \\  --env-file .env \\sonar-webhook-feishu\n\n\nåœ¨ SonarQube åå° Webhook ä¸­é…ç½®\n\n\nyour-address/webhook/sonar\n","categories":["åç«¯é¡¹ç›®","å‡†å¤‡å·¥ä½œ"],"tags":["GitLab","SonarQube"]},{"title":"ç¬¬äºŒç« ï¼šæ•°æ®ç»“æ„ä¸ç®—æ³•åŸºç¡€","url":"/posts/92102162/","content":"\n\næ›´æ–°\n\n\n25-05-18 åˆå§‹è®°å½•\n\nåŸºæœ¬æ¦‚å¿µä¸ä¸‰è¦ç´ \næ•°æ®ï¼šæ•°æ®æ˜¯ä¿¡æ¯çš„è½½ä½“ï¼Œæ˜¯æè¿°å®¢è§‚äº‹ç‰©å±æ€§çš„æ•°ã€å­—ç¬¦åŠæ‰€æœ‰èƒ½è¾“å…¥åˆ°è®¡ç®—æœºä¸­å¹¶è¢«è®¡ç®—æœºç¨‹åºè¯†åˆ«å’Œå¤„ç†çš„ç¬¦å·çš„é›†åˆã€‚æ•°æ®æ˜¯è®¡ç®—æœºç¨‹åºåŠ å·¥çš„åŸæ–™ã€‚\næ•°æ®å…ƒç´ ã€æ•°æ®é¡¹ï¼šæ•°æ®å…ƒç´ æ˜¯æ•°æ®çš„åŸºæœ¬å•ä½ï¼Œé€šå¸¸ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡Œè€ƒè™‘å’Œå¤„ç†ã€‚ä¸€ä¸ªæ•°æ®å…ƒç´ å¯ç”±è‹¥å¹²æ•°æ®é¡¹ç»„æˆï¼Œæ•°æ®é¡¹æ˜¯æ„æˆæ•°æ®å…ƒç´ çš„ä¸å¯åˆ†å‰²çš„æœ€å°å•ä½ã€‚\næ•°æ®ç»“æ„ï¼šæ˜¯ç›¸äº’ä¹‹é—´å­˜åœ¨ä¸€ç§æˆ–å¤šç§ç‰¹å®šå…³ç³»d çš„æ•°æ®å…ƒç´ çš„é›†åˆã€‚\nä¸‰è¦ç´ ï¼šé€»è¾‘ç»“æ„ã€ç‰©ç†ç»“æ„ï¼ˆå­˜å‚¨ç»“æ„ï¼‰ã€æ•°æ®çš„è¿ç®—\nä¸‰è¦ç´  - é€»è¾‘ç»“æ„\né›†åˆï¼šå„ä¸ªå…ƒç´ åŒå±äºä¸€ä¸ªé›†åˆï¼Œåˆ«æ— å…¶å®ƒå…³ç³»ã€‚\nçº¿æ€§ç»“æ„ï¼šæ•°æ®å…ƒç´ ä¹‹é—´æ—¶ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚é™¤äº†ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½æœ‰å”¯ä¸€å‰é©±ï¼›é™¤äº†æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ‰€æœ‰å…ƒç´ éƒ½æœ‰å”¯ä¸€åç»§ã€‚\næ ‘å½¢ç»“æ„ï¼šæ•°æ®å…ƒç´ ä¹‹é—´æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚\nå›¾ç»“æ„ï¼šæ•°æ®å…ƒç´ ä¹‹é—´æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚\nä¸‰è¦ç´  - ç‰©ç†ç»“æ„\né¡ºåºç»“æ„ï¼šæŠŠé€»è¾‘ä¸Šç›¸é‚»çš„å…ƒç´ å­˜å‚¨åœ¨å±‹é‡Œä½ç½®ä¸Šä¹Ÿç›¸é‚»çš„å­˜å‚¨å•å…ƒä¸­\nè”æ˜¯å­˜å‚¨ï¼šé€»è¾‘ä¸Šç›¸é‚»çš„å…ƒç´ åœ¨ç‰©ç†ä½ç½®ä¸Šå¯ä»¥ä¸ç›¸é‚»\nç´¢å¼•å­˜å‚¨ï¼šåœ¨å­˜å‚¨å…ƒç´ ä¿¡æ¯çš„åŒæ—¶ï¼Œè¿˜å»ºç«‹é™„åŠ çš„ç´¢å¼•è¡¨\næ•£åˆ—å­˜å‚¨ï¼šæ ¹æ®å…ƒç´ çš„å…³é”®å­—ç›´æ¥è®¡ç®—å‡ºè¯¥å…ƒç´ çš„å­˜å‚¨åœ°å€ï¼Œåˆç§°å“ˆå¸Œå­˜å‚¨\nç®—æ³•\näº”ä¸ªç‰¹æ€§\næœ‰ç©·æ€§ï¼šä¸€ä¸ªç®—æ³•å¿…é¡»æ€»åœ¨æ‰§è¡Œæœ‰ç©·æ­¥ä¹‹åç»“æŸï¼Œä¸”æ¯ä¸€æ­¥éƒ½å¯åœ¨æœ‰ç©·æ—¶é—´å†…å®Œæˆã€‚\nç¡®å®šæ€§ï¼šç®—æ³•ä¸­æ¯æ¡æŒ‡ä»¤å¿…é¡»æœ‰ç¡®åˆ‡çš„å«ä¹‰ï¼Œå¯¹äºç›¸åŒçš„è¾“å…¥åªèƒ½å¾—å‡ºç›¸åŒçš„è¾“å‡ºã€‚\nå¯è¡Œæ€§ï¼šç®—æ³•ä¸­æè¿°çš„æ“ä½œéƒ½å¯ä»¥é€šè¿‡å·²ç»å®ç°çš„åŸºæœ¬è¿ç®—æ‰§è¡Œæœ‰é™æ¬¡æ¥å®ç°ã€‚\nè¾“å…¥ï¼šä¸€ä¸ªç®—æ³•æœ‰é›¶ä¸ªæˆ–å¤šä¸ªè¾“å…¥ï¼Œè¿™äº›è¾“å…¥å–è‡ªäºæŸä¸ªç‰¹å®šçš„å¯¹è±¡çš„é›†åˆã€‚\nè¾“å‡ºï¼šä¸€ä¸ªç®—æ³•æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å‡ºï¼Œè¿™äº›è¾“å‡ºæ˜¯ä¸è¾“å…¥æœ‰ç€æŸç§ç‰¹å®šçš„å…³ç³»çš„é‡ã€‚\nç®—æ³•æ•ˆç‡çš„åº¦é‡\næ—¶é—´å¤æ‚åº¦ï¼šæ—¶é—´å¼€é”€ä¸é—®é¢˜è§„æ¨¡ n ä¹‹é—´çš„å…³ç³»\nç©ºé—´å¤æ‚åº¦ï¼šç©ºé—´å¼€é”€ï¼ˆå†…å­˜å¼€é”€ï¼‰ä¸é—®é¢˜è§„æ¨¡ n ä¹‹é—´çš„å…³ç³»ã€‚\né€’å½’è°ƒç”¨å¸¦æ¥çš„å†…å­˜å¼€é”€ï¼šS(n) = O(n) ç©ºé—´å¤æ‚åº¦ = é€’å½’è°ƒç”¨çš„æ·±åº¦\nO(1) &lt; O(log2n) &lt; O(n) &lt; O(nlog2n) &lt; O(n^2) &lt; O(n^3) &lt; O(2^n) &lt; O(n!) &lt; O(n^n)\nçº¿æ€§è¡¨\nå­˜å‚¨ç»“æ„\n|- é¡ºåºè¡¨|- é“¾è¡¨ |-- å•é“¾è¡¨|-- å¾ªç¯é“¾è¡¨|-- åŒå‘é“¾è¡¨\n\n\n\næ€§èƒ½ç±»åˆ«\nå…·ä½“é¡¹ç›®\né¡ºåºå­˜å‚¨\né“¾å¼å­˜å‚¨\n\n\n\n\nç©ºé—´æ€§èƒ½\nå­˜å‚¨å¯†åº¦\n=1\n&lt;1\n\n\n\nå®¹é‡åˆ†é…\näº‹å…ˆç¡®å®š\nåŠ¨æ€æ”¹å˜\n\n\næ—¶é—´æ€§èƒ½\næŸ¥æ‰¾è¿ç®—\nO(n/2)\nO(n/2)\n\n\n\nè¯»è¿ç®—\nO(1)\nO([n + 1]/2)ï¼Œæœ€å¥½æƒ…å†µä¸º 1ï¼Œæœ€åæƒ…å†µä¸º n\n\n\n\næ’å…¥è¿ç®—\nO(n/2)ï¼Œæœ€å¥½æƒ…å†µä¸º 0ï¼Œæœ€åæƒ…å†µä¸º n\nO(1)\n\n\n\nåˆ é™¤è¿ç®—\n([n - 1]/2)ï¼Œ\nO(1)\n\n\n\nå…¶ä»–\nç®—æ³•é—®é¢˜ç›´æ¥çœ‹ä¹‹å‰çš„ç®—æ³•ç¬”è®°ã€‚\n\nå†…é“¾ï¼š[[é¢è¯•-æ•°æ®ç»“æ„å’Œç®—æ³•]]\nå¤–é“¾ï¼šé¢è¯•-æ•°æ®ç»“æ„å’Œç®—æ³•\n\n","categories":["é¢è¯•","è½¯è€ƒ","ä¸­çº§-è½¯ä»¶è®¾è®¡å¸ˆ"]},{"title":"ç¬¬ä¸€ç« ï¼šè®¡ç®—æœºç³»ç»ŸçŸ¥è¯†","url":"/posts/3f3c39e1/","content":"\n\næ›´æ–°\n\n\n25-04-06 åˆå§‹è®°å½•\n\næ•°å€¼åŠå…¶è½¬æ¢å’Œæ•°æ®çš„è¡¨ç¤º\näºŒè¿›åˆ¶ï¼ˆBï¼‰ã€å…«è¿›åˆ¶ï¼ˆOï¼‰ã€åè¿›åˆ¶ï¼ˆDï¼‰ã€åå…­è¿›åˆ¶ï¼ˆHï¼‰\nä»»æ„è¿›åˆ¶ -&gt; åè¿›åˆ¶ï¼šä½æƒå±•å¼€\nåè¿›åˆ¶ -&gt; ä»»æ„è¿›åˆ¶ï¼šçŸ­é™¤æ³•\näºŒè¿›åˆ¶ -&gt; åå…­è¿›åˆ¶ï¼š4 ä½è½¬ 1 ä½\n\n\n\n2^12\n2^11\n2^10\n2^9\n2^8\n2^7\n2^6\n2^5\n2^4\n2^3\n2^2\n2^1\n2^0\n2^-1\n2^-2\n2^-3\n\n\n\n\n4096\n2048\n1024\n512\n256\n128\n64\n32\n16\n8\n4\n2\n1\n0.5\n0.25\n0.125\n\n\n\nè®¡ç®—æœºå†…æ•°æ®çš„è¡¨ç¤º\nçœŸå€¼ä¸æœºå™¨æ•°\nçœŸå€¼ï¼šç¬¦åˆäººç±»ä¹ æƒ¯çš„æ•°å­—\næœºå™¨æ•°ï¼šå„ç§æ•°æ®åœ¨è®¡ç®—æœºä¸­è¡¨ç¤ºçš„å½¢å¼ç§°ä¸ºæœºå™¨æ•°ï¼Œå…¶ç‰¹ç‚¹æ˜¯æ•°çš„ç¬¦å·ç”¨ 0ã€1 è¡¨ç¤ºã€‚å³æ­£è´Ÿå·éœ€è¦è¢«â€œæ•°å­—åŒ–â€\næœºå™¨æ•°- æ— ç¬¦å·æ•°ï¼šæ— ç¬¦å·æ•°è¡¨ç¤ºæ­£æ•°ï¼Œåœ¨æœºå™¨æ•°ä¸­æ²¡æœ‰ç¬¦å·ä½- æœ‰ç¬¦å·æ•°\t- åŸç \t- åç \t- è¡¥ç \t- ç§»ç \nåŸç \nåŸç ï¼šç”¨æ•°å€¼éƒ¨åˆ†è¡¨ç¤ºçœŸå€¼çš„ç»å¯¹å€¼ï¼Œç¬¦å·ä½â€œ0/1â€å¯¹åº”â€œæ­£/è´Ÿâ€ã€‚\n\nè‹¥æœºå™¨å­—é•¿ n+1 ä½ï¼ŒåŸç æ•´æ•°çš„è¡¨ç¤ºèŒƒå›´ï¼š-(2^n -1) &lt;= x &lt;= 2^n -1è‹¥æœºå™¨å­—é•¿ n+1 ä½ï¼Œåˆ™æ•°å€¼éƒ¨åˆ†ï¼ˆå°¾æ•°ï¼‰å  n ä½ï¼ŒçœŸå€¼ 0 æœ‰ +0 å’Œ -0 ä¸¤ç§å½¢å¼ã€‚\n\nåç \nåç ï¼šè‹¥ç¬¦å·ä½ä¸º 0ï¼Œåˆ™åç ä¸åŸç ç›¸åŒã€‚è‹¥ç¬¦å·ä½ä¸º 1ï¼Œåˆ™æ•°å€¼ä½å…¨éƒ¨å–åã€‚\n\nè‹¥æœºå™¨å­—é•¿ n+1 ä½ï¼Œåç æ•´æ•°çš„è¡¨ç¤ºèŒƒå›´ï¼š-(2^n -1) &lt;= x &lt;= 2^n -1çœŸå€¼ 0 æœ‰ +0 å’Œ -0 ä¸¤ç§å½¢å¼ã€‚\n\nè¡¥ç \nè¡¥ç ï¼šè‹¥ç¬¦å·ä½ä¸º 0ï¼Œåˆ™è¡¥ç ä¸åŸç ç›¸åŒã€‚è‹¥ç¬¦å·ä½ä¸º 1ï¼Œåˆ™è¡¥ç =åç æœ«ä½ +1ã€‚\n\nè‹¥æœºå™¨å­—é•¿ n+1 ä½ï¼Œè¡¥ç æ•´æ•°çš„è¡¨ç¤ºèŒƒå›´ï¼š-2^n &lt;= x &lt;= 2^n -1\nçœŸå€¼ 0 åªæœ‰ä¸€ç§å½¢å¼00000000ã€‚å®šç‚¹æ•´æ•°è¡¥ç  [x]è¡¥ = 10000000 è¡¨ç¤º -2^7\n\nç§»ç \nç§»ç ï¼šè¡¥ç çš„åŸºç¡€ä¸Šå°†ç¬¦å·ä½å–åã€‚æ³¨æ„ï¼šç§»ç åªèƒ½ç”¨äºè¡¨ç¤ºæ•´æ•°ã€‚\n\nè‹¥æœºå™¨å­—é•¿ n+1 ä½ï¼Œè¡¥ç æ•´æ•°çš„è¡¨ç¤ºèŒƒå›´ï¼š-2^n &lt;= x &lt;= 2^n -1\n\nå®šç‚¹æ•° å’Œ æµ®ç‚¹æ•°\nå®šç‚¹æ•°ï¼šå°±æ˜¯å°æ•°ç‚¹çš„ä½ç½®å›ºå®šä¸å˜çš„æ•°ã€‚å°æ•°ç‚¹çš„ä½ç½®é€šå¸¸æœ‰ä¸¤ç§çº¦å®šæ–¹å¼ï¼šå®šç‚¹æ•´æ•°ï¼ˆçº¯æ•´æ•°ï¼Œå°æ•°ç‚¹åœ¨æœ€ä½æœ‰æ•ˆæ•°å€¼ä½ä¹‹åï¼‰å’Œå®šç‚¹å°æ•°ï¼ˆçº¯å°æ•°ï¼Œå°æ•°ç‚¹åœ¨æœ€é«˜æœ‰æ•ˆæ•°å€¼ä½ä¹‹å‰ï¼‰\n5D - 0ï¼Œ01001.0.5D - 0.1000\næµ®ç‚¹æ•°ï¼šå°æ•°ç‚¹ä½ç½®ä¸å›ºå®šçš„æ•°ï¼Œä»–èƒ½è¡¨ç¤ºæ›´å¤§èŒƒå›´çš„æ•°ã€‚åœ¨æµ®ç‚¹è¡¨ç¤ºæ³•ä¸­ï¼Œé˜¶ç é€šå¸¸ä¸ºå¸¦ç¬¦å·çš„çº¯æ•´æ•°ï¼Œå°¾æ•°ä¸ºå¸¦ç¬¦å·çš„çº¯å°æ•°ã€‚æµ®ç‚¹æ•°é€šå¸¸è¡¨ç¤ºä¸º N=MR^Eã€‚å…¶ä¸­ï¼ŒM ç§°ä¸ºå°¾æ•°ï¼ŒR ç§°ä¸ºåŸºæ•°ï¼ŒE ç§°ä¸ºé˜¶ç ã€‚\n\n\n\né˜¶ç ï¼ˆEï¼‰\nç ä»·\næ•°ç¬¦\nå°¾æ•°ï¼ˆMï¼‰\n\n\n\n\né˜¶ç ï¼Œå†³å®šæµ®ç‚¹æ•°æ‰€èƒ½è¡¨ç¤ºçš„æ•°å€¼èŒƒå›´\nå°¾æ•°ï¼Œ å†³å®šæµ®ç‚¹æ•°æ‰€èƒ½è¡¨ç¤ºçš„æ•°å€¼ç²¾åº¦\n\næ ¡éªŒç \næ ¡éªŒç ï¼šç”¨æ¥æ£€æµ‹ä¼ é€çš„æ•°æ®æ˜¯å¦å‡ºé”™ã€‚\nç è·ï¼šæŒ‡ä¸€ä¸ªç¼–ç ç³»ç»Ÿä¸­ä»»æ„ä¸¤ä¸ªåˆæ³•ç¼–ç ä¹‹é—´è‡³å°‘æœ‰å¤šå°‘ä¸ªäºŒè¿›åˆ¶ä½ä¸åŒã€‚\nå¥‡å¶æ ¡éªŒ\nå‘ç°é”™è¯¯ã€‚\nå¾ªç¯å†—ä½™æ ¡éªŒç  CRC\nåº”ç”¨äºæ•°æ®é€šä¿¡é¢†åŸŸå’Œç£ä»‹è´¨å­˜å‚¨ç³»ç»Ÿä¸­ã€‚é•¿åº¦ kï¼ˆæ•°æ®ä½ï¼‰ + rï¼ˆæ ¡éªŒä½ï¼‰\næµ·æ˜ç \næµ·æ˜ç çš„æ„æˆæ–¹æ³•æ˜¯ï¼šåœ¨æ•°æ®ä½ä¹‹é—´æ’å…¥ k ä¸ªæ ¡éªŒç ï¼Œé€šè¿‡æ‰©å¤§ç è·æ¥å®ç°æ£€é”™å’Œçº é”™ã€‚\n\nè®¾æ•°æ®ä½æ˜¯ n ä½ï¼Œæ ¡éªŒä½æ˜¯ k ä½ï¼Œåˆ™ n å’Œ k å¿…é¡»æ»¡è¶³ä»¥ä¸‹å…³ç³»ï¼š\n2^k -1 &gt;= n+k\n\nè®¡ç®—æœºç³»ç»Ÿç»„æˆ\näº”å¤§éƒ¨ä»¶\n\nè¾“å…¥è®¾å¤‡ã€è¾“å‡ºè®¾å¤‡ã€å­˜å‚¨å™¨ã€è¿ç®—å™¨ã€æ§åˆ¶å™¨ã€‚è¾“å…¥/è¾“å‡ºè®¾å¤‡ä¸å­˜å‚¨å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“é€šè¿‡è¿ç®—å™¨å®Œæˆã€‚\n\nå†¯Â·è¯ºä¾æ›¼è®¡ç®—æœºçš„ç‰¹ç‚¹ï¼š\n\n\nè®¡ç®—æœºç”±äº”å¤§éƒ¨ä»¶ç»„æˆï¼ˆè¾“å…¥è®¾å¤‡ã€è¾“å‡ºè®¾å¤‡ã€å­˜å‚¨å™¨ã€è¿ç®—å™¨ã€æ§åˆ¶å™¨ï¼‰\n\n\næŒ‡ä»¤å’Œæ•°æ®ä»¥åŒç­‰åœ°ä½å­˜äºå­˜å‚¨å™¨ï¼Œå¯æŒ‰åœ°å€å¯»è®¿\n\n\næŒ‡ä»¤å’Œæ•°æ®ç”¨äºŒè¿›åˆ¶è¡¨ç¤º\n\n\næŒ‡ä»¤ç”±æ“ä½œç å’Œåœ°å€ç ç»„æˆ\n\n\nå­˜å‚¨ç¨‹åº\n\n\nä»¥è¿ç®—å™¨ä¸ºä¸­å¿ƒ\n\n\nè¾“å…¥è®¾å¤‡ï¼šå°†ä¿¡æ¯è½¬æ¢ä¸ºæœºå™¨èƒ½è¯†åˆ«çš„å½¢å¼ 0/1\nè¾“å‡ºè®¾å¤‡ï¼šå°†ç»“æœè½¬æ¢ä¸ºäººä»¬ç†ŸçŸ¥çš„å½¢å¼\nä¸»å­˜å‚¨å™¨ï¼šå­˜æ”¾æ•°æ®å’Œç¨‹åº\nè¿ç®—å™¨ï¼šç®—æœ¯è¿ç®—ã€é€»è¾‘è¿ç®—\næ§åˆ¶å™¨ï¼šæŒ‡æŒ¥å„éƒ¨ä»¶ã€ä½¿ç¨‹åºå¾—ä»¥è¿è¡Œ\nä¸»å­˜å‚¨å™¨\n\nå­˜å‚¨ä½“ã€MARã€MDR\n\nå­˜å‚¨å•å…ƒï¼šæ¯ä¸ªå­˜å‚¨å•å…ƒå­˜æ”¾ä¸€ä¸²äºŒè¿›åˆ¶ä»£ç ã€‚\nå­˜å‚¨å­—ï¼šå­˜å‚¨å•å…ƒä¸­äºŒè¿›åˆ¶ä»£ç çš„ç»„åˆã€‚\nå­˜å‚¨å­—é•¿ï¼šå­˜å‚¨å•å…ƒä¸­äºŒè¿›åˆ¶ä»£ç çš„ä½æ•°ã€‚\nå­˜å‚¨å…ƒï¼šå³å­˜å‚¨äºŒè¿›åˆ¶çš„ç”µå­å…ƒä»¶ï¼Œæ¯ä¸ªå­˜å‚¨å…ƒå¯å­˜ 1 bitã€‚\nMARï¼šåœ°å€å¯„å­˜å™¨ï¼ˆæ ‡è®°å­˜å‚¨å•å…ƒçš„ä¸ªæ•°ï¼‰\nMDRï¼šæ•°æ®å¯„å­˜å™¨\nMAR = 4ä½ -&gt; æ€»å…±æœ‰ 2*2*2*2 ä¸ªå­˜å‚¨å•å…ƒMDR = 16ä½ -&gt; æ¯ä¸ªå­˜å‚¨å•å…ƒå¯å­˜æ”¾ 16 bit\nCPU - è¿ç®—å™¨\nè¿ç®—å™¨ï¼šç”¨äºå®ç°ç®—æœ¯è¿ç®—ï¼ˆå¦‚ï¼šåŠ å‡ä¹˜é™¤ï¼‰ã€é€»è¾‘è¿ç®—ï¼ˆå¦‚ï¼šä¸æˆ–éï¼‰\nACCï¼šç´¯åŠ å™¨ï¼Œç”¨äºå­˜æ”¾æ“ä½œæ•°ï¼Œæˆ–è¿ç®—ç»“æœã€‚\nMQï¼šä¹˜å•†å¯„å­˜å™¨ï¼Œåœ¨ä¹˜ã€é™¤è¿ç®—æ—¶ï¼Œç”¨äºå­˜æ”¾æ“ä½œæ•°æˆ–ç»“æœè¿ç®—ã€‚\nXï¼šé€šç”¨çš„æ“ä½œæ•°å¯„å­˜å™¨ï¼Œç”¨äºå­˜æ”¾æ“ä½œæ•°ã€‚\nALUï¼šç®—æœ¯é€»è¾‘å•å…ƒï¼Œé€šè¿‡å†…éƒ¨å¤æ‚çš„ç”µè·¯å®ç°ç®—æœ¯è¿ç®—ã€é€»è¾‘è¿ç®—ã€‚\nDRï¼šæ•°æ®ç¼“å­˜å¯„å­˜å™¨ã€‚\nPSWï¼šçŠ¶æ€æ¡ä»¶å¯„å­˜å™¨ï¼Œç”¨æ¥ä¿å­˜æŒ‡ä»¤è¿è¡Œæ ‡å¿—ã€‚\nCPU - æ§åˆ¶å™¨\nCUï¼šæ§åˆ¶å•å…ƒï¼Œåˆ†ææŒ‡ä»¤ï¼Œç»™å‡ºæ§åˆ¶ä¿¡å·ã€‚\nIRï¼šæŒ‡ä»¤å¯„å­˜å™¨ï¼Œå­˜æ”¾å½“å‰æ‰§è¡Œçš„æŒ‡ä»¤ã€‚\nPCï¼šç¨‹åºè®¡æ•°å™¨ï¼Œå­˜æ”¾ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼Œæœ‰è‡ªåŠ¨åŠ  1åŠŸèƒ½ã€‚\nARï¼šåœ°å€å¯„å­˜å™¨ï¼Œä¿å­˜å½“å‰ CPU æ‰€è®¿é—®çš„å†…å­˜å•å…ƒåœ°å€ã€‚\nIDï¼šæŒ‡ä»¤è¯‘ç å™¨ï¼Œå¯¹æ“ä½œç è¿›è¡Œåˆ†æã€‚\nè®¡ç®—æœºä½“ç³»ç»“æ„\nFlynn åˆ†ç±»æ³•\n\n\n\nä½“ç³»ç»“æ„ç±»å‹\nç»“æ„\nå…³é”®ç‰¹æ€§\nä»£è¡¨\n\n\n\n\nå•æŒ‡ä»¤æµå•æ•°æ®æµ SISD\næ§åˆ¶éƒ¨åˆ†ï¼šä¸€ä¸ªå¤„ç†å™¨ï¼šä¸€ä¸ªä¸»å­˜æ¨¡å—ï¼šä¸€ä¸ª\n\nå•å¤„ç†å™¨ç³»ç»Ÿ\n\n\nå•æŒ‡ä»¤æµå¤šæ•°æ®æµ SIMD\næ§åˆ¶éƒ¨åˆ†ï¼šä¸€ä¸ªå¤„ç†å™¨ï¼šå¤šä¸ªä¸»å­˜æ¨¡å—ï¼šå¤šä¸ª\nå„å¤„ç†å™¨ä»¥å¼‚æ­¥çš„å½¢å¼æ‰§è¡ŒåŒä¸€æ¡æŒ‡ä»¤\nå¹¶è¡Œå¤„ç†æœºé˜µåˆ—å¤„ç†æœºè¶…çº§å‘é‡å¤„ç†æœº\n\n\nå¤šæŒ‡ä»¤æµå•æ•°æ®æµ MISD\næ§åˆ¶éƒ¨åˆ†ï¼šå¤šä¸ªå¤„ç†å™¨ï¼šä¸€ä¸ªä¸»å­˜æ¨¡å—ï¼šå¤šä¸ª\nè¢«è¯æ˜ä¸å¯èƒ½ï¼Œè‡³å°‘æ˜¯ä¸å®é™…\nç›®å‰æ²¡æœ‰ï¼Œæœ‰æ–‡çŒ®ç§°æµæ°´è®¡ç®—æœºä¸ºæ­¤ç±»\n\n\nå¤šæŒ‡ä»¤æµå¤šæ•°æ®æµ MIMD\næ§åˆ¶éƒ¨åˆ†ï¼šå¤šä¸ªå¤„ç†å™¨ï¼šå¤šä¸ªä¸»å­˜æ¨¡å—ï¼šå¤šä¸ª\nèƒ½å¤Ÿå®ç°ä½œä¸šã€ä»»åŠ¡ã€æŒ‡ä»¤ç­‰å„çº§å…¨é¢å±è¡Œ\nå¤šå¤„ç†æœºç³»ç»Ÿå¤šè®¡ç®—æœº\n\n\n\næŒ‡ä»¤ç³»ç»Ÿ\næŒ‡ä»¤\næŒ‡ä»¤ï¼ˆåˆç§°æœºå™¨æŒ‡ä»¤ï¼‰ï¼šæ˜¯æŒ‡ä»¤è®¡ç®—æœºæ‰§è¡ŒæŸç§æ“ä½œçš„å‘½ä»¤ï¼Œæ˜¯è®¡ç®—æœºè¿è¡Œçš„æœ€å°åŠŸèƒ½å•ä½ã€‚\nä¸€å°è®¡ç®—æœºçš„æ‰€æœ‰æŒ‡ä»¤çš„é›†åˆæ„æˆè¯¥æœºçš„æŒ‡ä»¤ç³»ç»Ÿï¼Œä¹Ÿç§°ä¸ºæŒ‡ä»¤é›†ã€‚\næŒ‡ä»¤æ ¼å¼\nä¸€æ¡æŒ‡ä»¤å°±æ˜¯æœºå™¨è¯­è¨€çš„ä¸€ä¸ªè¯­å¥ï¼Œå®ƒæ˜¯ä¸€ç»„æœ‰æ„ä¹‰çš„äºŒè¿›åˆ¶ä»£ç ã€‚\nä¸€æ¡æŒ‡ä»¤é€šå¸¸è¦åŒ…æ‹¬æ“ä½œç å­—æ®µï¼ˆæ“ä½œçš„ç±»å‹ï¼‰å’Œåœ°å€ç å­—æ®µï¼ˆæ“ä½œæ•°åŠè¿ç®—ç»“æœå­˜æ”¾çš„åœ°å€ï¼‰ä¸¤éƒ¨åˆ†ã€‚\nä¸ƒç§å¯»å€æ–¹å¼\n\n\nç«‹å³å¯»å€ï¼šæ“ä½œæ•°ä½œä¸ºæŒ‡ä»¤çš„ä¸€éƒ¨åˆ†ç›´æ¥å†™åœ¨æŒ‡ä»¤ä¸­ï¼Œè¿™ç§æ“ä½œæ•°ç§°ä¸ºç«‹å³æ•°ã€‚\n\n\nå¯„å­˜å™¨å¯»å€ï¼šæŒ‡ä»¤æ‰€è¦çš„æ“ä½œæ•°å·²å­˜å‚¨åœ¨æŸå¯„å­˜å™¨ä¸­ï¼Œæˆ–æŠŠç›®æ ‡æ“ä½œæ•°å­˜å…¥å¯„å­˜å™¨ã€‚\n\n\nç›´æ¥å¯»å€ï¼šæŒ‡ä»¤æ‰€è¦çš„æ“ä½œæ•°å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œåœ¨æŒ‡ä»¤ä¸­ç›´æ¥ç»™å‡ºè¯¥æ“ä½œæ•°çš„æœ‰æ•ˆåœ°å€ã€‚\n\n\nå¯„å­˜å™¨é—´æ¥å¯»å€ï¼šæ“ä½œæ•°åœ¨å­˜å‚¨å™¨ä¸­ï¼Œæ“ä½œæ•°çš„æœ‰æ•ˆåœ°å€ç”¨ SIã€DIã€BX å’Œ BP å››ä¸ªå¯„å­˜å™¨ä¹‹ä¸€æ¥åˆ¶å®šã€‚\n\n\nå¯„å­˜å™¨ç›¸å¯¹å¯»å€ï¼šæ“ä½œæ•°åœ¨å­˜å‚¨å™¨ä¸­ï¼Œå…¶æœ‰æ•ˆåœ°å€æ˜¯ä¸€ä¸ªåŸºå€å¯„å­˜å™¨æˆ–å˜å€å¯„å­˜å™¨ä¸­çš„å†…å®¹å’ŒæŒ‡ä»¤ä¸­çš„ 8 ä½/16 ä½åç§»é‡ä¹‹å’Œã€‚\n\n\nåŸºå€åŠ å˜å€å¯»å€æ–¹å¼ï¼šæ“ä½œæ•°åœ¨å­˜å‚¨å™¨ä¸­ï¼Œå…¶æœ‰æ•ˆåœ°å€æ˜¯ä¸€ä¸ªåŸºå€å¯„å­˜å™¨å’Œä¸€ä¸ªå˜å€å¯„å­˜å™¨çš„å†…å®¹ä¹‹å’Œã€‚\n\n\nç›¸å¯¹åŸºå€åŠ å˜å€å¯»å€ï¼šæ“ä½œæ•°åœ¨å­˜å‚¨å™¨ä¸­ï¼Œå…¶æœ‰æ•ˆåœ°å€æ˜¯ä¸€ä¸ªåŸºå€å¯„å­˜å™¨çš„å€¼ã€ä¸€ä¸ªå˜å€å¯„å­˜å™¨çš„å€¼å’ŒæŒ‡ä»¤ä¸­çš„ 8 ä½/16 ä½åç§»é‡ä¹‹å’Œã€‚\n\n\nå¤æ‚æŒ‡ä»¤é›†è®¡ç®—æœº - CISCã€ç²¾ç®€æŒ‡ä»¤é›†è®¡ç®—æœº - RISC\n\n\n\n\nCISCï¼ˆComplexï¼‰\nRISCï¼ˆReducedï¼‰\n\n\n\n\næŒ‡ä»¤ç³»ç»Ÿ\nå¤æ‚ã€åºå¤§\nç®€å•ã€ç²¾ç®€\n\n\næŒ‡ä»¤æ•°ç›®\nä¸€èˆ¬å¤§äº 200 æ¡\nä¸€èˆ¬å°äº 100 æ¡\n\n\næŒ‡ä»¤å­—é•¿\nä¸å›ºå®š\nå®šé•¿\n\n\nå¯è®¿å­˜æŒ‡ä»¤\nä¸åŠ é™åˆ¶\nåªæœ‰ Load/Store æŒ‡ä»¤\n\n\nå„ç§æŒ‡ä»¤æ‰§è¡Œæ—¶é—´\nç›¸å·®è¾ƒå¤§\nç»å¤§å¤šæ•°ä¸€ä¸ªå‘¨æœŸå†…å®Œæˆ\n\n\nå„ç§æŒ‡ä»¤ä½¿ç”¨é¢‘åº¦\nç›¸å·®è¾ƒå¤§\néƒ½æ¯”è¾ƒå¸¸ç”¨\n\n\né€šç”¨å¯„å­˜å™¨æ•°é‡\nè¾ƒå°‘\nå¤š\n\n\næ§åˆ¶æ–¹å¼\nç»å¤§å¤šæ•°ä¸ºå¾®ç¨‹åºæ§åˆ¶\nç»å¤§å¤šæ•°ä¸ºç»„åˆé€»è¾‘æ§åˆ¶\n\n\næŒ‡ä»¤æµæ°´çº¿\nå¯ä»¥é€šè¿‡ä¸€å®šæ–¹å¼å®ç°\nå¿…é¡»å®ç°\n\n\n\næŒ‡ä»¤çš„æµæ°´å¤„ç†\næŒ‡ä»¤æ§åˆ¶æ–¹å¼æœ‰é¡ºåºæ–¹å¼ã€é‡å æ–¹å¼å’Œæµæ°´æ–¹å¼ä¸‰ç§ã€‚\næµæ°´çº¿çš„è®¡ç®—\n\nåˆ—ï¼šè‹¥æŒ‡ä»¤æµæ°´çº¿æŠŠä¸€æ¡æŒ‡ä»¤åˆ†ä¸ºå–æŒ‡ã€åˆ†æå’Œæ‰§è¡Œä¸‰éƒ¨åˆ†ï¼Œä¸”ä¸‰éƒ¨åˆ†çš„æ—¶é—´åˆ†åˆ«æ˜¯å–æŒ‡ 2nsï¼Œåˆ†æ 2nsï¼Œæ‰§è¡Œ 1nsã€‚é‚£ä¹ˆï¼Œæµæ°´çº¿å‘¨æœŸæ˜¯å¤šå°‘ï¼Ÿ100 æ¡æŒ‡ä»¤å…¨éƒ¨æ‰§è¡Œå®Œæ¯•éœ€è¦çš„æ—¶é—´æ˜¯å¤šå°‘ï¼Ÿ\n\næµæ°´çº¿å‘¨æœŸä¸ºæ‰§è¡Œæ—¶é—´æœ€é•¿çš„ä¸€æ®µ\næµæ°´çº¿è®¡ç®—å…¬å¼ä¸ºï¼š1 æ¡æŒ‡ä»¤æ‰§è¡Œæ—¶é—´ +ï¼ˆæŒ‡ä»¤æ¡æ•° -1ï¼‰ æµæ°´çº¿å‘¨æœŸ*\næµæ°´çº¿å‘¨æœŸï¼š2nsæ—¶é—´ï¼š2ns + 2ns + 1ns + (100 - 1) * 2ns = 103 ns\næµæ°´çº¿çš„ååç‡ï¼ˆTPï¼‰ï¼šæ˜¯æŒ‡åœ¨å•ä½æ—¶é—´å†…æµæ°´çº¿æ‰€å®Œæˆçš„ä»»åŠ¡æ•°é‡æˆ–è¾“å‡ºçš„ç»“æœæ•°é‡ã€‚è®¡ç®—å…¬å¼ï¼šTP=æŒ‡ä»¤æ¡æ•°/æµæ°´çº¿æ‰§è¡Œæ—¶é—´\nTP = 100 / [2ns + 2ns + 1ns + (100 - 1) * 2ns] = 100 / 103\næµæ°´çº¿çš„åŠ é€Ÿæ¯”ï¼šå®ŒæˆåŒæ ·ä¸€æ‰¹ä»»åŠ¡ï¼Œä¸ä½¿ç”¨æµæ°´çº¿æ‰€ç”¨çš„æ—¶é—´ä¸ä½¿ç”¨æµæ°´çº¿æ‰€ç”¨çš„æ—¶é—´ä¹‹æ¯”ã€‚è®¡ç®—å…¬å¼ï¼šS=ä¸ä½¿ç”¨æµæ°´çº¿æ‰§è¡Œæ—¶é—´/ä½¿ç”¨æµæ°´çº¿æ‰§è¡Œæ—¶é—´\nS = (2ns + 2ns + 1ns) * 100 / [2ns + 2ns + 1ns + (100 - 1) * 2ns] = 500 / 103\nè¾“å…¥è¾“å‡ºæŠ€æœ¯\nCPU ä¸å¤–è®¾ä¹‹é—´çš„æ•°æ®ä¼ è¾“æ–¹å¼\n\n\nç›´æ¥ç¨‹åºæ§åˆ¶æ–¹å¼ç›´æ¥ç¨‹åºæ§åˆ¶æ–¹å¼æ˜¯æŒ‡åœ¨å®Œæˆæ•°æ®çš„è¾“å…¥/è¾“å‡ºä¸­ï¼Œæ•´ä¸ªè¾“å…¥/è¾“å‡ºçš„è¿‡ç¨‹æ˜¯åœ¨ CPU æ‰§è¡Œç¨‹åºçš„æ§åˆ¶ä¸‹å®Œæˆçš„ã€‚è¿™ç§æ–¹å¼è¿˜å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§ï¼š\n\næ— æ¡ä»¶ä¼ è¾“æ–¹å¼ï¼šæ— æ¡ä»¶åœ°ä¸ CPU äº¤æ¢æ•°æ®ã€‚\nç¨‹åºæŸ¥è¯¢æ–¹å¼ï¼šå…ˆé€šè¿‡ CPU æŸ¥è¯¢å¤–è®¾çŠ¶æ€ï¼Œå‡†å¤‡å¥½ä¹‹åå†ä¸ CPU äº¤æ¢æ•°æ®ã€‚\n\n\n\nä¸­æ–­æ–¹å¼ä¸­æ–­æ–¹å¼åˆ©ç”¨ä¸­æ–­æœºåˆ¶ï¼Œä½¿ I/O ç³»ç»Ÿåœ¨ä¸å¤–è®¾äº¤æ¢æ•°æ®æ—¶ï¼ŒCPU æ— é¡»ç­‰å¾…ï¼Œä¹Ÿä¸å¿…æŸ¥è¯¢ I/O çŠ¶æ€ï¼Œå³å¯ä»¥æŠ½èº«å‡ºæ¥å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œå› æ­¤æé«˜äº†ç³»ç»Ÿæ•ˆç‡ã€‚\n\n\nç›´æ¥å­˜å‚¨å™¨å­˜å–æ–¹å¼ï¼ˆDMAï¼‰æ˜¯åœ¨å­˜å‚¨å™¨ä¸ I/O è®¾å¤‡é—´ç›´æ¥ä¼ é€æ•°æ®ï¼Œå³åœ¨å†…å­˜ä¸ I/O è®¾å¤‡ä¹‹é—´ä¼ é€ä¸€ä¸ªæ•°æ®å—çš„è¿‡ç¨‹ä¸­ï¼Œä¸éœ€è¦ CPU çš„ä»»ä½•å¹²æ¶‰ï¼Œæ˜¯ä¸€ç§å®Œå…¨ç”± DMA ç¡¬ä»¶å®Œæˆ I/O æ“ä½œçš„æ–¹å¼ã€‚\n\n\nè¾“å…¥/è¾“å‡ºå¤„ç†æœºï¼ˆIOPï¼‰æ˜¯ä¸€ä¸ªä¸“ç”¨å¤„ç†æœºï¼Œç”¨äºå®Œæˆä¸»æœºçš„è¾“å…¥/è¾“å‡ºæ“ä½œã€‚IOP æ ¹æ®ä¸»æœºçš„ I/O å‘½ä»¤ï¼Œå®Œæˆå¯¹å¤–è®¾æ•°æ®çš„è¾“å…¥/è¾“å‡ºã€‚\n\n\nå­˜å‚¨ç³»ç»Ÿ\nå±‚æ¬¡ç»“æ„\nCPUé«˜é€Ÿç¼“å­˜ï¼ˆCacheï¼‰-è¾…åŠ©ç¡¬ä»¶ä¸»å­˜-è¾…åŠ©ç¡¬ä»¶/è½¯ä»¶è¾…å­˜\nä¸»å­˜ - è¾…å­˜ï¼ˆç¡¬ä»¶ + æ“ä½œç³»ç»Ÿï¼‰ï¼šå®ç°è™šæ‹Ÿç³»ç»Ÿå­˜å‚¨ï¼Œè§£å†³äº†ä¸»å­˜å®¹é‡ä¸å¤Ÿçš„é—®é¢˜\nCache - ä¸»å­˜ï¼ˆç¡¬ä»¶è‡ªåŠ¨å®Œæˆï¼‰ï¼šè§£å†³äº†ä¸»å­˜ä¸ CPU é€Ÿåº¦ä¸åŒ¹é…çš„é—®é¢˜\nåˆ†ç±»\n\n\næŒ‰ä½ç½®åˆ†ç±»ï¼šå¯ä»¥åˆ†ä¸ºå†…å­˜å’Œå¤–å­˜å†…å­˜ï¼ˆä¸»å­˜ï¼‰ï¼šç”¨æ¥å­˜å‚¨å½“å‰è¿è¡Œæ‰€éœ€è¦çš„ç¨‹åºå’Œæ•°æ®ï¼Œé€Ÿåº¦å¿«ã€å®¹é‡å°ã€‚å¤–å­˜ï¼ˆè¾…å­˜ï¼‰ï¼šç”¨æ¥å­˜å‚¨å½“å‰ä¸å‚ä¸è¿è¡Œçš„æ•°æ®ï¼Œå®¹é‡å¤§ï¼Œé€Ÿåº¦æ…¢ã€‚\n\n\næŒ‰ææ–™åˆ†ç±»ï¼Œå¯åˆ†ä¸ºç£å­˜å‚¨å™¨ã€åŠå¯¼ä½“å­˜å‚¨å™¨å’Œå…‰å­˜å‚¨å™¨ã€‚ç£å­˜å‚¨å™¨ï¼šç”¨ç£æ€§ä»‹è´¨åšæˆï¼Œå¦‚ç£èŠ¯ã€ç£æ³¡ã€ç£ç›˜ã€ç£å¸¦ç­‰åŠå¯¼ä½“å­˜å‚¨å™¨ï¼šæ ¹æ®æ‰€ç”¨å…ƒä»¶åˆå¯åˆ†ä¸ºåŒæå‹å’Œ MOS å‹ä¸¤ç±»ï¼›æ ¹æ®æ˜¯å¦éœ€è¦åˆ·æ–°åˆå¯åˆ†ä¸ºé™æ€å’ŒåŠ¨æ€ä¸¤ç±»ã€‚å…‰å­˜å‚¨å™¨ï¼šç”±å…‰å­¦ã€ç”µå­¦å’Œæœºæ¢°éƒ¨ä»¶ç­‰ç»„æˆï¼Œå¦‚å…‰ç›˜å­˜å‚¨å™¨ã€‚\n\n\næŒ‰å·¥ä½œæ–¹å¼åˆ†ï¼Œå¯åˆ†ä¸ºè¯»/å†™å­˜å‚¨å™¨å’Œåªè¯»å­˜å‚¨å™¨ã€‚è¯»/å†™å­˜å‚¨å™¨ï¼ˆRAMï¼‰å®ƒæŒ‡æ—¢èƒ½è¯»å–æ•°æ®ä¹Ÿèƒ½å­˜å…¥æ•°æ®çš„å­˜å‚¨å™¨ã€‚åªè¯»å­˜å‚¨å™¨ï¼ˆROMï¼‰å·¥ä½œè¿‡ç¨‹ä¸­ä»…èƒ½è¯»å–çš„å­˜å‚¨å™¨ã€‚\n\n\n\n\nå›ºå®šåªè¯»å­˜å‚¨å™¨ï¼ˆROMï¼‰ã€‚è¿™ç§å­˜å‚¨å™¨æ˜¯åœ¨å‚å®¶ç”Ÿäº§æ—¶å°±å†™å¥½æ•°æ®çš„ï¼Œå…¶å†…å®¹åªèƒ½è¯»å‡ºï¼Œä¸èƒ½æ”¹å˜ã€‚ä¸€èˆ¬ç”¨äºå­˜æ”¾ç³»ç»Ÿç¨‹åº BIOSå’Œç”¨äºå¾®ç¨‹åºæ§åˆ¶ã€‚\n\n\nå¯ç¼–ç¨‹çš„åªè¯»å­˜å‚¨å™¨ï¼ˆPROMï¼‰ã€‚å…¶ä¸­çš„å†…å®¹å¯ä»¥ç”±ç”¨æˆ·ä¸€æ¬¡æ€§åœ°å†™å…¥ï¼Œå†™å…¥åä¸èƒ½å†ä¿®æ”¹ã€‚\n\n\nå¯æ“¦é™¤å¯ç¼–ç¨‹çš„çš„åªè¯»å­˜å‚¨å™¨ï¼ˆEPROMï¼‰ã€‚å…¶ä¸­çš„å†…å®¹æ—¢å¯ä»¥è¯»å‡ºï¼Œä¹Ÿå¯ä»¥ç”±ç”¨æˆ·å†™å…¥ï¼Œå†™å…¥åè¿˜å¯ä»¥ä¿®æ”¹ï¼Œç´«å¤–çº¿ç…§å°„æ“¦é™¤ä¿¡æ¯ã€‚\n\n\nç”µæ“¦é™¤å¯ç¼–ç¨‹çš„çš„åªè¯»å­˜å‚¨å™¨ï¼ˆEEPROMï¼‰ã€‚ä¸ EPROM ç›¸ä¼¼ï¼ŒEEPROM ä¸­çš„å†…å®¹æ—¢å¯ä»¥è¯»å‡ºï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæ”¹å†™ï¼Œç”µæ“¦é™¤çš„æ–¹æ³•è¿›è¡Œæ•°æ®çš„æ”¹å†™ã€‚\n\n\né—ªå­˜å­˜å‚¨å™¨ï¼ˆFlash Memoryï¼‰ã€‚ç®€ç§°é—ªå­˜ï¼Œé—ªå­˜çš„ç‰¹æ€§ä»‹äº EPROM å’Œ EEPROM ä¹‹é—´ï¼Œç±»ä¼¼äº EEPROMï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç”µä¿¡å·è¿›è¡Œä¿¡æ¯çš„æ“¦é™¤æ“ä½œã€‚æ•´å—é—ªå­˜å¯ä»¥åœ¨æ•°ç§’å†…åˆ é™¤ï¼Œé€Ÿåº¦è¿œå¿«äº EPROMã€‚\n\n\né«˜é€Ÿç¼“å­˜ -Cache\né«˜é€Ÿç¼“å­˜ï¼ˆCacheï¼‰æ˜¯ä½äº CPU å’Œä¸»å­˜ä¹‹é—´çš„é«˜é€Ÿå­˜å‚¨å­ç³»ç»Ÿã€‚\nç›®çš„ï¼šæé«˜å­˜å‚¨å™¨çš„å¹³å‡è®¿é—®é€Ÿåº¦ï¼Œä½¿å­˜å‚¨å™¨çš„é€Ÿåº¦ä¸ CPU çš„é€Ÿåº¦ç›¸åŒ¹é…ã€‚\nåœ°å€å˜æ¢å’Œæ•°æ®å—çš„æ›¿æ¢ç®—æ³•å‡ç”±ç¡¬ä»¶å®ç°ã€‚\né€šå¸¸è¢«é›†æˆåˆ° CPU å†…ï¼Œä»¥æé«˜è®¿é—®é€Ÿåº¦ï¼Œå…¶ä¸»è¦ç‰¹ç‚¹æ˜¯å®¹é‡å°ã€é€Ÿåº¦å¿«ã€æˆæœ¬é«˜ã€‚\nCache çš„ç»„æˆ\n\n\nCache å­˜å‚¨å™¨éƒ¨åˆ†ï¼šç”¨æ¥å­˜æ”¾ä¸»å­˜çš„éƒ¨åˆ†å¤åˆ¶ä¿¡æ¯ã€‚\n\n\næ§åˆ¶éƒ¨åˆ†çš„åŠŸèƒ½ï¼šåˆ¤æ–­ CPU è¦è®¿é—®çš„ä¿¡æ¯æ˜¯å¦åœ¨ Cache å­˜å‚¨å™¨ä¸­ï¼Œè‹¥åœ¨ï¼Œå³ä¸ºå‘½ä¸­ï¼Œè‹¥ä¸åœ¨åˆ™æ²¡æœ‰å‘½ä¸­ã€‚\n\n\nCache çš„ä¸‰ç§åœ°å€æ˜ å°„\nåœ°å€æ˜ åƒï¼šæŠŠä¸»å­˜ä¸­çš„åœ°å€æ˜ å°„æˆ Cache å­˜å‚¨å™¨ä¸­çš„åœ°å€\n\n\nç›´æ¥æ˜ å°„ï¼šå°±æ˜¯ä¸»å­˜çš„å—ä¸ Cache ä¸­å—çš„å¯¹åº”å…³ç³»æ˜¯å›ºå®šçš„ã€‚ä¸»å­˜ä¸­çš„å—åªèƒ½å­˜æ”¾åœ¨ Cache å­˜å‚¨å™¨çš„ç›¸åŒå—å·ä¸­ã€‚å› æ­¤ï¼Œåªè¦ä¸»å­˜åœ°å€ä¸­çš„ä¸»å­˜åŒºå·ä¸ Cache ä¸­çš„ä¸»å­˜åŒºå·ç›¸åŒï¼Œåˆ™è¡¨æ˜è®¿é—® Cache å‘½ä¸­ã€‚ä¼˜ç‚¹ï¼šåœ°å€å˜æ¢å¾ˆç®€å•ï¼Œç¼ºç‚¹ï¼šçµæ´»æ€§å·®ã€‚Cache åˆ†å—ï¼Œä¸»å­˜åˆ†åŒºï¼Œæ¯ä¸ªåŒºå†åˆ†å—ï¼Œå¹¶ä¸”æ¯ä¸ªåŒºçš„å—æ•°å’Œ Cache çš„åˆ†å—ç›¸åŒã€‚\n\n\nå…¨ç›¸è”æ˜ åƒï¼šå…è®¸ä¸»å­˜ä¸­çš„ä»»ä¸€å—å¯ä»¥è°ƒå…¥ Cache çš„ä»»ä¸€å—çš„ç©ºé—´ã€‚åœ¨åœ°å€å˜æ¢æ—¶ï¼Œå°†ä¸»å­˜åœ°å€é«˜ä½è¡¨ç¤ºçš„ä¸»å­˜å—å·ä¸ Cache ä¸­çš„ä¸»å­˜å—å·è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥ç›¸åŒåˆ™ä¸ºå‘½ä¸­ã€‚ä¼˜ç‚¹ï¼šä¸»å­˜çš„å—è°ƒå…¥ Cache çš„ä½ç½®ä¸å—é™åˆ¶ï¼Œååˆ†çµæ´»ã€‚å…¶ç¼ºç‚¹æ˜¯æ— æ³•ä»ä¸»å­˜å—å·ä¸­è·å¾— Cache çš„å—å·ï¼Œå˜æ¢æ¯”è¾ƒå¤æ‚ï¼Œé€Ÿåº¦æ¯”è¾ƒæ…¢\n\n\nç»„ç›¸è”æ˜ åƒï¼šè¿™ç§æ–¹å¼æ˜¯å‰é¢ä¸¤ç§æ–¹å¼çš„æŠ˜ä¸­ã€‚å…·ä½“æ–¹æ³•æ˜¯å°† Cache å…ˆåˆ†æˆç»„å†åˆ†å—ã€‚ç»„ç»„ç›¸è”æ˜ åƒå°±æ˜¯ç»„é—´é‡‡ç”¨ç›´æ¥æ˜ åƒæ–¹å¼ï¼Œè€Œç»„å†…çš„å—é‡‡ç”¨å…¨ç›¸è”æ˜ åƒæ–¹å¼ã€‚\n\n\nCache çš„æ€§èƒ½åˆ†æ\n\nè‹¥ H ä¸º Cache çš„å‘½ä¸­ç‡ï¼Œtc ä¸º Cache çš„å­˜å–æ—¶é—´ï¼Œtm ä¸ºä¸»å­˜çš„è®¿é—®æ—¶é—´ï¼Œåˆ™ Cache çš„ç­‰æ•ˆè®¿é—®æ—¶é—´ ta ä¸º\n\nta = H * tc + (1 - H) * tm\nä½¿ç”¨ Cache æ¯”ä¸ä½¿ç”¨ Cache çš„ CPU è®¿é—®å­˜å‚¨å™¨é€Ÿåº¦æé«˜çš„å€æ•° r å¯ä»¥ç”¨ä¸‹å¼æ±‚å¾—\nr = tm / ta\nä¸»å­˜çš„æ‰©å±•\nä½æ‰©å±•\nå­—æ‰©å±•\nä¸»å­˜çš„ç¼–å€\n\nå†…å­˜åœ°å€ä» AC000H åˆ° C7FFFHï¼Œå…±æœ‰ ï¼ŸK ä¸ªåœ°å€å•å…ƒï¼Œå¦‚æœè¯¥å†…å­˜åœ°å€æŒ‰å­—ï¼ˆ16bitï¼‰ç¼–å€ï¼Œç”± 28 ç‰‡å­˜å‚¨å™¨èŠ¯ç‰‡æ„æˆã€‚å·²çŸ¥æ„æˆæ­¤å†…å­˜çš„èŠ¯ç‰‡æ¯ç‰‡æœ‰ 16K ä¸ªå­˜å‚¨å•å…ƒï¼Œåˆ™è¯¥èŠ¯ç‰‡æ¯ä¸ªå­˜å‚¨å•å…ƒå­˜å‚¨ ï¼Ÿä½ã€‚\n1K=2^10\n1M=2^20\n1G=2^30\n\nC7FFFH - AC000H + 1 = 1C000H = 1 * 2^4^4 + 12 * 2^4^3 = (2^4 + 12)*2^12= 28 * 2^12åœ°å€å•å…ƒ = 28 * 2^12 / 2^10 = 28 * 2^2 = 112 K\n112K * 16 = 28 * 16K * å­˜å‚¨ä½æ•°å­˜å‚¨ä½æ•° = 4 bit\nè™šæ‹Ÿå­˜å‚¨å™¨\nè™šæ‹Ÿå­˜å‚¨å™¨æ˜¯ç”±ä¸»å­˜ã€è¾…å­˜ã€å­˜å‚¨ç®¡ç†å•å…ƒåŠæ“ä½œç³»ç»Ÿä¸­çš„å­˜å‚¨ç®¡ç†è½¯ä»¶ç»„æˆçš„å­˜å‚¨ç³»ç»Ÿã€‚ç¨‹åºå‘˜ä½¿ç”¨è¯¥å­˜å‚¨ç³»ç»Ÿæ—¶ï¼Œå¯ä»¥ä½¿ç”¨çš„å†…å­˜ç©ºé—´å¯è¿œå¤§äºä¸»å­˜çš„ç‰©ç†ç©ºé—´ï¼Œä½†å®é™…ä¸Šå¹¶ä¸å­˜åœ¨é‚£ä¹ˆå¤§çš„ä¸»å­˜ï¼Œé¡¾ç§°å…¶ä¸ºè™šæ‹Ÿå­˜å‚¨å™¨ã€‚\nè™šæ‹Ÿå­˜å‚¨å™¨ä½¿å­˜å‚¨ç³»ç»Ÿæ—¢å…·æœ‰ç›¸å½“äºå¤–å­˜çš„å®¹é‡åˆå…·æœ‰æ¥è¿‘äºä¸»å­˜çš„è®¿é—®é€Ÿåº¦ã€‚\nç£ç›˜å­˜å‚¨å™¨\nå­˜å–æ—¶é—´ = å¯»é“æ—¶é—´ + ç­‰å¾…æ—¶é—´ï¼ˆå¹³å‡å®šä½æ—¶é—´ + è½¬åŠ¨å»¶è¿Ÿï¼‰\næ³¨æ„ï¼šå¯»é“æ—¶é—´æ˜¯æŒ‡ç£å¤´ç§»åŠ¨åˆ°ç£é“æ‰€éœ€çš„æ—¶é—´ï¼›ç­‰å¾…æ—¶é—´ä¸ºç­‰å¾…è¯»å†™çš„æ‰‡åŒºè½¬åˆ°ç£å¤´ä¸‹æ–¹æ‰€ç”¨çš„æ—¶é—´ã€‚\næ€»çº¿ç³»ç»Ÿ\n\n\nç‰‡å†…æ€»çº¿ï¼ˆå†…éƒ¨æ€»çº¿ï¼‰ç‰‡å†…æ€»çº¿æ˜¯èŠ¯ç‰‡å†…éƒ¨çš„æ€»çº¿ã€‚å®ƒæ˜¯ CPU èŠ¯ç‰‡å†…éƒ¨å¯„å­˜å™¨ä¸å¯„å­˜å™¨ä¹‹é—´ã€å¯„å­˜å™¨ä¸ ALU ä¹‹é—´çš„å…¬å…±è¿æ¥çº¿ã€‚\n\n\nç³»ç»Ÿæ€»çº¿ç³»ç»Ÿæ€»çº¿æ˜¯è®¡ç®—æœºç³»ç»Ÿå†…å„åŠŸèƒ½éƒ¨ä»¶ï¼ˆCPUã€ä¸»å­˜ã€I/O æ¥å£ï¼‰ä¹‹é—´ç›¸äº’è¿æ¥çš„æ€»çº¿ã€‚æŒ‰ç³»ç»Ÿæ€»çº¿ä¼ è¾“ä¿¡æ¯å†…å®¹çš„ä¸åŒï¼Œåˆå¯ä»¥åˆ†ä¸º 3 ç±»ï¼šæ•°æ®æ€»çº¿ã€åœ°å€æ€»çº¿å’Œæ§åˆ¶æ€»çº¿ã€‚\n\n\né€šä¿¡æ€»çº¿ï¼ˆå¤–éƒ¨æ€»çº¿ï¼‰ç”¨äºè®¾å¤‡ä¸€çº§çš„äº’è¿ï¼Œè®¡ç®—æœºå¯é€šè¿‡è¯¥æ€»çº¿å’Œå…¶ä»–è®¾å¤‡è¿›è¡Œä¿¡æ¯ä¸æ•°æ®äº¤æ¢ã€‚\n\n\nç£ç›˜é˜µåˆ—æŠ€æœ¯ï¼ˆRAIDï¼‰\nç£ç›˜é˜µåˆ—ç”±å¤šå°ç£ç›˜å­˜å‚¨å™¨ç»„æˆï¼Œæ˜¯å¿«é€Ÿã€å¤§å®¹é‡ä¸”é«˜å¯é çš„å¤–å­˜å­ç³»ç»Ÿã€‚ç°åœ¨å¸¸è§çš„ç‹¬ç«‹å†—ä½™ç£ç›˜é˜µåˆ—ï¼ˆRAIDï¼‰å°±æ˜¯ä¸€ç§ç”±å¤šå—ç‹¬ç«‹ç£ç›˜æ„æˆçš„å†—ä½™é˜µåˆ—ã€‚RAID æŠ€æœ¯åˆ†ä¸ºå‡ ç§ä¸åŒçš„ç­‰çº§ï¼Œåˆ†åˆ«å¯ä»¥æä¾›ä¸åŒçš„é€Ÿåº¦ã€å®‰å…¨æ€§å’Œæ€§ä»·æ¯”ã€‚\n\n\n\nRAID çº§\nè¯´æ˜\n\n\n\n\nRAID-0\nä¸€ç§ä¸å…·å¤‡å®¹é”™èƒ½åŠ›çš„ç£ç›˜é˜µåˆ—\n\n\nRAID-1\næ˜¯é‡‡ç”¨é•œåƒå®¹é”™æŠ€æœ¯æ”¹å–„å¯é æ€§çš„ä¸€ç§ç£ç›˜é˜µåˆ—\n\n\nRAID-2\næ˜¯é‡‡ç”¨æµ·æ˜ç è¿›è¡Œé”™è¯¯æ£€æµ‹çš„ä¸€ç§ç£ç›˜é˜µåˆ—\n\n\nRAID-3\nå‡å°‘äº†ç”¨äºæ£€éªŒçš„ç£ç›˜å­˜å‚¨å™¨å°æ•°ï¼Œä»è€Œæé«˜äº†ç£ç›˜é˜µåˆ—çš„æœ‰æ•ˆå®¹é‡ï¼Œä¸€èˆ¬åªæœ‰ä¸€ä¸ªæ£€éªŒç›˜\n\n\nRAID-4\næ˜¯ä¸€ç§å¯ä»¥ç‹¬ç«‹åœ°å¯¹ç»„å†…å„ç£ç›˜è¿›è¡Œè¯»å†™çš„ç£ç›˜é˜µåˆ—ï¼Œè¯¥é˜µåˆ—ä¹Ÿåªç”¨ä¸€ä¸ªæ£€éªŒç›˜\n\n\nRAID-5\næ˜¯å¯¹ RAID-4 çš„ä¸€ç§æ”¹è¿›ï¼Œä»–ä¸è®¾ç½®ä¸“é—¨çš„æ£€éªŒç›˜ã€‚åŒä¸€å°ç£ç›˜ä¸Šæ—¢è®°å½•æ•°æ®ï¼Œä¹Ÿè®°å½•æ£€æµ‹ä¿¡æ¯ã€‚è¿™å°±è§£å†³äº†å‰é¢å¤šå°ç£ç›˜æœºäº‰ç”¨ä¸€å°æ£€éªŒç›˜çš„é—®é¢˜\n\n\nRAID-6\né‡‡ç”¨ä¸¤çº§æ•°æ®å†—ä½™å’Œæ–°çš„æ•°æ®ç¼–ç ä»¥è§£å†³æ•°æ®æ¢å¤é—®é¢˜ï¼Œåœ¨ä¸¤ä¸ªç£ç›˜å‡ºç°æ•…éšœæ—¶ä»ç„¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚åœ¨è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œåˆ†åˆ«è¿›è¡Œä¸¤ä¸ªç‹¬ç«‹çš„æ ¡éªŒè¿ç®—ï¼Œå½¢æˆä¸¤ä¸ªç‹¬ç«‹çš„å†—ä½™æ•°æ®ï¼Œå¹¶å†™å…¥ä¸¤ä¸ªä¸åŒçš„ç£ç›˜ã€‚\n\n\n\nè®¡ç®—æœºå¯é æ€§\nè®¡ç®—æœºç³»ç»Ÿçš„å¯é æ€§æ˜¯æŒ‡ä»å®ƒå¼€å§‹è¿è¡Œï¼ˆt=0ï¼‰åˆ°æŸä¸ªæ—¶åˆ» t è¿™æ®µæ—¶é—´å†…èƒ½æ­£å¸¸è¿è¡Œçš„æ¦‚ç‡ï¼Œç”¨ R(t) è¡¨ç¤º\nä¸²è”éƒ¨ä»¶çš„å¯é åº¦ = å„éƒ¨ä»¶çš„å¯é åº¦çš„ä¹˜ç§¯ä¸²è”éƒ¨ä»¶çš„å¯é åº¦ = 1 - å„éƒ¨ä»¶å¤±æ•ˆç‡çš„ä¹˜ç§¯\n","categories":["é¢è¯•","è½¯è€ƒ","ä¸­çº§-è½¯ä»¶è®¾è®¡å¸ˆ"],"tags":["è½¯è€ƒä¸­çº§"]}]